dir|^|Packages
file|^|Packages/index.php|^|66|^|1008653962
<?
include ("../Settings.php");
header("Location: $boardurl");
?>
file|^|Packages/server.list|^|164|^|1008653963
YaBB.info Avatars|^|http://www.yabb.info/packages/as
YaBB.info Mods|^|http://www.yabb.info/packages/mod
YaBB.info Language Packs|^|http://www.yabb.info/packages/lp
dir|^|Sources
file|^|Sources/Admin.php|^|96711|^|1008718663
<?php
/*****************************************************************************/
/* Admin.php                                                                 */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

global $adminplver;
$adminplver="YaBB SE";


// verify the user is an administrator
is_admin();

function Admin (){
	global $yytitle,$YaBBversion,$txt,$img,$scripturl,$color,$imagesdir,$settings,$username;
	global $realName,$cgi,$sourcedir,$recentsender,$db_prefix;

	$er = error_reporting(0);
	$serverDetails = file ("http://www.yabb.info/yabbinfo_versions.php");
	if (!$serverDetails)
		$serverDetails = file("$sourcedir/versions.php");
	error_reporting($er);
	foreach($serverDetails as $expr)
		eval($expr);

	// get the latest member stuff
	$request = mysql_query("SELECT memberName,realName FROM {$db_prefix}members ORDER BY dateRegistered DESC LIMIT 1");
	$temp = mysql_fetch_array($request);
	$name = (!isset($temp['realName']) || $temp['realName']=='')?$temp['memberName']:$temp['realName'];

	$thelatestmember = "<font size=2><B>$txt[656]</B></font> <font size=1><a href=\"$scripturl?action=viewprofile;user=$temp[memberName]\">$name</a></font>";

	// get the number of members
	$request = mysql_query("SELECT COUNT(*) as memcount FROM {$db_prefix}members");
	$temp = mysql_fetch_array($request);
	$memcount = $temp[0];

	// Load data for the 'remove old messages' feature, get totals, and get moderators
	$request = mysql_query("SELECT value FROM {$db_prefix}settings WHERE variable='maxdays'");
	$temp = mysql_fetch_array($request);
	$maxdays = $temp[0];

	$result = mysql_query("SELECT COUNT(*) as memcount FROM {$db_prefix}members;");
	$temp = mysql_fetch_row($result);
    $memcount = $temp[0];
	$result = mysql_query("SELECT COUNT(*) as totalm FROM {$db_prefix}messages;");
	$temp = mysql_fetch_row($result);
    $totalm = $temp[0];
	$result = mysql_query("SELECT COUNT(*) as totalt FROM {$db_prefix}topics;");
	$temp = mysql_fetch_row($result);
    $totalt = $temp[0];
	$result = mysql_query("SELECT COUNT(*) as totalb FROM {$db_prefix}boards;");
	$temp = mysql_fetch_row($result);
    $numboards = $temp[0];
	$result = mysql_query("SELECT COUNT(*) as totalc FROM {$db_prefix}categories;");
	$temp = mysql_fetch_row($result);
    $numcats = $temp[0];
	$result = mysql_query("SELECT COUNT(*) as click_total FROM {$db_prefix}log_clicks;");
	$temp = mysql_fetch_row($result);
    $yyclicks = $temp[0];

//	$avgt = $totalt / $memcount;
//	$avgm = $totalm / $memcount;  why the 'heck' (here's to StarSaber) are these needed?

	// load the administrators
	$request = mysql_query("SELECT memberName,realName FROM {$db_prefix}members WHERE memberGroup='Administrator'");
	$admins = array();
	while ($row = mysql_fetch_array($request))
		$admins[] = "<a href=\"$scripturl?action=viewprofile;user=$row[memberName]\">$row[realName]</a>";
	$administrators = implode(",",$admins);

	$yytitle = "$txt[208]";
	template_header();
	print <<<EOT
		<script language="javascript" TYPE="text/javascript">
		<!--
		function reqWin(desktopURL){
        desktop =window.open(desktopURL,"name","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,width=400,height=200,resizable=no");
        }
		// -->
	</script>
<table border="0" cellpadding="0" cellspacing="6" align="center" width="100%">
  <tr>
    <td colspan=2 width="100%">
    <table border="0" cellpadding="5" cellspacing="1" align="center" bgcolor="$color[bordercolor]" class="bordercolor" width="100%">
      <tr>
        <td bgcolor="$color[titlebg]" class="titlebg" height="23" align="center" colspan="2">
        <font size="4" color="$color[titletext]">$txt[208]</font></td>
      </tr><tr>
        <td class="windowbg" bgcolor="$color[windowbg]" valign="top" align="center" width="50%">
		<table border="0" cellpadding="0" cellspacing="0">
		<tr><td colspan=2><a href="javascript:reqWin('help.php?help=13')" class="help"><img src="$imagesdir/helptopics.gif" border="0" alt="$txt[119]"></a> <b>$txt[yse217]</td></tr>
		<tr><td colspan="2"><img src="$imagesdir/blank.gif" height="6" width="4" alt=""></td></tr>
EOT;
	$yabbinfo = getYaBBinfo();
	foreach($yabbinfo as $info){
		print "<tr><td colspan=\"2\"><font size=\"1\"><a href=\"$info[url]\">$info[subject]</a> | $info[author] | ".timeformat($info['logTime'])."</font></td></tr>\n";
		print "<tr><td><font size=\"1\">&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td><font size=\"1\">$info[details]</font></td></tr>\n";
		print "<tr><td colspan=\"2\"><img src=\"$imagesdir/blank.gif\" height=\"6\" width=\"4\" alt=\"\"></td></tr>\n";
	}
print<<<EOT
		</table>
        </td>
        <td class="windowbg" bgcolor="$color[windowbg]" width="50%" valign=top>
        <font size="2"><B>$txt[248] $settings[1] ($username)!</B></font>
        <font size="1"><BR>$txt[644]</font></td>
      </tr>
    </table>
    </td>
  </tr><tr>
    <td valign="top" width="50%">
    <table border="0" cellpadding="4" cellspacing="1" align="center" bgcolor="$color[bordercolor]" class="bordercolor" width="100%">
      <tr>
        <td class="catbg" bgcolor="$color[catbg]"><font size="4" class="catbg">$txt[424]</font></td>
      </tr><tr>
        <td bgcolor="$color[windowbg]" height="21" class="windowbg">
        <img src="$imagesdir/board.gif" alt="" border="0"> <font size="3"><b>$txt[427]</b></font></td>
      </tr><tr>
        <td bgcolor="$color[windowbg2]" height="21" class="windowbg2"><font size="2">
        <a href="$cgi;action=editnews">$txt[7]</a><br>
        <a href="$cgi;action=editagreement">$txt[yse11]</a><br>
        <a href="$cgi;action=managecats">$txt[3]</a><br>
        <a href="$cgi;action=manageboards">$txt[4]</a><br>
        <a href="$cgi;action=packages">$txt[yse198]</a><br>
		<a href="$cgi;action=manageattachments">$txt[yse201]</a><br><br></font>
        </td>
      </tr><tr>
        <td bgcolor="$color[windowbg]" height="21" class="windowbg">
        <img src="$imagesdir/board.gif" alt="" border="0"> <font size="3"><b>$txt[426]</b></font></td>
      </tr><tr>
        <td bgcolor="$color[windowbg2]" height="21" class="windowbg2"><font size="2">
        <a href="$cgi;action=viewmembers">$txt[5]</a><br>
        <a href="$cgi;action=modmemgr">$txt[8]</a><br>
        <a href="$cgi;action=mailing">$txt[6]</a><br>
        <a href="$cgi;action=ipban">$txt[206]</a><br>
        <a href="$cgi;action=setreserve">$txt[207]</a><br><br>
        <form action="$cgi;action=viewinactive" method="POST">
        <font size="2">$txt[yse71] <input type=text name="mindays" size="2" maxlength="3" value="30"> $txt[yse72]
        <input type="submit" value="$txt[305]"></font></form></font>
        </td>
      </tr><tr>
        <td bgcolor="$color[windowbg]" height="21" class="windowbg">
        <img src="$imagesdir/board.gif" alt="" border="0"> <font size="3"><b>$txt[428]</b></font></td>
      </tr><tr>
        <td bgcolor="$color[windowbg2]" height="21" class="windowbg2"><font size="2">
        <a href="$cgi;action=modtemp">$txt[216]</a><br>
        <a href="$cgi;action=modsettings">$txt[222]</a><br>
        <a href="$cgi;action=modifyModSettings">$txt[yse2]</a><br>
        <a href="$cgi;action=setcensor">$txt[135]</a><br><br></font>
        </td>
      </tr><tr>
        <td bgcolor="$color[windowbg]" height="21" class="windowbg">
        <img src="$imagesdir/board.gif" alt="" border="0"> <font size="3"><b>$txt[501]</b></font></td>
      </tr><tr>
        <td width="340" bgcolor="$color[windowbg2]" height="21" class="windowbg2"><font size="2">
        <a href="$cgi;action=repairboards">$txt[610]</a><BR>
        <a href="$cgi;action=boardrecount">$txt[502]</a><br>
        <a href="$cgi;action=clean_log">$txt[202]</a><br>
        <form action="$cgi;action=removeoldthreads" method="POST">
        <font size="2">$txt[124] <input type=text name="maxdays" size="2" value="$maxdays"> $txt[579]
        <input type="submit" value="$txt[31]"></font></form>
        </td>
      </tr>
    </table>
    </td>
    <td valign="top" width="100%">
    <table border="0" cellpadding="4" cellspacing="1" align="center" bgcolor="$color[bordercolor]" class="bordercolor" width="100%">
      <tr>
        <td class="catbg" bgcolor="$color[catbg]"><font size="4" class="catbg">$txt[645]</font></td>
      </tr><tr>
        <td bgcolor="$color[windowbg]" class="windowbg" height="21">
        <img src="$imagesdir/cat.gif" alt="" border="0"> <font size="3"><B>$txt[94]</B></font><BR></td>
      </tr><tr>
	<td bgcolor="$color[windowbg2]" class="windowbg2">
	<table border="0" cellpadding="1" cellspacing="0" width="100%">
	  <tr>
            <td><font size="2">$txt[488]</font></td>
            <td align="right"><font size="2">$memcount</font></td>
          </tr><tr>
            <td><font size="2">$txt[489]</font></td>
            <td align="right"><font size="2">$totalm</font></td>
          </tr><tr>
            <td><font size="2">$txt[490]</font></td>
            <td align="right"><font size="2">$totalt</font></td>
          </tr><tr>
            <td><font size="2">$txt[658]</font></td>
            <td align="right"><font size="2">$numcats</font></td>
          </tr><tr>
            <td><font size="2">$txt[665]</font></td>
            <td align="right"><font size="2">$numboards</font></td>
          </tr><tr>
            <td><font size="2">$txt[691] <font size="1">($txt[692])</font>:</font></td>
            <td align="right"><font size="2">$yyclicks</font></td>
          </tr><tr>
            <td colspan="2"><font size="2"><a href="$scripturl?action=showclicks">$txt[693]</a></font></td>
          </tr>
        </table>
	</td>
      </tr><tr>
        <td bgcolor="$color[windowbg]" class="windowbg" height="21">
        <img src="$imagesdir/cat.gif" alt="" border="0"> <font size="3"><B>$txt[657]</B></font><BR></td>
      </tr><tr>
	<td bgcolor="$color[windowbg2]" class="windowbg2">
        $thelatestmember<BR>
        <font size="2"><B>$txt[659]</b></font><font size="1"> 
EOT;
        include_once("$sourcedir/Recent.php");
        $recentsender = "admin";
		LastPost();
	print <<<EOT
        </font><BR><BR>
	<font size="2"><B>$txt[684]:</B></font> <font size="1">$administrators</font><BR><BR>
        <font size="2"><b>$txt[425]:</b></font>
        <font size="1">$YaBBversion/$GLOBALS[server_YaBBversion]</font><BR>
        <center><font size="2"><a href="$cgi;action=detailedversion">$txt[429]</a></font></center><BR></td>
      </tr>
    </table>
		<br>
<table border="0" cellpadding="5" cellspacing="1" align="center" bgcolor="$color[bordercolor]" class="bordercolor" width="100%">
      <tr>
	<td class="catbg" bgcolor="$color[catbg]">
	<img src="$imagesdir/xx.gif" alt="" border="0">
	<font size="4" class="catbg">$txt[571]</font></td>
      </tr><tr>
        <td class="windowbg" bgcolor="$color[windowbg]">
        <font size="1"><BR><i><B>YaBB SE Dev Team:</B> </i>Joseph Fung, Jeff Lewis, Dave Baughman, Christian Land, Peter Crouch, Zef Hemel, Ted Suzman, Tim Ceuppens, Philip Renich and the rest who helped lay the foundation with YaBB 1 Final and YaBB 1 Gold.<br> <br>
		<i><B>YaBB SE Beta Testers:</B> </i>Edwin Weij, Dave Smulders, Michael Prager, John R, Tom Smid, Shaun, Shoeb Omar, Patty Breen, Chris Boston, Mohammed Alimul, Richard Bongiovanni, Andrea Hubacher, Ian Fette, Brian McClure and Darren Hedlund</font>
        <BR><BR></td>
      </tr>
</table>
    </td>
  </tr>
</table>
EOT;
	footer();
	obExit();
}

/****************************************/
/* FORUM CONTROLS                       */
/****************************************/
function EditNews (){
	global $yytitle,$txt,$cgi,$color,$imagesdir,$db_prefix;
	$request = mysql_query("SELECT value FROM {$db_prefix}settings WHERE variable='news'");
	$temp = mysql_fetch_row($request);
	$news = $temp[0];
	$yytitle = $txt[7];
	template_header();
	print <<<EOT
<form action="$cgi;action=editnews2" method="POST">
<table border="0" width="70%" cellspacing="1" cellpadding="3" bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]">
    	<script language="javascript" TYPE="text/javascript">
		<!--
		function reqWin(desktopURL){
        desktop =window.open(desktopURL,"name","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,width=400,height=200,resizable=no");
        }
		// -->
	</script>
    <a href="javascript:reqWin('help.php?help=2')" class="help"><img src="$imagesdir/helptopics.gif" border="0" alt="$txt[119]"></a>
    <font size="2" class="text1" color="$color[titletext]"><b>$txt[7]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]"><BR><font size="1">$txt[670]</font><BR><BR></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]" align="center"><BR>
    <font size="2">
    <textarea cols="70" rows="8" name="news">$news</textarea><br><input type="submit" value="$txt[10]"></font><BR></td>
  </tr>
</table>
</form>
EOT;
	footer();
	obExit();
}

function EditNews2 (){
	global $news,$cgi,$yySetLocation,$db_prefix;
	$request = mysql_query("UPDATE {$db_prefix}settings SET value='$news' WHERE variable='news'");
	$yySetLocation = "$cgi;action=admin";
	redirectexit();
}

function EditAgreement (){
	global $yytitle,$txt,$cgi,$color,$imagesdir,$db_prefix;
	$request = mysql_query("SELECT value FROM {$db_prefix}settings WHERE variable='agreement'");
	$temp = mysql_fetch_row($request);
	$agreement = $temp[0];
	$yytitle = $txt['yse11'];
	template_header();
	print <<<EOT
<form action="$cgi;action=editagreement2" method="POST">
<table border="0" width="70%" cellspacing="1" cellpadding="3" bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]">
    	<script language="javascript" TYPE="text/javascript">
		<!--
		function reqWin(desktopURL){
        desktop =window.open(desktopURL,"name","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,width=400,height=200,resizable=no");
        }
		// -->
	</script>
    <a href="javascript:reqWin('help.php?help=3')" class="help"><img src="$imagesdir/helptopics.gif" border="0" alt="$txt[119]"></a>
    <font size="2" class="text1" color="$color[titletext]"><b>$txt[yse11]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]"><BR><font size="1">$txt[yse12]</font><BR><BR></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]" align="center"><BR>
    <font size="2">
    <textarea cols="70" rows="20" name="agreement">$agreement</textarea><br><input type="submit" value="$txt[10]"></font><BR></td>
  </tr>
</table>
</form>
EOT;
	footer();
	obExit();
}

function EditAgreement2 (){
	global $agreement,$cgi,$yySetLocation,$db_prefix;
	$request = mysql_query("UPDATE {$db_prefix}settings SET value='$agreement' WHERE variable='agreement'");
	$yySetLocation = "$cgi;action=admin";
	redirectexit();
}

/****************************************/
/* MEMBER CONTROLS                      */
/****************************************/
function ViewMembers (){
	global $yytitle,$txt,$color,$cgi,$imagesdir,$db_prefix;
	$yytitle = $txt[9];
	template_header();
	print <<<EOT
<table border="0" width="300" cellspacing="1" cellpadding="2" bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]">
    <script language="javascript" TYPE="text/javascript">
		<!--
		function reqWin(desktopURL){
        desktop =window.open(desktopURL,"name","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,width=400,height=200,resizable=no");
        }
		// -->
	</script>
    <a href="javascript:reqWin('help.php?help=4')" class="help"><img src="$imagesdir/helptopics.gif" border="0" alt="$txt[119]"></a>
    <font size="2" class="text1" color="$color[titletext]"><b>$txt[9]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]" align="left" width="95%">
    <form action="$cgi;action=deletemultimembers" method="POST">
    <table border="0" cellspacing="4" cellpadding="0" align="center" width="95%">
EOT;
	$request = mysql_query("SELECT memberName,realName,ID_MEMBER FROM {$db_prefix}members WHERE 1 ORDER BY memberName");
	while ($curmem = mysql_fetch_array($request)) {
		$rname = isset($curmem['realName'])?"($curmem[realName])":'';
        if ($curmem['memberName'] == "admin") {
			print "      <tr>\n        <td><font size=\"2\"><a href=\"$cgi;action=viewprofile;user=$curmem[memberName]\">$curmem[memberName] $rname</a></font></td><td> &nbsp;&nbsp;</td>\n      </tr>\n";
		} else {
			print "      <tr>\n        <td><font size=\"2\"><a href=\"$cgi;action=viewprofile;user=$curmem[memberName]\">$curmem[memberName] $rname</a></font></td><td> &nbsp;&nbsp;<input type=\"checkbox\" name=\"ID_MEMBER$curmem[ID_MEMBER]\"></td>\n      </tr>\n";
		}
	}
	print <<<EOT
	<tr>
	<td class="windowbg" bgcolor="$color[windowbg]" align="center"><input type="submit" value="$txt[608]"></td>
  </tr>
</table>
</form>
</td>
  </tr>
    </table>

EOT;
	footer();
	obExit();
}

function ViewInactiveMembers (){
	global $yytitle,$txt,$color,$cgi,$imagesdir,$db_prefix,$mindays;
	$yytitle = $txt[9];
	template_header();
    $daytime = strtotime("-$mindays days");

	print <<<EOT
<table border="0" width="300" cellspacing="1" cellpadding="2" bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]">
    <script language="javascript" TYPE="text/javascript">
		<!--
		function reqWin(desktopURL){
        desktop =window.open(desktopURL,"name","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,width=400,height=200,resizable=no");
        }
		// -->
	</script>
    <a href="javascript:reqWin('help.php?help=4')" class="help"><img src="$imagesdir/helptopics.gif" border="0" alt="$txt[119]"></a>
    <font size="2" class="text1" color="$color[titletext]"><b>$txt[yse99]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]" align="left" width="95%">
    <form action="$cgi;action=deletemultimembers" method="POST">
    <table border="0" cellspacing="4" cellpadding="0" align="center" width="95%">
EOT;
	$request = mysql_query("SELECT memberName,realName,ID_MEMBER,lastLogin FROM {$db_prefix}members WHERE (lastLogin <= $daytime) ORDER BY memberName");
	while ($curmem = mysql_fetch_array($request)) {
		$rname = isset($curmem['realName'])?"($curmem[realName])":'';
        $difference=jeffsdatediff(time(),$curmem['lastLogin']);
        if ($curmem['memberName'] == "admin") {
			print "      <tr>\n        <td><font size=\"2\"><a href=\"$cgi;action=viewprofile;user=$curmem[memberName]\">$curmem[memberName] $rname</a></font></td><td>&nbsp; $difference &nbsp;</td> <td> &nbsp;&nbsp;</td>\n      </tr>\n";
		} else {
			print "      <tr>\n        <td><font size=\"2\"><a href=\"$cgi;action=viewprofile;user=$curmem[memberName]\">$curmem[memberName] $rname</a></font></td><td>&nbsp; $difference &nbsp;</td><td> &nbsp;&nbsp;<input type=\"checkbox\" name=\"ID_MEMBER$curmem[ID_MEMBER]\"></td>\n      </tr>\n";
		}
	}
	print <<<EOT
	<tr>
	<td class="windowbg" bgcolor="$color[windowbg]" align="center"><input type="submit" value="$txt[608]"></td>
  </tr>
</table>
</form>
</td>
  </tr>
    </table>

EOT;
	footer();
	obExit();
}

function DeleteMultiMembers (){
	global $HTTP_POST_VARS,$yySetLocation,$scripturl,$db_prefix;
	foreach($HTTP_POST_VARS as $key => $value)
		if (substr($key,0,9)=='ID_MEMBER' && $value=='on'){
			$request = mysql_query("SELECT memberName FROM {$db_prefix}members WHERE ID_MEMBER=".substr($key,9)." LIMIT 1");
			$row = mysql_fetch_row($request);
			if (strcasecmp($row[0],'admin') != 0)
			{
				$request = mysql_query("UPDATE {$db_prefix}messages SET ID_MEMBER='-1' WHERE ID_MEMBER='".substr($key,9)."'");
				$request = mysql_query("DELETE FROM {$db_prefix}members WHERE ID_MEMBER=".substr($key,9)." LIMIT 1");
				$request = mysql_query("DELETE FROM {$db_prefix}log_topics WHERE memberName='$row[0]'");
				$request = mysql_query("DELETE FROM {$db_prefix}log_boards WHERE memberName='$row[0]'");
				$request = mysql_query("DELETE FROM {$db_prefix}log_mark_read WHERE memberName='$row[0]'");
				$request = mysql_query("DELETE FROM {$db_prefix}instant_messages WHERE (ID_MEMBER_TO=".substr($key,9)." AND deletedBy=0)");
				$request = mysql_query("DELETE FROM {$db_prefix}instant_messages WHERE (ID_MEMBER_FROM=".substr($key,9)." AND deletedBy=1)");
				$request = mysql_query("UPDATE {$db_prefix}instant_messages SET deletedBy=1 WHERE ID_MEMBER_TO=".substr($key,9));
				$request = mysql_query("UPDATE {$db_prefix}instant_messages SET deletedBy=0 WHERE ID_MEMBER_FROM=".substr($key,9));
			}
		}
	$yySetLocation = "$scripturl?action=admin";
	redirectexit();
}

function EditMemberGroups (){
	global $yytitle,$txt,$color,$imagesdir,$cgi,$db_prefix;
	$yytitle = $txt[8];
	template_header();
	$request = mysql_query("SELECT ID_GROUP,membergroup FROM {$db_prefix}membergroups WHERE 1 ORDER BY ID_GROUP");
	$groups = array();
	$additional  = '';
	while ($groups[] = mysql_fetch_array($request)){;}
	for ($i = 8; $i < sizeof($groups); $i ++)
		$additional .= "{$groups[$i]['membergroup']}\n";
	$additional = trim($additional);
	print <<<EOT
<table border="0" width="600" cellspacing="1" bgcolor="$color[bordercolor]" class="bordercolor" align="center" cellpadding="4">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]">
    <script language="javascript" TYPE="text/javascript">
		<!--
		function reqWin(desktopURL){
        desktop =window.open(desktopURL,"name","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,width=400,height=200,resizable=no");
        }
		// -->
	</script>
    <a href="javascript:reqWin('help.php?help=5')" class="help"><img src="$imagesdir/helptopics.gif" border="0" alt="$txt[119]"></a>
    <font size="2" class="text1" color="$color[titletext]"><b>$txt[8]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]">
    <form action="$cgi;action=modmemgr2" method="POST">
    <table border="0" cellpadding="1" cellspacing="0">
      <tr>
        <td align="right"><font size="2"><b>$txt[11]:</b></font></td>
        <td><input type="text" name="admin" size=30 value="{$groups[0]['membergroup']}"></td>
      </tr><tr>
        <td align="right"><font size="2"><b>Global Moderator:</b></font></td>
        <td><input type="text" name="globalmod" size="30" value="{$groups[7]['membergroup']}"></td>
      </tr><tr>
        <td align="right"><font size="2"><b>$txt[12]:</b></font></td>
        <td><input type="text" name="moderator" size="30" value="{$groups[1]['membergroup']}"></td>
      </tr><tr>
        <td align="right"><font size="2"><b>$txt[569]:</b></font></td>
        <td><input type="text" name="newbie" size="30" value="{$groups[2]['membergroup']}"></td>
      </tr><tr>
        <td align="right"><font size="2"><b>$txt[13]:</b></font></td>
        <td><input type="text" name="junior" size="30" value="{$groups[3]['membergroup']}"></td>
      </tr><tr>
        <td align="right"><font size="2"><b>$txt[14]:</b></font></td>
        <td><input type="text" name="full" size="30" value="{$groups[4]['membergroup']}"></td>
      </tr><tr>
        <td align="right"><font size="2"><b>$txt[15]:</b></font></td>
        <td><input type="text" name="senior" size="30" value="{$groups[5]['membergroup']}"></td>
      </tr><tr>
        <td align="right"><font size="2"><b>$txt[570]:</b></font></td>
        <td><input type="text" name="god" size="30" value="{$groups[6]['membergroup']}"></td>
      </tr><tr>
        <td align="right"><font size="2"><B>$txt[16]:</b></font></td>
        <td><textarea name="additional" cols="30" rows="5">$additional</textarea><BR>
        <center><input type="submit" value="$txt[10]"></center></td>
      </tr>
    </table>
    </form>
    </td>
  </tr>
</table>
EOT;
	footer();
	obExit();
}

function EditMemberGroups2 (){
	global $admin,$globalmod,$moderator,$newbie,$junior,$full,$senior,$god,$additional,$yySetLocation,$cgi,$db_prefix;
	$request = mysql_query("UPDATE {$db_prefix}membergroups SET membergroup='$admin',grouptype=0 WHERE ID_GROUP=1");
	$request = mysql_query("UPDATE {$db_prefix}membergroups SET membergroup='$globalmod',grouptype=0 WHERE ID_GROUP=8");
	$request = mysql_query("UPDATE {$db_prefix}membergroups SET membergroup='$moderator',grouptype=0 WHERE ID_GROUP=2");
	$request = mysql_query("UPDATE {$db_prefix}membergroups SET membergroup='$newbie',grouptype=0 WHERE ID_GROUP=3");
	$request = mysql_query("UPDATE {$db_prefix}membergroups SET membergroup='$junior',grouptype=0 WHERE ID_GROUP=4");
	$request = mysql_query("UPDATE {$db_prefix}membergroups SET membergroup='$full',grouptype=0 WHERE ID_GROUP=5");
	$request = mysql_query("UPDATE {$db_prefix}membergroups SET membergroup='$senior',grouptype=0 WHERE ID_GROUP=6");
	$request = mysql_query("UPDATE {$db_prefix}membergroups SET membergroup='$god',grouptype=0 WHERE ID_GROUP=7");
	$moregroups = explode("\n",$additional);
	$request = mysql_query("DELETE FROM {$db_prefix}membergroups WHERE grouptype=1");
	foreach($moregroups as $onemore)
		$request = mysql_query("INSERT INTO {$db_prefix}membergroups (membergroup,grouptype) VALUES ('".trim($onemore)."',1)");

	$yySetLocation = "$cgi;action=admin";
	redirectexit();
}

function MailingList (){
	global $yytitle,$txt,$color,$imagesdir,$cgi,$db_prefix;
	$yytitle = "$txt[6]";
	template_header();
	print <<<EOT
<form action="$cgi;action=ml" method="POST">
<table border="0" width="600" cellspacing="1" cellpadding="4" bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]">
    <script language="javascript" TYPE="text/javascript">
		<!--
		function reqWin(desktopURL){
        desktop =window.open(desktopURL,"name","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,width=400,height=200,resizable=no");
        }
		// -->
	</script>
    <a href="javascript:reqWin('help.php?help=6')" class="help"><img src="$imagesdir/helptopics.gif" border="0" alt="$txt[119]"></a>
    <font size="2" class="text1" color="$color[titletext]"><b>$txt[6]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]">
    <BR><font size=1>$txt[735]</font><BR><BR></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]">
    <textarea cols="70" rows="7" name="emails">
EOT;
	$request = mysql_query("SELECT emailAddress FROM {$db_prefix}members WHERE 1");
	while ($curmem = mysql_fetch_row($request))
		print "$curmem[0]; ";
	print <<<EOT
</textarea><BR><BR></td>
  </tr><tr>
    <td bgcolor="$color[titlebg]"><font size="2" color="$color[titletext]"><b>$txt[338]</b></font></td>
  </tr><tr>
    <td bgcolor="$color[windowbg2]" class="windowbg2">
    <input type="text" name="subject" size="30" value="$txt[70]"><br><br>
    <textarea cols="70" rows="9" name="message">$txt[72]</textarea><br><br>
    <center><input type="submit" value="$txt[339]"></center></td>
  </tr>
</table>
</form>
EOT;
	footer();
	obExit();
}

function ml (){
	global $emails,$message,$yySetLocation,$cgi,$txt,$scripturl,$mbname,$subject,$db_prefix;
	$addressed = explode("; ",$emails);
	foreach ($addressed as $curmem) {
		$curmem = trim($curmem);
		if ($curmem != '')
			sendmail( $curmem, "$mbname: $subject", "$message\n\n$txt[130]\n\n$scripturl");
	}
	$yySetLocation = "$cgi;action=admin";
	redirectexit();
}

function ipban (){
 global $yytitle,$cgi,$txt,$imagesdir,$color,$db_prefix;
	$request = mysql_query("SELECT type,value FROM {$db_prefix}banned WHERE 1");
	$ipban = array();
	$emailban = array();
	$userban = array();
	while ($row = mysql_fetch_assoc($request))
	{
		if ($row['type']=='email')
			$emailban[]=$row['value'];
		elseif ($row['type']=='ip')
			$ipban[]=$row['value'];
        elseif ($row['type']=='username')
            $userban[]=$row['value'];
	}
	$ipbans = implode("\n",$ipban);
	$emailbans = implode("\n",$emailban);
    $userbans = implode("\n",$userban);
	$yytitle = "$txt[340]";
	template_header();
	print <<<EOT
<form action="$cgi;action=ipban2" method="POST">
<table border="0" cellspacing="1" cellpadding="4" align="center" width="550">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]">
    <script language="javascript" TYPE="text/javascript">
		<!--
		function reqWin(desktopURL){
        desktop =window.open(desktopURL,"name","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,width=400,height=200,resizable=no");
        }
		// -->
	</script>
    <a href="javascript:reqWin('help.php?help=7')" class="help"><img src="$imagesdir/helptopics.gif" border="0" alt="$txt[119]"></a>
    <font size="2" class="text1" color="$color[titletext]"><b>$txt[340]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]" align="center">
    <font size="2">
    <BR>$txt[724]<br>
    <textarea cols="60" rows="6" name="ban">$ipbans</textarea><br><br>
    $txt[725]<br>
    <textarea cols="60" rows="6" name="ban_email">$emailbans</textarea><br><BR>
    $txt[7252]<br>
    <textarea cols="60" rows="6" name="ban_user">$userbans</textarea><br><BR>
    <input type="submit" value="$txt[10]">
    </font></td>
  </tr>
</table>
</form>
EOT;
	footer();
	obExit();
}

function ipban2 (){
	global $ban,$ban_email,$ban_user,$yySetLocation,$cgi,$db_prefix;
	$ipban = explode("\n",$ban);
	$emailban = explode("\n",$ban_email);
    $userban = explode("\n",$ban_user);
	$request = mysql_query("DELETE FROM {$db_prefix}banned WHERE 1");
	foreach($ipban as $curban)
		$request = mysql_query("INSERT INTO {$db_prefix}banned (type,value) VALUES ('ip','".trim($curban)."')");
	foreach($emailban as $curban)
		$request = mysql_query("INSERT INTO {$db_prefix}banned (type,value) VALUES ('email','".trim($curban)."')");
    foreach($userban as $curban)
		$request = mysql_query("INSERT INTO {$db_prefix}banned (type,value) VALUES ('username','".trim($curban)."')");

	$yySetLocation = "$cgi;action=admin";
	redirectexit();
}

function SetReserve (){
	global $yytitle,$color,$txt,$cgi,$imagesdir,$db_prefix;
	$request = mysql_query("SELECT setting,value FROM {$db_prefix}reserved_names WHERE 1");
	$reserved = array();
	$matchword = $matchcase = $matchuser = $matchname = 0;
	while ($row = mysql_fetch_array($request))
	{
		if ($row['setting']=='word')
			$reserved[]=$row['value'];
		else
			${$row['setting']}=$row['value']?' checked':'';
	}
	$reswords = implode("\n",$reserved);

	$yytitle = "$txt[341]";
	
	template_header();
	print <<<EOT
<form action="$cgi;action=setreserve2" method="POST">
<table border="0" cellspacing="1" bgcolor="$color[bordercolor]" class="bordercolor" align="center" cellpadding="4" width="580">
  <tr>
    <td bgcolor="$color[titlebg]" class="titlebg">
    <script language="javascript" TYPE="text/javascript">
		<!--
		function reqWin(desktopURL){
        desktop =window.open(desktopURL,"name","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,width=400,height=200,resizable=no");
        }
		// -->
	</script>
    <a href="javascript:reqWin('help.php?help=8')" class="help"><img src="$imagesdir/helptopics.gif" border="0" alt="$txt[119]"></a>
    <font size=2 color="$color[titletext]"><b>$txt[341]</b></font></td>
  </tr><tr>
    <td bgcolor="$color[windowbg]" class="windowbg">
    <font size="1"><BR>$txt[699]<BR><BR></font></td>
  </tr><tr>
    <td bgcolor="$color[windowbg2]" class="windowbg2"><div align="center"><font size="2">
    $txt[342]<br>
    <textarea cols="30" rows="6" name="reserved">$reswords</textarea></font></div><br>
	<font size="2"><input type="checkbox" name="matchword" $matchword></font>
	<font size="2">$txt[726]</font><br>
	<font size="2"><input type="checkbox" name="matchcase" $matchcase></font>
	<font size="2">$txt[727]</font><br>
	<font size="2"><input type="checkbox" name="matchuser" $matchuser></font>
	<font size="2">$txt[728]</font><br>
	<font size="2"><input type="checkbox" name="matchname" $matchname></font>
	<font size="2">$txt[729]</font><br>
	<div align="center"><input type="submit" value="$txt[10]"></div></td>
</tr>
</table>
</form>
EOT;
	footer();
	obExit();
}

function SetReserve2 (){
	global $reserved,$matchword,$matchcase,$matchuser,$matchname,$yySetLocation,$cgi,$db_prefix;
	$matchword = isset($matchword) ? 1 : 0;
	$matchcase = isset($matchcase) ? 1 : 0;
	$matchuser = isset($matchuser) ? 1 : 0;
	$matchname = isset($matchname) ? 1 : 0;
	$request = mysql_query("UPDATE {$db_prefix}reserved_names SET value=$matchword WHERE setting='matchword'");
	$request = mysql_query("UPDATE {$db_prefix}reserved_names SET value=$matchcase WHERE setting='matchcase'");
	$request = mysql_query("UPDATE {$db_prefix}reserved_names SET value=$matchuser WHERE setting='matchuser'");
	$request = mysql_query("UPDATE {$db_prefix}reserved_names SET value=$matchname WHERE setting='matchname'");
	$resnames = explode("\n",$reserved);
	$request = mysql_query("DELETE FROM {$db_prefix}reserved_names WHERE setting='word'");
	foreach($resnames as $curname)
		$request = mysql_query("INSERT INTO {$db_prefix}reserved_names (setting,value) VALUES ('word','".trim($curname)."')");
	$yySetLocation = "$cgi;action=admin";
	redirectexit();
}


function ModifyTemplate (){
	global $yytitle,$boarddir,$txt,$imagesdir,$color,$cgi,$db_prefix;
	$lines = file("$boarddir/template.html"); 
	$lines = str_replace("</textarea>","</text-area>",$lines);
	$fulltemplate = implode("",$lines);
	$yytitle = $txt[216];
	template_header();
	print <<<EOT
<form action="$cgi;action=modtemp2" method="POST">
<table border="0" width="100%" cellspacing="1" bgcolor="$color[bordercolor]" class="bordercolor" cellpadding="4">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]">
    <script language="javascript" TYPE="text/javascript">
		<!--
		function reqWin(desktopURL){
        desktop =window.open(desktopURL,"name","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,width=400,height=200,resizable=no");
        }
		// -->
	</script>
    <a href="javascript:reqWin('help.php?help=9')" class="help"><img src="$imagesdir/helptopics.gif" border="0" alt="$txt[119]"></a>
    <font size="2" class="text1" color="$color[titletext]"><b>$txt[216]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]">
    <BR><font size="1">$txt[682]</font><BR><BR></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]" align="center"><font size="2">
    <form action="$cgi;action=modtemp2" method="POST"><BR>
    <textarea rows="30" cols="95" name="template" style="width:98%">$fulltemplate</textarea>
    <br><BR><input type="submit" value="$txt[10]"></font></td>
  </tr>
</table>
</form>
EOT;
	footer();
	obExit();
}

function ModifyTemplate2 (){
	global $template,$boarddir,$yySetLocation,$cgi,$db_prefix;
	$template = stripcslashes($template);
	$template = str_replace("</text-area>","</textarea",$template);
	$fh = fopen("$boarddir/template.html",'w');
	fputs ($fh,$template);
	fclose($fh);
	$yySetLocation = "$cgi;action=admin";
	redirectexit();
}

function ModifySettings (){
	if (!copy("Settings.php", "Settings.bak"))
		fatal_error($txt['yse1']);

	global $maintenance,$guestaccess,$yyForceIIS,$yyblankpageIIS,$RegAgree,$emailpassword,$emailnewpass;
	global $emailwelcome,$MenuType,$enable_ubbc,$autolinkurls,$curposlinks,$profilebutton,$enable_news;
	global $enable_guestposting,$enable_notification,$allow_hide_email,$showlatestmember,$Show_RecentBar;
	global $Show_MemberBar,$showmarkread,$showmodify,$ShowBDescrip,$showuserpic,$showusertext,$color;
	global $showgenderimage,$shownewsfader,$showyabbcbutt,$allowpics,$use_flock,$mailtype,$timeformatstring;
	global $cgi,$color,$db_name,$db_server,$db_user,$db_passwd,$txt,$usetempfile,$faketruncation,$db_prefix;
	global $imagesdir,$boarddir,$mbname,$boardurl,$Cookie_Length,$cookieusername,$cookiepassword;
	global $mailprog,$smtp_server,$webmaster_email,$sourcedir,$facesdir,$facesurl,$faderpath,$ubbcjspath;
	global $helpfile,$timeoffset,$language,$TopAmmount,$MembersPerPage,$maxdisplay,$MaxMessLen,$maxmessagedisplay;
	global $MaxSigLen,$ClickLogTime,$max_log_days_old,$fadertime,$timeout,$JrPostNum,$FullPostNum,$SrPostNum;
	global $GodPostNum,$userpic_width,$userpic_height,$userpic_limits,$yytitle,$mtxt,$mtitle,$mmessage;

	$mainchecked=$guestaccchecked=$forcechecked=$blankchecked=$agreechecked=$mailpasschecked=$newpasschecked=$welchecked=$menuchecked=$ubbcchecked=$aluchecked=$cpchecked=$pbchecked=$insertchecked=$newschecked=$gpchecked=$notifchecked=$ahmchecked=$slmchecked=$srbarchecked=$smbarchecked=$smreadchecked=$smodchecked=$supicchecked=$sutextchecked=$sgichecked=$snfchecked=$mst1=$mts2=$bdescripchecked=$syabbcchecked=$allowpicschecked=$srb0=$srb1=$srb2='';
	
	$yytitle = $txt[222];
	template_header();
	
	# figure out what to print
	if ($maintenance) { $mainchecked = ' checked'; }
	if ($guestaccess == 0) { $guestaccchecked = ' checked'; }
	if ($yyForceIIS) { $forcechecked = ' checked'; }
	if ($yyblankpageIIS) { $blankchecked = ' checked'; }
	if($RegAgree) { $agreechecked = " checked"; }
	if($emailpassword) { $mailpasschecked = " checked"; }
	if($emailnewpass) { $newpasschecked = " checked"; }
	if($emailwelcome) { $welchecked = " checked"; }
	if ($MenuType) { $menuchecked = ' checked'; }
	if ($enable_ubbc) { $ubbcchecked = ' checked'; }
	if ($autolinkurls) { $aluchecked = ' checked'; }
	if ($curposlinks) { $cpchecked = ' checked'; }
	if ($profilebutton) { $pbchecked = ' checked'; }
	if ($enable_news) { $newschecked = "checked"; }
	if ($enable_guestposting) { $gpchecked = "checked"; }
	if ($enable_notification) { $notifchecked = "checked"; }
	if ($allow_hide_email) { $ahmchecked = "checked"; }
	if ($showlatestmember) { $slmchecked = "checked"; }
	if ($Show_MemberBar) { $smbarchecked = "checked"; }
	if ($showmarkread) { $smreadchecked = "checked"; }
	if ($showmodify) { $smodchecked = "checked"; }
	if ($ShowBDescrip) { $bdescripchecked = "checked"; }
	if ($showuserpic) { $supicchecked = "checked"; }
	if ($showusertext) { $sutextchecked = "checked"; }
	if ($showgenderimage) { $sgichecked = "checked"; }
	if ($shownewsfader) { $snfchecked = "checked"; }
	if ($showyabbcbutt) { $syabbcchecked = "checked"; }
	if ($allowpics) { $allowpicschecked = "checked"; }
	if ($mailtype == 0) { $mts1 = ' selected'; } else if ($mailtype == 1) { $mts2 = ' selected'; }
	if ($Show_RecentBar == 1){$srb1=' selected';} else if ($Show_RecentBar == 2){$srb2 = ' selected'; } else {$srb0=' selected';}
	
	print <<<EOT
<script language="javascript" TYPE="text/javascript">
		<!--
		function reqWin(desktopURL){
        desktop =window.open(desktopURL,"name","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,width=480,height=200,resizable=no");
        }
		// -->
	</script>
		<form action="$cgi;action=modsettings2" method="POST">
<table width="75%" border="0" cellspacing="1" cellpadding="0" bgcolor="$color[bordercolor]" class="bordercolor" align="center"><tr><td>
  <table border="0" cellspacing="0" cellpadding="4" align="center" width="100%">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]" colspan="2">
    <img src="$imagesdir/settings.gif" alt="" border="0">
    <font size="2" class="text1" color="$color[titletext]"><b>$txt[222]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]" colspan="2"><BR><font size="1">$txt[347]</font><BR><BR></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]" width="400"><font size="2">$txt[yse5]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="db_server" value="$db_server"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]" width="400"><font size="2">$txt[yse6]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="db_user" value="$db_user"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]" width="400"><font size="2">$txt[yse7]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="db_passwd" value="$db_passwd"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]" width="400"><font size="2">$txt[yse8]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="db_name" value="$db_name"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]" width="400"><font size="2">$txt[yse54]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="db_prefix" value="$db_prefix"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]" width="400"><font size="2">$txt[348]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="maintenance"$mainchecked></td>
  </tr><tr>
  <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$mtxt[1]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="mtitle" size="15" value="$mtitle"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$mtxt[2]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=text name="mmessage" size="30" value="$mmessage"></td>
  </tr><tr>
    <td colspan=2 class="windowbg2" bgcolor="$color[windowbg2]">
    <HR size=1 width="100%" color="$color[windowbg3]" class="windowbg3"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[632]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="guestaccess"$guestaccchecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[666]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="yyforceiis"$forcechecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[667]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="yyblankpageiis"$blankchecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[349]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><select name="language">
EOT;
$dir = dir($boarddir);
while ($entry = $dir->read()){
	$n = substr($entry,0,(strlen($entry)-4));
	$e = substr($entry,(strlen($entry)-4),4);
	if ($e == '.lng'){
		$selected = "";
		if ($entry == $language) { $selected = " selected"; }
		print "    <option value=\"$entry\"$selected>$n</option>\n";
	}
}

print <<<EOT
</select></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[350]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="mbname" size="30" value="$mbname"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[351]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="boardurl" size="35" value="$boardurl"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[432]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="Cookie_Length" size="5" value="$Cookie_Length"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[352]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="cookieusername" size="20" value="$cookieusername"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[353]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="cookiepassword" size="20" value="$cookiepassword"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[584]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="RegAgree"$agreechecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[702]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="emailpassword"$mailpasschecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[639]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="emailnewpass"$newpasschecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[619]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="emailwelcome"$welchecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[354]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="mailprog" size="20" value="$mailprog"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[407]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="smtp_server" size="20" value="$smtp_server"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[355]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="webmaster_email" size="20" value="$webmaster_email"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[404]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]">
    <select name="mailtype" size=1>
    <option value="0"$mts1>$txt[405]</option>
    <option value="1"$mts2>$txt[406]</option>
    </select></td>
  </tr><tr>
    <td colspan="2" class="windowbg2" bgcolor="$color[windowbg2]">
    <HR size="1" width="100%" class="windowbg3"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[356]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="boarddir" size="30" value="$boarddir"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[360]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="sourcedir" size="30" value="$sourcedir"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[362]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="facesdir" size="30" value="$facesdir"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[423]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="facesurl" size="35" value="$facesurl"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[363]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="imagesdir" size="35" value="$imagesdir"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[390]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="faderpath" size="35" value="$faderpath"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[506]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="ubbcjspath" size="35" value="$ubbcjspath"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[364]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="helpfile" size="35" value="$helpfile"></td>
  </tr><tr>
    <td colspan=2 class="windowbg2" bgcolor="$color[windowbg2]">
    <HR size="1" width="100%" class="windowbg3"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[365]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="titlebg" size="10" value="$color[titlebg]"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[366]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="titletext" size="10" value="$color[titletext]"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[367]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="windowbg" size="10" value="$color[windowbg]"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[368]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="windowbg2" size="10" value="$color[windowbg2]"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[640]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="windowbg3" size="10" value="$color[windowbg3]"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[369]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="catbg" size="10" value="$color[catbg]"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[370]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="bordercolor" size="10" value="$color[bordercolor]"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[388]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="fadertext" size="10" value="$color[fadertext]"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[389]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="fadertext2" size="10" value="$color[fadertext2]"></td>
  </tr><tr>
    <td colspan=2 class="windowbg2" bgcolor="$color[windowbg2]">
    <HR size=1 width="100%" class="windowbg3"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[521]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="menutype"$menuchecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[522]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="curposlinks"$cpchecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[523]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="profilebutton"$pbchecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[587]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]" nobreak><input type="text" name="timeformatstring" value="$timeformatstring"> <a href="javascript:reqWin('help.php?help=12')" class="help"><img src="$imagesdir/helptopics.gif" border="0" alt="$txt[119]"></a></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[723]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="allow_hide_email" $ahmchecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[382]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="showlatestmember" $slmchecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[387]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="shownewsfader" $snfchecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[509]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><select name="showrecentbar"><option value=0$srb0>$txt[yse93]</option><option value=1$srb1>$txt[yse94]</option><option value=2$srb2>$txt[yse95]</option></select></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[510]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="showmemberbar" $smbarchecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[618]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="showmarkread" $smreadchecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[732]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="showbdescrip" $bdescripchecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[383]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="showmodify" $smodchecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[384]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="showuserpic" $supicchecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[385]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="showusertext" $sutextchecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[386]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="showgenderimage" $sgichecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[740]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="showyabbcbutt" $syabbcchecked></td>
  </tr><tr>
    <td colspan=2 class="windowbg2" bgcolor="$color[windowbg2]">
    <HR size=1 width="100%" class="windowbg3"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[378]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="enable_ubbc"$ubbcchecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[379]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="enable_news" $newschecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[746]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="allowpics" $allowpicschecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[380]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="enable_guestposting" $gpchecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[381]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="enable_notification" $notifchecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[524]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="checkbox" name="autolinkurls"$aluchecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[371]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="timeoffset" size="5" value="$timeoffset"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[372]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="TopAmmount" size="5" value="$TopAmmount"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[373]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="MembersPerPage" size="5" value="$MembersPerPage"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[374]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="maxdisplay" size="5" value="$maxdisplay"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[375]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="maxmessagedisplay" size="5" value="$maxmessagedisplay"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[498]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="maxmesslen" size="5" value="$MaxMessLen"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[689]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="maxsiglen" size="5" value="$MaxSigLen"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[690]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="clicklogtime" size="5" value="$ClickLogTime"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[376]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="max_log_days_old" size="5" value="$max_log_days_old"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[739]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="fadertime" size="5" value="$fadertime"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[408]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="timeout" size="5" value="$timeout"></td>
  </tr><tr>
    <td colspan=2 class="windowbg2" bgcolor="$color[windowbg2]">
    <HR size=1 width="100%" class="windowbg3"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[588]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="jrmem" size="5" value="$JrPostNum"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[589]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="fullmem" size="5" value="$FullPostNum"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[590]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="srmem" size="5" value="$SrPostNum"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[591]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="godmem" size="5" value="$GodPostNum"></td>
  </tr><tr>
    <td colspan=2 class="windowbg2" bgcolor="$color[windowbg2]">
    <HR size="1" width="100%" class="windowbg3"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[476]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="userpic_width" size="5" value="$userpic_width"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[477]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="userpic_height" size="5" value="$userpic_height"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[478]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type="text" name="userpic_limits" size="35" value="$userpic_limits"></td>
 </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]" colspan="2" align="center" valign="middle">
    <HR size="1" width="100%" class="windowbg3"><input type="submit" value="$txt[10]">
    </td>
  </tr>
</table>
</td>
</tr>
</table>
</form>
EOT;
	footer();
	obExit();
}

function ModifySettings2 (){
	global $maintenance,$guestaccess,$yyForceIIS,$yyblankpageIIS,$RegAgree,$emailpassword,$emailnewpass;
	global $emailwelcome,$MenuType,$enable_ubbc,$autolinkurls,$curposlinks,$profilebutton,$enable_news;
	global $enable_guestposting,$enable_notification,$allow_hide_email,$showlatestmember,$Show_RecentBar;
	global $Show_MemberBar,$showmarkread,$showmodify,$ShowBDescrip,$showuserpic,$showusertext,$color;
	global $showgenderimage,$shownewsfader,$showyabbcbutt,$allowpics,$mailtype,$timeformatstring;
	global $cgi,$color,$db_name,$db_server,$db_user,$db_passwd,$txt,$db_prefix;
	global $imagesdir,$boarddir,$mbname,$boardurl,$Cookie_Length,$cookieusername,$cookiepassword;
	global $mailprog,$smtp_server,$webmaster_email,$sourcedir,$facesdir,$facesurl,$faderpath,$ubbcjspath;
	global $helpfile,$timeoffset,$language,$TopAmmount,$MembersPerPage,$maxdisplay,$MaxMessLen,$maxmessagedisplay;
	global $MaxSigLen,$ClickLogTime,$max_log_days_old,$fadertime,$timeout,$JrPostNum,$FullPostNum,$SrPostNum;
	global $GodPostNum,$userpic_width,$userpic_height,$userpic_limits,$showrecentbar ;
	global $settings,$pwseed,$Cookie_Exp_Date,$yySetCookies,$username,$password;

	global $HTTP_POST_VARS;
	foreach($HTTP_POST_VARS as $key=>$val)
		$HTTP_POST_VARS[$key] = stripslashes($val);

	$onoff = array('allowpics', 'showyabbcbutt', 'showbdescrip', 'maintenance', 'guestaccess', 'insert_original', 'enable_ubbc', 'enable_news', 'enable_guestposting', 'enable_notification', 'showlatestmember', 'showmemberbar', 'showmarkread', 'showmodify', 'showuserpic', 'showusertext', 'showgenderimage', 'shownewsfader', 'menutype', 'curposlinks', 'profilebutton', 'autolinkurls', 'emailpassword', 'RegAgree', 'emailwelcome', 'allow_hide_email', 'usetempfile', 'emailnewpass', 'yyForceIIS', 'yyblankpageIIS');
	foreach ($onoff as $key)
	{
		if (isset($HTTP_POST_VARS[$key]))
			$$key = 1;
		else
			$$key = 0;
	}

	$guestaccess = $guestaccess ? 0 : 1;
	
	# If empty fields are submitted, set them to default-values to save yabb from crashing

	$db_prefix = isset($HTTP_POST_VARS['db_prefix']) ? $HTTP_POST_VARS['db_prefix'] : "";

	$timeout = isset($HTTP_POST_VARS['timeout']) ? $HTTP_POST_VARS['timeout'] : 0;
	$fadertime = isset($HTTP_POST_VARS['fadertime']) ? $HTTP_POST_VARS['fadertime'] : 5;
	$timeoffset = isset($HTTP_POST_VARS['timeoffset']) ? $HTTP_POST_VARS['timeoffset'] : 0;
	$TopAmmount = isset($HTTP_POST_VARS['TopAmmount']) ? $HTTP_POST_VARS['TopAmmount'] : 25;
	$MembersPerPage = isset($HTTP_POST_VARS['MembersPerPage']) ? $HTTP_POST_VARS['MembersPerPage'] : 20;
	$maxmessagedisplay = isset($HTTP_POST_VARS['maxmessagedisplay']) ? $HTTP_POST_VARS['maxmessagedisplay'] : 20;
	$max_log_days_old = isset($HTTP_POST_VARS['max_log_days_old']) ? $HTTP_POST_VARS['max_log_days_old'] : 21;
	$clicklogtime = isset($HTTP_POST_VARS['clicklogtime']) ? $HTTP_POST_VARS['clicklogtime'] : 600;
	$Cookie_Length = isset($HTTP_POST_VARS['Cookie_Length']) ? $HTTP_POST_VARS['Cookie_Length'] : 60;
	$cookieusername = isset($HTTP_POST_VARS['cookieusername']) ? $HTTP_POST_VARS['cookieusername'] : 'yabbseusername';
	$cookiepassword = isset($HTTP_POST_VARS['cookiepassword']) ? $HTTP_POST_VARS['cookiepassword'] : 'yabbsepassword'	;
	$timeformatstring = isset($HTTP_POST_VARS['timeformatstring']) ? $HTTP_POST_VARS['timeformatstring'] : 'F jS, Y, h:i:s a';
	$maxmesslen = isset($HTTP_POST_VARS['maxmesslen']) ? $HTTP_POST_VARS['maxmesslen'] : 5000;
	$maxsiglen = isset($HTTP_POST_VARS['maxsiglen']) ? $HTTP_POST_VARS['maxsiglen'] : 200;
	$jrmem = isset($HTTP_POST_VARS['jrmem']) ? $HTTP_POST_VARS['jrmem'] : 50;
	$fullmem = isset($HTTP_POST_VARS['fullmem']) ? $HTTP_POST_VARS['fullmem'] : 100;
	$srmem = isset($HTTP_POST_VARS['srmem']) ? $HTTP_POST_VARS['srmem'] : 250;
	$godmem = isset($HTTP_POST_VARS['godmem']) ? $HTTP_POST_VARS['godmem'] : 500;
	$language = isset($HTTP_POST_VARS['language']) ? $HTTP_POST_VARS['language'] : 'english.lng';
	$mbname = isset($HTTP_POST_VARS['mbname']) ? $HTTP_POST_VARS['mbname'] : 'My YaBB SE';
	$boardurl = isset($HTTP_POST_VARS['boardurl']) ? $HTTP_POST_VARS['boardurl'] : GetBoardURL();
	$boarddir = isset($HTTP_POST_VARS['boarddir']) ? $HTTP_POST_VARS['boarddir'] : GetDirPath();
	$sourcedir = isset($HTTP_POST_VARS['sourcedir']) ? $HTTP_POST_VARS['sourcedir'] : "$boarddir/Sources";
	$facesdir = isset($HTTP_POST_VARS['facesdir']) ? $HTTP_POST_VARS['facesdir'] : "$boarddir/YaBBImages/avatars";
	$facesurl = isset($HTTP_POST_VARS['facesurl']) ? $HTTP_POST_VARS['facesurl'] : "$boardurl/YaBBImages/avatars";
	$imagesdir = isset($HTTP_POST_VARS['imagesdir']) ? $HTTP_POST_VARS['imagesdir'] : "$boardurl/YaBBImages";
	$helpfile = isset($HTTP_POST_VARS['helpfile']) ? $HTTP_POST_VARS['helpfile'] : "$boardurl/YaBBHelp/index.html";

	$mailprog = isset($HTTP_POST_VARS['mailprog']) ? $HTTP_POST_VARS['mailprog'] : '/usr/sbin/sendmail';
	$smtp_server = isset($HTTP_POST_VARS['smtp_server']) ? $HTTP_POST_VARS['smtp_server'] : '127.0.0.1';
	$webmaster_email = isset($HTTP_POST_VARS['webmaster_email']) ? $HTTP_POST_VARS['webmaster_email'] : 'webmaster@mysite.com';
	$mailtype = isset($HTTP_POST_VARS['mailtype']) ? $HTTP_POST_VARS['mailtype'] : 0;

	$color['titlebg'] = isset($HTTP_POST_VARS['titlebg']) ? $HTTP_POST_VARS['titlebg'] : '#6E94B7';
    $mtitle = isset($HTTP_POST_VARS['mtitle']) ? $HTTP_POST_VARS['mtitle'] : '$mtxt[04]';
    $mmessage = isset($HTTP_POST_VARS['mmessage']) ? $HTTP_POST_VARS['mmessage'] : '$mtxt[05]';

	$color['titletext'] = isset($HTTP_POST_VARS['titletext']) ? $HTTP_POST_VARS['titletext'] : '#FFFFFF';
	$color['windowbg'] = isset($HTTP_POST_VARS['windowbg']) ? $HTTP_POST_VARS['windowbg'] : '#AFC6DB';
	$color['windowbg2'] = isset($HTTP_POST_VARS['windowbg2']) ? $HTTP_POST_VARS['windowbg2'] : '#F8F8F8';
	$color['windowbg3'] = isset($HTTP_POST_VARS['windowbg3']) ? $HTTP_POST_VARS['windowbg3'] : '#6394BD';
	$color['catbg'] = isset($HTTP_POST_VARS['catbg']) ? $HTTP_POST_VARS['catbg'] : '#DEE7EF';
	$color['bordercolor'] = isset($HTTP_POST_VARS['bordercolor']) ? $HTTP_POST_VARS['bordercolor'] : '#6394BD';
	$color['fadertext'] = isset($HTTP_POST_VARS['fadertext']) ? $HTTP_POST_VARS['fadertext'] : '#000000';
	$color['fadertext2'] = isset($HTTP_POST_VARS['fadertext2']) ? $HTTP_POST_VARS['fadertext2'] : '#000000';

	$faderpath = isset($HTTP_POST_VARS['faderpath']) ? $HTTP_POST_VARS['faderpath'] : "$boardurl/fader.js";
	$ubbcjspath = isset($HTTP_POST_VARS['ubbcjspath']) ? $HTTP_POST_VARS['ubbcjspath'] : "$boardurl/ubbc.js";;
	$userpic_width = isset($HTTP_POST_VARS['userpic_width']) ? $HTTP_POST_VARS['userpic_width'] : 65;
	$userpic_height = isset($HTTP_POST_VARS['userpic_height']) ? $HTTP_POST_VARS['userpic_height'] : 65;
	$userpic_limits = isset($HTTP_POST_VARS['userpic_limits']) ? stripslashes($HTTP_POST_VARS['userpic_limits']) : 'Please note that your image has to be <b>gif</b> or <b>jpg</b> and that it will be resized!';

	$filler = "                                                                               ";
	$setfile = <<<EOT
<?php
/*****************************************************************************/
/* Settings.php                                                              */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

########## Board Info ##########
# Note: these settings must be properly changed for YaBB to work

\$maintenance = $maintenance;				# Set to 1 to enable Maintenance mode
\$mtitle = "$mtitle";                       # Subject for display
\$mmessage = "$mmessage";                   # Message Description for display

\$guestaccess = $guestaccess;				# Set to 0 to disallow guests from doing anything but login or register

\$yyForceIIS = $yyForceIIS;				# Set to 1 if you encounter errors while running on an MS IIS server
\$yyblankpageIIS = $yyblankpageIIS;			# Set to 1 if you encounter blank pages after posting (usually on MS IIS servers)

\$language = "$language";				# Change to language pack you want to use
\$mbname = "$mbname";					# The name of your YaBB forum
\$boardurl = "$boardurl";				# URL of your board's folder (without trailing '/')

\$Cookie_Length = $Cookie_Length;			# Cookies will expire after XX minutes of person logging in (they will be logged out after)
\$cookieusername = "$cookieusername";			# Name of the username cookie
\$cookiepassword = "$cookiepassword";			# Name of the password cookie

\$RegAgree = $RegAgree;					# Set to 1 to display the registration agreement when registering
\$emailpassword = $emailpassword;			# 0 - instant registration. 1 - password emailed to new members
\$emailnewpass = $emailnewpass;				# Set to 1 to email a new password to members if they change their email address
\$emailwelcome = $emailwelcome;				# Set to 1 to email a welcome message to users even when you have mail password turned off

\$mailprog = "$mailprog";				# Location of your sendmail program
\$smtp_server = "$smtp_server";				# SMTP-Server
\$webmaster_email = "$webmaster_email";		# Your e-mail address. (eg: \$webmaster_email = "admin\@host.com";)
\$mailtype = $mailtype;					# 0 - sendmail, 1 - SMTP

########## Database Info ##########
\$db_name = "$db_name";
\$db_user = "$db_user";
\$db_passwd = "$db_passwd";
\$db_server = "$db_server";
\$db_prefix = "$db_prefix";

########## Directories/Files ##########
# Note: directories other than \$imagesdir do not have to be changed unless you move things

\$boarddir = "$boarddir"; 				# The absolute path to the board's folder (usually can be left as '.')
\$sourcedir = "$sourcedir";        			# Directory with YaBB source files
\$facesdir = "$facesdir";				# Absolute Path to your avatars folder
\$facesurl = "$facesurl";				# URL to your avatars folder
\$imagesdir = "$imagesdir";				# URL to your images directory
\$ubbcjspath = "$ubbcjspath";	                        # Web path to your 'ubbc.js' REQUIRED for post/modify to work properly!
\$faderpath = "$faderpath";				# Web path to your 'fader.js'
\$helpfile = "$helpfile";				# Location of your help file


########## Colors ##########
# Note: equivalent to colors in CSS tag of template.html, so set to same colors preferrably
# for browsers without CSS compatibility and for some items that don't use the CSS tag

\$color['titlebg'] = "$color[titlebg]";		# Background color of the 'title-bar'
\$color['titletext'] = "$color[titletext]";		# Color of text in the 'title-bar' (above each 'window')
\$color['windowbg'] = "$color[windowbg]";		# Background color for messages/forms etc.
\$color['windowbg2'] = "$color[windowbg2]";		# Background color for messages/forms etc.
\$color['windowbg3'] = "$color[windowbg3]";		# Color of horizontal rules in posts
\$color['catbg'] = "$color[catbg]";			# Background color for category (at Board Index)
\$color['bordercolor'] = "$color[bordercolor]";	# Table Border color for some tables
\$color['fadertext']  = "$color[fadertext]";		# Color of text in the NewsFader ("The Latest News" color)
\$color['fadertext2']  = "$color[fadertext2]";	# Color of text in the NewsFader (news color)

########## Layout ##########

\$MenuType = $menutype;					# 1 for text menu or anything else for images menu
\$curposlinks = $curposlinks;				# 1 for links in navigation on current page, or 0 for text without link
\$profilebutton = $profilebutton;			# 1 to show view profile button under post, or 0 for blank
\$timeformatstring = "$timeformatstring";				# Select your preferred output Format of Time and Date
\$allow_hide_email = $allow_hide_email;			# Allow users to hide their email from public. Set 0 to disable
\$showlatestmember = $showlatestmember;			# Set to 1 to display "Welcome Newest Member" on the Board Index
\$shownewsfader = $shownewsfader;			# 1 to allow or 0 to disallow NewsFader javascript on the Board Index
							# If 0, you'll have no news at all unless you put <yabb news> tag
							# back into template.html!!!
\$Show_RecentBar = $showrecentbar;			# Set to 1 to display the Recent Posts bar on Board Index
\$Show_MemberBar = $showmemberbar;			# Set to 1 to display the Members List table row on Board Index
\$showmarkread = $showmarkread;				# Set to 1 to display and enable the mark as read buttons
\$showmodify = $showmodify;				# Set to 1 to display "Last modified: Realname - Date" under each message
\$ShowBDescrip = $showbdescrip;				# Set to 1 to display board descriptions on the topic (message) index for each board
\$showuserpic = $showuserpic;				# Set to 1 to display each member's picture in the message view (by the ICQ.. etc.)
\$showusertext = $showusertext;				# Set to 1 to display each member's personal text in the message view (by the ICQ.. etc.)
\$showgenderimage = $showgenderimage;			# Set to 1 to display each member's gender in the message view (by the ICQ.. etc.)
\$showyabbcbutt = $showyabbcbutt;                       # Set to 1 to display the yabbc buttons on Posting and IM Send Pages

########## Feature Settings ##########

\$enable_ubbc = $enable_ubbc;				# Set to 1 if you want to enable UBBC (Uniform Bulletin Board Code)
\$enable_news = $enable_news;				# Set to 1 to turn news on, or 0 to set news off
\$allowpics = $allowpics;				# set to 1 to allow members to choose avatars in their profile
\$enable_guestposting = $enable_guestposting;		# Set to 0 if do not allow 1 is allow.
\$enable_notification = $enable_notification;		# Allow e-mail notification
\$autolinkurls = $autolinkurls;				# Set to 1 to turn URLs into links, or 0 for no auto-linking.

\$timeoffset = $timeoffset;				# Time Offset (so if your server is EST, this would be set to -1 for CST)
\$TopAmmount = $TopAmmount;				# No. of top posters to display on the top members list
\$MembersPerPage = $MembersPerPage;			# No. of members to display per page of Members List - All
\$maxdisplay = $maxdisplay;				# Maximum of topics to display
\$maxmessagedisplay = $maxmessagedisplay;		# Maximum of messages to display
\$MaxMessLen = $maxmesslen;  				# Maximum Allowed Characters in a Posts
\$MaxSigLen = $maxsiglen;				# Maximum Allowed Characters in Signatures
\$ClickLogTime = $clicklogtime;				# Time in minutes to log every click to your forum (longer time means larger log file size)
\$max_log_days_old = $max_log_days_old;			# If an entry in the user's log is older than ... days remove it
							# Set to 0 if you want it disabled
\$fadertime = $fadertime;				# Length in seconds to display each item in the news fader
\$timeout = $timeout;					# Minimum time between 2 postings from the same IP


########## Membergroups ##########

\$JrPostNum = $jrmem;					# Number of Posts required to show person as 'junior' membergroup
\$FullPostNum = $fullmem;				# Number of Posts required to show person as 'full' membergroup
\$SrPostNum = $srmem;					# Number of Posts required to show person as 'senior' membergroup
\$GodPostNum = $godmem;					# Number of Posts required to show person as 'god' membergroup


########## MemberPic Settings ##########

\$userpic_width = $userpic_width;			# Set pixel size to which the selfselected userpics are resized, 0 disables this limit
\$userpic_height = $userpic_height;			# Set pixel size to which the selfselected userpics are resized, 0 disables this limit
\$userpic_limits = "$userpic_limits";			# Text To Describe The Limits
?>
EOT;

//	$setfile = preg_replace("/(.+\;)\s+(\#.+$)/e", $1 . substr( $filler, 0, (70-(length $1)) ) . $2,$setfile);
//	$setfile = preg_replace("/(.{64,}\;)\s+(\#.+$)/e",$1 . "\n   " . $2,$setfile);
	# $setfile =~ s~(.+\;)(\s+)(\#.{40,}?)\s+(.{10,}$)~$1 . $2 . $3 . "\n   # " . $4~gem;
	# $setfile =~ s~^\s\s\s+(\#.{40,}?)\s+(.{10,}$)~"   " . $1 . "\n   # " . $2~gem;
//	$setfile = preg_replaec("/^\s\s\s+(\#.+$)/e",substr( $filler, 0, 70 ) . $1 ,$setfile);
	
	$fh = fopen ("$boarddir/Settings.php",'w');
	fputs($fh,$setfile);
	fclose($fh);

	$password = crypt($settings[0],$pwseed);
	$Cookie_Exp_Date = 'Sun, 17-Jan-2038 00:00:00 GMT';

	$yySetCookies = "Set-Cookie: $cookieusername=$username; path=/; expires=$Cookie_Exp_Date;\n";
	$yySetCookies .= "Set-Cookie: $cookiepassword=$password; path=/; expires=$Cookie_Exp_Date;\n";

	LoadUserSettings();
	WriteLog();
	Admin();
}

function GetBoardURL () {
	global $HTTP_HOST,$SERVER_NAME,$SCRIPT_NAME,$SERVER_POST;
	$url = 'http://' . (isset($HTTP_HOST) ? $HTTP_HOST : $SERVER_NAME ).  
	($SERVER_PORT != 80 ? '' :$SERVER_PORT) .
	$SCRIPT_NAME;
	return $url;
}

# Gets our current absolute path. Needed for error messages.
function GetDirPath () {
	global $SCRIPT_FILENAME;
	return $SCRIPT_FILENAME;
}

function SetCensor (){
	global $yytitle,$txt,$color,$cgi,$imagesdir,$db_prefix;
	$request = mysql_query("SELECT vulgar,proper FROM {$db_prefix}censor WHERE 1");
	$censored = array();
	while ($row = mysql_fetch_row($request))
		$censored[] = "$row[0]=$row[1]";
	$censortext = implode("\n",$censored);
	$yytitle = $txt[135];
	template_header();
	print <<<EOT
<form action="$cgi;action=setcensor2" method="POST">
<table border="0" width="300" cellspacing="1" cellpadding="4" bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]">
	<script language="javascript" TYPE="text/javascript">
		<!--
		function reqWin(desktopURL){
        desktop =window.open(desktopURL,"name","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,width=400,height=200,resizable=no");
        }
		// -->
	</script>
    <a href="javascript:reqWin('help.php?help=11')" class="help"><img src="$imagesdir/helptopics.gif" border="0" alt="$txt[119]"></a>
    <font size="2" class="text1" color="$color[titletext]"><b>$txt[135]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]" align="center"><font size="2">
        $txt[136]<br>
    <textarea cols="50" rows="6" name="censortext">$censortext</textarea><br><BR>
    <input type="submit" value="$txt[10]"></font></td>
  </tr>
</table>
</form>
EOT;
	footer();
	obExit();
}

function SetCensor2 (){
	global $censortext,$yySetLocation,$cgi,$db_prefix;
	$censored = explode("\n",$censortext);
	$request = mysql_query("DELETE FROM {$db_prefix}censor WHERE 1");
	foreach ($censored as $row)
	{
		if (trim($row) != '')
		{
			$items = explode("=",trim($row));
			$request = mysql_query("INSERT INTO {$db_prefix}censor (vulgar,proper) VALUES ('$items[0]','$items[1]')");
		}
	}
	$yySetLocation = "$cgi;action=admin";
	redirectexit();
}


function clean_log () {
	global $yytitle,$txt,$scripturl,$cgi,$color,$db_prefix;
	$yytitle = $txt[202];
	template_header();
	print <<<EOT
<table border="0" width="90%" cellspacing=1 cellpadding="3" bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]">
    <font size="2" class="text1" color="$color[titletext]"><b>$txt[202]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]"><font size="2">$txt[203]
    <a href="$cgi;action=do_clean_log">$txt[163]</a>&nbsp;&nbsp;<a href="$scripturl?action=admin">$txt[164]</a><br>
    </font></td>
  </tr>
</table>
EOT;
	footer();
	obExit();
}

function do_clean_log (){
	global $db_prefix;
	$request = mysql_query("DELETE FROM {$db_prefix}log_online WHERE 1");
	Admin();
}

function AdminBoardRecount () {
	global $txt,$yytitle,$db_prefix;
	$yytitle = $txt[502];
	$board = array();
	$request = mysql_query("SELECT ID_BOARD FROM {$db_prefix}boards WHERE 1");
	while ($row = mysql_fetch_row($request)){
		$result = mysql_query("SELECT ID_TOPIC FROM {$db_prefix}topics WHERE ID_BOARD=$row[0]");
		$topics = mysql_num_rows($result);
		while ($row2 = mysql_fetch_row($result))
		{
			$result2 = mysql_query("SELECT COUNT(*) as count FROM {$db_prefix}messages WHERE ID_TOPIC=$row2[0]");
			$row3 = mysql_fetch_row($result2);
			$result2 = mysql_query("UPDATE {$db_prefix}topics SET numReplies=$row3[0]-1 WHERE ID_TOPIC=$row2[0]");
		}		
		$result = mysql_query("SELECT COUNT(*) FROM {$db_prefix}messages as m,{$db_prefix}topics as t WHERE (m.ID_TOPIC=t.ID_TOPIC AND t.ID_BOARD=$row[0])");
		$tmp = mysql_fetch_row($result);
		$posts = $tmp[0];
		$result = mysql_query("UPDATE {$db_prefix}boards SET numTopics=$topics,numPosts=$posts WHERE ID_BOARD=$row[0]");
	}

	template_header();
	print " <br><b>$txt[503]</b> <br> <br>";
	footer();
	obExit();
}

function ShowClickLog (){
	global $yytitle,$txt,$color,$imagesdir,$img,$boardurl,$db_prefix;
	$yytitle = $txt[693];
	template_header();

	$ip = array();
	$to = array();
	$from = array();
	$info = array();
	$request = mysql_query("SELECT ip,agent,toUrl,fromUrl FROM {$db_prefix}log_clicks WHERE 1");
	while ($row = mysql_fetch_assoc($request)){
		$ip[] = $row['ip'];
		$to[] = $row['toUrl'];
		$from[] = $row['fromUrl'];
		$info[] = $row['agent'];
	}

	
	$i = 0;
	$os = array();
	$browser = array();
	foreach ($info as $curentry) {
		if (!preg_match("/\s\(Win/",$curentry) || !preg_match("/\s\(mac/",$curentry))
			$curentry = preg_replace("/\s\((compatible;\s)*/"," - ",$curentry);
		else
			$curentry = preg_replace("/(\S)*\(/",";",$curentry);
		if (preg_match("/\s-\sWin/",$curentry))
			$curentry = preg_replace("/\s-\sWin/","; win",$curentry);
		if (preg_match("/\s-\sMac/",$curentry))
			$curentry = preg_replace("/\s-\sMac/","; mac",$curentry);
		if (strstr($curentry,"; "))
			list ($browser[$i],$os[$i]) = explode(";", $curentry);
		else{
			$browser[$i] = $curentry;
			$os[$i] = $txt[470];
		}
		$browser[$i] = isset($browser[$i])?$browser[$i]:'';
		$os[$i] = isset($os[$i])?$os[$i]:'';
		if (preg_match("/\) \//",$os[$i])) { list ($os[$i],$browser[$i]) = explode(") /", $os[$i]); }
		$os[$i] = str_replace(")","",$os[$i]);
		$i++;
	}

	print <<<EOT
<table border="0" cellspacing="1" cellpadding="5" bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td bgcolor="$color[titlebg]" class="titlebg">
    <img src="$imagesdir/xx.gif" alt="" border="0">&nbsp;
    <font size="2" color="$color[titletext]"><b>$txt[693]</b></font></td>
  </tr><tr>
    <td bgcolor="$color[windowbg]" class="windowbg">
    <BR><font size="1">$txt[697]</font><BR><BR></td>
  </tr><tr>
    <td bgcolor="$color[catbg]" class="catbg">
    <font size="2"><center><B>$txt[694]</B></center></font>
    </td>
  </tr><tr>
    <td bgcolor="$color[windowbg2]" class="windowbg2"><font size="2">
EOT;
$iplist = array();
for($i = 0; $i < sizeof($ip); $i++) {
	$iplist[$ip[$i]] = isset($iplist[$ip[$i]])?$iplist[$ip[$i]]+1:1;
}

$totalclick = sizeof($ip);
$totalip = sizeof($iplist);

print "<i>$txt[742]: $totalclick</i><BR>";
print "<i>$txt[743]: $totalip</i><BR><BR>";
foreach($iplist as $key=>$value)
	print "$key &nbsp;(<i>$value</i>)<BR>\n";

print <<<EOT
    </font></td>
  </tr><tr>
    <td bgcolor="$color[catbg]" class="catbg">
    <font size="2"><center><B>$txt[695]</B>
    </td>
  </tr><tr>
    <td bgcolor="$color[windowbg2]" class="windowbg2"><font size="2">
EOT;
$newbrowser = array();
for($i = 0; $i < sizeof($browser); $i++)
	$newbrowser[$browser[$i]] = isset($newbrowser[$browser[$i]])?$newbrowser[$browser[$i]]+1:1;

$totalbrow = sizeof($newbrowser);
print "<i>$txt[744]: $totalbrow</i><BR><BR>";

foreach ($newbrowser as $key => $value)
	print "$key &nbsp;(<i>$value</i>)<BR>\n";

print <<<EOT
    </font></td>
  </tr><tr>
    <td bgcolor="$color[catbg]" class="catbg">
    <font size="2"><center><B>$txt[696]</B>
    </td>
  </tr><tr>
    <td bgcolor="$color[windowbg2]" class="windowbg2"><font size="2">
EOT;
$newos = array();
for($i = 0; $i < sizeof($os); $i++)
	$newos[$os[$i]] = isset($newos[$os[$i]])?$newos[$os[$i]]+1:1;

$totalos = sizeof($newos);
print "<i>$txt[745]: $totalos</i><BR><BR>";

foreach ($newos as $key => $value)
	print "$key &nbsp;(<i>$value</i>)<BR>\n";

print <<<EOT
    </font></td>
  </tr><tr>
    <td bgcolor="$color[catbg]" class="catbg">
    <font size="2"><center><B>Pages Visited</B>
    </td>
  </tr><tr>
    <td bgcolor="$color[windowbg2]" class="windowbg2"><font size="2">
EOT;
$newto = array();
for($i = 0; $i < sizeof($to); $i++)
	$newto[$to[$i]] = isset($newto[$to[$i]])?$newto[$to[$i]]+1:1;

foreach($newto as $key => $value)
	print "<a href=\"$key\" target=\"_blank\">$key</a> 	&nbsp;(<i>$value</i>)<BR>\n";

print <<<EOT
    </font></td>
  </tr><tr>
    <td bgcolor="$color[catbg]" class="catbg">
    <font size="2"><center><B>Referring Pages</B>
    </td>
  </tr><tr>
    <td bgcolor="$color[windowbg2]" class="windowbg2"><font size="2">
EOT;
$newfrom = array();
for($i = 0; $i < sizeof($from); $i++)
	$newfrom[$from[$i]] = isset($newfrom[$from[$i]])?$newfrom[$from[$i]]+1:1;

foreach($newfrom as $key => $value){
	if ($key == '')
	$key = $txt[470];
	if (strcasecmp(substr($key,0,strlen($boardurl)),$boardurl) != 0)
		print "<a href=\"$key\" target=_blank>".wordwrap($key,80,'...<br>&nbsp;&nbsp;',1)."</a> &nbsp;(<i>$value</i>)<BR>\n";
}

print <<<EOT
    </font></td>
  </tr>
</table>
EOT;
	footer();
	obExit();
}

function ver_detail (){
	global $yytitle,$txt,$color,$YaBBversion,$language,$YaBBplver,$englishlngver,$adminplver;
	global $boardindexplver,$displayplver,$icqpagerplver,$instantmessageplver,$loadplver;
	global $lockthreadplver,$loginoutplver,$maintenanceplver,$manageboardsplver,$managecatsplver;
	global $memberlistplver,$modifymessageplver,$movethreadplver,$notifyplver,$postplver;
	global $profileplver,$recentplver,$registerplver,$removeoldthreadsplver,$removethreadplver;
	global $searchplver,$sendtopicplver,$securityplver,$subsplver,$messageindexplver,$pollplver;
	global $scripturl,$sourcedir,$db_prefix,$karmaphpver,$modsettingsphpver,$repairboardsphpver;
	loadfiles();
	$yytitle = $txt[429];
	template_header();

	$er = error_reporting(0);
	$serverDetails = file ("http://www.yabb.info/yabbinfo_versions.php");
	if (!$serverDetails)
		$serverDetails = file("$sourcedir/versions.php");
	error_reporting($er);

	foreach($serverDetails as $expr)
		eval($expr);
	print <<<EOT
<table border="0" width="70%" cellspacing="1" bgcolor="$color[titlebg]" align="center">
  <tr>
    <td bgcolor="$color[titlebg]"><font size="2" color="$color[titletext]"><b>$txt[429]</b></font></td>
</tr><tr>
    <td bgcolor="$color[windowbg]" align="center"><P>
    <table border="0" bgcolor="$color[windowbg]" class="windowbg" width="90%">
      <tr>
        <td width="30%"><font size="2"><B>$txt[495]</B><BR><BR></td>
        <td width="30%"><font size="2"><B>$txt[494]</B><BR><BR></td>
        <td width="30%"><font size="2"><B>$txt[493]</B><BR><BR></td>
      </tr><tr>
        <td width="30%"><font size="2">$txt[496]</td><td><font size="2"><i>$YaBBversion</i></td>
        <td>$GLOBALS[server_YaBBversion]</td>
      </tr><tr>
        <td width="30%"><font size="2">YaBB.php</td><td><font size="2"><i>$YaBBplver</i></td>
        <td>$GLOBALS[server_YaBBplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">$language</td><td><font size="2"><i>$englishlngver</i></td>
        <td>$GLOBALS[server_englishlngver]</td>
      </tr><tr>
        <td width="30%"><font size="2">Admin.php</td><td><font size="2"><i>$adminplver</i></td>
        <td>$GLOBALS[server_adminplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">BoardIndex.php</td><td><font size="2"><i>$boardindexplver</i></td>
        <td>$GLOBALS[server_boardindexplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">Display.php</td><td><font size="2"><i>$displayplver</i></td>
        <td>$GLOBALS[server_displayplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">ICQPager.php</td><td><font size="2"><i>$icqpagerplver</i></td>
        <td>$GLOBALS[server_icqpagerplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">InstantMessage.php</td><td><font size="2"><i>$instantmessageplver</i></td>
        <td>$GLOBALS[server_instantmessageplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">Karma.php</td><td><font size="2"><i>$karmaphpver</i></td>
        <td>$GLOBALS[server_karmaphpver]</td>
      </tr><tr>
        <td width="30%"><font size="2">Load.php</td><td><font size="2"><i>$loadplver</i></td>
        <td>$GLOBALS[server_loadplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">LockThread.php</td><td><font size="2"><i>$lockthreadplver</i></td>
        <td>$GLOBALS[server_lockthreadplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">LogInOut.php</td><td><font size="2"><i>$loginoutplver</i></td>
        <td>$GLOBALS[server_loginoutplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">Maintenance.php</td><td><font size="2"><i>$maintenanceplver</i></td>
        <td>$GLOBALS[server_maintenanceplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">ManageBoards.php</td><td><font size="2"><i>$manageboardsplver</i></td>
        <td>$GLOBALS[server_manageboardsplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">ManageCats.php</td><td><font size="2"><i>$managecatsplver</i></td>
        <td>$GLOBALS[server_managecatsplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">Memberlist.php</td><td><font size="2"><i>$memberlistplver</i></td>
        <td>$GLOBALS[server_memberlistplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">MessageIndex.php</td><td><font size="2"><i>$messageindexplver</i></td>
        <td>$GLOBALS[server_messageindexplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">ModifyMessage.php</td><td><font size="2"><i>$modifymessageplver</i></td>
        <td>$GLOBALS[server_modifymessageplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">ModSettings.php</td><td><font size="2"><i>$modsettingsphpver</i></td>
        <td>$GLOBALS[server_modsettingsphpver]</td>
      </tr><tr>
        <td width="30%"><font size="2">MoveThread.php</td><td><font size="2"><i>$movethreadplver</i></td>
        <td>$GLOBALS[server_movethreadplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">Notify.php</td><td><font size="2"><i>$notifyplver</i></td>
        <td>$GLOBALS[server_notifyplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">Poll.php</td><td><font size="2"><i>$pollplver</i></td>
        <td>$GLOBALS[server_pollplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">Post.php</td><td><font size="2"><i>$postplver</i></td>
        <td>$GLOBALS[server_postplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">Profile.php</td><td><font size="2"><i>$profileplver</i></td>
        <td>$GLOBALS[server_profileplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">Recent.php</td><td><font size="2"><i>$recentplver</i></td>
        <td>$GLOBALS[server_recentplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">Register.php</td><td><font size="2"><i>$registerplver</i></td>
        <td>$GLOBALS[server_registerplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">RemoveOldThreads.php</td><td><font size="2"><i>$removeoldthreadsplver</i></td>
        <td>$GLOBALS[server_removeoldthreadsplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">RemoveThread.php</td><td><font size="2"><i>$removethreadplver</i></td>
        <td>$GLOBALS[server_removethreadplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">RepairBoards.php</td><td><font size="2"><i>$repairboardsphpver</i></td>
        <td>$GLOBALS[server_repairboardsphpver]</td>
      </tr><tr>
        <td width="30%"><font size="2">Search.php</td><td><font size="2"><i>$searchplver</i></td>
        <td>$GLOBALS[server_searchplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">SendTopic.php</td><td><font size="2"><i>$sendtopicplver</i></td>
        <td>$GLOBALS[server_sendtopicplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">Security.php</td><td><font size="2"><i>$securityplver</i></td>
        <td>$GLOBALS[server_securityplver]</td>
      </tr><tr>
        <td width="30%"><font size="2">Subs.php</td><td><font size="2"><i>$subsplver</i></td>
        <td>$GLOBALS[server_subsplver]</td>
      </tr>
    </table>
    </font></td>
  </tr>
</table>
EOT;
	footer();
	obExit();
}

function getYaBBinfo()
{
	global $boarddir,$db_prefix;
	$request = mysql_query("SELECT value FROM {$db_prefix}settings WHERE variable='yabbinfo'");
	$row = mysql_fetch_row($request);
	if ($row[0] < time()-1800){
		$er = error_reporting(0);
		$contents = @file ("http://www.yabb.info/yabbinfo.xml");
		if (!$contents)
			$contents = file ("$boarddir/yabbinfo.xml");
		error_reporting($er);

		$completecontent = implode('',$contents);
		$fh = fopen("$boarddir/yabbinfo.xml","w");
		fputs($fh,$completecontent);
		$request = mysql_query("UPDATE {$db_prefix}settings SET value=".time()." WHERE variable='yabbinfo'");
	} else {
		$contents = file ("$boarddir/yabbinfo.xml");
		$completecontent = implode('',$contents);
	}

	$items = explode('<infoitem>',$completecontent);

	$infoitems = array();
	for ($i = 1; $i < sizeof($items); $i++)
	{
		$tempitem = array();
		preg_match("/<subject>(.*)<\/subject>/",$items[$i],$matches);
		$tempitem['subject'] = $matches[1];
		preg_match("/<url>(.*)<\/url>/",$items[$i],$matches);
		$tempitem['url'] = $matches[1];
		preg_match("/<timestamp>(.*)<\/timestamp>/",$items[$i],$matches);
		$tempitem['logTime'] = $matches[1];
		preg_match("/<author>(.*)<\/author>/",$items[$i],$matches);
		$tempitem['author'] = $matches[1];
		preg_match("/<details>(.*)<\/details>/",$items[$i],$matches);
		$tempitem['details'] = $matches[1];
		$infoitems[] = $tempitem;
	}
	return ($infoitems);
}
?>
file|^|Sources/BoardIndex.php|^|20619|^|1008887497
<?php
/*****************************************************************************/
/* BoardIndex.php                                                            */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$boardindexplver="YaBB SE";

function BoardIndex (){
	global $imagesdir,$txt,$scripturl,$mbname,$curposlinks,$showlatestmember,$maxmessagedisplay;
	global $color,$imagesdir,$enable_ubbc,$shownewsfader,$faderpath,$settings,$fadertime,$recentsender;
	global $username,$curboard,$showmarkread,$img,$Show_RecentBar,$Show_MemberBar,$realNames;
	global $sourcedir,$reminderurl,$Cookie_Length,$cgi,$yytitle,$ID_MEMBER,$modSettings,$db_prefix;
    $result = mysql_query("SELECT memberName,realName FROM {$db_prefix}members ORDER BY dateRegistered DESC LIMIT 1");
	$temp = mysql_fetch_row($result);
	$latestmember = $temp[0];
	$latestRealName = $temp[1];
    if (!$result) { echo "latestmember SQL failed";}
	$result = mysql_query("SELECT COUNT(*) as memcount FROM {$db_prefix}members;");
	$temp = mysql_fetch_row($result);
    $memcount = $temp[0];
    if (!$result) { echo "memcount SQL failed";}
	$result = mysql_query("SELECT COUNT(*) as totalm FROM {$db_prefix}messages as m,{$db_prefix}boards as b,{$db_prefix}topics as t,{$db_prefix}categories as c WHERE (m.ID_TOPIC=t.ID_TOPIC && t.ID_BOARD=b.ID_BOARD && b.ID_CAT=c.ID_CAT && ('$settings[7]'='Administrator' || '$settings[7]'='Global Moderator' || FIND_IN_SET('$settings[7]',c.memberGroups)!=0 || c.memberGroups=''))");

	$temp = mysql_fetch_row($result);
    $totalm = $temp[0];
    if (!$result) { echo "totalm SQL failed";}
	$result = mysql_query("SELECT COUNT(*) as totalt FROM {$db_prefix}topics;");
	$temp = mysql_fetch_row($result);
    $totalt = $temp[0];
    if (!$result) { echo "totalt SQL failed";}
 	$thelatestmember = "$txt[201] <a href=\"$scripturl?action=viewprofile;user=$latestmember\"><b>$latestRealName</b></a>$txt[581]";
	$thelatestmember2 = "$txt[656] <b><a href=\"$scripturl?action=viewprofile;user=$latestmember\">$latestRealName</a></b>";
	$yytitle = "$txt[18]";
	template_header();
	$curforumurl = $curposlinks ? "<a href=\"$scripturl\" class=\"nav\">$mbname</a>" : $mbname;
// Build the link tree
	$displayLinkTree = 	$modSettings['enableInlineLinks']? "<font size=\"1\" class=\"nav\"><b>$curforumurl</b></font>"  :  "<font size=\"2\" class=\"nav\"><IMG SRC=\"$imagesdir/open.gif\" BORDER=\"0\" alt=\"\"> <b>$curforumurl</b></font>" ;

	print <<<EOT
<table width="100%" align="center">
  <tr>
    <td valign="bottom">$displayLinkTree</td>
    <td align="right">
EOT;
	if ($modSettings['enableSP1Info'] != 1)
		print "<font size=\"2\">$txt[19]: $memcount &nbsp;&bull;&nbsp; $txt[95] $totalm &nbsp;&bull;&nbsp; $txt[64] $totalt";
	if ($showlatestmember == 1 && $modSettings['enableSP1Info'] != 1)
		print "	<br>".$thelatestmember."</font>\n";
	print <<<EOT
    </td>
  </tr>
</table>
EOT;
	if($shownewsfader == 1) {
		if(!isset($fadertime)) { $fadertime = 5000; }		

		print <<<EOT
<table border="0" width="100%" cellspacing="0" cellpadding="0" bgcolor="$color[bordercolor]" class="bordercolor"><tr><td>
<table border="0" width="100%" cellspacing="1" cellpadding="5" bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
    <td bgcolor="$color[titlebg]" class="titlebg" align="center">
    <font class="text1" color="$color[titletext]" size="2"><b>$txt[102]</b></font></td>
  </tr><tr>
    <td bgcolor="$color[windowbg2]" valign="middle" align="center" height="60">
    <SCRIPT LANGUAGE="JavaScript1.2" TYPE="text/javascript">
    <!--
	var delay = $fadertime
	var bcolor = "$color[windowbg2]"
	var tcolor = "$color[fadertext2]"
	var fcontent = new Array()
	begintag = '<font size="2"><B>'

EOT;

	$request = mysql_query("SELECT value FROM {$db_prefix}settings WHERE variable='news'");
	$temp = mysql_fetch_row($request);
	$newslines = str_replace("\r","",trim($temp[0]));
	$newslines = explode("\n",$temp[0]);
	for($i = 0; $i < sizeof($newslines); $i++){
		if ($enable_ubbc==1)
			$newslines[$i] = DoUBBC($newslines[$i]);
		$newslines[$i] = str_replace("\"","'",trim($newslines[$i]));
		$newslines[$i] = str_replace("/","\/",$newslines[$i]);
		print "fcontent[$i] = \"$newslines[$i]\"\n";
	}
	print <<<EOT
	closetag = '<\/b><\/font>'
	 // -->
    </SCRIPT>
    <SCRIPT LANGUAGE="JavaScript1.2" src="$faderpath" TYPE="text/javascript"></SCRIPT>
<script language="JavaScript1.2" type="text/javascript">
<!--
if (navigator.appVersion.substring(0,1) < 5 && navigator.appName == "Netscape") {
   var fwidth = screen.availWidth / 2;
   var bwidth = screen.availWidth / 4;
   document.write('<ilayer id="fscrollerns" width='+fwidth+' height=35 left='+bwidth+' top=0><layer id="fscrollerns_sub" width='+fwidth+' height=35 left=0 top=0><\/layer><\/ilayer>');
}
else if (navigator.userAgent.search(/Opera/) != -1 || (navigator.platform != "Win32" && navigator.userAgent.indexOf('Gecko') == -1)) {
   document.open();
   for(i=0;i<fcontent.length;++i) {
      document.write(begintag+fcontent[i]+closetag+"<br>");
   }
   document.close();
}
else {
   document.write('<div id="fscroller" style="width:90% height:15px; padding:2px"><\/div>');
}
window.onload = fade;
// -->
</script>
    </td>
  </tr>
</table>
</td></tr></table>
EOT;
		}
	print <<<EOT
<table border="0" width="100%" cellspacing="0" cellpadding="0" bgcolor="$color[bordercolor]" class="bordercolor"><tr><td>
<table border=0 width="100%" cellspacing="1" cellpadding="5" bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]" colspan="2"><font class="text1" color="$color[titletext]" size="66%"><b>$txt[20]</b></font></td>
    <td class="titlebg" bgcolor="$color[titlebg]" width="6%" align="center"><font class="text1" color="$color[titletext]" size="2"><b>$txt[330]</b></font></td>
    <td class="titlebg" bgcolor="$color[titlebg]" width="6%" align="center"><font class="text1" color="$color[titletext]" size="2"><b>$txt[21]</b></font></td>
    <td class="titlebg" bgcolor="$color[titlebg]" width="22%" align="center"><font class="text1" color="$color[titletext]" size="2"><b>$txt[22]</b></font></td>
  </tr>
EOT;

	$result = mysql_query("SELECT name,ID_CAT FROM {$db_prefix}categories WHERE ('$settings[7]'='Administrator' || '$settings[7]'='Global Moderator' || FIND_IN_SET('$settings[7]',memberGroups)!=0 || memberGroups='') ORDER BY catOrder");

	while ($row_cat = mysql_fetch_array($result))
	{
		print <<<EOT
  <tr>
    <td colspan="5" class="catbg" bgcolor="$color[catbg]" height="18"><a name="$row_cat[ID_CAT]"><font size="2"><b>$row_cat[name]</b></font></a></td>
  </tr>
EOT;
		$result2 = mysql_query("SELECT ID_BOARD,name,description,moderators,numPosts,numTopics FROM {$db_prefix}boards WHERE (ID_CAT=$row_cat[ID_CAT]) ORDER BY boardOrder");
		while ($row_board = mysql_fetch_array($result2))
		{
			$result3 = mysql_query("SELECT m.posterName,m.ID_MEMBER,m.posterTime,m.modifiedTime,m.subject,t.ID_TOPIC,t.numReplies FROM {$db_prefix}messages as m, {$db_prefix}topics as t WHERE (m.ID_MSG=t.ID_LAST_MSG && t.ID_BOARD=$row_board[ID_BOARD]) ORDER BY m.posterTime DESC LIMIT 1");
			$latestPostName = $txt[470];
			$latestPostTime = $txt[470];
			$latestPostID = '-1';
			$latestModTime = $subject = $topicID = '';
			$numReplies = 0;
			if (mysql_num_rows($result3) > 0)
				list ($latestPostName,$latestPostID,$latestPostTime,$latestModTime,$subject,$topicID,$numReplies) = mysql_fetch_row($result3);
			$latestEditTime = $latestModTime = $latestPostTime;

			if ($latestPostID != '-1') {
				$result3 = mysql_query("SELECT realName FROM {$db_prefix}members WHERE ID_MEMBER=$latestPostID");
				$rowmem = mysql_fetch_row($result3);
				$latestPostRealName = $rowmem[0];
			}


			$themoderators = explode(",",$row_board['moderators']);
			for ($i = 0; $i < sizeof($themoderators); $i++){
				$themoderators[$i] = trim($themoderators[$i]);
				if ($themoderators[$i]!=''){
				LoadRealName($themoderators[$i]);
				$themoderators[$i] = "<a href=\"$scripturl?action=viewprofile;user=$themoderators[$i]\"><acronym			title=\"$txt[62]\">{$realNames[$themoderators[$i]]}</acronym></a>";
				}
			}

			$showmods = implode (", ",$themoderators);
			if ($showmods!='')
			{
                 if (sizeof($themoderators)>1)
                  $showmods = "<BR><font size=\"1\"><i>$txt[299]: $showmods</i></font>";
                 else
                  $showmods = "<BR><font size=\"1\"><i>$txt[298]: $showmods</i></font>";
			}else{
				$showmods = "";}

			$new = "<img src=\"$imagesdir/off.gif\" alt=\"$txt[334]\">";

			if ($username!= 'Guest')
			{
				$result3 = mysql_query("SELECT logTime FROM {$db_prefix}log_boards WHERE (ID_BOARD=$row_board[ID_BOARD] && memberName='$username' && logTime >= $latestEditTime) LIMIT 1");
				$result3b = mysql_query("SELECT logTime FROM {$db_prefix}log_mark_read WHERE (ID_BOARD=$row_board[ID_BOARD] && memberName='$username' && logTime >= $latestEditTime) LIMIT 1");

				if (($latestPostTime != $txt[470]) && ((mysql_num_rows($result3) + mysql_num_rows($result3b)) == 0))
					$new = "<img src=\"$imagesdir/on.gif\" alt=\"$txt[333]\">";
			}

			if ($latestPostName != $txt[470] && $latestPostID != '-1')
				$latestPostName = "<a href=\"$scripturl?action=viewprofile;user=$latestPostName\">$latestPostRealName</a>";
			if ($latestPostTime != $txt[470])
				$latestPostTime = timeformat($latestPostTime);
			$subject = (strlen($subject) > 20)?substr($subject,0,20) . '...':$subject;
			$startPage = (floor(($numReplies)/$maxmessagedisplay)*$maxmessagedisplay);

			print <<<EOT
  <tr>
    <td class="windowbg" bgcolor="$color[windowbg]" width="6%" align="center" valign="top">$new</td>
    <td class="windowbg2" bgcolor="$color[windowbg2]" align="left" width="60%">
    <a name="$curboard"></a>
    <font size="2"><b><a href="$scripturl?board=$row_board[ID_BOARD]">$row_board[name]</a></b>
    <br>$row_board[description]</font>$showmods</td>
    <td class="windowbg" bgcolor="$color[windowbg]" valign="middle" align="center" width="6%"><font size="2">$row_board[numTopics]</font></td>
    <td class="windowbg" bgcolor="$color[windowbg]" valign="middle" align="center" width="6%"><font size="2">$row_board[numPosts]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]" valign="middle" width="22%"><font size="1">$latestPostTime<BR>in <a href="$scripturl?board=$row_board[ID_BOARD];action=display;threadid=$topicID;start=$startPage">$subject</a><br> $txt[525] $latestPostName</font></td>
  </tr>
EOT;
		}
	}
	// load the number of users online right now
	$guests = 0;
	$tmpusers = array();
	$request3 = mysql_query("SELECT identity FROM {$db_prefix}log_online WHERE 1 ORDER BY logTime DESC");
	while ($tmp = mysql_fetch_array($request3))
	{
		$identity = $tmp[0];
		$request4 = mysql_query("SELECT realName FROM {$db_prefix}members WHERE (memberName='$identity') LIMIT 1");
		if (mysql_num_rows($request4) > 0){
			$tmp = mysql_fetch_row($request4);
			$tmpusers[] = "<a href=\"$scripturl?action=viewprofile;user=$identity\">$tmp[0]</a>";
		}
		else
			$guests ++;
	}
	$users = "<font size=1>".implode(", ",$tmpusers)."</font>";
	$numusersonline = sizeof($tmpusers);

	if( $username != 'Guest' ) {
		// deal with instant messages
		$request3 = mysql_query("SELECT COUNT(*) FROM {$db_prefix}instant_messages WHERE (ID_MEMBER_TO=$ID_MEMBER && deletedBy != 1)");
		 $temp = mysql_fetch_row($request3);
		 $messnum = $temp[0];

		print <<<EOT
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]" colspan="6" align="center">
    <table cellpadding="0" border="0" cellspacing="0" width="100%">
      <tr>
        <td align="left">
        <img src="$imagesdir/new_some.gif" border="0" alt="$txt[333]"> &nbsp;&nbsp;
        <img src="$imagesdir/new_none.gif" border="0" alt="$txt[334]"></td>
        <td align="right"><font size="-1">&nbsp;
EOT;
		if($showmarkread==1)
			print " <a href=\"$scripturl?action=markallasread\">$img[markallread]</a>";
	print <<<EOT
        </font></td>
      </tr>
    </table>
    </td>
  </tr>
EOT;
		}
print "</table></td></tr></table><br><BR>";
if( $username == 'Guest' )
		print "<form action=\"$cgi;action=login2\" method=\"POST\">\n";
print <<<EOT
<table border="0" width="100%" cellspacing="0" cellpadding="0" bgcolor="$color[bordercolor]" class="bordercolor"><tr><td>
<table border="0" width="100%" cellspacing="1" cellpadding="4" bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
    <td bgcolor="$color[titlebg]" class="titlebg" align="center" colspan="2">
    <font class="text1" color="$color[titletext]" size="2"><b>$txt[685]</b></font></td>
  </tr>
EOT;

	if($Show_RecentBar == 1) {
		print <<<EOT

  <tr>
    <td class="catbg" bgcolor="$color[catbg]" colspan="2"><font size="2" class="catbg"> <b>$txt[214]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]" width="20" valign="middle" align="center"><img src="$imagesdir/xx.gif" border="0" alt=""></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2"><b><A href="$scripturl?action=recent">$txt[214]</A></b></font><br>
    <font size="1">
EOT;
	include_once ("$sourcedir/Recent.php");
	LastPost();
	print <<<EOT
    </tr>
EOT;
}
else if ($Show_RecentBar == 2)
{   
      print <<<EOT

  <tr>
    <td class="catbg" bgcolor="$color[catbg]" colspan="2"><font size="2" class="catbg"> <b>$txt[214]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]" width="20" valign="middle" align="center"><img src="$imagesdir/xx.gif" border="0" alt=""></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]">
    <font size="1">
EOT;
   include_once ("$sourcedir/Recent.php");
   LastPostings();
   print <<<EOT
    </tr>
EOT;
}
	
	if($Show_MemberBar == 1) {
		print <<<EOT
  <tr>
    <td class="catbg" bgcolor="$color[catbg]" colspan="2"><font size="2" class="catbg"> <b>$txt[331]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]" width="20" valign="middle" align="center"><img src="$imagesdir/guest.gif" border="0" width="20" alt=""></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]" width="100%"><font size="2"><b><A href="$scripturl?action=mlall">$txt[332]</A></b></font><br><font size="1">$txt[200]</font></td>
  </tr>
EOT;
	}
	if ($modSettings['enableSP1Info'] == 1)
	{
print <<<EOT
  <tr>
    <td class="catbg" bgcolor="$color[catbg]" colspan="2"><font size="2" class="catbg"> <b>$txt[645]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]" width="20" valign="middle" align="center"><img src="$imagesdir/info.gif" border="0" alt=""></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]" width="100%">
	<table border="0" width="80%"><tr>
	<td><font size=1>$txt[94] $txt[64] <b>$totalt</b> &nbsp;&nbsp;&nbsp;&nbsp; $txt[94] $txt[95] <b>$totalm</b><br>
	$txt[659] 
EOT;
include_once("$sourcedir/Recent.php");
$recentsender = "admin";
LastPost();
print <<<EOT
	<br><a href="$scripturl?action=recent">$txt[234]</a></font></td>
	<td><font size=1>
$txt[94] $txt[19] <b><a href="$scripturl?action=mlall">$memcount</a></b><br>
$thelatestmember2<br>
EOT;
if( $username != 'Guest' )
	print "$txt[yse199]: <b><a href=\"$scripturl?board=;action=im\">$messnum</a></b>";
print <<<EOT
</font></td>
	</tr></table>
</td>
 </tr>
EOT;
	}
	print <<<EOT
  <tr>
    <td class="catbg" bgcolor="$color[catbg]" colspan="2"><font size="2" class="catbg"> <b>$txt[158]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]" width="20" valign="middle" align="center"><img src="$imagesdir/online.gif" border="0" alt=""></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]" width="100%"><font size="2">$guests $txt[141], $numusersonline $txt[142]<br>$users</font></td>
  </tr>
EOT;
	if( $username != 'Guest' && $modSettings['enableSP1Info'] != 1) {
		print <<<EOT
  <tr>
    <td class="catbg" bgcolor="$color[catbg]" colspan="2"><font size="2" class="catbg"> <b>$txt[159]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]" width="20" valign="middle" align="center"><img src="$imagesdir/message_sm.gif" border="0" alt=""></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]" valign="top"><font size="2"><b><a href="$scripturl?board=;action=im">$txt[159]</a></b></font><br><font size="1">$txt[660] $messnum 
EOT;
		if($messnum == 1) { print $txt[471]; }
		else { print $txt[153]; }
		print <<<EOT
    .... $txt[661] <a href="$scripturl?board=;action=im">$txt[662]</a> $txt[663]</font></td>
  </tr>
EOT;
}
	if($modSettings['enableVBStyleLogin']!='1' && $username=='Guest') {
		print <<<EOT
  <tr>
    <td class="catbg" bgcolor="$color[catbg]" colspan="2"><font size="2" class="catbg"> <b>$txt[34]</b></font>
    <a href="$reminderurl?action=input_user"><small>($txt[315])</small></a></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg2]" width="20" align="center"><img src="$imagesdir/login_bindex.gif" border="0" alt=""></td>
    <td class="windowbg" bgcolor="$color[windowbg2]" valign="middle">	
    <table border="0" cellpadding="2" cellspacing="0" align="center" width="100%">
      <tr>
        <td valign="middle" align="left"><font size="2"><b>$txt[35]:</b><br><input type="text" name="user" size="15"></font></td>
        <td valign="middle" align="left"><font size="2"><b>$txt[36]:</b><br><input type="password" name="passwrd" size="15"></font></td>
        <td valign="middle" align="left"><font size="2"><b>$txt[497]:</b><br><input type="text" name="cookielength" size="4" maxlength="4" value="$Cookie_Length"></font></td>
        <td valign="middle" align="left"><font size="2"><b>$txt[508]:</b><br><input type="checkbox" name="cookieneverexp" checked></font></td>
        <td valign="middle" align="left"><input type="submit" value="$txt[34]"></td>
      </tr>
    </table>
	</td>
  </tr>
EOT;
	}

	print "</table></td></tr></table>";
if( $username == 'Guest' )
	print "</form>";

	footer();
	obExit();
}

function MarkAllRead (){
	global $settings,$username,$db_prefix;
	$result = mysql_query("SELECT c.ID_CAT,b.ID_BOARD FROM {$db_prefix}categories as c,{$db_prefix}boards as b WHERE ('$settings[7]'='Administrator' || '$settings[7]'='Global Moderator' || FIND_IN_SET('$settings[7]',c.memberGroups)!=0 || c.memberGroups='')");

	while (list($ID_CAT,$ID_BOARD) = mysql_fetch_row($result)){
		$request = mysql_query("SELECT logTime FROM {$db_prefix}log_mark_read WHERE (memberName='$username' AND ID_BOARD=$ID_BOARD) LIMIT 1");

		if (mysql_num_rows($request)==0)
			$request = mysql_query("INSERT INTO {$db_prefix}log_mark_read (logTime,memberName,ID_BOARD) VALUES (".time().",'$username',$ID_BOARD)");
		else
			$request = mysql_query("UPDATE {$db_prefix}log_mark_read SET logTime=".time()." WHERE (memberName='$username' AND ID_BOARD=$ID_BOARD)");
	
	}
	BoardIndex();
	obExit();
}
?>
file|^|Sources/Display.php|^|27598|^|1008860974
<?php
/*****************************************************************************/
/* Display.php                                                               */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$displayplver="YaBB SE";

function Display() {
    global $currentboard,$maxmessagedisplay,$censored,$enable_notification,$img;
	global $cgi,$yytitle,$imagesdir,$scripturl,$mbname,$showmodify,$settings;
	global $yyUDLoaded,$userprofile,$memberstar,$memberinfo,$icqad,$yimon,$ID_MEMBER;
	global $txt,$menusep,$start,$curposlinks,$color,$printurl,$MenuType,$username;
	global $enable_ubbc,$profilebutton,$membergroups,$allow_hide_email,$threadid;
	global $moderators,$modSettings,$viewResults,$realNames,$db_prefix;
    $viewnum = $threadid;
	if( $currentboard == "" ) { fatal_error($txt[1]); }

	$result = mysql_query("SELECT b.ID_CAT,b.name,c.name,c.memberGroups FROM {$db_prefix}boards as b,{$db_prefix}categories as c WHERE (b.ID_BOARD=$currentboard && b.ID_CAT=c.ID_CAT)");
	list($curcat,$boardname,$cat,$temp2) = mysql_fetch_row($result);
	$memgroups = explode(",",$temp2);

	if (!(in_array($settings[7],$memgroups) || $memgroups[0]==null || $settings[7]=='Administrator' || $settings[7]=='Global Moderator'))
		fatal_error($txt[1]);

	// do the previous next stuff
	$previousNext = '';
	if ($modSettings['enablePreviousNext'] == '1')  // modSettings is defined in loadBoard
	{
		// Grab the number which this topic is
		if ($modSettings['enableStickyTopics'] == '1')
			$result = mysql_query("SELECT t.ID_TOPIC FROM {$db_prefix}topics as t,{$db_prefix}topics as top,{$db_prefix}messages as m,{$db_prefix}messages as mes WHERE (m.ID_MSG=t.ID_LAST_MSG AND mes.ID_MSG=top.ID_LAST_MSG AND t.ID_BOARD=$currentboard AND top.ID_TOPIC=$threadid AND ((m.posterTime > mes.posterTime AND t.isSticky=top.isSticky) OR (t.isSticky>top.isSticky ))) ORDER BY t.isSticky DESC, t.ID_LAST_MSG DESC");
		else
			$result = mysql_query("SELECT t.ID_TOPIC FROM {$db_prefix}topics as t,{$db_prefix}topics as top{$db_prefix}messages as m,{$db_prefix}messages as mes WHERE (m.ID_MSG=t.ID_LAST_MSG AND mes.ID_MSG=top.ID_LAST_MSG AND t.ID_BOARD=$currentboard AND top.ID_TOPIC=$threadid AND m.posterTime > mes.posterTime) ORDER BY t.ID_LAST_MSG DESC");
		$prevTopic = mysql_num_rows($result)-1;
		$nextTopic = mysql_num_rows($result)+1;

		// get previous
		if ($modSettings['enableStickyTopics'] == '1')
			$result = mysql_query("SELECT t.ID_TOPIC FROM {$db_prefix}topics as t, {$db_prefix}messages as m  WHERE (t.ID_BOARD=$currentboard AND m.ID_MSG=t.ID_LAST_MSG) ORDER BY t.isSticky DESC, m.posterTime DESC LIMIT $prevTopic,1");
		else
			$result = mysql_query("SELECT t.ID_TOPIC FROM {$db_prefix}topics as t, {$db_prefix}messages as m  WHERE (t.ID_BOARD=$currentboard AND m.ID_MSG=t.ID_LAST_MSG) ORDER BY m.posterTime DESC LIMIT $prevTopic,1");
		list ($prevTopic) = mysql_num_rows($result) > 0 ? mysql_fetch_row($result) : array('');

		if ($prevTopic != '')
			$prevTopic = "<a href=\"$cgi;action=display;threadid=$prevTopic\">$modSettings[PreviousNext_back]</a>";

		// get next
		if ($modSettings['enableStickyTopics'] == '1')
			$result = mysql_query("SELECT t.ID_TOPIC FROM {$db_prefix}topics as t, {$db_prefix}messages as m WHERE (t.ID_BOARD=$currentboard AND m.ID_MSG=t.ID_LAST_MSG) ORDER BY t.isSticky DESC, m.posterTime DESC LIMIT $nextTopic,1");
		else
			$result = mysql_query("SELECT t.ID_TOPIC FROM {$db_prefix}topics as t, {$db_prefix}messages as m WHERE (t.ID_BOARD=$currentboard AND m.ID_MSG=t.ID_LAST_MSG) ORDER BY m.posterTime DESC LIMIT $nextTopic,1");
		list ($nextTopic) = mysql_num_rows($result) > 0 ? mysql_fetch_row($result) : array('');

		if ($nextTopic != '')
			$nextTopic = "<a href=\"$cgi;action=display;threadid=$nextTopic\">$modSettings[PreviousNext_forward]</a>";
		
		$previousNext = "$prevTopic $nextTopic";
	}


    $request = mysql_query("SELECT membergroup FROM {$db_prefix}membergroups WHERE 1 ORDER BY ID_GROUP");
   	$membergroups = array();

	while ($row = mysql_fetch_row($request))
		$membergroups[] = $row[0];

	// get all the topic info
	$request = mysql_query("SELECT t.numReplies,t.numViews,t.locked,ms.subject,t.isSticky,ms.posterName,ms.ID_MEMBER,t.ID_POLL,t.ID_MEMBER_STARTED FROM {$db_prefix}topics as t,{$db_prefix}messages as ms WHERE (t.ID_BOARD=$currentboard && t.ID_TOPIC=$viewnum AND ms.ID_MSG=t.ID_FIRST_MSG)");
	if (mysql_num_rows($request)==0)
		fatal_error($txt[472]);
	$topicinfo = mysql_fetch_array($request);

	// markt the topic as read :)
	$request = mysql_query("SELECT logTime FROM {$db_prefix}log_topics WHERE (memberName='$username' AND ID_TOPIC=$viewnum) LIMIT 1");
	if (mysql_num_rows($request)==0)
		$request = mysql_query("INSERT INTO {$db_prefix}log_topics (logTime,memberName,ID_TOPIC) VALUES (".time().",'$username',$viewnum)");
	else
		$request = mysql_query("UPDATE {$db_prefix}log_topics SET logTime=".time()." WHERE (memberName='$username' AND ID_TOPIC=$viewnum)");


	# Add 1 to the number of views of this thread.
	$request = mysql_query("UPDATE {$db_prefix}topics SET numViews=numViews+1 WHERE ID_TOPIC=$viewnum");

	/*# Check to make sure this thread isn't locked. */
	$noposting = $topicinfo['locked'];
	$mreplies = $topicinfo['numReplies'];
	$mstate = $topicinfo['locked'];
	$msubthread = $topicinfo['subject'];
	$yytitle = str_replace("\$","&#36;",$topicinfo['subject']);

	# Get the class of this thread, based on lock status and number of replies.
	$threadclass = '';
	if( $mstate == 1 || $mstate==2) { $threadclass = 'locked'; }
	elseif( $mreplies > 24 ) { $threadclass = 'veryhotthread'; }
	elseif( $mreplies > 14 ) { $threadclass = 'hotthread'; }
	elseif( $mstate == 0 ) { $threadclass = 'thread'; }
	if ($modSettings['enableStickyTopics'] == '1' && $topicinfo['isSticky'] == '1') {$threadclass = 'sticky'; }
	if (($mstate == 1 || $mstate==2 )&&($modSettings['enableStickyTopics'] == '1' && $topicinfo['isSticky'] == '1')) {$threadclass='lockedsticky';}

	# Load Censor List
	LoadCensorList();
	
	
	// Build a list of this board's moderators.
	$showmods = '';		// create an empty string
	$tmp = array();		// used to temporarily store the list
   $moderatorusernames = array();
	if( sizeof($moderators) > 0 && $moderators[0]!=NULL) {	// moderators is defined near the start of the function
		if( sizeof($moderators) == 1 )		// if only one mod - use a different string
			$showmods = "($txt[298]: ";
		else
			$showmods = "($txt[299]: ";
		for ($i = 0; $i < sizeof($moderators); $i++){
			$tmp[$i] = "<a href=\"$scripturl?action=viewprofile;user=$moderators[$i]\"><acronym			title=\"$txt[62]\">{$realNames[$moderators[$i]]}</acronym></a>";
         $moderatorusernames[trim($moderators[$i])] = true;
		}
		$showmods .= implode(", ",$tmp).")";	// stitch the list together
	}

	if( $enable_notification ) { // $enable_notification is defined in settings
		$notify = "$menusep<a href=\"$cgi;action=notify;threadid=$viewnum;start=$start\">$img[notify]</a>";
	}
	$selecthtml	= jumpto();

	# Build the page links list.
	$max = $mreplies + 1;
	$start = ($start > $mreplies) ? $mreplies : $start;
	$start = ( floor( $start / $maxmessagedisplay ) ) * $maxmessagedisplay;
	$tmpa = $start - $maxmessagedisplay;
	$pageindex = ($start == 0) ? '' : "<a href=\"$cgi;action=display;threadid=$viewnum;start=$tmpa\">&#171;</a>";
	$tmpa = 1;
	for( $counter = 0; $counter < $max; $counter += $maxmessagedisplay ) {
		$pageindex .= ($start == $counter) ? " <b>$tmpa</b>" : " <a href=\"$cgi;action=display;threadid=$viewnum;start=$counter\">$tmpa</a>";
		$tmpa++;
	}
	$tmpa = $start + $maxmessagedisplay;
	$tmpa = $tmpa > $mreplies ? $mreplies : $tmpa;
	if($start != $counter-$maxmessagedisplay) {
		$pageindex .= ($tmpa > $counter-$maxmessagedisplay) ? ' ' : " <a href=\"$cgi;action=display;threadid=$viewnum;start=$tmpa\">&#187;</a> ";
	}

	foreach ($censored as $tmpa => $tmpb)
		$msubthread = str_replace($tmpa,$tmpb,$msubthread);

	$curthreadurl = $curposlinks ? "<a href=\"$cgi;action=display;threadid=$viewnum\" class=\"nav\">$msubthread</a>" : $msubthread;
                    
# Build the link tree
	$displayLinkTree = $modSettings['enableInlineLinks'] ? "<font size=\"1\" class=\"nav\"><B><a href=\"$scripturl\" class=\"nav\">$mbname</a> </b>&nbsp;|&nbsp;<b> " : "<font size=\"2\" class=\"nav\"><B><img src=\"$imagesdir/open.gif\" border=\"0\" alt=\"\">&nbsp;&nbsp;<a href=\"$scripturl\" class=\"nav\">$mbname</a><br>" ;
	$displayLinkTree .= $modSettings['enableInlineLinks'] ? "<a href=\"$scripturl#$curcat\" class=\"nav\">$cat</a> </b>&nbsp;|&nbsp;<b> " : "<img src=\"$imagesdir/tline.gif\" border=\"0\" alt=\"\"><IMG SRC=\"$imagesdir/open.gif\" border=\"0\" alt=\"\">&nbsp;&nbsp;<a href=\"$scripturl#$curcat\" class=\"nav\">$cat</a><br>" ;
	$displayLinkTree .= $modSettings['enableInlineLinks'] ? "<a href=\"$cgi\" class=\"nav\">$boardname</a></b> $showmods<b> </b>&nbsp;|&nbsp;<b> " : "<img src=\"$imagesdir/tline2.gif\" border=\"0\" alt=\"\"><IMG SRC=\"$imagesdir/open.gif\" border=\"0\" alt=\"\">&nbsp;&nbsp;<a href=\"$cgi\" class=\"nav\">$boardname</a></b> $showmods<b><br>" ;
	$displayLinkTree .= $modSettings['enableInlineLinks'] ? "$txt[118]</b></font>" : "<img SRC=\"$imagesdir/tline3.gif\" border=\"0\" alt=\"\"><IMG SRC=\"$imagesdir/open.gif\" border=\"0\" alt=\"\">&nbsp;&nbsp;$curthreadurl</b></font>" ;

	// only show reply if not locked
	$reply = '';
	if (!$mstate)
		$reply="<a href=\"$cgi;action=post;threadid=$viewnum;title=$txt[116];start=$start\">$img[reply]</a>";
	// Create the poll info if it exists
	$pollHtml = '';
	if ($topicinfo['ID_POLL'] != '-1' && $modSettings['pollMode'] == '1')
	{
		$request = mysql_query("SELECT question,votingLocked,votedMemberIDs,option1,option2,option3	,option4,option5,option6,option7,option8,votes1,votes2,votes3,votes4,votes5,votes6,votes7,votes8 FROM {$db_prefix}polls WHERE ID_POLL='$topicinfo[ID_POLL]' LIMIT 1");
		$pollinfo = mysql_fetch_assoc($request);
		$pollimage=($pollinfo['votingLocked'] != '0' )?'locked_poll':'poll';
		$pollHtml =<<<EOT
<table cellpadding="0" cellspacing="0" border="0" width="100%" bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td>
    <table cellpadding="3" cellspacing="0" width="100%">
      <tr>
        <td>
         <font size="2" class="text1" color="$color[titletext]">&nbsp;<img src="$imagesdir/$pollimage.gif" alt=""> <b>$txt[yse43]</b></font>
        </td>
      </tr>
    </table>
    <table cellpadding="3" cellspacing="1" border="0" width="100%">
      <tr>
		<td valign="middle" align="left" bgcolor="$color[windowbg]" class="windowbg">
EOT;
$pollHtml.= "<table border=0><tr><td valign=\"top\"><b>$txt[yse21]:</b></td><td>".stripslashes(DoUBBC($pollinfo['question']));
		$lockVoting = '';
		$pollEdit = '';
		if ($ID_MEMBER==$topicinfo['ID_MEMBER_STARTED'] || in_array($username,$moderators) || $settings[7]=='Administrator')
			$lockVoting="<br><a href=\"$cgi;action=lockVoting;start=$start;threadid=$threadid\">".($pollinfo['votingLocked']=='0'?$txt['yse30']:$txt['yse30b'])."</a>";
		if (($ID_MEMBER==$topicinfo['ID_MEMBER_STARTED'] && $modSettings['pollEditMode']=='2') || (in_array($username,$moderators) && in_array($modSettings['pollEditMode'],array('2','1'))) || $settings[7]=='Administrator')
			$pollEdit="<a href=\"$cgi;action=editpoll;start=$start;threadid=$threadid\">$txt[yse39]</a>";

		if ($ID_MEMBER == '-1' || in_array("$ID_MEMBER", explode(",",$pollinfo['votedMemberIDs'])) || $pollinfo['votingLocked'] != '0' || $viewResults == '1')
		{
			$totalvotes =$pollinfo['votes1']+$pollinfo['votes2']+$pollinfo['votes3']+$pollinfo['votes4']+$pollinfo['votes5']+$pollinfo['votes6']+$pollinfo['votes7']+$pollinfo['votes8'];
			$divisor = ($totalvotes == 0)?1:$totalvotes;
			$pollHtml .= "<table><tr><td>";	
			$pollHtml .= "<br><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n";
			for ($i = 1; $i <= 8; $i++)
				if ($pollinfo["option$i"] != '')
			{
				$bar = floor(($pollinfo["votes$i"] / $divisor) * 100);
				$barWide = ($bar==0)?1:floor(($bar*5)/3);
				$barLine = "<img src=\"$imagesdir/poll_left.gif\" alt=\"\"><img src=\"$imagesdir/poll_middle.gif\" width=\"$barWide\" height=\"12\" alt=\"\"><img src=\"$imagesdir/poll_right.gif\" alt=\"\">";
				$pollHtml .= "<tr><td>".stripslashes(DoUBBC($pollinfo["option$i"]))."</td><td width=\"7\">&nbsp;</td><td nowrap>$barLine ".$pollinfo["votes$i"]." ($bar%)</td></tr>\n";
			}
			$pollHtml.="</table>\n</td><td width=\"15\">&nbsp;</td><td valign=\"bottom\">$lockVoting&nbsp;&nbsp;$pollEdit</td></tr><tr><td><b>$txt[yse24]: $totalvotes</b></td><td>&nbsp;</td></tr></table><br>";
		}
		else
		{
			$pollHtml .= "<form action=\"$cgi;action=vote;threadid=$threadid;start=$start;poll=$topicinfo[ID_POLL]\" method=\"post\">";
			$pollHtml .= "<table><td>";
			for ($i = 1; $i <= 8; $i++)
				if ($pollinfo["option$i"] != '')
					$pollHtml .= "<input type=\"radio\" name=\"option\" value=\"$i\"> ".stripslashes(DoUBBC($pollinfo["option$i"]))."<br>\n";
			$pollHtml .= "</td><td width=\"15\">&nbsp;</td><td valign=\"bottom\"><a href=\"$cgi;action=display;start=$start;threadid=$threadid;viewResults=1\">$txt[yse29]</a>$lockVoting&nbsp;&nbsp;$pollEdit</td></tr><tr><td><input type=\"submit\" value=\"$txt[yse23]\"></td><td>&nbsp;</td></tr></table></form>";
		}

		$pollHtml .=<<<EOT
			</td></tr></table></td>
      </tr>
    </table>
    </td>
  </tr>
</table>
EOT;
	}

	template_header();
	print <<<EOT
<script language="JavaScript1.2" type="text/javascript"><!--
	function DoConfirm(message, url) {
		if(confirm(message)) location.href = url;
	}
//--></script>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr>
    <td valign="bottom">$displayLinkTree</td>
	<td valign="bottom" align="right">
		<font size="2" class="nav">$previousNext</font>
	</td>
  </tr>
</table>
<table border="0" width="100%" cellspacing="0" cellpadding="0" bgcolor="$color[bordercolor]" class="bordercolor"><tr><td>
<table width="100%" cellpadding="3" cellspacing="1" border="0" bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
    <td align="left" class="catbg" bgcolor="$color[catbg]" width="100%"  height="35">
    <table cellpadding="3" cellspacing="0" width="100%">
      <tr>
        <td>
        <font size="2"><b>$txt[139]:</b> $pageindex</font>
        </td>
	<td class="catbg" bgcolor="$color[catbg]" align="right" width="350"><font size="-1">
        $reply$notify$menusep<a href="$cgi;action=sendtopic;threadid=$viewnum">$img[sendtopic]</a>$menusep<a href="$printurl?board=$currentboard;threadid=$viewnum" target="_blank">$img[printt]</a>&nbsp;
	</font></td>
      </tr>
    </table>
    </td>
  </tr>
</table>
</td></tr></table>
$pollHtml
<table cellpadding="0" cellspacing="0" border="0" width="100%" bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td>
    <table cellpadding="3" cellspacing="1" border="0" width="100%">
      <tr>
        <td valign="middle" align="left" width="15%" bgcolor="$color[titlebg]" class="titlebg">
        <font size="2" class="text1" color="$color[titletext]">&nbsp;<img src="$imagesdir/$threadclass.gif" alt="">
        &nbsp;<b>$txt[29]</b></font>
        </td>
        <td valign="middle" align="left" bgcolor="$color[titlebg]" class="titlebg" width="85%">
        <font size="2" class="text1" color="$color[titletext]"><b>&nbsp;$txt[118]: $msubthread</b> &nbsp;($txt[641] $topicinfo[numViews] $txt[642])</font></td>
      </tr>
    </table>
    </td>
  </tr>
</table>
EOT;

	# Load background color list.
	$bgcolors = array( $color['windowbg'], $color['windowbg2'] );
	$bgcolornum = sizeof($bgcolors);
	$cssvalues = array( "windowbg","windowbg2" );
	$cssnum = sizeof($bgcolors);

	if($MenuType == 0) { $sm = 1; }
	$counter = $start;

	# For each post in this thread:
	$request = mysql_query("SELECT ID_MSG,subject,posterName,posterEmail,posterTime,ID_MEMBER,icon,posterIP,body,smiliesEnabled,modifiedTime,modifiedName,attachmentFilename,attachmentSize FROM {$db_prefix}messages WHERE ID_TOPIC=$viewnum ORDER BY ID_MSG LIMIT $start,$maxmessagedisplay");

print "<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" width=\"100%\" bgcolor=\"$color[bordercolor]\" class=\"bordercolor\" align=\"center\">";

	while ($message = mysql_fetch_array($request)) {
		# Set up the attachment info - Meriadoc 12/14/2001
		$attached="";
		if ($message['attachmentSize']>0 && $modSettings['attachmentEnable'] != '0') {
			$attached = "<a href=\"$modSettings[attachmentUrl]/$message[attachmentFilename]\" target=_blank><img src=\"$imagesdir/clip.gif\" align=absmiddle border=0>&nbsp;<font size=1>$message[attachmentFilename]</font></a><BR>";
		}
		// Set up the image attachment info
		$attachImage = '';
		if ($modSettings['attachmentShowImages']=='1' && $modSettings['attachmentEnable'] != '0')
		{
			$imageTypes = array('jpg','jpeg','gif','png');
			if (in_array(strtolower(substr(strrchr($message[attachmentFilename], '.'), 1)),$imageTypes))
				$attachImage = "<hr color=gray size=1><img src=\"$modSettings[attachmentUrl]/$message[attachmentFilename]\">";
		}

		list ($mid,$msub, $mname, $memail, $mdate, $muserID, $micon, $mip, $postmessage, $es, $mlm, $mlmb) = $message;
		
		$windowbg = $bgcolors[($counter % $bgcolornum)];
		$css = $cssvalues[($counter % $cssnum)];

		# Should we show "last modified by?"
		$lastmodified = '';
		if( $mlm && $showmodify && !empty($mlm) && !empty($mlmb)) {
			$messed = timeformat($mlm);
			$lastmodified = "&#171; <i>$txt[211]: $messed $txt[525] $mlmb</i> &#187;";
		}
		$msub = isset($msub)?$msub:$txt[24];
		$messdate = timeformat($mdate);
		$mip = $settings[7] == 'Administrator' ? $mip : $txt[511];
		$sendm = '';

		# If the user isn't a guest, load his/her info.
		$set = false;
		if( $muserID != -1 && !isset($yyUDLoaded[$mname])) {
			# If user is not in memory, s/he must be loaded.
			$set = LoadUserDisplay($mname);
		}

		$star = '';
		$icq = '';
		$yim = '';
		$memberinf ='';
		$postinfo = '';
		$usernamelink = '';
		if( isset($yyUDLoaded[$mname]) && $muserID != '-1') {
			$star = $memberstar[$mname];
         if($moderatorusernames[$mname] && $userprofile[$mname]['memberGroup'] != "Administrator")
         {
            $star = "<img src=\"$imagesdir/starmod.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/starmod.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/starmod.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/starmod.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/starmod.gif\" border=0 alt=\"*\">";
            $memberinf = "<B>".$txt[12]."</B><br>";
			}
         else
            $addfunction = "";
         $rlnm = $userprofile[$mname]['realName'];
			$psts = $userprofile[$mname]['posts'];
 			$memberinf = $memberinf.$memberinfo[$mname];
			$icq = $icqad[$mname];
			$yim = $yimon[$mname];
			# Allow instant message sending if current user is a member.
			if( $username != 'Guest' )
				$sendm = "$menusep<a href=\"$cgi;action=imsend;to=$mname\">$img[message_sm]</a>";
			$usernamelink = "<a href=\"$scripturl?board=$currentboard;action=viewprofile;user=$mname\"><font size=\"2\"><b><acronym title=\"$txt[92] $rlnm\">$rlnm</acronym></b></font></a>";
			$postinfo = "$txt[26]: $psts<br>";
			$memail = $userprofile[$mname]['emailAddress'];
		}
		else {
			$musername = "Guest";
			$memberinf = "$txt[28]";
			$usernamelink = "<font size=\"2\"><b>$mname</b></font>";
		}
		# Censor the subject and message.
		foreach ($censored as $tmpa => $tmpb) {
			$postmessage = str_replace($tmpa,$tmpb,$postmessage);
			$msub = str_replace($tmpa,$tmpb,$msub);
		}
		# Run UBBC interpreter on the message.
		$message = $postmessage; # put the message back into the proper variable to do ubbc on it
		if($enable_ubbc) { $message = DoUBBC($message,$es); }
		$profbutton = ($profilebutton && $muserID != '-1') ? "<a href=\"$scripturl?action=viewprofile;user=$mname\">$img[viewprofile_sm]</a>$menusep": '';
		$counterwords = "";
		if($counter != 0) { $counterwords = "$txt[146] #$counter"; }
		# Print the post and user info for the poster.
		print <<<EOT

  <tr>
    <td>
    <table cellpadding="3" cellspacing="1" border="0" width="100%">
      <tr>
        <td bgcolor="$windowbg" class="$css">
        <table width="100%" cellpadding="4" cellspacing="1" class="$css" bgcolor="$windowbg">
          <tr>
            <td class="$css" bgcolor="$windowbg" valign="top" width="15%" rowspan="2">
            $usernamelink<br><font size="1">
            $memberinf<br>
EOT;
if($muserID != "-1") {
	print "            $star<br><BR>\n            ".$userprofile[$mname]['gender'];
	print "\n            $postinfo\n           ".$userprofile[$mname]['avatar'].$userprofile[$mname]['personalText'];
	print "\n            $icq &nbsp; $yim &nbsp; ".$userprofile[$mname]['AIM']."<BR>\n";
}
if($muserID == '-1') {
	print "            <BR><a href=\"mailto:$memail\">$img[email_sm]</a>\n";
}else if ($userprofile[$mname]['hideEmail'] != "1" || $settings[7] == "Administrator" || $allow_hide_email != '1') {
	print "            $profbutton".$userprofile[$mname]['websiteUrl']." <a href=\"mailto:$memail\">$img[email_sm]</a>$sendm\n";
} else {
	print"    $profbutton{$userprofile[$mname]['websiteUrl']}$sendm \n";
}
print <<< EOT
			</font>
			</td>
            <td class="$css" bgcolor="$windowbg" valign="top" width="85%" height="100%">
            <table width="100%" border="0">
              <tr>
                <td align="left" valign="middle"><a name="$mid"><img src="$imagesdir/$micon.gif" alt=""></a></td>
                <td align="left" valign="middle">
                <font size="2"><B>$msub</b></font><BR>
                <font size="1">&#171; <B>$counterwords $txt[30]:</B> $messdate &#187;</font></td>
                <td align="right" valign="bottom" nowrap height="20">
EOT;
if (!$mstate)
{
	print <<<EOT
                <font size="-1">$menusep<a href="$cgi;action=post;threadid=$viewnum;quote=$mid;title=$txt[116];start=$start">$img[replyquote]</a>
EOT;
		if(in_array($username,$moderators) || $settings[7] == 'Administrator' || $settings[7] == 'Global Moderator'|| ($ID_MEMBER==$muserID && $ID_MEMBER != -1))
                print "$menusep<a href=\"$cgi;action=modify;msg=$mid;threadid=$viewnum;start=$start\">$img[modify]</a>$menusep<a href=\"javascript:DoConfirm('$txt[154]?','$cgi;action=modify2;threadid=$viewnum;msg=$mid;d=1;start=$start');\">$img[delete]</a>";
		print "</font>";
}
print <<<EOT
                </td>
              </tr>
            </table>
            <hr width="100%" size="1" class="windowbg3">
            $message
            </td>
          </tr><tr>
            <td class="$css" bgcolor="$windowbg" valign="bottom">
            <table width="100%" border="0">
              <tr>
                <td align="left"><font size="1">$attached$lastmodified</font></td>
                <td align="right"><font size="1">
EOT;
if ($mip==$txt[511]){
    print "<img src=\"$imagesdir/ip.gif\" alt=\"\" border=\"0\"> $mip</font></td></tr></table>";
}
else{
 print "<a href=\"http://www.nic.com/cgi-bin/whois.cgi?query=$mip\" target=\"_blank\"><img src=\"$imagesdir/ip.gif\" alt=\"\" border=\"0\"> $mip</a></font></td></tr></table>";
}
if($muserID != '-1')
	print "{$userprofile[$mname]['signature']}";
print <<<EOT
			$attachImage
			</td>
          </tr>
        </table>
        </td>
      </tr>
    </table>
    </td>
  </tr>
EOT;
		$counter++;
	}

	print <<<EOT
</table>
<table border="0" width="100%" cellspacing="0" cellpadding="0" bgcolor="$color[bordercolor]" class="bordercolor"><tr><td>
<table width="100%" border="0" cellpadding="3" cellspacing="1" bgcolor="$color[bordercolor]" class="bordercolor">
EOT;
print <<<EOT
  <tr>
    <td align="left" class="catbg" bgcolor="$color[catbg]" width="100%" height="30">
    <table cellpadding="3" cellspacing="0" width="100%">
      <tr>
        <td>
        <font size="2"><b>$txt[139]:</b> $pageindex</font>
        </td>
	<td class="catbg" bgcolor="$color[catbg]" align="right" width="350"><font size="-1">
        $reply$notify$menusep<a href="$cgi;action=sendtopic;threadid=$viewnum">$img[sendtopic]</a>$menusep<a href="$printurl?board=$currentboard;threadid=$viewnum" target="_blank">$img[printt]</a>&nbsp;
	</font></td>
      </tr>
    </table>
    </td>
  </tr>
</table>
</td></tr></table>
<table border="0" width="100%" cellpadding="0" cellspacing="0">

EOT;
  if ($modSettings['enableInlineLinks'])
    echo "<tr>\n 	<td valign=\"bottom\">$displayLinkTree<br><br></td>\n </tr>";

  print <<<EOT
  <tr>
    <td align="left" colspan="2">
    <font size="2">
EOT;
	if(in_array($username,$moderators) || $settings[7] == 'Administrator' || $settings[7] == 'Global Moderator') {
		print <<<EOT
	<a href="$cgi;action=movethread;threadid=$viewnum"><img src="$imagesdir/admin_move.gif" alt="$txt[132]" border="0"></a>
	<a href="javascript:DoConfirm('$txt[162]','$cgi;action=removethread2;threadid=$viewnum');"><img src="$imagesdir/admin_rem.gif" alt="$txt[63]" border="0"></a>
EOT;
	}
	if(in_array($username,$moderators) || $settings[7] == 'Administrator' || $settings[7] == 'Global Moderator' || ($username == "$topicinfo[posterName]" && $username != 'Guest') ) {
		print (" <a href=\"$cgi;action=lock;threadid=$viewnum;locked=$topicinfo[locked]\"><img src=\"$imagesdir/admin_lock.gif\" alt=\"$txt[104]\" border=\"0\"></a>");
	}

	if ($modSettings['enableStickyTopics'] == '1' && (in_array($username,$moderators) || $settings[7] == 'Administrator' || $settings[7] == 'Global Moderator')) {
		print (" <a href=\"$cgi;action=sticky;threadid=$viewnum;sticky=$topicinfo[isSticky]\"><img src=\"$imagesdir/admin_sticky.gif\" border=\"0\"></a>");
		}
	print <<<EOT
    </font></td>
    <td align="right"><form action="$scripturl" method="GET">
    <font size="1">$txt[160]:</font>$selecthtml</form></td>
  </tr>
</table>
EOT;
	footer();
	obExit();
}
?>
file|^|Sources/gpl.txt|^|18009|^|1008718674
		    GNU GENERAL PUBLIC LICENSE
		       Version 2, June 1991

 Copyright (C) 1989, 1991 Free Software Foundation, Inc.
                       59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 Everyone is permitted to copy and distribute verbatim copies
 of this license document, but changing it is not allowed.

			    Preamble

  The licenses for most software are designed to take away your
freedom to share and change it.  By contrast, the GNU General Public
License is intended to guarantee your freedom to share and change free
software--to make sure the software is free for all its users.  This
General Public License applies to most of the Free Software
Foundation's software and to any other program whose authors commit to
using it.  (Some other Free Software Foundation software is covered by
the GNU Library General Public License instead.)  You can apply it to
your programs, too.

  When we speak of free software, we are referring to freedom, not
price.  Our General Public Licenses are designed to make sure that you
have the freedom to distribute copies of free software (and charge for
this service if you wish), that you receive source code or can get it
if you want it, that you can change the software or use pieces of it
in new free programs; and that you know you can do these things.

  To protect your rights, we need to make restrictions that forbid
anyone to deny you these rights or to ask you to surrender the rights.
These restrictions translate to certain responsibilities for you if you
distribute copies of the software, or if you modify it.

  For example, if you distribute copies of such a program, whether
gratis or for a fee, you must give the recipients all the rights that
you have.  You must make sure that they, too, receive or can get the
source code.  And you must show them these terms so they know their
rights.

  We protect your rights with two steps: (1) copyright the software, and
(2) offer you this license which gives you legal permission to copy,
distribute and/or modify the software.

  Also, for each author's protection and ours, we want to make certain
that everyone understands that there is no warranty for this free
software.  If the software is modified by someone else and passed on, we
want its recipients to know that what they have is not the original, so
that any problems introduced by others will not reflect on the original
authors' reputations.

  Finally, any free program is threatened constantly by software
patents.  We wish to avoid the danger that redistributors of a free
program will individually obtain patent licenses, in effect making the
program proprietary.  To prevent this, we have made it clear that any
patent must be licensed for everyone's free use or not licensed at all.

  The precise terms and conditions for copying, distribution and
modification follow.

		    GNU GENERAL PUBLIC LICENSE
   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION

  0. This License applies to any program or other work which contains
a notice placed by the copyright holder saying it may be distributed
under the terms of this General Public License.  The "Program", below,
refers to any such program or work, and a "work based on the Program"
means either the Program or any derivative work under copyright law:
that is to say, a work containing the Program or a portion of it,
either verbatim or with modifications and/or translated into another
language.  (Hereinafter, translation is included without limitation in
the term "modification".)  Each licensee is addressed as "you".

Activities other than copying, distribution and modification are not
covered by this License; they are outside its scope.  The act of
running the Program is not restricted, and the output from the Program
is covered only if its contents constitute a work based on the
Program (independent of having been made by running the Program).
Whether that is true depends on what the Program does.

  1. You may copy and distribute verbatim copies of the Program's
source code as you receive it, in any medium, provided that you
conspicuously and appropriately publish on each copy an appropriate
copyright notice and disclaimer of warranty; keep intact all the
notices that refer to this License and to the absence of any warranty;
and give any other recipients of the Program a copy of this License
along with the Program.

You may charge a fee for the physical act of transferring a copy, and
you may at your option offer warranty protection in exchange for a fee.

  2. You may modify your copy or copies of the Program or any portion
of it, thus forming a work based on the Program, and copy and
distribute such modifications or work under the terms of Section 1
above, provided that you also meet all of these conditions:

    a) You must cause the modified files to carry prominent notices
    stating that you changed the files and the date of any change.

    b) You must cause any work that you distribute or publish, that in
    whole or in part contains or is derived from the Program or any
    part thereof, to be licensed as a whole at no charge to all third
    parties under the terms of this License.

    c) If the modified program normally reads commands interactively
    when run, you must cause it, when started running for such
    interactive use in the most ordinary way, to print or display an
    announcement including an appropriate copyright notice and a
    notice that there is no warranty (or else, saying that you provide
    a warranty) and that users may redistribute the program under
    these conditions, and telling the user how to view a copy of this
    License.  (Exception: if the Program itself is interactive but
    does not normally print such an announcement, your work based on
    the Program is not required to print an announcement.)

These requirements apply to the modified work as a whole.  If
identifiable sections of that work are not derived from the Program,
and can be reasonably considered independent and separate works in
themselves, then this License, and its terms, do not apply to those
sections when you distribute them as separate works.  But when you
distribute the same sections as part of a whole which is a work based
on the Program, the distribution of the whole must be on the terms of
this License, whose permissions for other licensees extend to the
entire whole, and thus to each and every part regardless of who wrote it.

Thus, it is not the intent of this section to claim rights or contest
your rights to work written entirely by you; rather, the intent is to
exercise the right to control the distribution of derivative or
collective works based on the Program.

In addition, mere aggregation of another work not based on the Program
with the Program (or with a work based on the Program) on a volume of
a storage or distribution medium does not bring the other work under
the scope of this License.

  3. You may copy and distribute the Program (or a work based on it,
under Section 2) in object code or executable form under the terms of
Sections 1 and 2 above provided that you also do one of the following:

    a) Accompany it with the complete corresponding machine-readable
    source code, which must be distributed under the terms of Sections
    1 and 2 above on a medium customarily used for software interchange; or,

    b) Accompany it with a written offer, valid for at least three
    years, to give any third party, for a charge no more than your
    cost of physically performing source distribution, a complete
    machine-readable copy of the corresponding source code, to be
    distributed under the terms of Sections 1 and 2 above on a medium
    customarily used for software interchange; or,

    c) Accompany it with the information you received as to the offer
    to distribute corresponding source code.  (This alternative is
    allowed only for noncommercial distribution and only if you
    received the program in object code or executable form with such
    an offer, in accord with Subsection b above.)

The source code for a work means the preferred form of the work for
making modifications to it.  For an executable work, complete source
code means all the source code for all modules it contains, plus any
associated interface definition files, plus the scripts used to
control compilation and installation of the executable.  However, as a
special exception, the source code distributed need not include
anything that is normally distributed (in either source or binary
form) with the major components (compiler, kernel, and so on) of the
operating system on which the executable runs, unless that component
itself accompanies the executable.

If distribution of executable or object code is made by offering
access to copy from a designated place, then offering equivalent
access to copy the source code from the same place counts as
distribution of the source code, even though third parties are not
compelled to copy the source along with the object code.

  4. You may not copy, modify, sublicense, or distribute the Program
except as expressly provided under this License.  Any attempt
otherwise to copy, modify, sublicense or distribute the Program is
void, and will automatically terminate your rights under this License.
However, parties who have received copies, or rights, from you under
this License will not have their licenses terminated so long as such
parties remain in full compliance.

  5. You are not required to accept this License, since you have not
signed it.  However, nothing else grants you permission to modify or
distribute the Program or its derivative works.  These actions are
prohibited by law if you do not accept this License.  Therefore, by
modifying or distributing the Program (or any work based on the
Program), you indicate your acceptance of this License to do so, and
all its terms and conditions for copying, distributing or modifying
the Program or works based on it.

  6. Each time you redistribute the Program (or any work based on the
Program), the recipient automatically receives a license from the
original licensor to copy, distribute or modify the Program subject to
these terms and conditions.  You may not impose any further
restrictions on the recipients' exercise of the rights granted herein.
You are not responsible for enforcing compliance by third parties to
this License.

  7. If, as a consequence of a court judgment or allegation of patent
infringement or for any other reason (not limited to patent issues),
conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License.  If you cannot
distribute so as to satisfy simultaneously your obligations under this
License and any other pertinent obligations, then as a consequence you
may not distribute the Program at all.  For example, if a patent
license would not permit royalty-free redistribution of the Program by
all those who receive copies directly or indirectly through you, then
the only way you could satisfy both it and this License would be to
refrain entirely from distribution of the Program.

If any portion of this section is held invalid or unenforceable under
any particular circumstance, the balance of the section is intended to
apply and the section as a whole is intended to apply in other
circumstances.

It is not the purpose of this section to induce you to infringe any
patents or other property right claims or to contest validity of any
such claims; this section has the sole purpose of protecting the
integrity of the free software distribution system, which is
implemented by public license practices.  Many people have made
generous contributions to the wide range of software distributed
through that system in reliance on consistent application of that
system; it is up to the author/donor to decide if he or she is willing
to distribute software through any other system and a licensee cannot
impose that choice.

This section is intended to make thoroughly clear what is believed to
be a consequence of the rest of this License.

  8. If the distribution and/or use of the Program is restricted in
certain countries either by patents or by copyrighted interfaces, the
original copyright holder who places the Program under this License
may add an explicit geographical distribution limitation excluding
those countries, so that distribution is permitted only in or among
countries not thus excluded.  In such case, this License incorporates
the limitation as if written in the body of this License.

  9. The Free Software Foundation may publish revised and/or new versions
of the General Public License from time to time.  Such new versions will
be similar in spirit to the present version, but may differ in detail to
address new problems or concerns.

Each version is given a distinguishing version number.  If the Program
specifies a version number of this License which applies to it and "any
later version", you have the option of following the terms and conditions
either of that version or of any later version published by the Free
Software Foundation.  If the Program does not specify a version number of
this License, you may choose any version ever published by the Free Software
Foundation.

  10. If you wish to incorporate parts of the Program into other free
programs whose distribution conditions are different, write to the author
to ask for permission.  For software which is copyrighted by the Free
Software Foundation, write to the Free Software Foundation; we sometimes
make exceptions for this.  Our decision will be guided by the two goals
of preserving the free status of all derivatives of our free software and
of promoting the sharing and reuse of software generally.

			    NO WARRANTY

  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY
FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN
OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES
PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED
OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS
TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE
PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,
REPAIR OR CORRECTION.

  12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR
REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,
INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING
OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED
TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY
YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER
PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.

		     END OF TERMS AND CONDITIONS

	    How to Apply These Terms to Your New Programs

  If you develop a new program, and you want it to be of the greatest
possible use to the public, the best way to achieve this is to make it
free software which everyone can redistribute and change under these terms.

  To do so, attach the following notices to the program.  It is safest
to attach them to the start of each source file to most effectively
convey the exclusion of warranty; and each file should have at least
the "copyright" line and a pointer to where the full notice is found.

    <one line to give the program's name and a brief idea of what it does.>
    Copyright (C) <year>  <name of author>

    This program is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; either version 2 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program; if not, write to the Free Software
    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA


Also add information on how to contact you by electronic and paper mail.

If the program is interactive, make it output a short notice like this
when it starts in an interactive mode:

    Gnomovision version 69, Copyright (C) year name of author
    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
    This is free software, and you are welcome to redistribute it
    under certain conditions; type `show c' for details.

The hypothetical commands `show w' and `show c' should show the appropriate
parts of the General Public License.  Of course, the commands you use may
be called something other than `show w' and `show c'; they could even be
mouse-clicks or menu items--whatever suits your program.

You should also get your employer (if you work as a programmer) or your
school, if any, to sign a "copyright disclaimer" for the program, if
necessary.  Here is a sample; alter the names:

  Yoyodyne, Inc., hereby disclaims all copyright interest in the program
  `Gnomovision' (which makes passes at compilers) written by James Hacker.

  <signature of Ty Coon>, 1 April 1989
  Ty Coon, President of Vice

This General Public License does not permit incorporating your program into
proprietary programs.  If your program is a subroutine library, you may
consider it more useful to permit linking proprietary applications with the
library.  If this is what you want to do, use the GNU Library General
Public License instead of this License.
file|^|Sources/ICQPager.php|^|5175|^|1008718675
<?php
/*****************************************************************************/
/* ICQPager.php                                                              */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$icqpagerplver="YaBB SE";

function IcqPager()
{
	global $UIN,$yytitle,$color,$txt,$mbname,$cgi,$realname,$realemail;
	$uin = $UIN;

	$name = isset($realname)?"<input type=hidden name=\"from\" value=\"$realname\">$realname":"<input type=text name=\"from\" size=20 maxlength=40>";
	$email = isset($realemail)?"<input type=hidden name=\"fromemail\" value=\"$realemail\">$realemail":"<input type=text name=\"fromemail\" size=20 maxlength=40>";

	$yytitle = "$txt[513] $txt[514]";
	template_header();

print <<<EOT
<form action="$cgi&action=sendICQpage" method="post">
<table border=0  width="600" align="center" cellspacing=1 cellpadding="0" bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
    <td width="100%" bgcolor="$color[windowbg]" class="windowbg">
    <table width="100%" border="0" cellspacing="0" cellpadding="3">
      <tr>
        <td class="titlebg" bgcolor="$color[titlebg]" colspan="2">
        <font size=2 class="text1" color="$color[titletext]"><b>$yytitle</b></font></td>
      </tr><tr>
        <td bgcolor="$color[windowbg]" class="windowbg" align=right valign=top>
        <font size=2><B>$txt[324]:</B></font>
        </td>
        <td bgcolor="$color[windowbg]" class="windowbg" align=left valign=middle>
        <font size="2">$uin</font> <img src="http://wwp.icq.com/scripts/online.dll?icq=$uin&img=5" alt="$uin" border="0">
        </td>
      </tr><tr>
        <td bgcolor="$color[windowbg]" class="windowbg" align=right valign=top>
        <font size=2><B>$txt[335]:</B></font>
        </td>
        <td bgcolor="$color[windowbg]" class="windowbg" align=left valign=middle>
        $name
        </td>
      </tr><tr>
        <td bgcolor="$color[windowbg]" class="windowbg" align="right" valign="top">
        <font size=2><B>$txt[336]:</B></font>
        </td>
        <td bgcolor="$color[windowbg]" class="windowbg" align="left" valign="middle">
        $email
        </td>
      </tr><tr>
        <td bgcolor="$color[windowbg]" class="windowbg" align=right valign=top>
        <font size=2><B>$txt[72]:</B></font>
        </td>
        <td bgcolor="$color[windowbg]" class="windowbg" align=left valign=middle>
        <textarea name="body" rows="8" cols="45" wrap="Virtual"></textarea>
        </td>
      </tr><tr>
        <td bgcolor="$color[windowbg]" class="windowbg" align=center valign=middle colspan=2>
        <input type="hidden" name="subject" value="$mbname">
	<input type="hidden" name="to" value="$UIN">
        <input type="submit" name="Send" value="$txt[339]">
        </td>
      </tr>
    </table>
    </td>
  </tr>
</table>
</form>
EOT;

	footer();
	obExit();
}

function send_icqpage ()
{
	global $from,$fromemail,$to,$body,$username,$yytitle,$txt;
	//mail("$to@pager.icq.com",'',"$body");
    $to=$to."@pager.icq.com";
    $from=$fromemail;
	$status= sendmail ($to,"ICQ Page from SE",$body,$from);

	$yytitle = "$txt[513] $txt[514]";
	template_header();
    print "Sent to ".$to." from ".$from." and a status of ".$status."<BR>";
	print "<br><a href=\"javascript:window.close();\">$txt[51]</a><br>";
	footer();
	obExit();
}
?>
file|^|Sources/InstantMessage.php|^|34508|^|1008861058
<?php
/*****************************************************************************/
/* InstantMessage.php                                                        */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$instantmessageplver="YaBB SE";

function IMIndex (){
	global $username,$txt,$img,$yytitle,$imagesdir,$cgi,$action,$mbname,$censored,$scripturl;
	global $menusep,$color,$ID_MEMBER,$yyUDLoaded,$userprofile,$memberstar,$memberinfo,$icqad;
	global $yimon,$currentboard,$profilebutton,$enable_ubbc,$settings,$allow_hide_email,$db_prefix;
	global $modSettings;
	if( $username == 'Guest' ) { fatal_error($txt[147]); }
	$imbox = $txt[316];
	$txt[412] = str_replace("IMBOX",$imbox,$txt[412]);
	$img['im_delete'] = str_replace("IMBOX",$imbox,$img['im_delete']);

	// # Load censor list.
	LoadCensorList();

	// # Fix moderator showing in info
	$sender = "im";

	$yytitle = $txt[143];
	# Build the link tree
	$displayLinkTree = $modSettings['enableInlineLinks'] ? "<font size=\"1\" class=\"nav\"><B><a href=\"$scripturl\" class=\"nav\">$mbname</a> </b>&nbsp;|&nbsp;<b> " : "<font size=\"2\" class=\"nav\"><B><img src=\"$imagesdir/open.gif\" border=\"0\" alt=\"\">&nbsp;&nbsp;<a href=\"$scripturl\" class=\"nav\">$mbname</a><br>" ;
	$displayLinkTree .= $modSettings['enableInlineLinks'] ? "<a href=\"$cgi&action=im\" class=\"nav\">$txt[144]</a> </b>&nbsp;|&nbsp;<b> " : "<img src=\"$imagesdir/tline.gif\" border=\"0\" alt=\"\"><IMG SRC=\"$imagesdir/open.gif\" border=\"0\" alt=\"\">&nbsp;&nbsp;<a href=\"$cgi&action=im\" class=\"nav\">$txt[144]</a><br>" ;
	$displayLinkTree .= $modSettings['enableInlineLinks'] ? "$txt[316]</b></font>" : "<img SRC=\"$imagesdir/tline2.gif\" border=\"0\" alt=\"\"><IMG SRC=\"$imagesdir/open.gif\" border=\"0\" alt=\"\">&nbsp;&nbsp;$txt[316]</b></font>" ;

	template_header();

	print <<<EOT
<script language="JavaScript1.2" type="text/javascript"><!--
	function DoConfirm(message, url) {
		if(confirm(message)) location.href = url;
	}
//--></script>
<table border=0 width=100% cellspacing=0 cellpadding="0">
  <tr>
	<td valign=bottom>$displayLinkTree</td>
  </tr>
</table>
<table cellpadding="0" cellspacing="0" border="0" width="100%" bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td>
<table border=0 width="100%" cellspacing=1 bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
    <td align=right valign=bottom class="catbg" bgcolor="$color[catbg]" colspan=4><font size=-1>
EOT;

	/* Load Messages */
	$request = mysql_query("SELECT * FROM {$db_prefix}instant_messages WHERE (ID_MEMBER_TO='$ID_MEMBER' AND (deletedBy!=1)) ORDER BY msgtime");
	if( mysql_num_rows($request) > 0 )
		print "    <a href=\"$cgi&action=imremoveall&caller=1\">$img[im_delete]</a>$menusep";

	print <<<EOT
    <a href="$cgi&action=imoutbox">$img[im_outbox]</a>$menusep<a href="$cgi&action=imsend">$img[im_new]</a>$menusep<a href="$cgi&action=im">$img[im_reload]</a>$menusep<a href="$cgi&action=imprefs">$img[im_config]</a>
    </font></td>
  </tr>
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]" width="300"><font size=2 class="text1" color="$color[titletext]">&nbsp;<b>$txt[317]</b></font></td>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$txt[318]</b></font></td>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$txt[319]</b></font></td>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]">&nbsp;</font></td>
  </tr>
EOT;
	if ( mysql_num_rows($request)  == 0 ) {
		print <<<EOT
  <tr>
    <td class="windowbg" colspan=4 bgcolor="$color[windowbg]"><font size=2>$txt[151]</font></td>
  </tr>
EOT;
	}
	$bgcolors = array( $color['windowbg'], $color['windowbg2'] );
	$bgstyles = array ("windowbg", "windowbg2");
	$bgcolornum = sizeof($bgcolors);
	$bgstylenum = sizeof($bgstyles);

	$counter = 0;
	while ($row = mysql_fetch_array($request))
	{
		$counter++;
		$musername = $row['fromName'];
		$msub = $row['subject'];
		$mdate = $row['msgtime'];
		$immessage = $row['body'];
		$messageid = $row['ID_IM'];
		$windowbg = $bgcolors[($counter % $bgcolornum)];
		$windowcss = $bgstyles[($counter % $bgstylenum)];
		if( $msub == '' ) { $msub = $txt[24]; }
		foreach ($censored as $tmpa => $tmpb)
			$msub = str_replace ($tmpa,$tmpb,$msub);
		$mydate = timeformat($mdate);
		print<<<EOT
  <tr>
    <td class="$windowcss" bgcolor="$windowbg" width=300><font size=2>$mydate</font></td>
    <td class="$windowcss" bgcolor="$windowbg"><font size=2>$musername</font></td>
    <td class="$windowcss" bgcolor="$windowbg"><font size=2><a href="#$messageid">$msub</a></font></td>
    <td class="$windowcss" bgcolor="$windowbg"><font size=2><a href="javascript:DoConfirm('$txt[154]?','$cgi&action=imremove&caller=1&id=$messageid');">$img[im_remove]</a></font> </td>
  </tr>
EOT;
	}
print <<<EOT
</table>
</td></tr></table>
<br>
EOT;
	if( mysql_num_rows($request) > 0 ) {
		print<<<EOT
<table border=0 width="100%" cellspacing=1 cellpadding="4" bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
     <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]">&nbsp;<b>$txt[29]</b></font></td>
     <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$txt[118]</b></font></td>
  </tr>
EOT;
	

	$request = mysql_query("SELECT * FROM {$db_prefix}instant_messages WHERE (ID_MEMBER_TO=$ID_MEMBER && deletedBy != 1) ORDER BY msgtime");
	$counter = 0;
	while ($row = mysql_fetch_array($request)) {
		$counter++;
		$windowbg = $bgcolors[($counter % $bgcolornum)];
		$windowcss = $bgstyles[($counter % $bgstylenum)];
		$musername = $row['fromName'];
		$msub = $row['subject'];
		$mdate = $row['msgtime'];
		$immessage = $row['body'];
		$messageid = $row['ID_IM'];
		if( $msub == '' ) { $msub = $txt[24]; }
		$mydate = timeformat($mdate);
		$result = mysql_query("SELECT ID_MEMBER FROM {$db_prefix}members WHERE memberName='$musername'");
		# If user is not in memory, s/he must be loaded.
		if( $musername != 'Guest' && ! isset($yyUDLoaded[$musername]) )
			LoadUserDisplay($musername);

		if( $yyUDLoaded[$musername] ) {
			$deleted = 0;
			$star = $memberstar[$musername];
			$memberinf = $memberinfo[$musername];
			$icq = $icqad[$musername];
			$yim = $yimon[$musername];
			$usernamelink = "<a href=\"$scripturl?board=$currentboard&action=viewprofile&user=$musername\"><font size=2><b>{$userprofile[$musername]['realName']}</b></font></a>";
			$profbutton = ($profilebutton != '' && $musername != 'Guest') ? "$menusep<a href=\"$scripturl?action=viewprofile&user=$musername\">$img[viewprofile]</a>" : '';
			$postinfo = "$txt[26]: {$userprofile[$musername]['posts']}<br>";
			$memail = $userprofile[$musername]['emailAddress'];
		}
		else // user has been deleted
		{
			$deleted = 1;
			$star = '';
			$memberinf = '';
			$icq = '';
			$yim = '';
			$usernamelink = "$musername";
			$postinfo = '';
			$memail = '';
			$profbutton = '';
		}
		foreach ($censored as $tmpa => $tmpb) {
			$immessage = str_replace($tmpa,$tmpb,$immessage);
			$msub = str_replace($tmpa,$tmpb,$msub);
		}
		$message = $immessage; # put the message back in the proper variable for doing ubbc
		if($enable_ubbc) { $message = DoUBBC($message); }
		print <<<EOT
  <tr>
    <td class="$windowcss" bgcolor="$windowbg" width="160" valign="top" height="100%">
    $usernamelink<br>
    <font size=1>$memberinf<br>
    $star<br><br>
    $postinfo
	{$userprofile[$musername]['gender']}
    <center>{$userprofile[$musername]['avatar']} {$userprofile[$musername]['personalText']} {$userprofile[$musername]['ICQ']} $icq &nbsp; {$userprofile[$musername]['YIM']} $yim &nbsp; {$userprofile[$musername]['AIM']}
    </center></font></td>
    <td class="$windowcss" bgcolor="$windowbg" valign=top>
    <table border="0" cellspacing="0" cellpadding="3" width="100%" height="100%" align="center" bgcolor="$color[bordercolor]" class="bordercolor">
      <tr class="$windowcss" bgcolor="$windowbg" height="10" width="100%">
        <td class="$windowcss" bgcolor="$windowbg"><a name="$messageid"><font size=1>&nbsp;<b>$msub</b></font></td>
        <td class="$windowcss" bgcolor="$windowbg" align="right"><font size=1><b>$txt[30]:</b> $mydate</font></td>
      </tr><tr height="*">
        <td colspan="2" class="$windowcss" bgcolor="$windowbg" height="100%">
        <hr width="100%" size="1" color="$color[windowbg3]">
        <font size=2>$message</font>
        </td>
      </tr><TR height="10">
        <td colspan="2" class="$windowcss" bgcolor="$windowbg" height="10">
        <font size=2>{$userprofile[$musername]['signature']}</font>
        <hr width="100%" size="1" color="$color[windowbg3]">
        </td>
      </tr><tr height="10" width="100%">
	<td class="$windowcss" bgcolor="$windowbg" height="10">
        <font size=2>
EOT;
if ($userprofile[$musername]['hideEmail'] != '1' || $settings[7] == "Administrator" || $allow_hide_email != 1)
	print ("	{$userprofile[$musername]['websiteUrl_IM']}<a href=\"mailto:$memail\">$img[email]</a>$profbutton\n");
else
	print ("	{$userprofile[$musername]['websiteUrl_IM']}$profbutton\n");

print <<<EOT
        </font></td>
        <td class="$windowcss" bgcolor="$windowbg" height="10" align="right"><font size=2>
EOT;
if (!$deleted) {
	print <<<EOT
	<a href="$cgi&action=imsend&caller=1&imsg=$messageid&quote=1&to=$musername">$img[replyquote]</a>$menusep<a href="$cgi&action=imsend&caller=1&imsg=$messageid&reply=1&to=$musername">$img[im_reply]</a>$menusep
EOT;
}
print <<<EOT
	<a href="javascript:DoConfirm('$txt[154]?','$cgi&action=imremove&caller=1&id=$messageid');">$img[im_remove]</a>
        </font></td>
      </tr>
    </table>
    </td>
  </tr>
EOT;
	}
	print <<<EOT
</table>
EOT;
}
	footer();
	obExit();
}

function IMOutbox (){
	global $username,$txt,$img,$yytitle,$imagesdir,$cgi,$action,$mbname,$censored,$scripturl;
	global $menusep,$color,$ID_MEMBER,$yyUDLoaded,$userprofile,$memberstar,$memberinfo,$icqad;
	global $yimon,$currentboard,$profilebutton,$enable_ubbc,$settings,$allow_hide_email,$db_prefix;
	global $modSettings;
	if ($username == 'Guest') { fatal_error($txt[147]); }
	$imbox = $txt[320];
	$txt[412] = str_replace("IMBOX",$imbox,$txt[412]);
	$img['im_delete'] = str_replace("IMBOX",$imbox,$img['im_delete']);

	# Fix moderator showing in info
	$sender = "im";

	# Load censor list.
	LoadCensorList();

	$yytitle = $txt[143];
	template_header();

	# Build the link tree
	$displayLinkTree = $modSettings['enableInlineLinks'] ? "<font size=\"1\" class=\"nav\"><B><a href=\"$scripturl\" class=\"nav\">$mbname</a> </b>&nbsp;|&nbsp;<b> " : "<font size=\"2\" class=\"nav\"><B><img src=\"$imagesdir/open.gif\" border=\"0\" alt=\"\">&nbsp;&nbsp;<a href=\"$scripturl\" class=\"nav\">$mbname</a><br>" ;
	$displayLinkTree .= $modSettings['enableInlineLinks'] ? "<a href=\"$cgi&action=im\" class=\"nav\">$txt[144]</a> </b>&nbsp;|&nbsp;<b> " : "<img src=\"$imagesdir/tline.gif\" border=\"0\" alt=\"\"><IMG SRC=\"$imagesdir/open.gif\" border=\"0\" alt=\"\">&nbsp;&nbsp;<a href=\"$cgi&action=im\" class=\"nav\">$txt[144]</a><br>" ;
	$displayLinkTree .= $modSettings['enableInlineLinks'] ? "$txt[320]</b></font>" : "<img SRC=\"$imagesdir/tline2.gif\" border=\"0\" alt=\"\"><IMG SRC=\"$imagesdir/open.gif\" border=\"0\" alt=\"\">&nbsp;&nbsp;$txt[320]</b></font>" ;
	print <<<EOT
<script language="JavaScript1.2" type="text/javascript"><!--
	function DoConfirm(message, url) {
		if(confirm(message)) location.href = url;
	}
//--></script>
<table border=0 width=100% cellspacing=0>
  <tr>
    <td valign=bottom>$displayLinkTree</td>
  </tr><tr>
</table>
<table cellpadding="0" cellspacing="0" border="0" width="100%" bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td>
<table border=0 width="100%" cellspacing=1 bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
    <td align=right valign=bottom class="catbg" bgcolor="$color[catbg]" colspan=4><font size=-1>
EOT;
	# Read all messages
	$request = mysql_query("SELECT * FROM {$db_prefix}instant_messages WHERE (ID_MEMBER_FROM=$ID_MEMBER && deletedBy != 0) ORDER BY msgtime");

	if( mysql_num_rows($request) > 0 )
		print "    <a href=\"$cgi&action=imremoveall&caller=2\">$img[im_delete]</a>$menusep";
	print <<<EOT
    <a href="$cgi&action=im">$img[im_inbox]</a>$menusep<a href="$cgi&action=imsend">$img[im_new]</a>$menusep<a href="$cgi&action=im">$img[im_reload]</a>$menusep<a href="$cgi&action=imprefs">$img[im_config]</a>
    </font></td>
  </tr>
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]" width="300"><font size=2 class="text1" color="$color[titletext]">&nbsp;<b>$txt[317]</b></font></td>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$txt[324]</b></font></td>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$txt[319]</b></font></td>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]">&nbsp;</font></td>
  </tr>
EOT;
	# Display Message if there are no Messages in Users Outbox
	if ( mysql_num_rows($request) == 0) {
		print <<<EOT
  <tr>
    <td class="windowbg" colspan=4 bgcolor="$color[windowbg]"><font size=2>$txt[151]</font></td>
  </tr>
EOT;
	}

	$bgcolors = array( $color['windowbg'], $color['windowbg2'] );
	$bgstyles = array("windowbg","windowbg2");
	$bgcolornum = sizeof($bgcolors);
	$bgstylenum = sizeof($bgstyles);

	$counter = 0;
	while ($row = mysql_fetch_array($request)) {
		$counter++;
		$windowbg = $bgcolors[($counter % $bgcolornum)];
		$windowcss = $bgstyles[($counter % $bgstylenum)];
		$musername = $row['toName'];
		$msub = $row['subject'];
		$mdate = $row['msgtime'];
		$immessage = $row['body'];
		$messageid = $row['ID_IM'];
		if( $msub == '' ) { $msub = $txt[24]; }
		foreach ($censored as $tmpa=>$tmpb)
			$msub = str_replace($tmpa,$tmpb,$msub);
		$mydate = timeformat($mdate);
		print<<<EOT
  <tr>
    <td class="$windowcss" bgcolor="$windowbg" width=300><font size=2>$mydate</font></td>
    <td class="$windowcss" bgcolor="$windowbg"><font size=2>$musername</font></td>
    <td class="$windowcss" bgcolor="$windowbg"><font size=2><a href="#$messageid">$msub</a></font></td>
    <td class="$windowcss" bgcolor="$windowbg"><font size=2><a href="javascript:DoConfirm('$txt[154]?','$cgi&action=imremove&caller=2&id=$messageid');">$img[im_remove]</a></font></td>
  </tr>
EOT;
	}
print <<<EOT
</table>
</td></tr></table>	
<br>
EOT;
	if(mysql_num_rows($request) > 0) { 
		print <<<EOT
<table border=0 width=100% cellspacing=1 cellpadding="4" bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]">&nbsp;<b>$txt[535]</b></font></td>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$txt[118]</b></font></td>
  </tr>
EOT;
	
	$request = mysql_query("SELECT * FROM {$db_prefix}instant_messages WHERE (fromName='$username' && deletedBy != 0) ORDER BY msgtime");
	$counter = 0;
	while ($row = mysql_fetch_array($request)) {
		$counter++;
		$windowbg = $bgcolors[($counter % $bgcolornum)];
		$windowcss = $bgstyles[($counter % $bgstylenum)];
		$musername = $row['toName'];
		$msub = $row['subject'];
		$mdate = $row['msgtime'];
		$immessage = $row['body'];
		$messageid = $row['ID_IM'];

		if( $msub == '' ) { $msub = $txt[24]; }
		$mydate = timeformat($mdate);
		$result = mysql_query("SELECT ID_MEMBER FROM {$db_prefix}members WHERE memberName='$musername'");
		# If user is not in memory, s/he must be loaded.
		if( $musername != 'Guest' && ! isset($yyUDLoaded[$musername]) && mysql_num_rows($result)>0 )
			LoadUserDisplay($musername);
		if( $yyUDLoaded[$musername] ) {
			$star = $memberstar[$musername];
			$memberinf = $memberinfo[$musername];
			$icq = $icqad[$musername];
			$yim = $yimon[$musername];
			$usernamelink = "<a href=\"$scripturl?board=$currentboard&action=viewprofile&user=$musername\"><font size=2><B>{$userprofile[$musername]['realName']}</b></font></a>";
			$profbutton = ($profilebutton != '' && $musername != 'Guest') ? "$menusep<a href=\"$scripturl?action=viewprofile&user=$musername\">$img[viewprofile]</a>" : '';
			$postinfo = "$txt[26]: {$userprofile[$musername]['posts']}<br>";
			$memail = $userprofile[$musername]['emailAddress'];
		}
		$message = $immessage; # put the message back in the proper variable for doing ubbc
		foreach ($censored as $tmpa => $tmpb) {
			$immessage = str_replace($tmpa,$tmpb,$immessage);
			$msub = str_replace($tmpa,$tmpb,$msub);
		}
		$message = $immessage; # put the message back in the proper variable for doing ubbc
		if($enable_ubbc) { $message = DoUBBC($message); }
		print <<<EOT
  <tr>
    <td class="$windowcss" bgcolor="$windowbg" width="160" valign="top" height="100%">
    $usernamelink<br>
    <font size=1>$memberinf<br>
    $star<br><br>
    $postinfo
	{$userprofile[$musername]['gender']}
    <center>{$userprofile[$musername]['avatar']}{$userprofile[$musername]['personalText']}
	{$userprofile[$musername]['ICQ']} $icq &nbsp; {$userprofile[$musername]['YIM']} $yim &nbsp; {$userprofile[$musername]['AIM']}
    </center></font></td>
    <td class="$windowcss" bgcolor="$windowbg" valign=top>
    <table border="0" cellspacing="0" cellpadding="3" width="100%" height="100%" align="center" bgcolor="$color[bordercolor]" class="bordercolor">
      <tr class="$windowcss" bgcolor="$windowbg" height="10" width="100%">
        <td class="$windowcss" bgcolor="$windowbg"><font size="1"><a name="$messageid">&nbsp;<b>$msub</b></font></td>
        <td class="$windowcss" bgcolor="$windowbg" align="right"><font size=1><b>$txt[30]:</b> $mydate</font></td>
      </tr><tr height="100%">
        <td colspan="2" class="$windowcss" bgcolor="$windowbg" height="100%">
        <hr width="100%" size="1" color="$color[windowbg3]">
        <font size=2>$message</font>
        </td>
      </tr><TR height="10">
        <td colspan="2" class="$windowcss" bgcolor="$windowbg" height="10">
        <font size=2>{$userprofile[$musername]['signature']}</font>
        <hr width="100%" size="1" color="$color[windowbg3]">
        </td>
      </tr><tr height="10" width="100%">
	<td class="$windowcss" bgcolor="$windowbg" height="10">
        <font size=2>
EOT;
if ($userprofile[$musername]['hideEmail'] != "1" || $settings[7] == "Administrator" || $allow_hide_email != 1)
	print "{$userprofile[$musername]['websiteUrl_IM']}<a href=\"mailto:$memail\">$img[email]</a>$profbutton\n";
else
	print "{$userprofile[$musername]['websiteUrl_IM']}$profbutton\n";
print <<<EOT
        </font></td>
        <td class="$windowcss" bgcolor="$windowbg" align="right" height="10"><font size=2>
        <a href="$cgi&action=imsend&caller=2&imsg=$messageid&quote=1&to=$musername">$img[replyquote]</a>$menusep<a href="$cgi&action=imsend&caller=2&imsg=$messageid&reply=1&to=$musername">$img[im_reply]</a>$menusep<a href="javascript:DoConfirm('$txt[154]?','$cgi&action=imremove&caller=2&id=$messageid');">$img[im_remove]</a>        </font></td>
      </tr>
    </table>
    </td>
  </tr>
EOT;
	}
	print "</table>\n";
	}
	footer();
	obExit();
}


function IMPost(){
	global $username,$txt,$yytitle,$cgi,$img,$imagesdir,$color,$ubbcjspath,$mbname,$menusep,$imsg;
	global $showyabbcbutt,$enable_ubbc,$form_subject,$scripturl,$to,$form_message,$reply,$quote;
	global $sourcedir,$db_prefix,$modSettings;
	if($username == 'Guest') { fatal_error($txt[147]); }
	$yytitle=$txt[148];
	template_header();
	if(isset($imsg)) {
		$request = mysql_query ("SELECT * FROM {$db_prefix}instant_messages WHERE ID_IM=$imsg");
		$row  = mysql_fetch_array($request);
		$mfrom = $row['fromName'];
		$msubject = $row['subject'];
		$mdate = $row['msgtime'];
		$mmessage = $row['body'];
		$messageid = $row['ID_IM'];

		$form_subject = $msubject;
		if (!stristr(substr($form_subject,0,3),"re:") && ($reply=='1' || $quote=='1'))
			$form_subject = "Re:$form_subject";

		if($quote=='1') {
			$mmessage = str_replace("<br>","\n",$mmessage);
			$mmessage = preg_replace("/[quote](\S+?)\[\/quote]/","...",$mmessage);
			$form_message = "[quote] $mmessage [/quote]";
		}
	}

	$form_subject = isset($form_subject)?$form_subject:$txt[24];
	# Build the link tree
	$displayLinkTree = $modSettings['enableInlineLinks'] ? "<font size=\"1\" class=\"nav\"><B><a href=\"$scripturl\" class=\"nav\">$mbname</a> </b>&nbsp;|&nbsp;<b> " : "<font size=\"2\" class=\"nav\"><B><img src=\"$imagesdir/open.gif\" border=\"0\" alt=\"\">&nbsp;&nbsp;<a href=\"$scripturl\" class=\"nav\">$mbname</a><br>" ;
	$displayLinkTree .= $modSettings['enableInlineLinks'] ? "<a href=\"$cgi&action=im\" class=\"nav\">$txt[144]</a> </b>&nbsp;|&nbsp;<b> " : "<img src=\"$imagesdir/tline.gif\" border=\"0\" alt=\"\"><IMG SRC=\"$imagesdir/open.gif\" border=\"0\" alt=\"\">&nbsp;&nbsp;<a href=\"$cgi&action=im\" class=\"nav\">$txt[144]</a><br>" ;
	$displayLinkTree .= $modSettings['enableInlineLinks'] ? "$txt[321]</b></font>" : "<img SRC=\"$imagesdir/tline2.gif\" border=\"0\" alt=\"\"><IMG SRC=\"$imagesdir/open.gif\" border=\"0\" alt=\"\">&nbsp;&nbsp;$txt[321]</b></font>" ;

	print <<<EOT
<script language="JavaScript1.2" src="$ubbcjspath" type="text/javascript"></script>
<table border=0 width="700" cellpadding="3" align="center" cellspacing=0>
<tr>
	<td valign=bottom>$displayLinkTree</td>
</tr>
</table>
<table cellpadding="0" cellspacing="0" border="0" width="700" bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td>
<table border=0 width="700" cellspacing=1 bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
    <td align=right valign=bottom class="catbg" bgcolor="$color[catbg]" colspan=4><font size=-1>
EOT;
	print <<<EOT
<a href="$cgi;action=im">$img[im_inbox]</a>$menusep<a href="$cgi;action=imoutbox">$img[im_outbox]</a>$menusep<a href="$cgi;action=im">$img[im_reload]</a>$menusep<a href="$cgi;action=imprefs">$img[im_config]</a>
</font></td>
</table>
</td></tr></table>
<table border=0 width="700" align="center" cellpadding="3" cellspacing=1 bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]">$img[im_new_small]&nbsp;<b>$txt[321]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]">
    <form action="$cgi;action=imsend2" method="post" name="postmodify" onSubmit="submitonce(this);">
    <table border=0 cellpadding=3>
      <tr>
        <td align="right"><font size=2><b>$txt[150]:</b></font></td>
        <td><font size=2><input type=text name="to" value="$to" size="20" maxlength="50">
        <font size=1">$txt[748]</font></font></td>
      </tr><tr>
        <td align="right"><font size=2><b>$txt[70]:</b></font></td>
        <td><font size=2><input type=text name="subject" value="$form_subject" size="40" maxlength="50"></font></td>
      </tr>
EOT;
	  include_once("$sourcedir/Post.php");
	  printPostBox($form_message);
print <<<EOT
     <tr>
      <td align=center colspan=2>
       <input type="hidden" name="waction" value="imsend">
       <input type="submit" value="$txt[148]" onClick="WhichClicked('imsend');" accesskey="s">
       <input type="submit" name="preview" value="$txt[507]" onClick="WhichClicked('previewim');">
       <input type=reset value="$txt[329]">
      </td>
     </tr>
    </table>
   </form>
  </td>
 </tr>
</table>
EOT;
	footer();
	obExit();
}

function IMPost2()
{
global $subject,$username,$txt,$waction,$subject,$settings,$MaxMessLen,$message,$to,$yySetLocation,$cgi;
global $sourcedir,$db_prefix;
$nouser = array();
if($username == 'Guest') { fatal_error($txt[147]); }
$subject = trim ($subject);	
if (strlen($message)>$MaxMessLen) { fatal_error($txt[499]); }

if ($subject==''){ fatal_error("$txt[77]"); }
if ($message==''){ fatal_error("$txt[78]"); }

$mmessage = $message;
$msubject = $subject;

$message = htmlspecialchars($message);
$subject = htmlspecialchars($subject);
$message = str_replace("\r\n","<br>",$message);
$message = str_replace("\r","<br>",$message);
$message = str_replace("\n","<br>",$message);

if( $waction == 'previewim' ) {
	include_once ("$sourcedir/Post.php");
	Preview();
}

$multiple = explode(",", $to);
foreach ($multiple as $db) {
	$db = trim($db);
	$ignored = 0;
	$db = preg_replace("[^0-9A-Za-z#%+,-\.@^_]","",$db);

	# Check Ignore-List
	$request = mysql_query("SELECT im_ignore_list,ID_MEMBER,im_email_notify,emailAddress FROM {$db_prefix}members WHERE memberName='$db'");
	$row = mysql_fetch_row($request);
	$ignore = explode(",",$row[0]);
	$toID = $row[1];
	$emailNotify = $row[2];
	$notifyAddress = $row[3];

	# If User is on Recipient's Ignore-List, show Error Message
	foreach ($ignore as $igname) {
		#adds ignored user's name to array which error list will be built from later
		if ($igname == $username || $igname == "*") {
			$nouser[] = $db;
			$ignored = 1;
		}
	}

	if (mysql_num_rows($request)==0) {
		#adds invalid user's name to array which error list will be built from later
		$nouser[] = $db;
		$ignored = 1;
	}

	if(!$ignored) {
	$result = mysql_query("SELECT ID_MEMBER FROM {$db_prefix}members WHERE memberName='$username'");
	$row = mysql_fetch_row($result);
	$fromID = $row[0];
	$result = mysql_query("INSERT INTO {$db_prefix}instant_messages (ID_MEMBER_FROM,ID_MEMBER_TO,fromName,toName,msgtime,subject,body) VALUES ($fromID,$toID,'$username','$db',".time().",'$subject','$message')");

	# Send notification
	if ($emailNotify==1) {
		$mydate = timeformat(time());
		if ($notifyAddress != ""){
			$fromname = $settings[1];
			$txt[561] = str_replace ("SUBJECT",$msubject,$txt[561]);
			$txt[561] = str_replace ("SENDER",$fromname,$txt[561]);
			$txt[562] = str_replace ("DATE",$mydate,$txt[562]);
   			$txt[562] = str_replace ("MESSAGE",$mmessage,$txt[562]);
			$txt[562] = str_replace ("SENDER",$fromname,$txt[562]);
   			sendmail($notifyAddress,$txt[561],$txt[562]);
		}
	}
	}
}  #end foreach loop

#if there were invalid usernames in the recipient list, these names are listed after all valid users have been IMed
if (sizeof($nouser) > 0) { 
	$badusers = join(", ", $nouser);
	fatal_error("$badusers $txt[747]");
}
     	
$yySetLocation = "$cgi&action=im";
redirectexit();
}

function IMRemove()
{
	global $username,$txt,$yySetLocation,$cgi,$caller,$id,$db_prefix;
	if($username == 'Guest') { fatal_error($txt[147]); }
	if ($caller == 1)
		$field = "1";
	else
		$field = "0";

	$request = mysql_query ("SELECT deletedBy FROM {$db_prefix}instant_messages WHERE (ID_IM=$id AND deletedBy!=-1)");
	if (mysql_num_rows($request) > 0)
		$request = mysql_query("DELETE FROM {$db_prefix}instant_messages WHERE ID_IM=$id");
	else
		$request = mysql_query ("UPDATE {$db_prefix}instant_messages SET deletedBy=$field WHERE ID_IM=$id");

	$redirect = ($caller == 1) ? 'im' : 'imoutbox';
	$yySetLocation = "$cgi&action=$redirect";
	redirectexit();
}

function IMPreferences (){
	global $username,$txt,$ID_MEMBER,$yytitle,$cgi,$img,$imagesdir,$scripturl,$color,$mbname;
	global $db_prefix, $settings, $menusep, $color, $modSettings;

	if ($username == 'Guest') { fatal_error($txt[147]); }
	$request = mysql_query("SELECT im_ignore_list,im_email_notify FROM {$db_prefix}members WHERE ID_MEMBER=$ID_MEMBER");
	$imconfig = mysql_fetch_row($request);

	$sel0 = $sel1 = '';
	if ($imconfig[1]) {
		$sel0='';
		$sel1=' selected';
	} else {
		$sel0=' selected';
		$sel1='';
	}
	$ignores = str_replace(",","\n",$imconfig[0]);
	$yytitle = "$txt[323]: $txt[144]";
	# Build the link tree
	$displayLinkTree = $modSettings['enableInlineLinks'] ? "<font size=\"1\" class=\"nav\"><B><a href=\"$scripturl\" class=\"nav\">$mbname</a> </b>&nbsp;|&nbsp;<b> " : "<font size=\"2\" class=\"nav\"><B><img src=\"$imagesdir/open.gif\" border=\"0\" alt=\"\">&nbsp;&nbsp;<a href=\"$scripturl\" class=\"nav\">$mbname</a><br>" ;
	$displayLinkTree .= $modSettings['enableInlineLinks'] ? "<a href=\"$cgi&action=im\" class=\"nav\">$txt[144]</a> </b>&nbsp;|&nbsp;<b> " : "<img src=\"$imagesdir/tline.gif\" border=\"0\" alt=\"\"><IMG SRC=\"$imagesdir/open.gif\" border=\"0\" alt=\"\">&nbsp;&nbsp;<a href=\"$cgi&action=im\" class=\"nav\">$txt[144]</a><br>" ;
	$displayLinkTree .= $modSettings['enableInlineLinks'] ? "$txt[323]</b></font>" : "<img SRC=\"$imagesdir/tline2.gif\" border=\"0\" alt=\"\"><IMG SRC=\"$imagesdir/open.gif\" border=\"0\" alt=\"\">&nbsp;&nbsp;$txt[323]</b></font>" ;
	template_header();
	print <<<EOT
<table border=0 width=100% cellspacing=0>
<tr>
	<td valign=bottom>$displayLinkTree</td>
		</tr>
</table>
<table cellpadding="0" cellspacing="0" border="0" width="100%" bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td>
<table border=0 width="100%" cellspacing=1 bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
    <td align=right valign=bottom class="catbg" bgcolor="$color[catbg]" colspan=4><font size=-1>
<a href="$cgi;action=im">$img[im_inbox]</a>$menusep<a href="$cgi;action=imoutbox">$img[im_outbox]</a>$menusep<a href="$cgi;action=imsend">$img[im_new]</a>$menusep<a href="$cgi;action=im">$img[im_reload]</a>
</font>
</td>
</table>
</td></tr></table>
<table border=0 width=100% cellspacing=1 bgcolor="$color[bordercolor]" class="bordercolor">
 <tr>
  <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]">$img[im_config_small]&nbsp;<b>$txt[323]</b></font></td>
 </tr>
 <tr>
  <td class="windowbg" bgcolor="$color[windowbg]">
   <form action="$cgi;action=imprefs2" method=post>
    <table border=0>
     <tr>
      <td valign=top>
       <font size=2><b>$txt[325]:</b></font><br><font size=1>$txt[326]</font>
      </td>
      <td>
       <font size=2><textarea name=ignore rows=10 cols=50 wrap=virtual>$ignores</textarea></font>
      </td>
     </tr>
     <tr>
      <td valign=top>
       <font size=2><b>$txt[327]:</b></font>
      </td>
      <td>
       <font size=2>
	<select name="notify">
	 <option value="0"$sel0>$txt[164]
	 <option value="1"$sel1>$txt[163]
	</select>
       </font>
      </td>
     </tr>
     <tr>
      <td>
      	&nbsp;
      </td>
      <td>
       <input type=submit value="$txt[328]">
       <input type=reset value="$txt[329]">
      </td>
     </tr>
    </table>
   </form>
  </td>
 </tr>
</table>
EOT;
	footer();
	obExit();
}

function IMPreferences2 () {
	global $username,$ID_MEMBER,$yySetLocation,$ignore,$notify,$cgi,$db_prefix;
	if($username == 'Guest') { fatal_error($txt[147]); }
	$ignorelist = $ignore;

	$ignorelist = str_replace("\n",",",trim($ignorelist));
	$request = mysql_query("UPDATE {$db_prefix}members SET im_ignore_list='$ignorelist',im_email_notify=$notify WHERE ID_MEMBER=$ID_MEMBER");
	$yySetLocation = "$cgi&action=imprefs";
	redirectexit();
}

function KillAll (){
	global $username,$caller,$id,$ID_MEMBER,$cgi,$yySetLocation,$db_prefix;
	if($username == 'Guest') { fatal_error($txt[147]); }
	if ($caller == 1) {
		$field2 = "0";
		$field = "ID_MEMBER_TO";
		$field3 = "1";
		$redirect = 'im';
	} else if ($caller == 2) {
		$redirect = 'imoutbox';
		$field2 = "1";
		$field = "ID_MEMBER_FROM";
		$field3 = "0";
	}

	$request = mysql_query("DELETE FROM {$db_prefix}instant_messages WHERE ($field=$ID_MEMBER && deletedBy = $field2)");
	$request = mysql_query ("UPDATE {$db_prefix}instant_messages SET deletedBy=$field3 WHERE $field=$ID_MEMBER");

	$redirect = ($caller == 1) ? 'im' : 'imoutbox';
	
	$yySetLocation = "$cgi&action=$redirect";
	redirectexit();
}

function KillAllQuery (){
	global $username,$txt,$cgi,$yytitle,$img,$caller,$color,$yySetLocation,$db_prefix;
	$imbox = '';
	if($username == 'Guest') { fatal_error($txt[147]); }
	if ($caller == 1) {
		$yytitle .= $txt[316];
		$imbox = $txt[316];
		$cgi2 = "$cgi&action=imremoveall2&caller=1";
		$cgi .= "&action=im";
	} else if ($caller == 2) {
		$yytitle .= $txt[320];
		$imbox = $txt[320];
		$cgi2 = "$cgi&action=imremoveall2&caller=2";
		$cgi .= "&action=imoutbox";
	}
	$txt[412] = str_replace("IMBOX",$imbox,$txt[412]);
	$img['im_delete'] = str_replace("IMBOX",$imbox,$img['im_delete']);
	template_header();
	$yytitle = $txt[412];
	print <<<EOT
<table border=0 width="80%" cellspacing=1 bgcolor="$color[bordercolor]" class="bordercolor" align="center">
<tr>
	<td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$txt[412]</b></font></td>
</tr>
<tr>
	<td class="windowbg" bgcolor="$color[windowbg]"><font size=2>
$txt[413]<br>
<b><a href="$cgi2">$txt[163]</a> - <a href="$cgi">$txt[164]</a></b>
</font></td>
</tr>
</table>
EOT;
	footer();
	obExit();
}

?>
file|^|Sources/Karma.php|^|4737|^|1008718681
<?php
/*****************************************************************************/
/* Karma.php                                                                 */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$karmaphpver="YaBB SE";

function ModifyKarma ()
{
	global $modSettings,$username,$settings,$db_prefix,$karmaAction,$uid,$ID_MEMBER,$HTTP_REFERER,$txt;
	global $doLimitOne;

	/* if the mod is disabled, error */
	if ($modSettings['karmaMode']=='0')
		fatal_error($txt['yse63']);

	/* if we've defined any member groups to restrict it to, and if you're
	   not part of one of said membergroups, kick you're ass to the curb */
	if ($modSettings['karmaMemberGroups'][0]!='' && sizeof($modSettings['karmaMemberGroups'])==1 && !in_array($settings[7],$modSettings['karmaMemberGroups']))
		fatal_error($txt[1]);

	/* if you're a guest, blow you off */
	if ($username == 'Guest')
		fatal_error($txt[1]);

	/* if you don't have enough posts, tough luck */
	if ($settings[6] < $modSettings['karmaMinPosts'])
		fatal_error("$txt[yse60]$modSettings[karmaMinPosts].");

	/* and you can't modify you're own punk! */
	if ($uid == $ID_MEMBER)
		fatal_error("$txt[yse61]");

	$dir = strcasecmp("applaud","$karmaAction")?'-':'+';
	$nowtime = time();
	$request = mysql_query("DELETE FROM {$db_prefix}log_karma WHERE ($nowtime-logTime)>($modSettings[karmaWaitTime]*3600)");

	$change = 0;

	if ($modSettings['karmaTimeRestrictAdmins'] || $settings[7] != 'Administrator')
	{
		$request = mysql_query("SELECT action FROM {$db_prefix}log_karma WHERE (ID_TARGET='$uid' && ID_EXECUTOR='$ID_MEMBER') LIMIT 1");
		if (mysql_num_rows($request) == 0) // there are no entries for you and that user logged
		{
			$request = mysql_query("INSERT INTO {$db_prefix}log_karma (action,ID_TARGET,ID_EXECUTOR,logTime) VALUES ('$dir','$uid','$ID_MEMBER','$nowtime')");
			$change = 1;
		}
		else
		{
			$row = mysql_fetch_row($request);
			if ($row[0]==$dir)	// if you're trying to repeat
				fatal_error("$txt[yse62] $modSettings[karmaWaitTime] $txt[578].");
			else
			{
				$request = mysql_query ("UPDATE {$db_prefix}log_karma SET action='$dir', logTime='$nowtime' WHERE (ID_TARGET='$uid' && ID_EXECUTOR='$ID_MEMBER') $doLimitOne");
				$change = 2;
			}
		}

	}
	else
	{
		$request = mysql_query("UPDATE {$db_prefix}log_karma SET action='$dir',logTime='$nowtime' WHERE (ID_TARGET='$uid' && ID_EXECUTOR='$ID_MEMBER') $doLimitOne");
		if (mysql_affected_rows() == 0)
			$request = mysql_query("INSERT INTO {$db_prefix}log_karma (action,ID_TARGET,ID_EXECUTOR,logTime) VALUES ('$dir','$uid','$ID_MEMBER','$nowtime')");
		$change = 1;
	}

	if ($change != 0)
	{
		$field = ($dir == '+')?'karmaGood':'karmaBad';
		$request = mysql_query("UPDATE {$db_prefix}members SET $field=$field+$change WHERE ID_MEMBER='$uid' $doLimitOne");
	}

	print ("<script>history.go(-1)</script>");
	obExit();
}

?>file|^|Sources/Load.php|^|22146|^|1008773139
<?php
/*****************************************************************************/
/* Load.php                                                                  */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$loadplver="YaBB SE";

/* this function is called from index.php - it loads the cookies for the board
   and places the critical variables into the right place
		$username - the username of the logged in person, or 'Guest'
		$password - the doubly encrypted password stored in the cookie*/
function LoadCookie (){
	global $cookiepassword,$cookieusername,$password,$username,$HTTP_COOKIE_VARS;

	if( isset($HTTP_COOKIE_VARS[$cookiepassword]) && isset($HTTP_COOKIE_VARS['expiretime']) && $HTTP_COOKIE_VARS['expiretime'] > time())
	{
		$password = $HTTP_COOKIE_VARS[$cookiepassword];
		$username = (isset($HTTP_COOKIE_VARS[$cookieusername]) && $HTTP_COOKIE_VARS[$cookieusername] != "") ? $HTTP_COOKIE_VARS[$cookieusername] : 'Guest';
	}
	else
	{
		/* clear the cookies
		   note that in php, setCookie is called in reverse order - so we set it to an
		   expired time 'after' clearing it */
		setCookie($cookieusername);
		setCookie($cookieusername,'',time()-3600);
		setCookie($cookiepassword);
		setCookie($cookiepassword,'',time()-3600);

		/* clear the password and the username */
		$password = '';
		$username = 'Guest';
	}
}

/* This function is called from index.php to load the list of moderators,
   their realnames, and it loads the variables from the settings table.*/
function LoadBoard()
{
	global $moderators,$threadid,$yyThreadLine,$txt,$num,$thread,$board,$currentboard;
	global $caller,$modSettings,$realNames,$db_prefix;
	
	/* load the settings from the table 'settings' and put them into
	   an array called modSettings */
	$modSettings = array();
	$request = mysql_query("SELECT variable,value FROM {$db_prefix}settings WHERE (variable!='news' && variable!='agreement')");
	while ($row = mysql_fetch_row($request))
			$modSettings["$row[0]"] = $row[1];
	// explode any lists
	$modSettings['karmaMemberGroups'] = explode(",",$modSettings['karmaMemberGroups']);

	/* load the moderators for this board, if the board is specified */
	if ($board != '') 
	{
		$request = mysql_query ("SELECT b.moderators FROM {$db_prefix}boards as b WHERE (b.ID_BOARD='$currentboard')");
		/* if there aren't any, skip */
		if (mysql_num_rows($request) > 0)
		{
			$row = mysql_fetch_array($request);
			$moderators = explode(",",trim($row['moderators']));

			/* now load the real names of the moderators
			   into the realNames array */
			for ($i = 0; $i < sizeof($moderators); $i++)
			{
				$moderators[$i] = trim($moderators[$i]);
				LoadRealName ($moderators[$i]);
			}
		}
	}
}

/* load the list of censored words into an associative array.
   Each item is $censored['vulgar term'] = 'replacement' */
function LoadCensorList () {
	global $censored,$txt,$db_prefix;
	$request = mysql_query("SELECT vulgar,proper FROM {$db_prefix}censor WHERE 1");
	if (!$request)
		fatal_error("205 $txt[106]: $txt[23] censor");

	$censored = array();
	while ($row = mysql_fetch_row($request))
		$censored[trim($row[0])] = trim($row[1]);
}

/* Load the users settings into the array settings.  This array has
   been kept as close to the settings array in Y1G as possible*/
function LoadUserSettings () {
	global $username,$settings,$password,$action,$realname,$realemail,$yySetCookies,$pwseed,$HTTP_COOKIE_VARS;
	global $cookieusername,$cookiepassword,$pwseed,$ID_MEMBER,$realNames,$db_prefix;

	/* Only load this stuff if the username isn't Guest */
	if($username != 'Guest')
	{
		$request = mysql_query("SELECT passwd,realName,emailAddress,websiteTitle,websiteUrl,signature,posts,memberGroup,ICQ,AIM,YIM,gender,personalText,avatar,dateRegistered,location,birthdate,timeFormat,timeOffset,hideEmail,ID_MEMBER FROM {$db_prefix}members WHERE memberName='$username' LIMIT 1");
		/* If we found the user... */
		if (mysql_num_rows($request) != 0)
		{
			/* Initialize the settings array */
			$settings = mysql_fetch_row($request);

			/* compare a crypted version of the password in the database
			   with the password stored in the cookie.  Yes, the password
			   stored in the cookie is doubly encrypted */
			$spass = crypt($settings[0],$pwseed);
			if ($spass != $password && $action != 'logout')
			{
				$username = '';
			}
			else
			{
				$realname = isset($settings [1])?$settings[1]:$username;
				$realNames[$username] = $realname;
				$realemail = $settings[2];
				$ID_MEMBER = $settings[20];
			}
		}
		/* Otherwise clear everything */
		else
		{
			$username = '';
		}
	}
	/* If the user is a guest, initialize all the critial user settings */
	if ($username == '' || $username == 'Guest') {
		$username = 'Guest';
		$password = '';
		$settings = array(7=>'',18=>'0');
		$realname = '';
		$realemail = '';
		$ID_MEMBER = '-1';
		$HTTP_COOKIE_VARS = array();
	}
}

/* This is called from display, and from search */
function LoadUser ($user){
	global $userprofile,$icqad,$yimon,$modinfo,$memberinfo,$memberstar,$groupinfo,$db_prefix;
	global $scripturl;
	/* If the user isn't yet set, load it */
	if (!isset($userprofile[$user])){
		$request = mysql_query("SELECT * FROM {$db_prefix}members WHERE memberName='$user' LIMIT 1");
		if (mysql_num_rows($request)==0){ return (0); }
		$userprofile[$user] = mysql_fetch_array($request);
		if (!isset($userprofile[$user]['realName'])){ $userprofile[$user]['realName'] = $user; }
		if (!isset($userprofile[$user]['signature'])){ $userprofile[$user]['signature'] = ''; }
		if (!isset($userprofile[$user]['websiteUrl'])){ $userprofile[$user]['websiteUrl'] = ''; }
		if (!isset($userprofile[$user]['websiteTitle'])){ $userprofile[$user]['websiteUrl'] = ''; }
		if (!isset($userprofile[$user]['location'])){ $userprofile[$user]['location'] = ''; }
		if (!isset($userprofile[$user]['ICQ'])){ $userprofile[$user]['ICQ'] = ''; }
		$icqad[$user] = '';
		if (!isset($userprofile[$user]['AIM'])){ $userprofile[$user]['AIM'] = ''; }
		if (!isset($userprofile[$user]['YIM'])){ $userprofile[$user]['YIM'] = ''; }
		$yimon[$user] = '';
		if (!isset($userprofile[$user]['gender'])){ $userprofile[$user]['gender'] = ''; }
		if (!isset($userprofile[$user]['personalText'])){ $userprofile[$user]['personalText'] = ''; }
		if (!isset($userprofile[$user]['memberGroup'])){ $userprofile[$user]['memberGroup'] = ''; }
		$modinfo[$user] = '';
		$memberinfo[$user] = '';
		$memberstar[$user] = '';
		$groupinfo[$user] = '';
		if (!isset($userprofile[$user]['avatar'])){ $userprofile[$user]['avatar'] = ''; }
	}
	return 1;
}


/* Load the user's settings as used in display, IM or search */
function LoadUserDisplay ($user){
	global $userprofile,$yyUDLoaded,$userpic_width,$userpic_height,$userpic_tmpwidth,$scripturl;
	global $message,$enable_ubbc,$icqad,$yimon,$showgenderimage,$showusertext,$showuserpic;
	global $censored,$GodPostNum,$SrPostNum,$FullPostNum,$JrPostNum,$memberinfo,$imagesdir,$txt;
	global $userpic_tmpheight,$username,$allowpics,$sm,$membergroups,$memberstar,$facesurl,$img;
	global $menusep,$color,$cgi,$modinfo,$groupinfo,$realname,$db_prefix,$modSettings,$moderators,$settings;

	/* If the user is already loaded, exit */
	if (isset($yyUDLoaded[$user]))
		return 1;

	/* load the user */
	$set = LoadUser($user);

	/* if the user couldn't be loaded, load garbage*/
	if ($set == 0)
	{
		$userprofile[$user] = array();
		$userprofile[$user]['realName'] = $user;
		$userprofile[$user]['signature'] = '';
		$userprofile[$user]['websiteUrl'] = '';
		$userprofile[$user]['websiteUrl'] = '';
		$userprofile[$user]['location'] = '';
		$userprofile[$user]['avatar'] = '';
		$userprofile[$user]['hideEmail'] = '0';
		$userprofile[$user]['ICQ'] = '';
		$icqad[$user] = '';
		$userprofile[$user]['AIM'] = '';
		$userprofile[$user]['YIM'] = '';
		$yimon[$user] = '';
		$userprofile[$user]['gender'] = '';
		$userprofile[$user]['personalText'] = '';
		$userprofile[$user]['memberGroup'] = '';
		$userprofile[$user]['websiteUrl_IM'] = '';
		$userprofile[$user]['posts'] = '';
		$userprofile[$user]['emailAddress'] = '';
		$modinfo[$user] = '';
		$memberinfo[$user] = '';
		$memberstar[$user] = '';
		$groupinfo[$user] = '';
		$yyUDLoaded[$user]=0;
		return 0;
	}

	/* ### Load censor list ### */
	LoadCensorList();

	/* if the user pic limits are specified, implemen them, other wise, no restrictions are present */
	$userpic_tmpwidth = (($userpic_width != "") ? " width=\"$userpic_width\"" : "");
	$userpic_tmpheight = (($userpic_height != "") ? " height=\"$userpic_height\"" : "");
	
	/* Load the website image/link stuff */
	$userprofile[$user]['websiteUrl_IM'] = (($userprofile[$user]['websiteUrl']  != "") ? "<a href=\"".$userprofile[$user]['websiteUrl']."\" target=\"_blank\">$img[im_website]</a>$menusep" : "");
	if ($sm == 1)
		$userprofile[$user]['websiteUrl'] = (($userprofile[$user]['websiteUrl'] != "") ? "<a href=\"".$userprofile[$user]['websiteUrl']."\" target=\"_blank\">$img[website_sm]</a>$menusep" : "");
	else
		$userprofile[$user]['websiteUrl'] = (($userprofile[$user]['websiteUrl']  != "") ? "<a href=\"".$userprofile[$user]['websiteUrl']."\" target=\"_blank\">$img[website]</a>$menusep" : "");

	/* load the signature, replace the breaks in it */
	$breaks = array("\n\r","\r\n","\n","\r");
	$userprofile[$user]['signature'] = str_replace($breaks,"<br>",$userprofile[$user]['signature']);
	$userprofile[$user]['signature'] = (($userprofile[$user]['signature'] != "") ? "<hr width='100%' size=1 class='windowbg3'><font size=1>".$userprofile[$user]['signature']."</font>" : "");

	/* # do some ubbc on the signature if enabled */
	if($enable_ubbc)
		$userprofile[$user]['signature'] = DoUBBC($userprofile[$user]['signature']);

	/* ICQ and AIM, and YIM should be initialized in load user */
	if( $userprofile[$user]['ICQ'] != "" && is_numeric($userprofile[$user]['ICQ']) ) {
		$icqad[$user] = "<a href=\"http://wwp.icq.com/scripts/search.dll?to=".$userprofile[$user]['ICQ']."\" target=\"_blank\"><img src=\"$imagesdir/icqadd.gif\" alt=\"".$userprofile[$user]['ICQ']."\" border=0></a>";
		$userprofile[$user]['ICQ'] = "<a href=\"$cgi&amp;action=icqpager&amp;UIN=".$userprofile[$user]['ICQ']."\" target=\"_blank\"><img src=\"http://web.icq.com/whitepages/online?icq=".$userprofile[$user]['ICQ']."&amp;img=5\" alt=\"".$userprofile[$user]['ICQ']."\" border=0></a>";
	}
	$userprofile[$user]['AIM'] = ($userprofile[$user]['AIM'] != "") ? "<a href=\"aim:goim?screenname=".$userprofile[$user]['AIM']."&amp;message=Hi.+Are+you+there?\"><img src=\"$imagesdir/aim.gif\" alt=\"".$userprofile[$user]['AIM']."\" border=0></a>" : "";
	if( $userprofile[$user]['YIM'] != "" ) {
		$yimon[$user] = "<a href=\"http://edit.yahoo.com/config/send_webmesg?.target={$userprofile[$user]['YIM']}\"><img SRC=\"http://opi.yahoo.com/online?u=".$userprofile[$user]['YIM']."&amp;m=g&amp;t=0\" BORDER=0 alt=\"".$userprofile[$user]['YIM']."\"></a>";
	}

	/* if showing the gener image, and if the gender is specified */
	if( $showgenderimage && $userprofile[$user]['gender'] != "") {
		$userprofile[$user]['gender'] = (stristr($userprofile[$user]['gender'],"Female") ? 'Female' : 'Male');
		$userprofile[$user]['gender'] = "$txt[231]: <img src=\"$imagesdir/".$userprofile[$user]['gender'].".gif\" border=0 alt=\"".$userprofile[$user]['gender']."\"><br>";
	}

	/* if user text is enabled, add a <br> other wise erase it */
	$userprofile[$user]['personalText'] = $showusertext ? $userprofile[$user]['personalText']."<br>" : '';

	/* user pics is enabled */
	if( $showuserpic && $allowpics) {
		$userprofile[$user]['avatar'] = ($userprofile[$user]['avatar']=='') ? 'blank.gif' : $userprofile[$user]['avatar'];
		$userprofile[$user]['avatar'] = stristr($userprofile[$user]	['avatar'],'http://') ? "<br><img src=\"{$userprofile[$user]['avatar']}\"$userpic_tmpwidth$userpic_tmpheight border=\"0\" alt=\"\"><br><br>" : "<br><img src=\"$facesurl/{$userprofile[$user]['avatar']}\" border=\"0\" alt=\"\"><br><br>";
	}
	else {
		$userprofile[$user]['avatar'] = '<BR>';
	}

	/* ### Censor it ### */
	foreach ($censored as $tmpa => $tmpb) {
		$userprofile[$user]['signature'] = str_replace($tmpa,$tmpb,$userprofile[$user]['signature']);
		$userprofile[$user]['personalText'] = str_replace($tmpa,$tmpb,$userprofile[$user]['personalText']);
	}
	
	/* create the memberinfo and memberstars entries */
	if( $userprofile[$user]['posts'] > $GodPostNum ) {
		$memberinfo[$user] = "$membergroups[6]";
		$memberstar[$user] = "<img src=\"$imagesdir/star.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/star.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/star.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/star.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/star.gif\" border=0 alt=\"*\">";
	}
	elseif( $userprofile[$user]['posts'] > $SrPostNum ) {
		$memberinfo[$user] = "$membergroups[5]";
		$memberstar[$user] = "<img src=\"$imagesdir/star.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/star.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/star.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/star.gif\" border=0 alt=\"*\">";
	}
	elseif( $userprofile[$user]['posts'] > $FullPostNum ) {
		$memberinfo[$user] = "$membergroups[4]";
		$memberstar[$user] = "<img src=\"$imagesdir/star.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/star.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/star.gif\" border=0 alt=\"*\">";
	}
	elseif( $userprofile[$user]['posts'] > $JrPostNum ) {
		$memberinfo[$user] = "$membergroups[3]";
		$memberstar[$user] = "<img src=\"$imagesdir/star.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/star.gif\" border=0 alt=\"*\">";
	}
	else {
		$memberinfo[$user] = "$membergroups[2]";
		$memberstar[$user] = "<img src=\"$imagesdir/star.gif\" border=0 alt=\"*\">";
	}

	/* If this user is a moderator, and we aren't calling this from the IM */
    $modcheck=LoadRealName($user);

	if( isset ($moderators[$modcheck]) && $sender != "im") {
		$modinfo[$user] = "<i>$membergroups[1]</i><BR>";
		$memberstar[$user] = "</font><img src=\"$imagesdir/starmod.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/starmod.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/starmod.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/starmod.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/starmod.gif\" border=0 alt=\"*\">";
	}
	if( $userprofile[$user]['memberGroup'] == 'Administrator' ) {
		$memberstar[$user] = "<img src=\"$imagesdir/staradmin.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/staradmin.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/staradmin.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/staradmin.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/staradmin.gif\" border=0 alt=\"*\">";
		$memberinfo[$user] = "<B>$membergroups[0]</B>";
	}
	if( $userprofile[$user]['memberGroup'] == 'Global Moderator' ) {
		$memberstar[$user] = "<img src=\"$imagesdir/stargmod.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/stargmod.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/stargmod.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/stargmod.gif\" border=0 alt=\"*\"><img src=\"$imagesdir/stargmod.gif\" border=0 alt=\"*\">";
		$memberinfo[$user] = "<B>$membergroups[7]</B>";
	}

	// if the karma mod is enabled, append the karma information after the stars
	$karmaString = '';
	if ($modSettings['karmaMode'] == '1')
		$karmaString = "<br>$modSettings[karmaLabel] ".($userprofile[$user]['karmaGood']-$userprofile[$user]['karmaBad']);
	else if ($modSettings['karmaMode'] == '2')
		$karmaString = "<br>$modSettings[karmaLabel] +{$userprofile[$user]['karmaGood']}/-{$userprofile[$user]['karmaBad']}";

	if ($userprofile[$user]['posts'] < $modSettings['karmaMinPosts'] || ($modSettings['karmaMemberGroups'][0]!='' && sizeof($modSettings['karmaMemberGroups'])==1 && !in_array($settings[7],$modSettings['karmaMemberGroups'])) || $modSettings['karmaMode'] == '0' || $username=='Guest');
	else
	{
		$karmaString .= "<br><a href=\"$scripturl?action=modifykarma;karmaAction=applaud;uid={$userprofile[$user]['ID_MEMBER']}\">$modSettings[karmaApplaudLabel]</a> <a href=\"$scripturl?action=modifykarma;karmaAction=smite;uid={$userprofile[$user]['ID_MEMBER']}\">$modSettings[karmaSmiteLabel]</a>";
	}
	if ($modSettings['karmaMode'] != '0')
		$memberstar[$user] .= $karmaString;


	if( $userprofile[$user]['memberGroup'] != "" && $userprofile[$user]['memberGroup'] != 'Administrator' && $userprofile[$user]['memberGroup'] != 'Global Moderator')
	{
		$groupinfo[$user] = $userprofile[$user]['memberGroup']."<BR>";
	}
	if( $userprofile[$user]['memberGroup'] != 'Administrator' && $userprofile[$user]['memberGroup'] != 'Global Moderator')
	{
		$memberinfo[$user] = "$modinfo[$user]$groupinfo[$user]$memberinfo[$user]";
	}
	if($userprofile[$user]['posts'] > 100000) { $userprofile[$user]['posts'] = "$txt[683]"; }
	
	/* we've successfully loaded the user */
	$yyUDLoaded[$user] = 1;
	return 1;
}

/* this is called from admin.php only - it's used to load that list
   of administrators on the main admin page */
function LoadAdmins (){
	global $administrators,$db_prefix;
	is_admin();

	$admins = array();
	$request = mysql_query("SELECT realName,memberName FROM {$db_prefix}members WHERE memberGroup='Administrator'");
	while ($row = mysql_fetch_array($request)) {
		$admins[] = "<a href=\"$scripturl?action=viewprofile&amp;username=$row[memberName]\">$row[realName]</a>";
	}
	$administrators = implode("<font size=1>,</font>\n",$admins);
}

/* this is called from admin.php - shows the number of clicks
   we've logged.  I don't know why this is a separate function,
   but it was in Y1G and so it remains */
function LoadLogCount (){
	global $yyclicks,$db_prefix;
	is_admin();
	$request = mysql_query("SELECT COUNT(*) FROM {$db_prefix}log_clicks WHERE 1");
	list($yyclicks) = mysql_fetch_row($request);
}

/* this too, is only called from admin.php. It loads
   all the files that haven't already been loaded, so we can
   check the versions set at the top of them */
function loadfiles () {
	global $boardindexplver,$displayplver,$icqpagerplver,$instantmessageplver;
	global $lockthreadplver,$loginoutplver,$maintenanceplver,$manageboardsplver,$managecatsplver;
	global $memberlistplver,$modifymessageplver,$movethreadplver,$notifyplver,$postplver;
	global $profileplver,$recentplver,$registerplver,$removeoldthreadsplver,$removethreadplver;
	global $searchplver,$sendtopicplver,$messageindexplver,$adminplver,$pollplver;
	global $boarddir,$sourcedir,$language,$modsettingsphpver,$karmaphpver,$repairboardsphpver;
	include_once ("$boarddir/$language");
	include_once ("$sourcedir/BoardIndex.php");
	include_once ("$sourcedir/Display.php");
	include_once ("$sourcedir/ICQPager.php");
	include_once ("$sourcedir/InstantMessage.php");
	include_once ("$sourcedir/Admin.php");
	include_once ("$sourcedir/Karma.php");
	include_once ("$sourcedir/LockThread.php");
	include_once ("$sourcedir/LogInOut.php");
	include_once ("$sourcedir/Maintenance.php");
	include_once ("$sourcedir/ManageBoards.php");
	include_once ("$sourcedir/ManageCats.php");
	include_once ("$sourcedir/Memberlist.php");
	include_once ("$sourcedir/MessageIndex.php");
	include_once ("$sourcedir/ModifyMessage.php");
	include_once ("$sourcedir/ModSettings.php");
	include_once ("$sourcedir/MoveThread.php");
	include_once ("$sourcedir/Notify.php");
	include_once ("$sourcedir/Post.php");
	include_once ("$sourcedir/Profile.php");
	include_once ("$sourcedir/Recent.php");
	include_once ("$sourcedir/Register.php");
	include_once ("$sourcedir/RemoveOldThreads.php");
	include_once ("$sourcedir/RemoveThread.php");
	include_once ("$sourcedir/Search.php");
	include_once ("$sourcedir/Security.php");
	include_once ("$sourcedir/SendTopic.php");
	include_once ("$sourcedir/Subs.php");
	include_once ("$sourcedir/Poll.php");
	include_once ("$sourcedir/RepairBoards.php");
}

/* this is, I guess, replacing FormatUserName.  All it does is
   check if the user's name has already been loaded, and if not,
   loads the user's real name into the array $realNames */
function LoadRealName ($username)
{
	global $realNames,$db_prefix;
	if (!isset($realNames[$username]))
	{
		$request = mysql_query("SELECT realName FROM {$db_prefix}members WHERE memberName='$username' LIMIT 1");
		if (mysql_num_rows($request) == 0)
			$realNames[$username]=$username;
		else
		{
			$tmp = mysql_fetch_row($request);
			$realNames[$username]=$tmp[0];
		}
	}
}
?>
file|^|Sources/LockThread.php|^|3647|^|1008718687
<?php
/*****************************************************************************/
/* LockThread.php                                                            */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$lockthreadplver="YaBB SE";

function LockThread (){
	global $ID_MEMBER,$username,$moderators,$settings,$txt,$yyThreadLine,$start,$yySetLocation,$cgi;
	global $threadid,$db_prefix,$doLimitOne;
	$request = mysql_query("SELECT ID_MEMBER_STARTED,locked FROM {$db_prefix}topics WHERE ID_TOPIC=$threadid");
	$ThreadInfo = mysql_fetch_assoc($request);
	$locked = $ThreadInfo['locked'];
	if ($locked=='0')
	{
		if (in_array($username,$moderators) || $settings[7]=='Administrator' || $settings[7]=='Global Moderator')
			$locked = '1';
		else
			$locked = '2';
	}
	else if ($locked=='1')
	{
		if (in_array($username,$moderators) || $settings[7]=='Administrator' || $settings[7]=='Global Moderator')
			$locked = '0';
		else
			fatal_error($txt['yse31']);
	}
	else if ($locked=='2')
	{
		if ( in_array($username,$moderators) || $settings[7] == 'Administrator' || $settings[7] == 'Global Moderator' || ($ID_MEMBER == $ThreadInfo["ID_MEMBER_STARTED"] && $ID_MEMBER != '-1' && $ThreadInfo["ID_MEMBER_STARTED"] != '-1') )
			$locked = '0';
	}
	mysql_free_result($request);	
	if ( in_array($username,$moderators) || $settings[7] == 'Administrator' || $settings[7] == 'Global Moderator' || ($ID_MEMBER == $ThreadInfo["ID_MEMBER_STARTED"] && $ID_MEMBER != '-1' && $ThreadInfo["ID_MEMBER_STARTED"] != '-1') ){ 
	$request = mysql_query("UPDATE {$db_prefix}topics SET locked=$locked WHERE ID_TOPIC=$threadid $doLimitOne");
	$start = ($start != '') ? $start : 0;
	$yySetLocation = "$cgi;action=display&threadid=$threadid";
	redirectexit();
	} else { fatal_error($txt[93]); }
}

?>file|^|Sources/LogInOut.php|^|6764|^|1008718690
<?php
/*****************************************************************************/
/* LogInOut.php                                                              */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$loginoutplver="YaBB SE";

function Login (){
	global $txt,$yytitle,$cgi,$action,$color,$imagesdir,$reminderurl,$Cookie_Length;
	global $reminderurl;
	$yytitle = "$txt[34]";
	template_header();
	print <<<EOT
<BR><BR>
<form action="$cgi;action=login2" method="POST">
<table border="0" width="400" cellspacing="1" cellpadding="0" bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td class="windowbg" bgcolor="$color[windowbg]" width="100%">
    <table width="100%" cellspacing="0" cellpadding="3">
      <tr>
        <td class="titlebg" bgcolor="$color[titlebg]" colspan="2">
        <img src="$imagesdir/login_sm.gif" alt="">
        <font size=2 class="text1" color="$color[titletext]"><b>$txt[34]</b></font></td>
      </tr><tr>
        <td align="right" class="windowbg" bgcolor="$color[windowbg]"><font size=2><b>$txt[35]:</b></font></td>
        <td class="windowbg" bgcolor="$color[windowbg]"><font size=2><input type=text name="user" size=20></font></td>
      </tr><tr>
        <td align="right" class="windowbg" bgcolor="$color[windowbg]"><font size=2><b>$txt[36]:</b></font></td>
        <td class="windowbg" bgcolor="$color[windowbg]"><font size=2><input type=password name="passwrd" size=20></font></td>
      </tr><tr>
        <td align="right" class="windowbg" bgcolor="$color[windowbg]"><font size=2><b>$txt[497]:</b></font></td>
        <td class="windowbg" bgcolor="$color[windowbg]"><font size=2><input type=text name="cookielength" size=4 maxlength="4" value="$Cookie_Length"></font></td>
      </tr><tr>
        <td align="right" class="windowbg" bgcolor="$color[windowbg]"><font size=2><b>$txt[508]:</b></font></td>
        <td class="windowbg" bgcolor="$color[windowbg]"><font size=2><input type=checkbox name="cookieneverexp"></font></td>
      </tr><tr>
        <td align=center colspan=2 class="windowbg" bgcolor="$color[windowbg]"><BR><input type=submit value="$txt[34]"></td>
      </tr><tr>
        <td align=center colspan=2 class="windowbg" bgcolor="$color[windowbg]"><a href="$reminderurl?action=input_user"><small>$txt[315]</small></a><BR><BR></td>
      </tr>
    </table>
    </td>
  </tr>
</table>
</form>
EOT;
	footer();
	obExit();
}

function Login2() {
	global $txt,$settings,$username,$cookielength,$Cookie_Length,$user,$passwrd,$cookieneverexp,$db_prefix;
	global $pwseed,$cookieusername,$cookiepassword,$password,$yySetCookies;
	if($user == ""){ fatal_error("$txt[37]"); }
	if($passwrd == "") { fatal_error("$txt[38]"); }
	if(!preg_match("/^[\s0-9A-Za-z#%+,-\.:=?@^_]+$/",$user)) {fatal_error("$txt[240]"); }
	if ($cookielength==$txt['yse50']) { $cookielength = 1;$cookieneverexp='on'; }
	if (!is_numeric($cookielength)) {fatal_error("$txt[337]"); }

	$request = mysql_query("SELECT passwd,realName,emailAddress,websiteTitle,websiteUrl,signature,posts,memberGroup,ICQ,AIM,YIM,gender,personalText,avatar,dateRegistered,location,birthdate,timeFormat,timeOffset,hideEmail FROM {$db_prefix}members WHERE memberName='$user'");
	$passwrd = crypt($passwrd,substr($passwrd,0,2));
	if (mysql_num_rows($request) == 0)
		fatal_error("$txt[40]");
	else
	{
		$settings = mysql_fetch_row($request);
		if ($settings[0] != $passwrd)
			fatal_error("$txt[39]");
		else
			$username = $user;
	}

	if ($cookielength < 1 || $cookielength > 504000)
		$cookielength = $Cookie_Length;

	if(!isset($cookieneverexp) || $cookieneverexp == '')
		$Cookie_Length = $cookielength;
	else
		$Cookie_Length = 504000;	// about 1 year
		
	$password = crypt($passwrd,$pwseed);

	setCookie ($cookieusername,$username, time()+30240000);
	setCookie ($cookiepassword,$password, time()+30240000);
	setCookie ("expiretime",time()+(60*$Cookie_Length),time()+30240000);
    $lastLog=time();
    $result =  mysql_query("UPDATE {$db_prefix}members SET lastLogin='$lastLog' WHERE memberName='$user'");

	LoadUserSettings();
	WriteLog();
	redirectinternal();
}

function Logout (){
	global $username,$password,$cookieusername,$cookiepassword,$settings,$realname,$realemail;
	global $HTTP_COOKIE_VARS,$yySetCookies,$maintenance,$db_prefix,$sourcedir;
	# Write log
	$request = mysql_query("DELETE FROM {$db_prefix}log_online WHERE identity='$username'");
	setCookie($cookieusername);
	setCookie($cookieusername,'',time()-3600);
	setCookie($cookiepassword);
	setCookie($cookiepassword,'',time()-3600);
	setCookie('expiretime','-1');
	$username = 'Guest';
	$password = '';
	$settings = array(7=>'');
	$realname = '';
	$realemail = '';
	$HTTP_COOKIE_VARS = array();
	
	banning();
	if ($maintenance == 1 && $settings[7] != 'Administrator') { include_once ("$sourcedir/Maintenance.php"); InMaintenance(); }

	redirectinternal();
}
?>
file|^|Sources/Maintenance.php|^|4108|^|1008718692
<?php
/*****************************************************************************/
/* Maintenance.php                                                           */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$maintenanceplver="YaBB SE";

function InMaintenance () {

	global $yytitle,$color,$cgi,$action,$Cookie_Length,$txt,$mtitle,$mmessage,$imagesdir,$mtxt;

	$yytitle = "$txt[155]";
	template_header();
	print <<<EOT
<table border="0" width="100%" cellspacing="1" bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
   <td class="titlebg" bgcolor="$color[titlebg]" colspan="2" width="100%"><font size="2"
   class="text1"> <b>$mtitle</b></font></td>
   </tr>
    <tr>
      <td class="windowbg" bgcolor="$color[windowbg]" width="44"><p align="center"><font size="2"><br>
      <img src="$imagesdir/construction.gif"
      width="40" height="40" alt="$mtxt[3]"><br>
      &nbsp;
      </font>
     </td>
    <td class="windowbg" bgcolor="$color[windowbg]" width="100%"><font size="2"> $mmessage</font></td>
  </tr>
</table>

<table border="0" width="100%" cellspacing="1" bgcolor="$color[bordercolor]" class="bordercolor">
 <tr>
  <td bgcolor="$color[titlebg]"><font size="2" color="$color[titletext]"><b> $txt[114]</b></font></td>
 </tr><tr>
  <td bgcolor="$color[windowbg]"><font size="2"><form action="$cgi;action=login2" method="POST">
   <table border="0" width="100%">
    <tr>
      <td><font size="2"><b>$txt[35]:</b></font></td>                         
      <td><font size="2"><input type="text" name="user" size="15"></font></td>
      <td><font size="2"><b>$txt[36]:</b></font></td>
      <td><font size="2"><input type="password" name="passwrd" size="10"></font> &nbsp;</td>
    </tr>
    <tr>
      <td><font size="2"><b>$txt[497]:</b></font></td>
      <td><font size="2"><input type=text name="cookielength" size="4" maxlength="4" value="$Cookie_Length"> &nbsp;</font></td>
      <td><font size="2"><b>$txt[508]:</B></font></td>
      <td><font size="2"><input type="checkbox" name="cookieneverexp"></font></td>
    </tr>
    <tr>
      <td align=center colspan=4><input type=submit value="$txt[34]"></td>
    </tr>
   </table></form></font>
  </td>
 </tr>
</table>
EOT;

    footer();
	obExit();
}

?>
file|^|Sources/ManageBoards.php|^|10967|^|1008718697
<?php
/*****************************************************************************/
/* ManageBoards.php                                                          */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$manageboardsplver="YaBB SE";
is_admin();

function ManageBoards (){
	global $yytitle,$txt,$color,$cgi,$img,$imagesdir,$db_prefix;
	$yytitle = "$txt[41]";
    $selectcat="";
	$allcats = mysql_query("SELECT name,ID_CAT FROM {$db_prefix}categories WHERE 1 ORDER BY catOrder");
	while ($allcat = mysql_fetch_assoc($allcats))
	{
		if ($selectcat == '')
			$addboardselect = "<option value=$allcat[ID_CAT] selected>$allcat[name]</option>";
		$selectcat=$selectcat."<option value=$allcat[ID_CAT]>$allcat[name]</option>";
	}
	template_header();
	print <<<EOT
<table border="0" align="center" cellspacing="1" cellpadding="4" bgcolor="$color[bordercolor]" class="bordercolor" width="90%">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]" colspan="3">
		<script language="javascript" TYPE="text/javascript">
		<!--
		function reqWin(desktopURL){
        desktop =window.open(desktopURL,"name","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,width=400,height=200,resizable=no");
        }
		// -->
	</script>
    <a href="javascript:reqWin('help.php?help=1')" class="help"><img src="$imagesdir/helptopics.gif" border="0" alt="$txt[119]"></a>
    <font class="text1" color="$color[titletext]" size="1"><b>$txt[41]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]" colspan="3"><BR><font size="1">$txt[677]</font><BR><BR></td>
  </tr>
  <tr>
    <td bgcolor="$color[windowbg]" class="windowbg" width="100%" valign=top colspan="3">
    <form action="$cgi;action=addboard" method="POST">
    <table border="0" cellspacing="0" cellpadding="5">
      <tr>
        <td nobreak>
			<img src="$imagesdir/board.gif" alt="" border="0"> <font size="2"><b>$txt[44]: </b><input type=text name="boardname" size="30"></font>
		</td>
        <td valign="bottom" align="right" nobreak><font size="2">
			<b>$txt[yse84]: </b><select name="ID_CAT">$addboardselect$selectcat</select>
		</td>
      </tr>
  	  <tr>
		<td rowspan=2><textarea name="descr" cols=50 rows=3></textarea></td>	
		<td align="right"><b>$txt[299]: </b><input type=text name=moderator value="" size="25"></font></td></tr>
  	  <tr><td align="right"><input type=submit value="$txt[45]"></td></tr>
    </table>
    </form>
    </td>
  </tr>

	<tr>
    <td class="titlebg" bgcolor="$color[titlebg]" width="*"><font class="text1" color="$color[titletext]" size="1"><b>$txt[20]</b></font></td>
    <td class="titlebg" bgcolor="$color[titlebg]" width="20%"><font class="text1" color="$color[titletext]" size="1"><b>$txt[12]</b></font></td>
    <td class="titlebg" bgcolor="$color[titlebg]" width="20%"><font class="text1" color="$color[titletext]" size="1"><b>$txt[42]</b></font></td>
  </tr>
EOT;
$request = mysql_query("SELECT name,ID_CAT FROM {$db_prefix}categories WHERE 1 ORDER BY catOrder");
while ($curcat = mysql_fetch_assoc($request))
	{
		print <<<EOT
  <tr>
    <td colspan="3" bgcolor="$color[catbg]" class="catbg" height="25"><font size="2"><b>$curcat[name]</b> <a href="$cgi;action=reorderboards;ID_CAT=$curcat[ID_CAT]">($txt[643])</a></font></td>
  </tr>
EOT;
$request2 = mysql_query("SELECT name,description,moderators,ID_BOARD FROM {$db_prefix}boards WHERE ID_CAT=$curcat[ID_CAT]");
		while ($curboard = mysql_fetch_assoc($request2)) {
				print <<<EOT
  <tr>
    <td bgcolor="$color[windowbg2]" class="windowbg2" width="100%" valign="top" colspan="3">
    <form action="$cgi;action=modifyboard" method="POST">
    <table border="0" cellspacing="0" cellpadding="3">
      <tr>
        <td width="10" valign="top"><img src="$imagesdir/board.gif" alt="" border="0"></td>
        <td><font size="2">
        <input type="hidden" name="ID_BOARD" value="$curboard[ID_BOARD]"><input type="hidden" name="ID_CAT" value="$curcat[ID_CAT]">
        <input type="text" name="boardname" value="$curboard[name]" size="30"><br>
        <textarea name="descr" cols="50" rows="3">$curboard[description]</textarea><br>$txt[yse84]: <select name="changecat"><option value="nochange">$curcat[name]</option>$selectcat</select></font>
        </td>
        <td valign="middle" width="20%"><input type="text" name="moderator" value="$curboard[moderators]" size="25"></td>
        <td valign="middle" width="20%"><input type="submit" name="moda" value="$txt[17]">
        <input type="submit" name="moda" value="$txt[31]"></td>
      </tr>
    </table>
    </form>
    </td>
  </tr>
EOT;
		}
	}
	print "</table>";
	footer();
	obExit();
}

function ReorderBoards (){
	global $yytitle,$txt,$ID_CAT,$cgi,$color,$imagesdir,$db_prefix;
	$yytitle = $txt[46];
	template_header();
	print <<<EOT
<table border=0 width="400" cellspacing=1 bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]">
    <img src="$imagesdir/board.gif">
    <font size=2 class="text1" color="$color[titletext]"><b>$txt[46]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]" valign=top align="center"><font size=2>
   <form action="$cgi;action=reorderboards2" method="POST">
	<table border=0 align=center>
EOT;
	$request = mysql_query("SELECT name,ID_BOARD,boardOrder FROM {$db_prefix}boards WHERE ID_CAT=$ID_CAT ORDER BY boardOrder");
while ($row = mysql_fetch_assoc($request))
	print "<tr><td><font size=2>$row[name]</font></td><td>&nbsp;&nbsp;&nbsp;#<input type=text size=5 name=\"boardOrder$row[ID_BOARD]\" value=\"$row[boardOrder]\"></td></tr>\n";
print<<<EOT
	</table>
    <input type=hidden name="ID_CAT" value="$ID_CAT">
    <input type=submit value="$txt[46]">
    </form>
    </font></td>
  </tr>
</table>
EOT;
	footer();
	obExit();
}

function ReorderBoards2 (){
	global $HTTP_POST_VARS,$ID_CAT,$cgi,$yySetLocation,$db_prefix;
	$boardOrders = array();
	foreach($HTTP_POST_VARS as $key => $value) {
		if (substr($key,0,10)=='boardOrder')
			$request = mysql_query("UPDATE {$db_prefix}boards SET boardOrder=$value WHERE ID_BOARD=".substr($key,10));
	}
	$yySetLocation = "$cgi;action=reorderboards;ID_CAT=$ID_CAT";
	redirectexit();
}


function ConfRemBoard () {
	global $yytitle,$boardname,$color,$txt,$cgi,$ID_CAT,$ID_BOARD,$db_prefix;
	$yytitle = "$txt[31] - '$boardname'?";
	template_header();
	print <<<EOT
<table border=0 width=100% cellspacing=1 bgcolor="$color[bordercolor]" class="bordercolor">
<tr>
	<td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$txt[31] - '$boardname'?</b></font></td>
</tr>
<tr>
	<td class="windowbg" bgcolor="$color[windowbg]"><font size=2>
$txt[617]<br>
<b><a href="$cgi;action=modifyboard;ID_CAT=$ID_CAT;ID_BOARD=$ID_BOARD;moda=$txt[31]2">$txt[163]</a> - <a href="$cgi;action=manageboards">$txt[164]</a></b>
</font></td>
</tr>
</table>
EOT;
	footer();
	obExit();
}


function ModifyBoard (){
	global $descr,$boardname,$moderator,$ID_BOARD,$yySetLocation,$moda,$txt,$cgi,$db_prefix,$changecat;
	if($moda == $txt[17]) {

        if ($changecat!="nochange"){

            $result = mysql_query("UPDATE {$db_prefix}boards SET ID_CAT='$changecat' WHERE ID_BOARD=$ID_BOARD");
        }

		$request = mysql_query("UPDATE {$db_prefix}boards SET name='$boardname',description='$descr',moderators='$moderator' WHERE ID_BOARD=$ID_BOARD");
		$yySetLocation = "$cgi;action=manageboards";
		redirectexit();
	}
	else if ($moda == $txt[31])
	{
		ConfRemBoard();
	}
	else
	{
		template_header();
		print "$txt[48] $ID_BOARD<br>";
  
        //Lines 212-220 all there to delete attachments on board deletion - Jeff
        $request = mysql_query("SELECT m.attachmentFilename FROM {$db_prefix}messages as m, {$db_prefix}topics as t WHERE m.ID_TOPIC=t.ID_TOPIC AND t.ID_BOARD=$ID_BOARD AND attachmentFilename<>NULL");

        if (mysql_numrows($request)>0){
        while($row = mysql_fetch_array($request)){
        unlink($modSettings['attachmentUploadDir'] . "/" . $row['attachmentFilename']);

        }
       }
		$request2 = mysql_query("DELETE FROM {$db_prefix}boards WHERE ID_BOARD=$ID_BOARD");
		$request2 = mysql_query("SELECT ID_TOPIC FROM {$db_prefix}topics WHERE ID_BOARD=$ID_BOARD");
		while ($row2 = mysql_fetch_row($request2))
		{
			print "&nbsp;&nbsp;$txt[50] $row2[0]<br>";
			$request3 = mysql_query("DELETE FROM {$db_prefix}topics WHERE ID_TOPIC=$row2[0]");
			print "&nbsp;&nbsp;&nbsp;&nbsp;$txt[49]<br>";
			$request3 = mysql_query("DELETE FROM {$db_prefix}messages WHERE ID_TOPIC=$row2[0]");
			print "&nbsp;&nbsp;$txt[51]<br>";
		}
		print "$txt[51]<br> <br>";
		print "<font size=2><a href=\"$cgi;action=manageboards\">$txt[4]</a><br><a href=\"$cgi;action=admin\">$txt[208]</a></font><br>";
		footer();
	}
	obExit();
}

function CreateBoard (){
	global $boardname,$descr,$moderator,$yySetLocation,$cgi,$ID_CAT,$db_prefix;
	$request = mysql_query("INSERT INTO {$db_prefix}boards (name,description,moderators,ID_CAT) VALUES ('$boardname','$descr','$moderator',$ID_CAT)");
	$yySetLocation = "$cgi;action=manageboards";
	redirectexit();
}

?>
file|^|Sources/ManageCats.php|^|10324|^|1008803342
<?php
/*****************************************************************************/
/* ManageCats.php                                                            */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$managecatsplver="YaBB SE";

// verify the user is an admin
is_admin();
function ManageCats (){
	global $yytitle,$cgi,$txt,$img,$color,$imagesdir,$db_prefix;
	$categories = array();

	$request = mysql_query("SELECT membergroup FROM {$db_prefix}membergroups WHERE (ID_GROUP=1 OR ID_GROUP > 7)");
	$membergrps = '';
	while ($row = mysql_fetch_row($request))
		$membergrps .= "<option>".trim($row[0])."</option>";

	template_header();
	print <<<EOT
<table border="0" cellspacing="1" cellpadding="4" bgcolor="$color[bordercolor]" class="bordercolor" align="center" width="100%">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]" colspan="2">
	<script language="javascript" TYPE="text/javascript">
		<!--
		function reqWin(desktopURL){
        desktop =window.open(desktopURL,"name","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,width=400,height=200,resizable=no");
        }
		function memberGroups(theForm)
		{
		if (window.popup)
			popup.close();
		popup = window.open("","membergroups","toolbar=no,location=no,status=no,menubar=no,scrollbars=no,width=280,height=300,resizable=no");
		popup.document.write("<html><head><title>$txt[57]</title>\\n");
		popup.document.write("<script language='javascript' TYPE='text/javascript'>\\n");
		popup.document.write("function changeSelectedGroups(listObject) {\\n");
		popup.document.write("var newMemberGroups = '';\\n");
		popup.document.write("for (var i = 0; i < listObject.length; i++){\\n");
		popup.document.write("if (listObject.options[i].selected){\\n");
		popup.document.write("newMemberGroups += listObject.options[i].text +',';\\n");
		popup.document.write("}\\n}\\n");
		popup.document.write("if (newMemberGroups.length > 0){\\n");
		popup.document.write("newMemberGroups=newMemberGroups.substr(0,newMemberGroups.length-1)");
		popup.document.write("}\\nwindow.opener."+theForm+".catgroups.value=newMemberGroups;\\n}");
		popup.document.write("\\n</script>\\n</head>\\n<body>\\n");
		popup.document.write("<font face='verdana,arial' size=2><b>$txt[57]</b><br>$txt[yse55]\\n");
		popup.document.write("<p align=center><form name='form1'><select size=6 name='myOptions' multiple onchange='changeSelectedGroups(this)'>\\n");
		popup.document.write("$membergrps\\n");
		popup.document.write("</select><br> <br> <input type=button onclick=\"window.close()\" value=\"$txt[17]\"></form></p></font></body></html>");
		}
		// -->
	</script>
    <a href="javascript:reqWin('help.php?help=0')" class="help"><img src="$imagesdir/helptopics.gif" border="0" alt="$txt[119]"></a>
    <font size=2 class="text1" color="$color[titletext]"><b>$txt[52]</b></font></td>
  </tr><tr>
    <td colspan="2" bgcolor="$color[catbg]" class="catbg" height="25">
	<font size="2">
    <b>$txt[56]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]" valign="top">
	<!-- Begin Create Cat Code -->
    <form action="$cgi;action=createcat" method="POST"><table width="100%"><tr><td><font size=2>
    <B>$txt[44]:</B></font><BR><font size="1">$txt[672]</font></td>
    <td class="windowbg" bgcolor="$color[windowbg]" valign="top"><font size=2>
	<input type="text" size="40" name="catname"></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]" valign="top" width="50%"><font size=2>
    <B>$txt[57]:</B></font><BR><font size="1">$txt[673]</font></td>
    <td class="windowbg" bgcolor="$color[windowbg]" valign="top" width="50%"><font size=2>
    <input type="text" size="40" name="memgroup"><BR></font><font size="1">($txt[58])</font><br><BR>
    <input type="submit" value="$txt[59]">
	</td></tr></table></form>
	<!-- Stop Create Cat Code -->
    </td>
  </tr>
</table>

EOT;
	$request = mysql_query("SELECT name,ID_CAT,memberGroups,catOrder FROM {$db_prefix}categories WHERE 1 ORDER BY catOrder");
	while ($curcat = mysql_fetch_assoc($request)) {
		print <<<EOT
	<!-- Begin Modify Cat Code -->
	<form name="cat$curcat[ID_CAT]" action="$cgi;action=modifycat" method="POST">
   <table border="0" cellspacing="1" cellpadding="4" bgcolor="$color[bordercolor]" class="bordercolor" align="center" width="100%">
	<tr>
    <td colspan="2" valign="top" bgcolor="$color[catbg]" class="catbg" height="25">

		<font size="2"><b>$txt[44]: <input type="text" value="$curcat[name]" size="25" name="catname"><input type=hidden name="ID_CAT" value="$curcat[ID_CAT]"></B></font></td>
		</tr><tr>
		<td bgcolor="$color[windowbg2]" class="windowbg2" colspan="2">
			<table border="0" cellpadding="1" cellspacing="0" width="100%">
			<tr>
			<td valign="middle"><font size="2">
			$txt[43]:<BR> <input type="text" value="$curcat[catOrder]" size="5" name="catorder"></font></td>
			<td valign="middle"><font size="2">
			$txt[57]:<BR> <input type="text" value="$curcat[memberGroups]" size="40" name="catgroups">  <a href="javascript:memberGroups('cat$curcat[ID_CAT]');"><img src="$imagesdir/assist.gif" border="0" alt=""></a></font></td>
			<td valign="middle">
			<input type="hidden" name="id" value="$curcat[ID_CAT]">
			<input type="submit" name="moda" value="$txt[17]"> &nbsp;<input type="submit" name="moda" value="$txt[31]">
			</td>
			</tr>
			</table>
    </td>
  </tr></table></form>
EOT;
	}
print "\n";
	footer();
	obExit();
}

function CreateCat (){
	global $catname,$memgroup,$yySetLocation,$cgi,$db_prefix;
	$request = mysql_query("INSERT INTO {$db_prefix}categories (name,memberGroups,catOrder) VALUES ('$catname','$memgroup',0)");
	$yySetLocation = "$cgi;action=managecats";
	redirectexit();
}

function ConfRemCat (){
	global $yytitle,$txt,$catname,$color,$ID_CAT,$cgi;
	$yytitle = "$txt[31] - '$catname'?";
	template_header();
	print <<<EOT
<table border=0 width=100% cellspacing=1 bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$txt[31] - '$catname'?</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]"><font size=2>
    $txt[736]<br>
    <b><a href="$cgi;action=modifycat;ID_CAT=$ID_CAT;moda=$txt[31]2">$txt[163]</a> - <a href="$cgi;action=manageboards">$txt[164]</a></b>
    </font></td>
  </tr>
</table>
EOT;
	
	footer();
	obExit();
}

function ModifyCat (){
	global $moda,$txt,$catname,$catgroups,$catorder,$ID_CAT,$yySetLocation,$cgi,$db_prefix;
	if($moda == $txt[17]) {
		$request = mysql_query("UPDATE {$db_prefix}categories SET name='$catname',memberGroups='$catgroups',catOrder='$catorder' WHERE ID_CAT=$ID_CAT");
		$yySetLocation = "$cgi;action=managecats";
		redirectexit();
	} else if($moda == "$txt[31]") { ConfRemCat(); }
	else {
		template_header();
		print "$txt[60] $ID_CAT<br>";
  
        //Lines 174-182 all there to delete attachments on category deletion - Jeff
        $request = mysql_query("SELECT m.attachmentFilename FROM {$db_prefix}messages as m, {$db_prefix}topics as t, {$db_prefix}boards as b WHERE (m.ID_TOPIC=t.ID_TOPIC AND t.ID_BOARD=b.ID_BOARD AND b.ID_CAT=$ID_CAT AND m.attachmentFilename<>NULL)");

        if (mysql_numrows($request)>0){
	        while($row = mysql_fetch_array($request)){
			    unlink($modSettings['attachmentUploadDir'] . "/" . $row['attachmentFilename']);
			}
		}
		$request = mysql_query("DELETE FROM {$db_prefix}categories WHERE ID_CAT=$ID_CAT");
		$request = mysql_query("SELECT ID_BOARD FROM {$db_prefix}boards WHERE ID_CAT=$ID_CAT");

		while($row = mysql_fetch_row($request))
		{
			print "&nbsp;&nbsp;$txt[48] $row[0]<br>";
			$request2 = mysql_query("DELETE FROM {$db_prefix}boards WHERE ID_BOARD=$row[0]");
			$request2 = mysql_query("SELECT ID_TOPIC FROM {$db_prefix}topics WHERE ID_BOARD=$row[0]");
			while ($row2 = mysql_fetch_row($request2))
			{
				print "&nbsp;&nbsp;&nbsp;&nbsp;$txt[50] $row2[0]<br>";
				$request3 = mysql_query("DELETE FROM {$db_prefix}topics WHERE ID_TOPIC=$row2[0]");
				print "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$txt[49]<br>";
				$request3 = mysql_query("DELETE FROM {$db_prefix}messages WHERE ID_TOPIC=$row2[0]");
				print "&nbsp;&nbsp;&nbsp;&nbsp;$txt[51]<br>";
			}
			print "&nbsp;&nbsp;$txt[51]<br>";
		}
		print "$txt[51]<br> <br>";
		print "<font size=2><a href=\"$cgi;action=managecats\">$txt[3]</a><br><a href=\"$cgi;action=admin\">$txt[208]</a></font><br>";
		footer();
	obExit();
	}
}
?>
file|^|Sources/Memberlist.php|^|13222|^|1008718702
<?php
/*****************************************************************************/
/* Memberlist.php                                                            */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$memberlistplver="YaBB SE";

// initialize variables
global $txt,$cgi,$color,$img,$TopAmmount,$action,$scripturl,$MOST_POSTS,$TableHeader,$TableFooter,$username,$db_prefix;
$Sort = $page = $LetterLinks = $TableHeader = '';

if($username == "Guest") { fatal_error($txt[223]); }
if($action == "mlall") { $Sort .= "$txt[303] | "; } else { $Sort .= "<a href=\"$cgi;action=mlall\"><font size=2 class=\"text1\" color=\"$color[titletext]\">$txt[303]</font></a> | "; }
if($action == "mlletter") { $Sort .= "$txt[304] | "; } else { $Sort .= "<a href=\"$cgi;action=mlletter\"><font size=2 class=\"text1\" color=\"$color[titletext]\">$txt[304]</font></a> | "; }
if($action == "mltop") { $Sort .= "$txt[305] $txt[411] $TopAmmount $txt[306]"; } else { $Sort .= "<a href=\"$cgi;action=mltop\"><font size=2 class=\"text1\" color=\"$color[titletext]\">$txt[305] $txt[411] $TopAmmount $txt[306]</font></a>"; }

if($action == "mlletter") {
	for ($i = 97; $i < 123; $i++)
		$LetterLinks .= "<a href=\"$scripturl?action=mlletter;letter=".chr($i)."\">".strtoupper(chr($i))."</a> ";
}

$TableHeader .= "<table border=0 width=100% cellspacing=1 cellspacing=4 bgcolor=\"$color[bordercolor]\" class=\"bordercolor\" align=center>\n<tr>\n	<td class=\"titlebg\" bgcolor=\"$color[titlebg]\" colspan=7><b><font size=2 class=\"text1\" color=\"$color[titletext]\">$Sort</font></b></td></tr>";
if($LetterLinks != "") {
	$TableHeader .= "<tr>\n		<td class=\"catbg\" bgcolor=\"$color[catbg]\" colspan=7><b><font size=2>$LetterLinks</td>\n	</tr>\n";
}
$TableHeader .= <<<EOT
<tr>
	<td class="catbg" bgcolor="$color[catbg]" width="200"><b><font size=2>$txt[35]</font></b></td>
	<td class="catbg" bgcolor="$color[catbg]"><b><font size=2>$txt[307]</font></b></td>
	<td class="catbg" bgcolor="$color[catbg]"><b><font size=2>$txt[96]</font></b></td>
	<td class="catbg" bgcolor="$color[catbg]"><b><font size=2>$txt[86]</font></b></td>
	<td class="catbg" bgcolor="$color[catbg]"><b><font size=2>$txt[87]</font></b></td>
	<td class="catbg" bgcolor="$color[catbg]" width="20"><b><font size=2>$txt[513]</font></b></td>
	<td class="catbg" bgcolor="$color[catbg]"><b><font size=2>$txt[21]</font></b></td>
</tr>
EOT;

$TableFooter = "</table>";

global $NUM_MEMBERS;
$result = mysql_query ("SELECT COUNT(*) as memcount FROM {$db_prefix}members");
$row = mysql_fetch_row($result);
$NUM_MEMBERS = $row[0];
$result = mysql_query("SELECT MAX(posts) FROM {$db_prefix}members");
$row = mysql_fetch_row($result);
$MOST_POSTS = ($row[0]!=0)?$row[0]:1;

function MLAll (){
    global $user,$txt,$start,$MembersPerPage,$settings,$allow_hide_email,$color,$TableHeader,$MOST_POSTS;
	global $imagesdir,$cgi,$TableFooter,$db_prefix;
	global $NUM_MEMBERS,$yytitle;
	if ($MOST_POSTS==0) {$MOST_POSTS=1;}
	if($user == "Guest") { fatal_error($txt[223]); }
	# Get the number of members
//	$result = mysql_query ("SELECT COUNT(*) as memcount FROM {$db_prefix}members");
//	$row = mysql_fetch_row($result);
	$memcount = $NUM_MEMBERS;
	if($start == "") { $start = 0; }
//	$numshown=0;
	$numbegin = ($start + 1);
	$numend = ($start + $MembersPerPage);
	if($numend > $memcount) { $numend = $memcount; }
//	$b = $start;

	$yytitle = "$txt[308] $numbegin $txt[311] $numend";
	template_header();

	print <<<EOT
		<table border=0 cellspacing=0 cellpadding="3" align="center" width="100%">
		  <tr>
		    <td bgcolor="$color[titlebg]" align="center" class="titlebg">
		    <font size="2" class="text1" color="$color[titletext]"><B>$txt[308] $numbegin $txt[311] $numend ($txt[309] $memcount $txt[310])</B></font>
		    </td>
		  </tr>
		</table>
EOT;

	print $TableHeader;

	$request = mysql_query("SELECT memberName,realName,websiteTitle,websiteUrl,posts,memberGroup,ICQ,emailAddress,hideEmail FROM {$db_prefix}members WHERE 1 LIMIT $start,$MembersPerPage");
	while ($row = mysql_fetch_array($request)) {
		$name = $row['memberName'];
		$Bar = "";
		$ICQ = "";

		$Bar = "&nbsp;";
		$ICQ = "";

		$barchart = round(($row['posts'] / $MOST_POSTS) * 100);
		if ($barchart <= 0) {$barchart = 1;}
		$Bar = "<img src=\"$imagesdir/bar.gif\" width=$barchart height=15 border=\"0\">";

		if(isset ($row['ICQ'])) {
			$ICQ = "<a href=\"$cgi\;action=icqpager;UIN=$row[ICQ]\" target=_blank><img src=\" http://web.icq.com/whitepages/online?icq=$row[ICQ];img=5\" alt =\"$row[ICQ]\" border=0></a>";
		}
		$row['websiteTitle'] = isset($row['websiteTitle'])?$row['websiteTitle']:'';
		$row['websiteUrl'] = isset($row['websiteUrl'])?$row['websiteUrl']:'';
		$row['memberGroup'] = isset($row['memberGroup'])?$row['memberGroup']:'';

		if($row['posts'] > 100000) { $row['posts'] = "$txt[683]"; }
		
		print <<<EOT
			<tr>
				<td class="windowbg" bgcolor="$color[windowbg]"><font size=2><a href="$cgi;action=viewprofile;user=$row[memberName]">$row[realName]</a></font></td>
EOT;
				if ($row['hideEmail'] && $settings[7] != "Administrator" && $allow_hide_email) { print <<<EOT
					<td class="windowbg2" bgcolor="$color[windowbg2]"><font size=2><i>$txt[722]</i></font></td>
EOT;
				} else { print<<<EOT
					<td class="windowbg2" bgcolor="$color[windowbg2]"><font size=2><a href="mailto:$row[emailAddress]">$row[emailAddress]</a></font></td>
EOT;
				}
				print <<<EOT
				<td class="windowbg" bgcolor="$color[windowbg]"><font size=2><a href="$row[websiteUrl]" target="_blank">$row[websiteTitle]</a></font>&nbsp;</td>
				<td class="windowbg2" bgcolor="$color[windowbg2]" align="center"><font size=2>$row[posts]</font>&nbsp;</td>
				<td class="windowbg" bgcolor="$color[windowbg]"><font size=2>$row[memberGroup]</font>&nbsp;</td>
				<td class="windowbg2" bgcolor="$color[windowbg2]" align="center"><font size=2>$ICQ</font>&nbsp;</td>
				<td class="windowbg" bgcolor="$color[windowbg]">$Bar</td>
			</tr>

EOT;
	}

	print $TableFooter;

	print <<<EOT
	<table border=0 width=100% cellpadding=0 cellspacing=0>
	<tr>
		<td><font size=2><b>$txt[139]:</b>
EOT;
	$c=0;
	while(($c*$MembersPerPage) < $NUM_MEMBERS) {
		$viewc = $c+1;
		$strt = ($c*$MembersPerPage);
		if($start == $strt)
			print " $viewc";
		else 
			print " <a href=\"$cgi;action=mlall;start=$strt\">$viewc</a>";
		++$c;
	}
	print<<<EOT
		</td>
	</tr>
	</table>
EOT;
	footer();
	obExit();
}

function MLByLetter (){
	global $username,$txt,$TableHeader,$TableFooter,$MOST_POSTS,$NUM_MEMBERS,$letter,$imagesdir,$cgi,$settings;
	global $color,$yytitle,$allow_hide_email,$db_prefix;
	if($username == "Guest") { fatal_error("$txt[223]"); }
	$yytitle = "$txt[312]";
	template_header();
	print $TableHeader;

	$request = mysql_query("SELECT * FROM {$db_prefix}members WHERE (SUBSTRING(realName,1,1)='$letter') ORDER BY realName");

	while ($row = mysql_fetch_array($request)) {
		$name = $row['memberName'];
		$Bar = "";
		$ICQ = "";

		$barchart = (int)round(($row['posts'] / $MOST_POSTS) * 100);
		if ($barchart == 0) {$barchart = 1;}
		$Bar = "<img src=\"$imagesdir/bar.gif\" width=$barchart height=15 border=\"0\">";

		if(isset($row['ICQ'])) {
			$ICQ = "<a href=\"$cgi\;action=icqpager;UIN=$row[ICQ]\" target=_blank><img src=\" http://web.icq.com/whitepages/online?icq=$row[ICQ];img=5\" alt =\"$row[ICQ]\" border=0></a>";
		}
		$row['websiteTitle'] = isset($row['websiteTitle'])?$row['websiteTitle']:'';
		$row['websiteUrl'] = isset($row['websiteUrl'])?$row['websiteUrl']:'';
		$row['memberGroup'] = isset($row['memberGroup'])?$row['memberGroup']:'';

		if($row['posts'] > 100000) { $row['posts'] = "$txt[683]"; }
		
		print <<<EOT
			<tr>
				<td class="windowbg" bgcolor="$color[windowbg]"><font size=2><a href="$cgi;action=viewprofile;user=$row[memberName]">$row[realName]</a></font></td>
EOT;
				if ($row['hideEmail'] && $settings[7] != "Administrator" && $allow_hide_email) { print <<<EOT
					<td class="windowbg2" bgcolor="$color[windowbg2]"><font size=2><i>$txt[722]</i></font></td>
EOT;
				} else { print<<<EOT
					<td class="windowbg2" bgcolor="$color[windowbg2]"><font size=2><a href="mailto:$row[emailAddress]">$row[emailAddress]</a></font></td>
EOT;
				}
				print <<<EOT
				<td class="windowbg" bgcolor="$color[windowbg]"><font size=2><a href="$row[websiteUrl]" target="_blank">$row[websiteTitle]</a></font>&nbsp;</td>
				<td class="windowbg2" bgcolor="$color[windowbg2]" align="center"><font size=2>$row[posts]</font>&nbsp;</td>
				<td class="windowbg" bgcolor="$color[windowbg]"><font size=2>$row[memberGroup]</font>&nbsp;</td>
				<td class="windowbg2" bgcolor="$color[windowbg2]" align="center"><font size=2>$ICQ</font>&nbsp;</td>
				<td class="windowbg" bgcolor="$color[windowbg]">$Bar</td>
			</tr>
EOT;
	}
if (mysql_num_rows($request)==0)
	print "<tr><td colspan=7 class=\"windowbg\" bgcolor=\"$color[windowbg]\">$txt[170]</td></tr>";

	print $TableFooter;

	footer();
	obExit();
}

function MLTop () {
    global $user,$txt,$start,$MembersPerPage,$settings,$allow_hide_email,$TopAmmount,$color;
	global $TableHeader,$MOST_POSTS,$imagesdir,$cgi,$db_prefix;
	global $NUM_MEMBERS,$TableFooter,$yytitle;
 	if($user == "Guest") { fatal_error("$txt[223]"); }
	$yytitle = "$txt[313] $TopAmmount $txt[314]";
	template_header();
	print $TableHeader;

	$request = mysql_query("SELECT * FROM {$db_prefix}members WHERE 1 ORDER BY posts DESC LIMIT $TopAmmount");

	while ($row = mysql_fetch_array($request)) {
		$name = $row['memberName'];
		$Bar = "";
		$ICQ = "";

		$Bar = "&nbsp;";
		$ICQ = "";

		$barchart = round(($row['posts'] / $MOST_POSTS) * 100);
		if ($barchart <= 0) {$barchart = 1;}
		$Bar = "<img src=\"$imagesdir/bar.gif\" width=$barchart height=15 border=\"0\">";

		if(isset($row['ICQ'])) {
			$ICQ = "<a href=\"$cgi\;action=icqpager;UIN=$row[ICQ]\" target=_blank><img src=\" http://web.icq.com/whitepages/online?icq=$row[ICQ];img=5\" alt =\"$row[ICQ]\" border=0></a>";
		}
		$row['websiteTitle'] = isset($row['websiteTitle'])?$row['websiteTitle']:'';
		$row['websiteUrl'] = isset($row['websiteUrl'])?$row['websiteUrl']:'';
		$row['memberGroup'] = isset($row['memberGroup'])?$row['memberGroup']:'';

		if($row['posts'] > 100000) { $row['posts'] = "$txt[683]"; }
		
		print <<<EOT
			<tr>
				<td class="windowbg" bgcolor="$color[windowbg]"><font size=2><a href="$cgi;action=viewprofile;user=$row[memberName]">$row[realName]</a></font></td>
EOT;
				if ($row['hideEmail'] && $settings[7] != "Administrator" && $allow_hide_email) { print <<<EOT
					<td class="windowbg2" bgcolor="$color[windowbg2]"><font size=2><i>$txt[722]</i></font></td>
EOT;
				} else { print<<<EOT
					<td class="windowbg2" bgcolor="$color[windowbg2]"><font size=2><a href="mailto:$row[emailAddress]">$row[emailAddress]</a></font></td>
EOT;
				}
				print <<<EOT
				<td class="windowbg" bgcolor="$color[windowbg]"><font size=2><a href="$row[websiteUrl]" target="_blank">$row[websiteTitle]</a></font>&nbsp;</td>
				<td class="windowbg2" bgcolor="$color[windowbg2]" align="center"><font size=2>$row[posts]</font>&nbsp;</td>
				<td class="windowbg" bgcolor="$color[windowbg]"><font size=2>$row[memberGroup]</font>&nbsp;</td>
				<td class="windowbg2" bgcolor="$color[windowbg2]" align="center"><font size=2>$ICQ</font>&nbsp;</td>
				<td class="windowbg" bgcolor="$color[windowbg]">$Bar</td>
			</tr>
EOT;
	}

	print $TableFooter;

	footer();
	obExit();
}

?>
file|^|Sources/MessageIndex.php|^|17985|^|1008860985
<?php
/*****************************************************************************/
/* MessageIndex.php                                                          */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$messageindexplver="YaBB SE";


function MessageIndex (){
	global $view,$maxdisplay,$showmarkread,$img,$maxmessagedisplay,$menusep,$currentboard,$realNames;
	global $imagesdir,$censored,$username,$user,$pageindex,$mbname,$txt,$ShowBDescrip,$color,$scripturl;
	global $curposlinks,$cgi,$yytitle,$settings,$start,$modSettings,$viewResults,$ID_MEMBER,$db_prefix;

	// Get the board and category information
	$result = mysql_query("SELECT b.name,b.description,b.moderators,c.name,b.ID_CAT,c.memberGroups FROM {$db_prefix}boards as b,{$db_prefix}categories as c WHERE(b.ID_BOARD=$currentboard && b.ID_CAT=c.ID_CAT)");
	list ($boardname,$bdescrip,$bdmods,$cat,$currcat,$temp2) = mysql_fetch_row($result);

	$memgroups = explode(",",$temp2);
	if (!(in_array($settings[7],$memgroups) || $memgroups[0]==null || $settings[7]=='Administrator' || $settings[7]=='Global Moderator'))
		fatal_error($txt[1]);

	// how many topics are there in total?
	// (used to figure out how many pages)
	$result = mysql_query("SELECT COUNT(*) as topiccount FROM {$db_prefix}topics WHERE (ID_BOARD=$currentboard)");
	$temp = mysql_fetch_row($result);
    $topiccount = $temp[0];
	// are we views all the topics, or just a few?
	$maxindex = $view == 'all' ? $topiccount : $maxdisplay;

	// Make sure the starting place makes sense.
	if (!isset($start)) { $start = 0; }
	if( $start > $topiccount ) { $start =( $topiccount % $maxindex ) * $maxindex; }
	elseif( $start < 0 ) { $start = 0; }

	// Construct the page links for this board.
	$tmpa = $start - $maxindex;
	$pageindex .= ($start == 0 ) ? " " : "<a href=\"$cgi;action=messageindex;start=$tmpa\">&#171;</a> ";
	$tmpa = 1;
	for( $counter = 0; $counter < $topiccount; $counter += $maxindex ) {
		$pageindex .= ($start == $counter) ? "<B>$tmpa</B> " : "<a href=\"$cgi;action=messageindex;start=$counter\">$tmpa</a> ";
		++$tmpa;
	}
	$tmpa = $start + $maxindex;
	$tmpa = ($tmpa > $topiccount) ? $topiccount : $tmpa;
	if($start != $counter-$topiccount) {
		$pageindex .= $tmpa > $counter-$maxindex ? " " : "<a href=\"$cgi;action=messageindex;start=$tmpa\">&#187;</a> ";
	}

	// Add the "new poll" icon if allowed
	$newPollIcon = ($modSettings['pollMode']=='1' && (($modSettings['pollPostingRestrictions']=='1' && $settings[7]=='Administrator') || $modSettings['pollPostingRestrictions']=='0'))?"$menusep<a href=\"$cgi;action=postpoll\">$img[newpoll]</a>":'';


	// mark current board as seen
	$request = mysql_query("SELECT logTime FROM {$db_prefix}log_boards WHERE (memberName='$username' AND ID_BOARD=$currentboard) LIMIT 1");
	if (mysql_num_rows($request)==0)
		$request = mysql_query("INSERT INTO {$db_prefix}log_boards (logTime,memberName,ID_BOARD) VALUES (".time().",'$username',$currentboard)");
	else
		$request = mysql_query("UPDATE {$db_prefix}log_boards SET logTime=".time()." WHERE (memberName='$username' AND ID_BOARD=$currentboard)");

	// Build a list of the board's moderators.
	$moderators = explode(",", $bdmods);
	if (sizeof($moderators) > 0 && $moderators[0]!=NULL)
	{
		if (sizeof($moderators) == 1)
			$showmods = "($txt[298]: ";
		else
			$showmods = "($txt[299]: ";
		$tmp = array();
		for ($i = 0; $i < sizeof($moderators); $i++){
			$tmp[$i] = "<a href=\"$scripturl?action=viewprofile;user=$moderators[$i]\"><acronym			title=\"$txt[62]\">{$realNames[$moderators[$i]]}</acronym></a>";
		}
		$showmods .= implode(", ",$tmp).")";
	}

	$request = mysql_query("SELECT * FROM {$db_prefix}censor WHERE 1");
	$censored = array();
	while (list($tmpa,$tmpb) = mysql_fetch_row($request))
		$censored[$tmpa] = $tmpb;

	// Print the header and board info.
	$yytitle = $boardname;
	template_header();
	$curboardurl = $curposlinks ? "<a href=\"$cgi\" class=\"nav\">$boardname</a>" : $boardname;
	# Build the link tree
	$displayLinkTree = $modSettings['enableInlineLinks'] ? "<font size=\"1\" class=\"nav\"><B><a href=\"$scripturl\" class=\"nav\">$mbname</a> </b>&nbsp;|&nbsp;<b> " : "<font size=\"2\" class=\"nav\"><B><img src=\"$imagesdir/open.gif\" border=\"0\" alt=\"\">&nbsp;&nbsp;<a href=\"$scripturl\" class=\"nav\">$mbname</a><br>" ;
	$displayLinkTree .= $modSettings['enableInlineLinks'] ? "<a href=\"$scripturl#$currcat\" class=\"nav\">$cat</a> </b>&nbsp;|&nbsp;<b> " : "<img src=\"$imagesdir/tline.gif\" border=\"0\" alt=\"\"><IMG SRC=\"$imagesdir/open.gif\" border=\"0\" alt=\"\">&nbsp;&nbsp;<a href=\"$scripturl#$currcat\" class=\"nav\">$cat</a><br>" ;
	$displayLinkTree .= $modSettings['enableInlineLinks'] ? "$curboardurl</b> $showmods</font>" : "<img src=\"$imagesdir/tline2.gif\" border=\"0\" alt=\"\"><IMG SRC=\"$imagesdir/open.gif\" border=\"0\" alt=\"\">&nbsp;&nbsp;$curboardurl</b> $showmods</font>" ;
	print <<< EOT
<table width="100%" cellpadding="0" cellspacing="0">
  <tr>
    <td>$displayLinkTree</td>
  </tr>
</table>
EOT;
if($ShowBDescrip) {
print <<<EOT
<table border="0" width="100%" cellspacing="0" cellpadding="0" bgcolor="$color[bordercolor]" class="bordercolor"><tr><td>
<table width="100%" cellpadding="3" cellspacing="1" border="0" bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
    <td align="left" class="catbg" bgcolor="$color[catbg]" width="100%"  height="30">
    <table cellpadding="3" cellspacing="0" width="100%">
      <tr>
        <td width="100%"><font size="1">$bdescrip</font></td>
      </tr>
    </table>
    </td>
  </tr>
</table>
</td></tr></table>
EOT;

}
print <<<EOT
<table border="0" width="100%" cellspacing="0" cellpadding="0" bgcolor="$color[bordercolor]" class="bordercolor"><tr><td>
<table width="100%" cellpadding="3" cellspacing="1" border="0" bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
    <td align="left" class="catbg" bgcolor="$color[catbg]" width="100%"  height="30">
    <table cellpadding="3" cellspacing="0" width="100%">
      <tr>
        <td><font size="2"><b>$txt[139]:</b> $pageindex</font></td>
	<td align="right" nowrap><font size="-1"><b>
EOT;
if($username != 'Guest') {
if($showmarkread) { 
	print "	<a href=\"$cgi;action=markasread\">$img[markboardread]</a>";
}
}
	print <<<EOT
	$menusep<a href="$cgi;action=post;title=$txt[464]">$img[newthread]</a>$newPollIcon&nbsp;
	</b></font></td>
      </tr>
    </table>
    </td>
  </tr>
</table>
</td></tr></table>
<table border="0" width="100%" cellspacing="0" cellpadding="0" bgcolor="$color[bordercolor]" class="bordercolor"><tr><td>
<table border="0" width="100%" cellspacing="1" cellpadding="4" bgcolor="$color[bordercolor]" class="bordercolor">
<tr>
	<td class="titlebg" bgcolor="$color[titlebg]" width="10%" colspan="2"><font size="2">&nbsp;</font></td>
	<td class="titlebg" bgcolor="$color[titlebg]" width="48%"><font size="2" class="text1" color="$color[titletext]"><b>$txt[70]</b></font></td>
	<td class="titlebg" bgcolor="$color[titlebg]" width="14%"><font size="2" class="text1" color="$color[titletext]"><b>$txt[109]</b></font></td>
	<td class="titlebg" bgcolor="$color[titlebg]" width="4%" align="center"><font size="2" class="text1" color="$color[titletext]"><b>$txt[110]</b></font></td>
	<td class="titlebg" bgcolor="$color[titlebg]" width="4%" align="center"><font size="2" class="text1" color="$color[titletext]"><b>$txt[301]</b></font></td>
	<td class="titlebg" bgcolor="$color[titlebg]" width="27%"><font size="2" class="text1" color="$color[titletext]"><b>$txt[111]</b></font></td>
EOT;

	// Grab the appropriate topic information
	if ($modSettings['enableStickyTopics'] == '1')
		$result = mysql_query("SELECT t.ID_LAST_MSG,t.ID_TOPIC,t.numReplies,t.locked,m.posterName,m.ID_MEMBER,t.numViews,m.posterTime,m.modifiedTime,t.ID_FIRST_MSG,t.isSticky,t.ID_POLL,mes.posterName as mname,mes.ID_MEMBER as mid,mes.subject as msub,mes.icon as micon FROM {$db_prefix}topics as t, {$db_prefix}messages as m, {$db_prefix}messages as mes WHERE (t.ID_BOARD=$currentboard AND m.ID_MSG=t.ID_LAST_MSG AND mes.ID_MSG=t.ID_FIRST_MSG) ORDER BY t.isSticky DESC, m.posterTime DESC LIMIT $start,$maxindex");
	else
		$result = mysql_query("SELECT t.ID_LAST_MSG,t.ID_TOPIC,t.numReplies,t.locked,m.posterName,m.ID_MEMBER,t.numViews,m.posterTime,m.modifiedTime,t.ID_FIRST_MSG,t.isSticky,t.ID_POLL,mes.posterName as mname,mes.ID_MEMBER as mid,mes.subject as msub,mes.icon as micon FROM {$db_prefix}topics as t, {$db_prefix}messages as m,{$db_prefix}messages as mes WHERE (t.ID_BOARD=$currentboard AND m.ID_MSG=t.ID_LAST_MSG AND mes.ID_MSG=t.ID_FIRST_MSG) ORDER BY m.posterTime DESC LIMIT $start,$maxindex");


	// Begin printing the message index for current board.
	while ($row = mysql_fetch_array($result))
	{
		if ($row['ID_POLL'] != '-1' && $modSettings['pollMode']==0)
			continue;
		$lastposter = $row['posterName'];
		$lastPosterID = $row['ID_MEMBER'];
		$mdate = $row['posterTime'];
		$mname = $row['mname'];
		$mid = $row['mid'];
		$msub = $row['msub'];
		$micon=$row['micon'];
		$mnum = $row['ID_TOPIC'];
		$mreplies = $row['numReplies'];
		$mstate = $row['locked'];
		$views = $row['numViews'];
		$isSticky = $row['isSticky'];
		$pollID = $row['ID_POLL'];
		$topicEditedTime = $row['posterTime'];
		if ($lastPosterID != '-1') {
			LoadRealName ($lastposter);
			$name1 = $realNames[$lastposter];
		}
		if ($mid != '-1') {
			LoadRealName ($mname);
			$name2 = $realNames[$mname];
		}

		// Set thread class depending on locked status and number of replies.
		if( $mstate == 1 || $mstate==2 ) { $threadclass = 'locked'; }
		elseif( $mreplies > 24 ) { $threadclass = 'veryhotthread'; }
		elseif( $mreplies > 14 ) { $threadclass = 'hotthread'; }
		elseif( $mstate == 0) { $threadclass = 'thread'; }
		if ($modSettings['enableStickyTopics'] == '1' && $isSticky == '1') {$threadclass = 'sticky'; }
		if (($mstate == 1 || $mstate==2 )&&($modSettings['enableStickyTopics'] == '1' && $isSticky == '1')) {$threadclass='lockedsticky';}
		if ($modSettings['pollMode']=='1' && $pollID != '-1') { $threadclass = 'poll'; }
		if ($modSettings['pollMode']=='1' && $pollID != '-1' && ( $mstate == 1 || $mstate==2 )) {$threadclass = 'locked_poll'; }

		// Decide if thread should have the "NEW" indicator next to it.
		// Do this by reading the user's log for last read time on thread,
		// and compare to the last post time on the thread.
		$new = true;
		$request = mysql_query("SELECT logTime FROM {$db_prefix}log_topics WHERE (ID_TOPIC=$mnum && memberName='$username' && logTime>=$topicEditedTime) LIMIT 1");
		if (mysql_num_rows($request) == 0)
		{
			$request = mysql_query("SELECT logTime FROM {$db_prefix}log_mark_read WHERE (ID_BOARD=$currentboard && memberName='$username' && logTime>=$topicEditedTime)");
			if (mysql_num_rows($request) != 0)
				$new = false;
		}
		else
			$new = false;

		if (!$new || $username=='Guest')
			$new = '';
		else
			$new = "<img src=\"$imagesdir/new.gif\" alt=$txt[302]\">";

		if ($mid != -1)
			$mname = "<a href=\"$scripturl?action=viewprofile;user=$mname\"><acronym title=\"$txt[92] $name2\">$name2</acronym></a>";

		// Censor the subject of the thread.
		foreach ($censored as $tmpa => $tmpb)
			$msub = str_replace($tmpa,$tmpb,$msub);

		// Decide how many pages the thread should have.
		$threadlength = $mreplies + 1;
		$pages = '';
		if( $threadlength > $maxmessagedisplay ) {
			$tmppages = array();
			$tmpa = 1;
			for( $tmpb = 0; $tmpb < $threadlength; $tmpb += $maxmessagedisplay ) {
				$tmppages[] = "<a href=\"$cgi;action=display;threadid=$mnum;start=$tmpb\">$tmpa</a>";
				++$tmpa;
			}
			if (sizeof($tmppages) <= 5 ) {	// should we show links to ALL the pages?
				$pages = implode(" ",$tmppages);
				$pages = "<font size=\"1\">&#171; $pages &#187;</font>";
			} else {						// or should we skip some?
				$s1 = sizeof($tmppages)-1;
				$s2 = sizeof($tmppages)-2;
				$pages = "<font size=\"1\">&#171; $tmppages[0] $tmppages[1] ... $tmppages[$s2] $tmppages[$s1] &#187;</font>";
			}
		}

		if ($lastPosterID != -1)
			$lastposter = "<a href=\"$scripturl?action=viewprofile;user=$lastposter\">$name1</a>";

		# Print the thread info.
		$mydate = timeformat($mdate);
		print <<<EOT
<tr>
	<td class="windowbg2" valign="middle" align="center" width="6%" bgcolor="$color[windowbg2]"><img src="$imagesdir/$threadclass.gif" alt=""></td>
	<td class="windowbg2" valign="middle" align="center" width="4%" bgcolor="$color[windowbg2]"><img src="$imagesdir/$micon.gif" alt="" border="0" align="middle"></td>
	<td class="windowbg" valign="middle" width="48%" bgcolor="$color[windowbg]"><font size="2"><a href="$cgi;action=display;threadid=$mnum">$msub</a> $new $pages</font></td>
	<td class="windowbg2" valign="middle" width="14%" bgcolor="$color[windowbg2]"><font size="2">$mname</font></td>
	<td class="windowbg" valign="middle" width="4%" align="center" bgcolor="$color[windowbg]"><font size="2">$mreplies</font></td>
	<td class="windowbg" valign="middle" width="4%" align="center" bgcolor="$color[windowbg]"><font size="2">$views</font></td>
	<td class="windowbg2" valign="middle" width="27%" bgcolor="$color[windowbg2]"><font size="1">$mydate<br>$txt[525] $lastposter</font></td>
</tr>
EOT;
	}
	print <<<EOT
</table>
</td></tr></table>
<table border="0" width="100%" cellspacing="0" cellpadding="0" bgcolor="$color[bordercolor]" class="bordercolor"><tr><td>
<table width="100%" border="0" cellpadding="3" cellspacing="1" bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
    <td align="left" class="catbg" bgcolor="$color[catbg]" width="100%"  height="30">
    <table cellpadding="3" cellspacing="0" width="100%">
      <tr>
        <td><font size="2"><b>$txt[139]:</b> $pageindex</font></td>
	<td class="catbg" bgcolor="$color[catbg]" align="right"><font size="-1">
EOT;
if($username != 'Guest') {
if($showmarkread) { 
	print "	<a href=\"$cgi;action=markasread\">$img[markboardread]</a>";
}
}
	$selecthtml = jumpto();
	$polllegend = ($modSettings['pollMode']=='1')?"<br><img src=\"$imagesdir/poll.gif\" alt=\"\"> <font size=1>$txt[yse43]</font>":'';
	$stickylegend = ($modSettings['enableStickyTopics'] == '1')?"<br><img src=\"$imagesdir/sticky.gif\" alt=\"\"> <font size=1>$txt[yse96]</font>":'';
	$lockedstickylegend = ($modSettings['enableStickyTopics'] == '1')?"<br><img src=\"$imagesdir/lockedsticky.gif\" alt=\"\"> <font size=1>$txt[yse97]</font>":'';
	$lockedpolllegend = ($modSettings['pollMode']=='1')?"<br><img src=\"$imagesdir/locked_poll.gif\" alt=\"\"> <font size=1>$txt[yse98]</font>":'';

	print <<<EOT
	$menusep<a href="$cgi;action=post;title=$txt[464]">$img[newthread]</a>$newPollIcon&nbsp;
	</font></td>
      </tr>
    </table>
    </td>
  </tr>
</table>
</td></tr></table>
<table cellpadding="0" cellspacing="0" width="100%">
EOT;
  if ($modSettings['enableInlineLinks'])
    echo "<tr>\n 	<td colspan=\"3\" valign=\"bottom\">$displayLinkTree<br><br></td>\n </tr>";
print <<<EOT
  <tr>
    <td align="left" valign="middle">
    <img src="$imagesdir/hotthread.gif" alt=""> <font size="1">$txt[454]</font>
    <BR><img src="$imagesdir/veryhotthread.gif" alt=""> <font size="1">$txt[455]</font>$stickylegend$polllegend</td>
    <td align="left" valign="middle">
    <img src="$imagesdir/locked.gif" alt=""> <font size="1">$txt[456]</font>
    <BR><img src="$imagesdir/thread.gif" alt=""> <font size="1">$txt[457]</font>$lockedstickylegend$lockedpolllegend</td>
    <td align="right" valign="middle"><form action="$scripturl" method="GET">
    <font size="1">$txt[160]:</font>$selecthtml</form></td>
  </tr>
</table>
EOT;
	footer();
	obExit();
}

function MarkRead() {
	# Mark all threads in this board as read.
	global $currentboard,$username,$db_prefix;
	$request = mysql_query("SELECT logTime FROM {$db_prefix}log_mark_read WHERE (ID_BOARD=$currentboard && memberName='$username')");
	if (mysql_num_rows($request) == 0)
		$request = mysql_query("INSERT INTO {$db_prefix}log_mark_read (logTime,ID_BOARD,memberName) VALUES (".time().",$currentboard,'$username')");
	else
		$request = mysql_query("UPDATE {$db_prefix}log_mark_read SET logTime=".time()." WHERE (ID_BOARD=$currentboard && memberName='$username')");

	MessageIndex();
	obExit();
}
?>
file|^|Sources/ModifyMessage.php|^|15646|^|1008798080
<?php
/*****************************************************************************/
/* ModifyMessage.php                                                         */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$modifymessageplver="YaBB SE";

function ModifyMessage (){
	global $username,$ID_MEMBER,$currentboard,$yytitle,$txt,$color,$cgi,$imagesdir,$img,$threadid,$msg,$modSettings;
	global $moderators,$settings,$ubbcjspath,$color,$enable_ubbc,$showyabbcbutt,$start,$sourcedir,$db_prefix;
	if($username == 'Guest') { fatal_error($txt[223]); }
	if( $currentboard == '' ) { fatal_error($txt[1]); }
	
	$request = mysql_query("SELECT m.*,t.locked FROM {$db_prefix}messages as m, {$db_prefix}topics as t WHERE (m.ID_MSG=$msg AND m.ID_TOPIC=t.ID_TOPIC) LIMIT 1");
	$row = mysql_fetch_assoc($request);
	if( $row['locked'] == 1 )
		fatal_error($txt[90]);

	$yytitle = $txt[66];

	if($row['ID_MEMBER'] != $ID_MEMBER && !in_array($username,$moderators) && $settings[7] != 'Administrator' && $settings[7] != 'Global Moderator' )
		fatal_error($txt[67]);

	$lastmodification = isset($row['modifiedTime'])? timeformat($row['modifiedTime']) : '-';
	$nosmiley = $row['smiliesEnabled'] ? '' : ' checked';

	$row['body'] = str_replace("<br>","\n",$row['body']);

	# Attachment stuff added by Meriadoc
if ($modSettings['attachmentEnable'] == 0)
{
	$attachmentFields = "";			// if attachments are disabled, don't show anything
}
elseif ($modSettings['attachmentEnable'] == 1)
{
	if($row['attachmentSize'] > 0)	// if there is an attachment show only delete
	{
$attachmentFields = "
	<tr>
      <td align=\"right\"><font size=2><b>$txt[yse119]:</b></font><BR><BR></td>
      <td><input type=hidden name=\"attachOld\" value=\"$row[attachmentFilename]\"><input type=checkbox name=\"delAttach\"><font size=1>$txt[yse130]</font><BR><BR></td>
</tr>";
	}
	else
	{
$attachmentFields = "
<tr>
      <td align=\"right\"><font size=2><b>$txt[yse119]:</b></font><BR><BR></td>
      <td><input type=file name=\"attachment\" size=48>
      <br><font size=1>$txt[yse120]: $modSettings[attachmentExtensions]<br>$txt[yse121]: $modSettings[attachmentSizeLimit] KB<Br>$txt[yse129]</font><BR><BR></td>
</tr>";
	}
}
elseif ($modSettings['attachmentEnable'] == 2)
{
	if($row['attachmentSize'] > 0)	// if there is an attachment show only delete
	{
$attachmentFields = "
	<tr>
      <td align=\"right\"><font size=2><b>$txt[yse119]:</b></font><BR><BR></td>
      <td><input type=hidden name=\"attachOld\" value=\"$row[attachmentFilename]\"><input type=checkbox name=\"delAttach\"><font size=1>$txt[yse130]</font><BR><BR></td>
</tr>";
	}
}

if($modSettings['attachmentMemberGroups']!="") {
	if(!in_array($settings[7],explode(",",trim($modSettings['attachmentMemberGroups'])))) {
		$attachmentFields = "";
	}
}

	template_header();
	print <<<EOT
<script language="JavaScript1.2" src="$ubbcjspath" type="text/javascript"></script>

<script language="JavaScript1.2" type="text/javascript">
<!--
function showimage()
{
	document.images.icons.src="$imagesdir/"+document.postmodify.icon.options[document.postmodify.icon.selectedIndex].value+".gif";
}
//-->
</script>
<form action="$cgi;action=modify2;start=$start" method=post name="postmodify" onSubmit="submitonce(this);" enctype="multipart/form-data">
<table border=0  width="75%" align="center" cellpadding="3" cellspacing=1 bgcolor="$color[bordercolor]" class="bordercolor">
<tr>
	<td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$txt[66]</b></font></td>
</tr>
<tr>
	<td class="windowbg" bgcolor="$color[windowbg]">
<input type=hidden name="postid" value="$msg">
<input type=hidden name="threadid" value="$threadid">
<table border="0" cellpadding="3">
<tr>
	<td align="right"><font size=2><b>$txt[68]:</b></font></td>
	<td><font size=2>$row[posterName]</font></td>
</tr>
<tr>
	<td align="right"><font size=2><b>$txt[69]:</b></font></td>
	<td><font size=2>$row[posterEmail]</font></td>
</tr>
<tr>
	<td align="right"><font size=2><b>$txt[70]:</b></font></td>
	<td><font size=2><input type=text name="subject" value="$row[subject]" size="40" maxlength="80"></font></td>
</tr>
<tr>
	<td align="right"><font size=2><b>$txt[71]:</b></font></td>
	<td>
<select name="icon" onChange="showimage()">
	<option value="$row[icon]">$txt[112]
	<option value="$row[icon]">------------
	<option value="xx">$txt[281]
	<option value="thumbup">$txt[282]
	<option value="thumbdown">$txt[283]
	<option value="exclamation">$txt[284]
	<option value="question">$txt[285]
	<option value="lamp">$txt[286]
	<option value="smiley">$txt[287]
	<option value="angry">$txt[288]
	<option value="cheesy">$txt[289]
	<option value="laugh">$txt[290]
	<option value="sad">$txt[291]
	<option value="wink">$txt[292]
	</select>
	<img src="$imagesdir/$row[icon].gif" name="icons" border=0 hspace=15 alt=""></td>
</tr>
EOT;
include_once("$sourcedir/Post.php");
printPostBox ($row['body']);

print <<<EOT
<tr>
	<td valign=top align="right"><font size=2><b>$txt[211]:</b></font></td>
	<td><font size=2>$lastmodification</font></td>
</tr>
<tr>
      <td align="right"><font size=2><b>$txt[276]:</b></font><BR><BR></td>
      <td><font size=2><input type=checkbox name="ns" value="NS"$nosmiley></font>
      <font size=1>$txt[277]</font><BR><BR></td>
</tr>
$attachmentFields
<tr>
	<td align=center colspan=2>
	<input type="hidden" name="waction" value="postmodify">
	<input type="hidden" name="posterName" value="$row[posterName]">
	<input type="submit" name="postmodify" value="$txt[10]" onClick="WhichClicked('postmodify');"  accesskey="s">
	<input type="submit" name="previewmodify" value="$txt[507]" onClick="WhichClicked('previewmodify');">
	<input type="reset" value="$txt[278]">
	</td>
</tr>
</table>
</td>
</tr>
</table>
</form>
EOT;
	footer();
	obExit();
}

function ModifyMessage2 (){
	global $username,$txt,$ID_MEMBER,$cgi,$yySetLocation,$waction,$d,$postid,$threadid,$db_prefix;
	global $moderators,$name,$email,$subject,$icon,$message,$ns,$MaxMessLen,$maxmessagedisplay;
	global $currentboard,$settings,$msg,$realname,$start,$posterName,$sourcedir,$doLimitOne,$attachOld;
	global $attachment,$attachment_size,$attachment_name,$HTTP_POST_FILES,$delAttach,$modSettings;
	# Validate the attachment if there is one
	# By Meriadoc 12/11-14/2001

// change all ' ' to '_'
$HTTP_POST_FILES['attachment']['name'] = str_replace(' ','_',$HTTP_POST_FILES['attachment']['name']);
// remove all special chars
$HTTP_POST_FILES['attachment']['name'] = preg_replace("/[^\w_.-]/","",$HTTP_POST_FILES['attachment']['name']);

if($delAttach=='on') {
	unlink($modSettings['attachmentUploadDir'] . "/" . $attachOld);
}
elseif($HTTP_POST_FILES['attachment']['name'] != '') {
		if($HTTP_POST_FILES['attachment']['size'] > $modSettings['attachmentSizeLimit'] * 1024) { fatal_error("$txt[yse122] $modSettings[attachmentSizeLimit]."); }
		if($modSettings['attachmentCheckExtensions'] == "1") {
			if (!in_array(strtolower(substr(strrchr($HTTP_POST_FILES['attachment']['name'], '.'), 1)),explode(",",strtolower($modSettings['attachmentExtensions'])))) {
				fatal_error("$HTTP_POST_FILES[attachment][name].<br>$txt[yse123] $modSettings[attachmentExtensions].");
			}
		}
		// make sure they aren't trying to upload a nasty file
		$disabledFiles = array('CON','COM1','COM2','COM3','COM4','PRN','AUX','LPT1');
		if (in_array(strtoupper(substr(strrchr($HTTP_POST_FILES['attachment']['name'], '.'), 1)),$disabledFiles)) {
				fatal_error("$HTTP_POST_FILES[attachment][name].<br>$txt[yse130b].");
		}
		if(file_exists($modSettings['attachmentUploadDir'] . "/" . $HTTP_POST_FILES['attachment']['name'])) { $attachCancel=1; }

		if(!isset($attachCancel)) {
			$dirSize = "0";
			$dir=opendir($modSettings['attachmentUploadDir']);
			while($file=readdir($dir)) {
				$dirSize = $dirSize + filesize($modSettings['attachmentUploadDir'] . "/" .$file);
			}
			if($HTTP_POST_FILES['attachment']['size'] + $dirSize > $modSettings['attachmentDirSizeLimit'] * 1024) { fatal_error($txt['yse126']); }

			$parts = isset($HTTP_POST_FILES['attachment']) ? preg_split("~(\\|/)~",$HTTP_POST_FILES['attachment']['name']) : array();
			$destName = array_pop($parts);

			if(!move_uploaded_file($HTTP_POST_FILES['attachment']['tmp_name'], $modSettings['attachmentUploadDir'] . "/" . $destName)) { fatal_error("$txt[yse124]"); }
			chmod ("$modSettings[attachmentUploadDir]/$destName",0644) || $chmod_failed = 1;
		}
}



	$smilies = ($ns!='')?0:1;
	if($username == 'Guest') { fatal_error($txt[223]); }

	if (trim($subject=='') && $d != '1')
		fatal_error($txt[77]);
	if (trim($message=='') && $d != '1')
		fatal_error($txt[78]);

	if($waction == 'previewmodify' ) {
		include_once("$sourcedir/Post.php");
		Preview();
	}

    $message = preparsecode($message, $realname, $username);

	$deletepost = (isset($d) || $waction == 'deletemodify');

	if( $deletepost ) {
		if( $waction == 'deletemodify' ) {
			$msg = $postid;
		}
		$postid = $msg;
	}

	$yySetLocation = "$cgi&action=display&threadid=$threadid&start=$start";

	$request = mysql_query("SELECT m.*,t.locked,t.ID_FIRST_MSG,t.ID_LAST_MSG,t.ID_TOPIC,t.ID_BOARD,t.ID_POLL FROM {$db_prefix}messages as m, {$db_prefix}topics as t WHERE (m.ID_MSG=$postid AND m.ID_TOPIC=t.ID_TOPIC) LIMIT 1");
	$row = mysql_fetch_assoc($request);
	if(($settings[7] != 'Administrator') && ($settings[7] != 'Global Moderator') && !in_array($username,$moderators) && $row['ID_MEMBER'] != $ID_MEMBER) {
		fatal_error($txt[67]);
	}
	if( $row['locked'] == 1 )
		fatal_error($txt[90]);

	# Make sure the user is allowed to edit this post.
	if($row['ID_MEMBER'] != $ID_MEMBER && !in_array($username,$moderators) && $settings[7] != 'Administrator' && $settings[7] != 'Global Moderator' )
		fatal_error($txt[67]);

	if( $row['locked'] == 1 )
		fatal_error($txt[90]);

	if( $deletepost ) {
		if( $row['ID_MEMBER'] != '-1')
			$request = mysql_query("UPDATE {$db_prefix}members SET posts=posts-1 WHERE (ID_MEMBER=$row[ID_MEMBER] && posts > 0) $doLimitOne");

		if ($row['ID_FIRST_MSG']==$row['ID_LAST_MSG'])	// this is the only post
		{
			$request = mysql_query("DELETE FROM {$db_prefix}topics WHERE ID_TOPIC=$row[ID_TOPIC] LIMIT 1");
			$request = mysql_query("DELETE FROM {$db_prefix}polls WHERE ID_POLL='$row[ID_POLL]' LIMIT 1");
			$request = mysql_query("UPDATE {$db_prefix}boards SET numPosts=numPosts-1,numTopics=numTopics-1 WHERE ID_BOARD=$row[ID_BOARD] $doLimitOne");
			$yySetLocation = "$cgi";
		}
		else if ($row['ID_FIRST_MSG']==$row['ID_MSG'])	// this is the first message
		{
			$request = mysql_query("SELECT ID_MSG FROM {$db_prefix}messages WHERE (ID_TOPIC=$row[ID_TOPIC] AND ID_MSG!=$row[ID_MSG]) ORDER BY ID_MSG LIMIT 1");
			$row2 = mysql_fetch_assoc($request);
			$request = mysql_query("UPDATE {$db_prefix}topics SET ID_FIRST_MSG=$row2[ID_MSG],numReplies=numReplies-1 WHERE ID_TOPIC=$row[ID_TOPIC] $doLimitOne");
			$request = mysql_query("UPDATE {$db_prefix}boards SET numPosts=numPosts-1 WHERE ID_BOARD=$row[ID_BOARD] $doLimitOne");
		}
		else if ($row['ID_LAST_MSG']==$row['ID_MSG'])	// this is the last message
		{
			$request = mysql_query("SELECT ID_MSG FROM {$db_prefix}messages WHERE (ID_TOPIC=$row[ID_TOPIC] AND ID_MSG!=$row[ID_MSG]) ORDER BY ID_MSG DESC LIMIT 1");
			$row2 = mysql_fetch_assoc($request);
			$request = mysql_query("UPDATE {$db_prefix}topics SET ID_LAST_MSG=$row2[ID_MSG],numReplies=numReplies-1 WHERE ID_TOPIC=$row[ID_TOPIC] $doLimitOne");
			$request = mysql_query("UPDATE {$db_prefix}boards SET numPosts=numPosts-1 WHERE ID_BOARD=$row[ID_BOARD] $doLimitOne");
		}
		else // this is just "some" message
		{
			$request = mysql_query("UPDATE {$db_prefix}topics SET numReplies=numReplies-1 WHERE ID_TOPIC=$row[ID_TOPIC] $doLimitOne");
			$request = mysql_query("UPDATE {$db_prefix}boards SET numPosts=numPosts-1 WHERE ID_BOARD=$row[ID_BOARD] $doLimitOne");
		}
		$request = mysql_query("DELETE FROM {$db_prefix}messages WHERE ID_MSG=$postid LIMIT 1");
		#delete attachment, by Meriadoc
		if ($row['attachmentSize'] > 0)
			unlink($modSettings['attachmentUploadDir'] . "/" . $row['attachmentFilename']);
	}
	else {
		# If the post is to be modified...

		if (!isset($message)){ fatal_error($txt[78]); }
		if (!isset($subject)){ fatal_error($txt[77]); }
		if (strlen($message)>$MaxMessLen) { fatal_error($txt[499]); }

		$subject = htmlspecialchars($subject);
		$subject = str_replace("|","&#124;",$subject);

		$message = htmlspecialchars($message);
		$message = str_replace("|","&#124;",$message);
		$message = str_replace("\r\n","<br>",$message);
		$message = str_replace("\c","<br>",$message);
		$message = str_replace("\t","&nbsp;&nbsp;&nbsp;",$message);

		$request = mysql_query("UPDATE {$db_prefix}messages SET subject='$subject',icon='$icon',body='$message',modifiedTime=".time().",modifiedName='$realname',smiliesEnabled=$smilies WHERE ID_MSG=$postid $doLimitOne");

		# update for the attachments
		if($delAttach=='on') {
			$request = mysql_query("UPDATE {$db_prefix}messages SET attachmentSize='0',attachmentFilename=NULL WHERE ID_MSG=$postid $doLimitOne");
		}
		elseif($attachment_size!='') {
			$request = mysql_query("UPDATE {$db_prefix}messages SET attachmentSize='$attachment_size',attachmentFilename='".mysql_escape_string($HTTP_POST_FILES['attachment']['name'])."' WHERE ID_MSG=$postid $doLimitOne");
		}

	}
	// markt the topic as read :)
	$request = mysql_query("SELECT logTime FROM {$db_prefix}log_topics WHERE (memberName='$username' AND ID_TOPIC=$threadid) LIMIT 1");
	if (mysql_num_rows($request)==0)
		$request = mysql_query("INSERT INTO {$db_prefix}log_topics (logTime,memberName,ID_TOPIC) VALUES (".time().",'$username',$threadid)");
	else
		$request = mysql_query("UPDATE {$db_prefix}log_topics SET logTime=".time()." WHERE (memberName='$username' AND ID_TOPIC=$threadid)");

	redirectexit();
}

?>file|^|Sources/ModSettings.php|^|20282|^|1008718710
<?php
/*****************************************************************************/
/* ModSettings.php                                                           */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$modsettingsphpver = "YaBB SE";

function ModifyModSettings() {
	global $txt,$img,$yytitle,$cgi,$imagesdir,$color,$mtxt,$modSettings,$db_prefix;
	$yytitle = $txt['yse2'];
	template_header();
	$stickyTopicsChecked = ($modSettings['enableStickyTopics']=='1')?' checked':'';
	$todayModChecked = ($modSettings['todayMod']=='1')?' checked':'';
	$previousNextModChecked = ($modSettings['enablePreviousNext']=='1')?' checked':'';
	$enableVBStyleLoginChecked = ($modSettings['enableVBStyleLogin'] == '1')?' checked':'';
	$enableCompressedOutputChecked = ($modSettings['enableCompressedOutput'] == '1')?' checked':'';
	$disableCachingChecked = ($modSettings['disableCaching'] == '1')?' checked':'';
	$enableInlineLinksChecked = ($modSettings['enableInlineLinks'] == '1')?' checked':'';
	$enableSP1Info = ($modSettings['enableSP1Info'] == '1')?' checked':'';

	$pollModeDisabled = ($modSettings['pollMode']=='0')?' selected':'';
	$pollModeEnabled = ($modSettings['pollMode']=='1')?' selected':'';
	$pollModeTopics = ($modSettings['pollMode']=='2')?' selected':'';

	$pollRestrictionsNone = ($modSettings['pollPostingRestrictions']=='0')?' selected':'';
	$pollRestrictionsAdminOnly = ($modSettings['pollPostingRestrictions']=='1')?' selected':'';

	$pollEditModeAdmin = ($modSettings['pollEditMode']=='0')?' selected':'';
	$pollEditModeMods = ($modSettings['pollEditMode']=='1')?' selected':'';
	$pollEditModeStarter = ($modSettings['pollEditMode']=='2')?' selected':'';

	$karmaModeDisabled = ($modSettings['karmaMode']=='0')?' selected':'';
	$karmaModeTotal = ($modSettings['karmaMode']=='1')?' selected':'';
	$karmaModePosNeg = ($modSettings['karmaMode']=='2')?' selected':'';
	$karmaModes = explode("|",$txt['yse64']);
	$karmaLabels = explode("|",$txt['yse69']);
	$karmaTRAChecked = ($modSettings['karmaTimeRestrictAdmins'] == '1')?' checked':'';
	$karmaMemberGroups = implode(",",$modSettings['karmaMemberGroups']);

	//Attachment variables added by Meriadoc 12/11/2001
	$attachModeDisabled = ($modSettings['attachmentEnable']=='0')?' selected':'';
	$attachModeEnable = ($modSettings['attachmentEnable']=='1')?' selected':'';
	$attachModeNoNew = ($modSettings['attachmentEnable']=='2')?' selected':'';
	$attachModes = explode("|",$txt['yse111']);
	$attachCheckExten = ($modSettings['attachmentCheckExtensions']=='1')?' checked':'';
	$attachGuest = ($modSettings['attachmentEnableGuest']=='1')?' checked':'';
	$attachShow = ($modSettings['attachmentShowImages']=='1')?' checked':'';

	$request = mysql_query("SELECT membergroup FROM {$db_prefix}membergroups WHERE (ID_GROUP=1 OR ID_GROUP > 7)");
	$membergrps = '';
	while ($row = mysql_fetch_row($request))
		$membergrps .= "<option>".trim($row[0])."</option>";

	print <<<EOT
<form action="$cgi;action=modifyModSettings2" method="POST" name="form1">
<table width="80%" border="0" cellspacing="1" cellpadding="0" bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
  <td>
  <table border="0" cellspacing="0" cellpadding="4" align="center" width="100%">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]" colspan="2">
    <script language="javascript" TYPE="text/javascript">
		<!--
		function reqWin(desktopURL){
        desktop =window.open(desktopURL,"name","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,width=400,height=200,resizable=no");
        }
		function memberGroups(theForm)
		{
		if (window.popup)
			popup.close();
		popup = window.open("","membergroups","toolbar=no,location=no,status=no,menubar=no,scrollbars=no,width=280,height=300,resizable=no");
		popup.document.write("<html><head><title>$txt[57]</title>\\n");
		popup.document.write("<script language='javascript' TYPE='text/javascript'>\\n");
		popup.document.write("function changeSelectedGroups(listObject) {\\n");
		popup.document.write("var newMemberGroups = '';\\n");
		popup.document.write("for (var i = 0; i < listObject.length; i++){\\n");
		popup.document.write("if (listObject.options[i].selected){\\n");
		popup.document.write("newMemberGroups += listObject.options[i].text +',';\\n");
		popup.document.write("}\\n}\\n");
		popup.document.write("if (newMemberGroups.length > 0){\\n");
		popup.document.write("newMemberGroups=newMemberGroups.substr(0,newMemberGroups.length-1)");
		popup.document.write("}\\nwindow.opener.form1."+theForm+".value=newMemberGroups;\\n}");
		popup.document.write("\\n</script>\\n</head>\\n<body>\\n");
		popup.document.write("<font face='verdana,arial' size=2><b>$txt[57]</b><br>$txt[yse55]\\n");
		popup.document.write("<p align=center><form name='form1'><select size=6 name='myOptions' multiple onchange='changeSelectedGroups(this)'>\\n");
		popup.document.write("$membergrps\\n");
		popup.document.write("</select><br> <br> <input type=button onclick=\"window.close()\" value=\"$txt[17]\"></form></p></font></body></html>");
		}
		// -->
	</script>
    <a href="javascript:reqWin('help.php?help=10')" class="help"><img src="$imagesdir/helptopics.gif" border="0" alt="$txt[119]"></a>
    <font size="2" class="text1" color="$color[titletext]"><b>$txt[yse2]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]" colspan="2"><BR><font size="1">$txt[yse3]</font><BR><BR></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse4]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=checkbox name="stickyTopicsChecked" $stickyTopicsChecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]" colspan=2><HR size="1" width="100%" class="windowbg3"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse9]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=checkbox name="todayModChecked" $todayModChecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]" colspan=2><HR size="1" width="100%" class="windowbg3"></td>
  </tr><tr>
	<td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse17]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=checkbox name="previousNextModChecked" $previousNextModChecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse18]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=text name="PreviousNext_back" value="$modSettings[PreviousNext_back]"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse19]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=text name="PreviousNext_forward" value="$modSettings[PreviousNext_forward]"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]" colspan=2><HR size="1" width="100%" class="windowbg3"></td>
  </tr><tr>
	<td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse35]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><select name="pollMode"><option value="0" $pollModeDisabled>$txt[yse34]</option><option value="1" $pollModeEnabled>$txt[yse32]</option><option value="2" $pollModeTopics>$txt[yse33]</option></select></td>
  </tr><tr>
	<td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse36]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><select name="pollPostingRestrictions"><option value="0" $pollRestrictionsNone>$txt[yse38]</option><option value="1" $pollRestrictionsAdminOnly>$txt[yse37]</option></select></td>
  </tr><tr>
	<td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse44]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><select name="pollEditMode"><option value="0" $pollEditModeAdmin>$txt[yse37]</option><option value="1" $pollEditModeMods>$txt[yse45]</option><option value="2" $pollEditModeStarter>$txt[yse46]</option></select></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]" colspan=2><HR size="1" width="100%" class="windowbg3"></td>
  </tr><tr>
	<td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse51]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=checkbox name="enableVBStyleLoginChecked" $enableVBStyleLoginChecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]" colspan=2><HR size="1" width="100%" class="windowbg3"></td>
  </tr><tr>
	<td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse58]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=checkbox name="enableCompressedOutputChecked" $enableCompressedOutputChecked></td>
  </tr><tr>
	<td class="windowbg2" bgcolor="$color[windowbg2]">&nbsp;</td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="1">$txt[yse59]</font></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]" colspan=2><HR size="1" width="100%" class="windowbg3"></td>
  </tr><tr>
	<td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse103]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=checkbox name="disableCachingChecked" $disableCachingChecked></td>
  </tr><tr>
	<td class="windowbg2" bgcolor="$color[windowbg2]">&nbsp;</td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="1">$txt[yse104]</font></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]" colspan=2><HR size="1" width="100%" class="windowbg3"></td>
  </tr><tr>
	<td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse105]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=checkbox name="enableInlineLinksChecked" $enableInlineLinksChecked></td>
  </tr><tr>
	<td class="windowbg2" bgcolor="$color[windowbg2]">&nbsp;</td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="1">$txt[yse106]</font></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]" colspan=2><HR size="1" width="100%" class="windowbg3"></td>
  </tr><tr>
	<td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse200]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=checkbox name="enableSP1Info" $enableSP1Info></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]" colspan=2><HR size="1" width="100%" class="windowbg3"></td>
  </tr><tr>
	<td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse70]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><select name="karmaMode"><option value="0" $karmaModeDisabled>$karmaModes[0]</option><option value="1" $karmaModeTotal>$karmaModes[1]</option><option value="2" $karmaModePosNeg>$karmaModes[2]</option></select></td>
  </tr><tr>
	<td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse65]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=checkbox name="karmaTRAChecked" $karmaTRAChecked></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$karmaLabels[0]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=text name="karmaLabel" value="$modSettings[karmaLabel]"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$karmaLabels[1]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=text name="karmaSmiteLabel" value="$modSettings[karmaSmiteLabel]"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$karmaLabels[2]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=text name="karmaApplaudLabel" value="$modSettings[karmaApplaudLabel]"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse68]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=text name="karmaMemberGroups" value="$karmaMemberGroups"> <a href="javascript:memberGroups('karmaMemberGroups');"><img src="$imagesdir/assist.gif" border="0" alt=""></a></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse67]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=text name="karmaMinPosts" value="$modSettings[karmaMinPosts]"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse66]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=text name="karmaWaitTime" value="$modSettings[karmaWaitTime]"></td>
<!-- Added form inputs by Meriadoc 12/11/2001 -->
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]" colspan=2><HR size="1" width="100%" class="windowbg3"></td>
  </tr><tr>
	<td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse110]</font></td>
	<td class="windowbg2" bgcolor="$color[windowbg2]"><select name="attachmentEnable"><option value="0" $attachModeDisabled>$attachModes[0]</option><option value="1" $attachModeEnable>$attachModes[1]</option><option value="2" $attachModeNoNew>$attachModes[2]</option></select></td>
  </tr><tr>
	<td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse127]</font></td>
	<td class="windowbg2" bgcolor="$color[windowbg2]"><input type=checkbox name="attachGuest" $attachGuest></td>
  </tr><tr>
	<td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse113]</font></td>
	<td class="windowbg2" bgcolor="$color[windowbg2]"><input type=checkbox name="attachCheckExten" $attachCheckExten></td>
  </tr><tr>
	<td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse112]</font></td>
	<td class="windowbg2" bgcolor="$color[windowbg2]"><input type=checkbox name="attachShow" $attachShow></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse128]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=text name="attachmentMemberGroups" value="$modSettings[attachmentMemberGroups]"> <a href="javascript:memberGroups('attachmentMemberGroups');"><img src="$imagesdir/assist.gif" border="0" alt=""></a></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse114]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=text name="attachmentExtensions" value="$modSettings[attachmentExtensions]"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse115]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=text name="attachmentUploadDir" value="$modSettings[attachmentUploadDir]"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse116]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=text name="attachmentUrl" value="$modSettings[attachmentUrl]"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse117]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=text name="attachmentSizeLimit" value="$modSettings[attachmentSizeLimit]"></td>
  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><font size="2">$txt[yse118]</font></td>
    <td class="windowbg2" bgcolor="$color[windowbg2]"><input type=text name="attachmentDirSizeLimit" value="$modSettings[attachmentDirSizeLimit]"></td>

  </tr><tr>
    <td class="windowbg2" bgcolor="$color[windowbg2]" colspan="2" align="center" valign="middle">
    <HR size="1" width="100%" class="windowbg3"><input type="submit" value="$txt[10]">
    </td>
  </tr>
</table>
</td>
</tr>
</table>
</form>
EOT;
	footer();
	obExit();
}

function ModifyModSettings2()
{
	global $HTTP_POST_VARS,$db_prefix,$sourcedir,$doLimitOne;

	// let's do all the checkbox values....
	$onoffArray = array('stickyTopicsChecked'=>'enableStickyTopics', 'todayModChecked'=>'todayMod', 'previousNextModChecked'=>'enablePreviousNext', 'enableVBStyleLoginChecked'=>'enableVBStyleLogin', 'enableCompressedOutputChecked'=>'enableCompressedOutput', 'karmaTRAChecked'=>'karmaTimeRestrictAdmins', 'disableCachingChecked'=>'disableCaching', 'enableInlineLinksChecked'=>'enableInlineLinks', 'attachCheckExten'=>'attachmentCheckExtensions', 'attachGuest'=>'attachmentEnableGuest', 'attachShow'=>'attachmentShowImages', 'enableSP1Info'=>'enableSP1Info');

	foreach ($onoffArray as $check => $var)
	{
		$onoff = isset($HTTP_POST_VARS[$check]) ? 1 : 0;
		$request = mysql_query("UPDATE {$db_prefix}settings SET value=$onoff WHERE variable='$var' $doLimitOne");
	}

	// now let's do all the textfield/select values
	// set default values
	if (!isset($HTTP_POST_VARS['pollPostingRestrictions'])) { $HTTP_POST_VARS['pollPostingRestrictions']='0'; }
	if (!isset($HTTP_POST_VARS['pollMode'])) { $HTTP_POST_VARS['pollMode']='0'; }
	if (!isset($HTTP_POST_VARS['pollEditMode'])) { $HTTP_POST_VARS['pollEditMode']='0'; }
	if (!isset($HTTP_POST_VARS['PreviousNext_back'])) { $HTTP_POST_VARS['PreviousNext_back']='previous'; }
	if (!isset($HTTP_POST_VARS['PreviousNext_forward'])) { $HTTP_POST_VARS['PreviousNext_forward']='next'; }

	if (!isset($HTTP_POST_VARS['attachmentEnable'])) { $HTTP_POST_VARS['attachmentEnable']='0'; }
	if ($HTTP_POST_VARS['attachmentSizeLimit'] == "") { $HTTP_POST_VARS['attachmentSizeLimit']='0'; }
	if ($HTTP_POST_VARS['attachmentDirSizeLimit'] == "") { $HTTP_POST_VARS['attachmentDirSizeLimit']='0'; }
	if ($HTTP_POST_VARS['attachmentUrl'] == "") { $HTTP_POST_VARS['attachmentUrl']="$boardurl/attachments"; }
	if ($HTTP_POST_VARS['attachmentUploadDir'] == "") { $HTTP_POST_VARS['attachmentUploadDir']="$boarddir/attachments"; }

	$textVars = array('PreviousNext_back', 'PreviousNext_forward', 'pollMode', 'pollPostingRestrictions', 'pollEditMode', 'karmaMode', 'karmaLabel', 'karmaSmiteLabel', 'karmaApplaudLabel', 'karmaWaitTime', 'karmaMinPosts', 'karmaMemberGroups', 'attachmentEnable', 'attachmentSizeLimit', 'attachmentDirSizeLimit', 'attachmentUrl', 'attachmentUploadDir', 'attachmentExtensions', 'attachmentMemberGroups');

	foreach($textVars as $txtVar)
		$request = mysql_query("UPDATE {$db_prefix}settings SET value='$HTTP_POST_VARS[$txtVar]' WHERE variable='$txtVar' $doLimitOne");

	LoadUserSettings();
	WriteLog();
	include_once("$sourcedir/Admin.php");
	Admin();
}

?>file|^|Sources/MoveThread.php|^|5797|^|1008718712
<?
/*****************************************************************************/
/* MoveThread.php                                                            */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$movethreadplver="YaBB SE";

function MoveThread(){
	global $username,$moderators,$settings,$txt,$currentboard,$color,$cgi,$threadid,$ubbcjspath,$db_prefix;
	if (!in_array($username,$moderators) && $settings[7] != 'Administrator' && $settings[7] != 'Global Moderator') { fatal_error($txt[134]); }
	$yytitle = "$txt[132]";
	$boardlist="";
	$request = mysql_query("SELECT ID_BOARD, name FROM {$db_prefix}boards WHERE ID_BOARD != $currentboard");
	while ($row = mysql_fetch_assoc($request)){	
		$boardlist .= "<option value=\"$row[ID_BOARD]\">$row[name]</option>\n";
	}
	mysql_free_result($request);
	template_header();
	print <<<EOT
<script language="JavaScript1.2" src="$ubbcjspath" type="text/javascript"></script>
<table border="0" width="400" cellspacing="1" bgcolor="$color[bordercolor]" class="bordercolor" cellpadding="4" align="center">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$txt[132]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]" valgin="middle" align="center"><font size=2>
    <form action="$cgi&action=movethread2&threadid=$threadid" method="POST" onSubmit="submitonce(this);"><br>
	<table border=0><tr><td>
    <b>$txt[133]:</b><select name="toboard">$boardlist</select><br> <br>
	$txt[yse57]<br><textarea rows="3" cols="35" name="reason"></textarea><br> <br>
    <input type=submit value="$txt[132]">
    </td></tr></table>
	</form>
    </font></td>
  </tr>
</table>
EOT;
	footer();
	obExit();
}

function MoveThread2() {
	global $username,$moderators,$settings,$txt,$currentboard,$threadid,$scripturl,$toboard,$yySetLocation;
	global $db_prefix,$reason,$ID_MEMBER,$realemail,$REMOTE_ADDR,$board,$doLimitOne;
	if (!in_array($username,$moderators) && $settings[7] != 'Administrator' && $settings[7] != 'Global Moderator') { fatal_error($txt[134]); }

	if (!is_numeric($threadid)) { fatal_error($txt[337]); }
	
	$request = mysql_query("SELECT t.numReplies,m.subject FROM {$db_prefix}topics as t,{$db_prefix}messages as m WHERE (t.ID_TOPIC=$threadid && t.ID_FIRST_MSG=m.ID_MSG)");
	if (mysql_num_rows($request)==0) {
		fatal_error("This topic does not exist in the topics list");
	}
	$A_moved = mysql_fetch_assoc($request);
	mysql_free_result($request);
	$threadposts = $A_moved["numReplies"] + 1;
	
	$request = mysql_query("UPDATE {$db_prefix}topics SET ID_BOARD=$toboard WHERE ID_TOPIC=$threadid");
		
	$request = mysql_query("UPDATE {$db_prefix}boards SET numTopics=numTopics-1, numPosts=numPosts-$threadposts WHERE ID_BOARD = $currentboard");

	$request = mysql_query("UPDATE {$db_prefix}boards SET numTopics=numTopics+1, numPosts=numPosts+$threadposts WHERE ID_BOARD = $toboard");

	// create a link to this in the old board
	$request = mysql_query("INSERT INTO {$db_prefix}topics (ID_BOARD,ID_MEMBER_STARTED,ID_MEMBER_UPDATED,locked,numReplies,numViews,notifies) VALUES ('$board','$ID_MEMBER','$ID_MEMBER',1,0,0,'')");
	$remnantTopic = mysql_insert_id();
	$remnantSubject = addcslashes("$txt[yse56]: $A_moved[subject]","\"'");
	$reason .= "\n\n[url]$scripturl?board=$toboard;action=display;threadid={$threadid}[/url]";
	$request = mysql_query("INSERT INTO {$db_prefix}messages (ID_MEMBER,ID_TOPIC,subject,body,posterName,posterTime,posterEmail,posterIP,icon) VALUES ('$ID_MEMBER','$remnantTopic','$remnantSubject','$reason','$username','".time()."','$realemail','$REMOTE_ADDR','moved')");
	$remnantMsg = mysql_insert_id();
	$request = mysql_query("UPDATE {$db_prefix}topics SET ID_LAST_MSG='$remnantMsg',ID_FIRST_MSG='$remnantMsg' WHERE ID_TOPIC='$remnantTopic' $doLimitOne");

	$yySetLocation = "$scripturl?board=$toboard;action=display;threadid=$threadid;start=0";
	redirectexit();
}

?>file|^|Sources/Notify.php|^|8402|^|1008718714
<?php
/*****************************************************************************/
/* Reminder.php                                                              */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$notifyplver="YaBB SE";

function Notify (){
	global $board,$username,$txt,$cgi,$scripturl,$img,$imagesdir,$yytitle,$threadid,$ID_MEMBER,$start,$color,$db_prefix;
	if( $board == '' ) { fatal_error($txt[1]); }
	if($username == "Guest") { fatal_error("$txt[138]"); }
	$yytitle = "$txt[125]";
	template_header();

	$request = mysql_query("SELECT ID_TOPIC FROM {$db_prefix}topics WHERE (ID_TOPIC=$threadid && FIND_IN_SET('$ID_MEMBER',notifies) != 0) LIMIT 1");

	if (mysql_num_rows($request) != 0){

	print <<<EOT
<table border="0" width="100%" cellspacing="1" bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$txt[125]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]"><font size=2>
    $txt[212]<br>
    <b><a href="$cgi;action=notify3;threadid=$threadid;start=$start">$txt[163]</a> - <a href="$cgi;action=display;threadid=$threadid;start=$start">$txt[164]</a></b>
    </font></td>
  </tr>
</table>
EOT;

	}
	else
	{

	print <<<EOT
<table border="0" width="100%" cellspacing="1" bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$txt[125]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]"><font size=2>
    $txt[126]<br>
    <b><a href="$cgi;action=notify2;threadid=$threadid;start=$start">$txt[163]</a> - <a href="$cgi;action=display;threadid=$threadid;start=$start">$txt[164]</a></b>
    </font></td>
  </tr>
</table>
EOT;
	}

	footer();
	obExit();
}

function Notify2 (){
	global $board,$username,$txt,$start,$cgi,$ID_MEMBER,$yySetLocation,$threadid,$db_prefix,$doLimitOne;
	if ($board == '') { fatal_error($txt[1]); }
	if ($username == 'Guest') { fatal_error($txt[138]); }

	$request = mysql_query("SELECT notifies FROM {$db_prefix}topics WHERE (ID_TOPIC=$threadid) LIMIT 1");
	list ($notification) = mysql_fetch_row($request);
	$notifies = explode(",",$notification);
	$notifications2 = array();
	foreach ($notifies as $note) {
		if ($note!= $ID_MEMBER && $note!='')
			$notifications2[]=$note;
	}
	if (!in_array($ID_MEMBER,$notifications2)) {	
		$notifications2[] = $ID_MEMBER;
	}
	$notification = implode(",",$notifications2);
	$request = mysql_query("UPDATE {$db_prefix}topics SET notifies='$notification' WHERE ID_TOPIC=$threadid $doLimitOne");
	$yySetLocation = "$cgi;action=display;threadid=$threadid;start=$start";
	redirectexit();
}

function Notify3 (){
	global $board,$txt,$yySetLocation,$cgi,$ID_MEMBER,$username,$threadid,$db_prefix,$doLimitOne;
	if( $board == '' ) { fatal_error($txt[1]); }
	if($username == "Guest") { fatal_error($txt[138]); }

	$request = mysql_query("SELECT notifies FROM {$db_prefix}topics WHERE (ID_TOPIC=$threadid) LIMIT 1");
	list ($notification) = mysql_fetch_row($request);
	$notifies = explode(",",$notification);
	$notifications2 = array();
	foreach ($notifies as $note) {
		if ($note!= $ID_MEMBER && $note!='')
			$notifications2[]=$note;
	}
	$notification = implode(",",$notifications2);
	$request = mysql_query("UPDATE {$db_prefix}topics SET notifies='$notification' WHERE ID_TOPIC=$threadid $doLimitOne");
	$yySetLocation = "$cgi;action=display;threadid=$threadid;start=$start";
	redirectexit();
}

function Notify4 (){
	global $username,$txt,$HTTP_POST_VARS,$ID_MEMBER,$db_prefix,$doLimitOne;
	if($username == "Guest") { fatal_error($txt[138]); }

	foreach ($HTTP_POST_VARS as $key=>$value)
	{
		if (substr($key,0,6)=='topic-' && $value)
		{
			$topic = substr($key,6);
			$request = mysql_query("SELECT notifies FROM {$db_prefix}topics WHERE (ID_TOPIC=$topic) LIMIT 1");
			list ($notification) = mysql_fetch_row($request);
			$notifies = explode(",",$notification);
			$notifications2 = array();
			foreach ($notifies as $note) {
				if ($note!= $ID_MEMBER)
				$notifications2[]=$note;
			}
			$notification = implode(",",$notifications2);
			$request = mysql_query("UPDATE {$db_prefix}topics SET notifies='$notification' WHERE ID_TOPIC=$topic $doLimitOne");
		}
	}
	Shownotifications();
}

function Shownotifications (){
	global $username,$txt,$ID_MEMBER,$censored,$yytitle,$board,$color,$cgi,$scripturl,$db_prefix;
	if($username == "Guest") { fatal_error($txt[138]); }
	$request = mysql_query("SELECT t.ID_TOPIC,m.subject,m.posterName,m.ID_MEMBER FROM {$db_prefix}topics as t, {$db_prefix}messages as m WHERE (FIND_IN_SET($ID_MEMBER,t.notifies) != 0 && m.ID_MSG=t.ID_FIRST_MSG)");

	# Load Censor List
	LoadCensorList();
	
	$yytitle = "$txt[417]";
	template_header();

	print <<<EOT
<table border="0" width="100%" cellspacing="1" cellpadding="6" bgcolor="$color[bordercolor]" class="bordercolor">
 <tr>
  <td bgcolor="$color[titlebg]">
   <font size="2" color="$color[titletext]"><b>$txt[418]</b></font>
  </td>
 </tr><tr>
  <td bgcolor="$color[windowbg]">
   <br>
EOT;
	if (mysql_num_rows($request)==0)
		print "<font size=\"2\">$txt[414]<br><br>&nbsp;</font>";
	else
	{
		print "<form action=\"$cgi;action=notify4\" method=\"post\">";
		print "<table>\n";
		print "<tr><td colspan=2><font size=2>$txt[415]:</font><br>&nbsp;</td></tr>";

		while ($row = mysql_fetch_assoc($request))
		{
			foreach ($censored as $tmpa=>$tmpb)
				$row['subject'] = str_replace($tmpa,$tmpb,$row['subject']);

			print "<tr><td><font size=2>";
			print "<input type=checkbox name=\"topic-$row[ID_TOPIC]\" value=\"1\"></font></td>";
			if ($row['ID_MEMBER'] != -1)
			{
				$request2 = mysql_query("SELECT realName,memberName FROM {$db_prefix}members WHERE ID_MEMBER=$row[ID_MEMBER] LIMIT 1");
				$row2 = mysql_fetch_array($request2);
				print "<td><font size=2><b><i>$row[subject]</i></b> $txt[525] <a href=\"$scripturl?board=$board;action=viewprofile;user=$row2[memberName]\">$row2[realName]</a></font></td></tr>\n";
			}
			else
			{
				print "<td><font size=2><b><i>$row[subject]</i></b> $txt[525] $row[posterName]</font></td></tr>\n";
			}
		}
		print "<tr><td colspan=2><br><font size=2>$txt[416]</font><br>&nbsp;</td></tr>\n";
		print "<tr><td>&nbsp;</td><td><input type=reset value=\"$txt[329]\">&nbsp;&nbsp;&nbsp;<input type=submit value=\"$txt[417]\"></td></tr>";
		print "</table></form><br>&nbsp;\n";
	}

	print <<<EOT
  </td>
 </tr>
</table>
EOT;
	footer();
	obExit();

}

?>file|^|Sources/Packages.php|^|17805|^|1008718719
<?
/*****************************************************************************/
/* Packages.php                                                              */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

global $adminplver;
$adminplver="YaBB SE";

include_once("Sources/Packer.php");
// verify the user is an administrator
is_admin();

function Packages()
{
   global $txt, $color, $scripturl, $yytitle;

	$yytitle = $txt['yse131'];
	template_header();
	print <<<EOT
<table border="0" cellpadding="0" cellspacing="6" align="center" width="100%">
  <tr>
    <td colspan=2 width="100%">
    <table border="0" cellpadding="5" cellspacing="1" align="center" bgcolor="$color[bordercolor]" class="bordercolor" width="100%">
      <tr>
        <td bgcolor="$color[titlebg]" class="titlebg" height="23" align="center" colspan="2">
        <font size="4" color="$color[titletext]">$txt[yse131]</font></td>
      </tr><tr>
        <td class="windowbg" bgcolor="$color[windowbg]" valign="middle" align="left" width="100%">
        <b>$txt[yse132]</b><br>
        <i>$txt[yse133]</i>
EOT;

   if($dir = @opendir("Packages"))
   {
      echo "<ul>";
      while($file = readdir($dir))
      {
         if(!strstr($file, ".yp"))
            continue;
         echo "<li>$file\n";
         if(ereg("(.+)\.mod\.yp", $file, $regs))
   	      echo "<a href=\"$scripturl?action=packagepremod;file=$file\">[ $txt[yse134] ]</a>\n";
         if(ereg("(.+)\.as\.yp", $file, $regs))
   	      echo "<a href=\"$scripturl?action=packageavatars;file=$file\">[ $txt[yse135] ]</a>\n";
         if(ereg("(.+)\.lp\.yp", $file, $regs))
   	      echo "<a href=\"$scripturl?action=packagelanguage;file=$file\">[ $txt[yse136] ]</a>\n";
 
         echo "<a href=\"$scripturl?action=packagelist;file=$file\">[ $txt[yse137] ]</a>
               <a href=\"$scripturl?action=packageremove;file=$file\">[ $txt[yse138] ]</a>";
       }
       closedir($dir);
       echo <<<EOT
       </ul>
       <a href="$scripturl?action=packagecreate">[ $txt[yse139] ]</a><br>
       <a href="$scripturl?action=packageget">[ $txt[yse140] ]</a><br>
   </td>
   </tr>
   </table></td></tr></table>
EOT;
   }
 	footer();
	obExit();
}

function PackageRemove()
{
   global $scripturl, $file;

   unlink("Packages/".$file);

   header("Location: $scripturl?action=packages\n\n");
}

function PackageCreate()
{
   global $txt, $color, $scripturl, $yytitle;

   $yytitle = $txt['yse141'];
	template_header();
	print <<<EOT
<table border="0" cellpadding="0" cellspacing="6" align="center" width="100%">
  <tr>
    <td colspan=2 width="100%">
    <table border="0" cellpadding="5" cellspacing="1" align="center" bgcolor="$color[bordercolor]" class="bordercolor" width="100%">
      <tr>
        <td bgcolor="$color[titlebg]" class="titlebg" height="23" align="center" colspan="2">
        <font size="4" color="$color[titletext]"$txt[yse141]</font></td>
      </tr><tr>
        <td class="windowbg" bgcolor="$color[windowbg]" valign="middle" align="left" width="100%">
    <form action="$scripturl?action=packagecreate2" method="POST">
    <table border=0 cellspacing=0 cellpadding=4>
    <tr>
       <th colspan=2>$txt[yse142]</td>
    </tr>
    <tr>
       <td valign=top><b>$txt[yse143]:</b></td>
       <td valign=top><input type=text name="dir" size=30><br>
       <font size=1>$txt[yse144]</font></td>
    </tr>
    <tr>
       <td valign=top><b>$txt[yse145]:</b></td>
       <td valign=top><input type=text name="root" size=30><br>
       <font size=1>$txt[yse146]</font></td>
    </tr>
    <tr>
       <td valign=top><b>$txt[yse147]:</b></td>
       <td valign=top><input type=text name="name" size=30 value=".yp"></td>
    </tr>
    <tr>
       <td colspan=2><input type=submit value="$txt[yse148]"></td>
    </tr>
    </table></td></tr></table>
    </td>
   </tr>
   </table></td></tr></table>
EOT;
  	footer();
	obExit();

}

function PackageCreate2()
{
   global $txt, $color, $scripturl, $yytitle, $name, $dir, $root;

   $yytitle = $txt['yse141'];
	template_header();
	print <<<EOT
<table border="0" cellpadding="0" cellspacing="6" align="center" width="100%">
  <tr>
    <td colspan=2 width="100%">
    <table border="0" cellpadding="5" cellspacing="1" align="center" bgcolor="$color[bordercolor]" class="bordercolor" width="100%">
      <tr>
        <td bgcolor="$color[titlebg]" class="titlebg" height="23" align="center" colspan="2">
        <font size="4" color="$color[titletext]">$txt[yse141]</font></td>
      </tr><tr>
        <td class="windowbg" bgcolor="$color[windowbg]" valign="middle" align="left" width="100%">
EOT;
  $packer = new Packer("Packages/$name");

  echo <<<EOT
   <table border=0 cellspacing=0 cellpadding=4>
   <tr>
      <th colspan=2>$txt[yse149]</th>
   </tr>
   <tr>
      <td class=td1>
EOT;
  $packer->addFiles(array("./".$dir), "./".$root);


  echo "$txt[51]<br>$txt[yse150]: <a href=\"Packages/$name\">[ $txt[yse151] ]</a><br><br>
    <a href=\"$scripturl?action=packagecreate\">[ $txt[193] ]</a>
   </td>
   </tr>
   </table></td></tr></table>
   </td>
   </tr>
   </table></td></tr></table>   ";
  	footer();
	obExit();
}


function PackagePremod()
{
   global $txt, $color, $scripturl, $file, $yytitle;

	$yytitle = $txt['yse153'];
	template_header();
	print <<<EOT
<table border="0" cellpadding="0" cellspacing="6" align="center" width="100%">
  <tr>
    <td colspan=2 width="100%">
    <table border="0" cellpadding="5" cellspacing="1" align="center" bgcolor="$color[bordercolor]" class="bordercolor" width="100%">
      <tr>
        <td bgcolor="$color[titlebg]" class="titlebg" height="23" align="center" colspan="2">
        <font size="4" color="$color[titletext]">$txt[yse153]</font></td>
      </tr><tr>
        <td class="windowbg" bgcolor="$color[windowbg]" valign="middle" align="left" width="100%">
      $txt[yse152]
      <a href="$scripturl?action=packagemod;file=$file">[ $txt[yse154] ]</a>
      </td>
   </tr>
   </table></td></tr></table>
EOT;
  	footer();
	obExit();
}

function PackageMod()
{
   global $txt, $color, $scripturl, $file, $yytitle;

	$yytitle = $txt['yse155'];
	template_header();
	print <<<EOT
<table border="0" cellpadding="0" cellspacing="6" align="center" width="100%">
  <tr>
    <td colspan=2 width="100%">
    <table border="0" cellpadding="5" cellspacing="1" align="center" bgcolor="$color[bordercolor]" class="bordercolor" width="100%">
      <tr>
        <td bgcolor="$color[titlebg]" class="titlebg" height="23" align="center" colspan="2">
        <font size="4" color="$color[titletext]">$txt[yse156]</font></td>
      </tr><tr>
        <td class="windowbg" bgcolor="$color[windowbg]" valign="middle" align="left" width="100%">
EOT;
  
  $packer = new Packer("Packages/$file");
  echo $packer->extract(".");

  if(file_exists("Packages/modification.mod"))
    echo "
      $txt[yse157]<br>
      <a href=\"$scripturl?action=packagemod2;try=1\">[ $txt[yse158] ]</a>
      <a href=\"$scripturl?action=packagemod2;try=0\">[ $txt[yse159] ]</a><br>";
  elseif(file_exists("Packages/modification.php"))
    echo "
      $txt[yse160]<br>
      <a href=\"$scripturl?action=packagemod3\">[ $txt[yse161] ]</a><br>";
  elseif(file_exists("Packages/modification.txt"))
    echo "
      $txt[yse162]<br>
      <a href=\"$scripturl?action=packagemod4\">[ $txt[yse163] ]</a><br>";
  else
    echo "
      $txt[yse164]<br><br>
      <a href=\"$scripturl?action=packages\">[ $txt[193] ]</a><br>";
   
  echo "</td></tr></table></td></tr></table>";
  	footer();
	obExit();
}

function PackageMod2()
{
   global $txt, $color, $scripturl, $yytitle, $try;
	$yytitle = $txt['yse155'];
	template_header();
	print <<<EOT
<table border="0" cellpadding="0" cellspacing="6" align="center" width="100%">
  <tr>
    <td colspan=2 width="100%">
    <table border="0" cellpadding="5" cellspacing="1" align="center" bgcolor="$color[bordercolor]" class="bordercolor" width="100%">
      <tr>
        <td bgcolor="$color[titlebg]" class="titlebg" height="23" align="center" colspan="2">
        <font size="4" color="$color[titletext]">$txt[yse155]</font></td>
      </tr><tr>
        <td class="windowbg" bgcolor="$color[windowbg]" valign="middle" align="left" width="100%">
EOT;

  // Apply mod
  $file = implode("", file("Packages/modification.mod"));
  $file = str_replace("\r", "", $file);

  // Now find and parse the mod info
  $currentfile = "";
  $filecontents = "";
  $searchfor = "";

  while(preg_match("/<(file|search|add|replace)>\n(.+?)\n<\\/\\1>/is", $file, $regs))
  {
    if($regs[1] == "file")
    {
      if($currentfile && !$try)
      {
         copy($currentfile, $currentfile."~");
         $fp = fopen($currentfile, "w");
         fputs($fp, $filecontents);
         fclose($fp);
         echo "<b>$txt[yse165] $currentfile, $txt[yse166] ".$currentfile."~</b><br>\n";
      }
      $currentfile = $regs[2];
      $filecontents = implode("", file($currentfile));
      $filecontents = str_replace("\r", "", $filecontents);
      echo "<h2>$currentfile</h2>";
    }
    elseif($regs[1] == "search")
    {
      $searchfor = $regs[2];
      echo "$txt[yse167] <hr><pre>$searchfor</pre><hr>";
    }
    elseif($regs[1] == "add")
    {
      if(strstr($filecontents, $searchfor))
      {
         echo "$txt[yse168]<hr><pre>$regs[2]</pre><hr>";
         $filecontents = str_replace($searchfor, $searchfor."\n".$regs[2], $filecontents);
      }
      else
         echo "$txt[yse169]<br>";
      $searchfor = "";
    }
    elseif($regs[1] == "replace")
    {
      if(strstr($filecontents, $searchfor))
      {
         echo "$txt[yse170]<hr><pre>$regs[2]</pre><hr>";
         $filecontents = str_replace($searchfor, $regs[2], $filecontents);
      }
      else
         echo "$txt[yse169]<br>";
      $searchfor = "";
    }
    $file = str_replace("<$regs[1]>\n$regs[2]\n</$regs[1]>", "", $file);
  }
  if($currentfile && !$try)
  {
    copy($currentfile, $currentfile."~");
    $fp = fopen($currentfile, "w");
    fputs($fp, $filecontents);
    fclose($fp);
    echo "<b>$txt[yse165] $currentfile, $txt[yse165] ".$currentfile."~</b><br>\n";
  }
  echo "$txt[51]<br><br>";

  // Done...
  //unlink("../packages/modification.mod");
  if($try)
     echo $txt['yse171'];
  else
  {
     echo $txt['yse172'];

     if(file_exists("Packages/modification.php"))
       echo "
         $txt[yse160]<br>
         <a href=\"$scripturl?action=packagemod3\">[ $txt[yse161] ]</a><br>";
     elseif(file_exists("Packages/modification.txt"))
       echo "
         $txt[yse162]<br>
         <a href=\"$scripturl?action=packagemod4\">[ $txt[yse163] ]</a><br>";
     else
       echo "
         $txt[yse164]<br><br>
         <a href=\"$scripturl?action=packages\">[ $txt[193] ]</a><br>";
  }
  echo "</td></tr></table></td></tr></table>";
  footer();
  obExit();
}

function PackageMod3()
{
   global $txt, $color, $scripturl, $yytitle, $try;
	$yytitle = $txt['yse155'];
	template_header();
	print <<<EOT
<table border="0" cellpadding="0" cellspacing="6" align="center" width="100%">
  <tr>
    <td colspan=2 width="100%">
    <table border="0" cellpadding="5" cellspacing="1" align="center" bgcolor="$color[bordercolor]" class="bordercolor" width="100%">
      <tr>
        <td bgcolor="$color[titlebg]" class="titlebg" height="23" align="center" colspan="2">
        <font size="4" color="$color[titletext]">$txt[yse155]</font></td>
      </tr><tr>
        <td class="windowbg" bgcolor="$color[windowbg]" valign="middle" align="left" width="100%">
EOT;
  echo "<b>$txt[yse173]</b><hr>";

  include("Packages/modification.php");
  
  //unlink("../packages/modification.php");
  if(file_exists("Packages/modification.txt"))
    echo "
      $txt[yse162]<br>
      <a href=\"$scripturl?action=packagemod4\">[ $txt[yse163] ]</a><br>";
  else
    echo "
      $txt[yse164]<br><br>
      <a href=\"$scripturl?action=packages\">[ $txt[193] ]</a><br>";
  echo "</td></tr></table></td></tr></table>";
  footer();
  obExit();
}

function PackageMod4()
{
   global $txt, $color, $scripturl, $yytitle, $try;
	$yytitle = $txt['yse155'];
	template_header();
	print <<<EOT
<table border="0" cellpadding="0" cellspacing="6" align="center" width="100%">
  <tr>
    <td colspan=2 width="100%">
    <table border="0" cellpadding="5" cellspacing="1" align="center" bgcolor="$color[bordercolor]" class="bordercolor" width="100%">
      <tr>
        <td bgcolor="$color[titlebg]" class="titlebg" height="23" align="center" colspan="2">
        <font size="4" color="$color[titletext]">$txt[yse174]</font></td>
      </tr><tr>
        <td class="windowbg" bgcolor="$color[windowbg]" valign="middle" align="left" width="100%">
EOT;
  echo "<b>$txt[yse175]</b><br>";
  echo "<hr><pre>";
  echo htmlspecialchars(implode("", file("Packages/modification.txt")));
  echo "</pre><hr>";

  //unlink("../packages/modification.txt");
  echo "
    $txt[yse164]<br><br>
      <a href=\"$scripturl?action=packages\">[ $txt[193] ]</a><br>";
  echo "</td></tr></table></td></tr></table>";
  footer();
  obExit();
}

function PackageAvatars()
{
   global $txt, $color, $scripturl, $file, $yytitle;

	$yytitle = $txt['yse176'];
	template_header();
	print <<<EOT
<table border="0" cellpadding="0" cellspacing="6" align="center" width="100%">
  <tr>
    <td colspan=2 width="100%">
    <table border="0" cellpadding="5" cellspacing="1" align="center" bgcolor="$color[bordercolor]" class="bordercolor" width="100%">
      <tr>
        <td bgcolor="$color[titlebg]" class="titlebg" height="23" align="center" colspan="2">
        <font size="4" color="$color[titletext]">$txt[yse176]</font></td>
      </tr><tr>
        <td class="windowbg" bgcolor="$color[windowbg]" valign="middle" align="left" width="100%">
EOT;
  
  $packer = new Packer("Packages/$file");
  echo $packer->extract(".");

  echo <<<EOT
$txt[yse177]<br><br>
<a href="$scripturl?action=packages">[ $txt[193] ]</a><br>
</td></tr></table></td></tr></table>
EOT;
  	footer();
	obExit();
}

function PackageLanguage()
{
   global $txt, $color, $scripturl, $file, $yytitle;

	$yytitle = $txt['yse178'];
	template_header();
	print <<<EOT
<table border="0" cellpadding="0" cellspacing="6" align="center" width="100%">
  <tr>
    <td colspan=2 width="100%">
    <table border="0" cellpadding="5" cellspacing="1" align="center" bgcolor="$color[bordercolor]" class="bordercolor" width="100%">
      <tr>
        <td bgcolor="$color[titlebg]" class="titlebg" height="23" align="center" colspan="2">
        <font size="4" color="$color[titletext]">$txt[yse178]</font></td>
      </tr><tr>
        <td class="windowbg" bgcolor="$color[windowbg]" valign="middle" align="left" width="100%">
EOT;
  
  $packer = new Packer("Packages/$file");
  echo $packer->extract(".");

  echo <<<EOT
$txt[yse179]<br><br>
<a href="$scripturl?action=packages">[ $txt[193] ]</a><br>
</td></tr></table></td></tr></table>
EOT;
  	footer();
	obExit();
}


function PackageList()
{
   global $txt, $color, $scripturl, $file;

	$yytitle = $txt['yse180'];
	template_header();
	print <<<EOT
<table border="0" cellpadding="0" cellspacing="6" align="center" width="100%">
  <tr>
    <td colspan=2 width="100%">
    <table border="0" cellpadding="5" cellspacing="1" align="center" bgcolor="$color[bordercolor]" class="bordercolor" width="100%">
      <tr>
        <td bgcolor="$color[titlebg]" class="titlebg" height="23" align="center" colspan="2">
        <font size="4" color="$color[titletext]">$txt[yse180]</font></td>
      </tr><tr>
        <td class="windowbg" bgcolor="$color[windowbg]" valign="middle" align="left" width="100%">
EOT;
  $packer = new Packer("Packages/$file");
  $files = $packer->listFiles();
  echo "
  <b>$txt[yse181] $file</b>
  <ol>";
  for($i=0 ; $i<count($files); ++$i)
  {
    echo "<li>".$files[$i]['name']." (".$files[$i]['size']." bytes)\n";
  }
  echo "</ol><a href=\"$scripturl?action=packages\">[ $txt[193] ]</a>";
  echo "</td></tr></table></td></tr></table>";
  	footer();
	obExit();
}

?>file|^|Sources/Packer.php|^|5543|^|1008718721
<?php
/*****************************************************************************/
/* Packer.php                                                                */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

class Packer
{
  var $filename;
  var $fp;

  function Packer($fn)
  {
    $this->filename = $fn;
  }

  function addFiles($files, $root, $new = true)
  {
    if($new)
      $this->fp = fopen($this->filename,"wb");
    else
      $this->fp = fopen($this->filename,"ab");
    for($i=0 ; $i < count($files) ; ++$i)
    {
      $fullfilename = $files[$i];
      if(is_dir($fullfilename))
	$this->processdir($fullfilename, $root);
      else
      {
	$size = filesize($fullfilename);
	$time = filemtime($fullfilename);

	echo "$txt[yse194] $fullfilename ...<br>\n";
	// Write file to archive
	$file = fopen($fullfilename, "rb");
	$buffer = fread($file, $size);
	fclose($file);
	fwrite($this->fp, 'file|^|'.str_replace($root."/","",$fullfilename).'|^|'.strlen($buffer).'|^|'.$time."\n");
	fwrite($this->fp, $buffer, $size);
      }
    }
    fclose($this->fp);
  }

  function processdir($name, $root)
  {
    if($name != $root)
	fputs($this->fp, 'dir|^|'.str_replace($root."/", "", $name)."\n");
	
    $dir = @opendir($name) or die("Nope");
    while($file = readdir($dir))
    {
      if($file == "." || $file == "..")
	continue;
      $fullfilename = $name."/".$file;
      if(is_dir($fullfilename))
	$this->processdir($fullfilename, $root);
      else
      {
	$size = filesize($fullfilename);
	$time = filemtime($fullfilename);

	echo "Archiving $fullfilename ...<br>\n";
	// Write file to archive
	$file = fopen($fullfilename, "rb");
	$buffer = fread($file, $size);
	fclose($file);
	fwrite($this->fp, 'file|^|'.str_replace($root."/","",$fullfilename).'|^|'.strlen($buffer).'|^|'.$time."\n");
	fwrite($this->fp, $buffer, $size);
      }
    }
    closedir($dir);
  }

  function extract($directory, $prefix = "", $overwrite = false)
  {
    $output = "";

    $this->fp = fopen($this->filename, "rb");
    while(!feof($this->fp))
    {
      $data = explode('|^|', chop(fgets($this->fp, 4086)));
      if(count($data) < 2)
         break;
      $filename = $directory."/".$data[1];
      if(ereg("^".quotemeta($prefix), $data[1]))
      {
         if($data[0] == "dir" && !file_exists($filename) && $data[1] != ".")
         {
           mkdir($filename, 0777);
           @chmod($filename, 0777);
         }
         if($data[0] == "file")
         {
           if(file_exists($filename) && filemtime($filename) >= $data[3] && !$overwrite)
           {
             $buffer = fread($this->fp, $data[2]);
             $output .= "$txt[yse195]$filename$txt[yse196]<br>\n";
           }
           else
           {
             $buffer = fread($this->fp, $data[2]);
             $fp = fopen($filename, "wb");
             fputs($fp, $buffer, $data[2]);
             fclose($fp);
             @chmod($filename, 0666);
             @touch($filename, $data[3]);
             $output .= "$txt[yse197]$filename ...<br>\n";
           }
         }
      }
      else
      {
         if($data[0] == "file")
             $buffer = fread($this->fp, $data[2]);
      }
    }
    fclose($this->fp);

    return $output;
  }

  function listFiles()
  {
    $files = array();

    $this->fp = fopen($this->filename, "rb");
    while(!feof($this->fp))
    {
      $data = explode('|^|', chop(fgets($this->fp, 4086)));
      if($data[0] == "file")
      {
      	$id = count($files);
      	$files[$id]['name'] = $data[1];
      	$files[$id]['size'] = $data[2];
      	$buffer = fread($this->fp, $data[2]);
      }
    }
    fclose($this->fp);
    return $files;
  }
}
?>file|^|Sources/Poll.php|^|20386|^|1008769273
<?php
/*****************************************************************************/
/* Post.php                                                                  */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$pollplver="YaBB SE";

function PostPoll (){
	global $username,$password,$txt,$img,$modSettings,$db_prefix;
	global $board,$enable_notification,$yytitle,$ubbcjspath,$scripturl;
	global $enable_ubbc,$showyabbcbutt,$realname,$realemail,$imagesdir,$mbname;
	global $cgi,$color,$threadid,$settings,$moderators,$sourcedir;

	if ($username == 'Guest') { fatal_error($txt['yse28']); }
	if ($board == '' ) { fatal_error($txt[1]); }
	if ($modSettings['pollPostingRestrictions']=='1' && $settings[7] != 'Administrator')
		fatal_error($txt[1]);

	include_once ("$sourcedir/Post.php");

	# Determine what category we are in.
	$request = mysql_query("SELECT b.ID_BOARD as bid,b.name as bname,c.ID_CAT as cid,c.name as cname FROM {$db_prefix}boards as b,{$db_prefix}categories as c WHERE (b.ID_BOARD=$board AND b.ID_CAT=c.ID_CAT)");
	$bcinfo = mysql_fetch_array($request);
	$curcat = $bcinfo['cid'];
	$cat = $bcinfo['cname'];
	$currentboard = $bcinfo['bid'];
	$boardname = $bcinfo['bname'];

	$notification = (!$enable_notification) ? '' : <<<EOT
<tr>
	<td align="right"><font size=2><b>$txt[131]:</b></font></td>
	<td><font size=2><input type=checkbox name="notify"></font> <font size=1> $txt[yse14]</font></td>
</tr>
EOT;
	$lockthread = ($settings[7]!='Administrator' && !in_array($username,$moderators)) ? '' : <<<EOT
<tr>
	<td align="right"><font size=2><b>$txt[yse13]:</b></font></td>
	<td><font size=2><input type=checkbox name="lock"></font> <font size=1> $txt[yse15]</font></td>
</tr>
EOT;

	$yytitle=$txt['yse21'];
	template_header();

	$msubject=$mname=$memail=$mdate=$musername=$micon=$mip=$mmessage=$mns=$mid='';

	print <<<EOT

<script language="JavaScript1.2" type="text/javascript">
<!--
function showimage()
{
	document.images.icons.src="$imagesdir/"+document.postmodify.icon.options[document.postmodify.icon.selectedIndex].value+".gif";
}
//-->
</script>
<form action="$cgi;action=postpoll2" method="post" name="postmodify" onSubmit="submitonce(this);">
<table  width="75%" align="center" cellpadding="0" cellspacing="0">
  <tr>
    <td valign=bottom colspan="2">
    <font size=2 class="nav"><B><img src="$imagesdir/open.gif" border="0" alt="">&nbsp;&nbsp;
    <a href="$scripturl" class="nav">$mbname</a><br>
    <img src="$imagesdir/tline.gif" border="0" alt=""><IMG SRC="$imagesdir/open.gif" border="0" alt="">&nbsp;&nbsp;
    <a href="$scripturl#$curcat" class="nav">$cat</a><br>
    <img src="$imagesdir/tline2.gif"  border="0" alt=""><IMG SRC="$imagesdir/open.gif" border="0" alt="">&nbsp;&nbsp;
    <a href="$cgi" class="nav">$boardname</a><br>
    <img SRC="$imagesdir/tline3.gif"  border="0" alt=""><IMG SRC="$imagesdir/open.gif" border="0" alt="">&nbsp;&nbsp;
    $txt[yse20]</b></font></td>
  </tr>
</table>
<table border="0"  width="75%" align="center" cellspacing="1" cellpadding="3" bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$txt[yse21]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]">
    <input type="hidden" name="threadid" value="$threadid">
    <table border=0 cellpadding="3" width="100%">
      <tr>
        <td align="right"><font size=2><b>$txt[70]:</b></font></td>
        <td><font size=2><input type=text name="subject" size="40" maxlength="50"></font></td>
      </tr><tr>
	<td align="right"><font size=2><b>$txt[71]:</b></font></td>
	<td>
<select name="icon" onChange="showimage()">
	<option value="xx">$txt[281]
	<option value="thumbup">$txt[282]
	<option value="thumbdown">$txt[283]
	<option value="exclamation">$txt[284]
	<option value="question">$txt[285]
	<option value="lamp">$txt[286]
	<option value="smiley">$txt[287]
	<option value="angry">$txt[288]
	<option value="cheesy">$txt[289]
	<option value="laugh">$txt[290]
	<option value="sad">$txt[291]
	<option value="wink">$txt[292]
	</select>
	<img src="$imagesdir/xx.gif" name="icons" border="0" hspace="15" alt=""></td>
</tr>
	<tr><td align="right"><font size=2><b>$txt[yse21]:</b></font></td><td align="left"><input type="text" name="question" size="40"></td></tr>
<tr><td>&nbsp;</td><td><font size=2>
$txt[yse22] 1: <input type="text" name="option1" size="25"><br>
$txt[yse22] 2: <input type="text" name="option2" size="25"><br>
$txt[yse22] 3: <input type="text" name="option3" size="25"><br>
$txt[yse22] 4: <input type="text" name="option4" size="25"><br>
$txt[yse22] 5: <input type="text" name="option5" size="25"><br>
$txt[yse22] 6: <input type="text" name="option6" size="25"><br>
$txt[yse22] 7: <input type="text" name="option7" size="25"><br>
$txt[yse22] 8: <input type="text" name="option8" size="25">
</font></td></tr>
EOT;
printPostBox("");
print <<<EOT
$lockthread
$notification
<tr>
	<td align="right"><font size=2><b>$txt[276]:</b></font><BR><BR></td>
	<td><input type=checkbox name="ns" value="NS"> <font size=1> $txt[277]</font><BR><BR></td>
</tr>
<tr>
	<td align="center" colspan="2">
    <font size="1" class="text1" color="#000000"><font style="font-weight:normal" size="1">$txt[yse25]</font></font><BR>
	<input type="hidden" name="waction" value="post">
	<input type="submit" name="post" value="$txt[105]" onClick="WhichClicked('post');" accesskey="s">
	<input type="reset" value="$txt[278]" accesskey="r">
	</td>
</tr>
<tr>
<td colspan=2></td>
</tr>
</table>
</td>
</tr>
</table>
</form>
EOT;
	footer();
	obExit();
}

function PostPoll2 (){
	global$username,$subject,$message,$icon,$ns,$txt,$notify,$MaxMessLen,$db_prefix,$threadid,$doLimitOne;
	global $settings,$board,$mreplies,$maxmessagedisplay,$enable_guestposting,$waction,$ID_MEMBER,$ubbcjspath ;
	global $REMOTE_ADDR,$cgi,$yySetLocation,$color,$sourcedir,$realname,$lock,$settings,$moderators;
	global $question,$option1,$option2,$option3,$option4,$option5,$option6,$option7,$option8;
	if($username == 'Guest' && $enable_guestposting == 0) {	fatal_error($txt[165]); }

	if($username == 'Guest') { fatal_error($txt['yse28']); }
	if( $board == '' ) { fatal_error($txt[1]); }

	// did they toggle lock topic after post?
	$locked = (($settings[7]=='Administrator' || in_array($username,$moderators)) && $lock=='on')?1:0;

	if (trim($subject==''))
		fatal_error($txt[77]);
	if (trim($message==''))
		fatal_error($txt[78]);

	if (strlen($message)>$MaxMessLen) { fatal_error($txt[499]); }
	if( $waction == 'preview' ) { PreviewPoll(); }
	spam_protection();

	if (strlen($subject) > 50) { $subject = substr($subject,0,50); }
	$message = str_replace(array("&","\"","<",">"),array('&amp','&quot','&lt','&gt'),$message);
	$subject = str_replace(array("&","\"","<",">"),array('&amp','&quot','&lt','&gt'),$subject);

	// Preparse code (zef)
	$message = preparsecode($message, $realname, $username);

	$message = str_replace("\r\n","<br>",$message);
	$message = str_replace("\r","",$message);
	$message = str_replace("\n","",$message);

	$subject = str_replace("|","&#124",$subject);
	$message = str_replace("|","&#124",$message);
	$message = str_replace("\t","&nbsp;&nbsp;&nbsp;",$message);

	$time = time();
	$se = $ns?0:1;

	$request = mysql_query("INSERT INTO {$db_prefix}messages (ID_TOPIC,ID_MEMBER,subject,posterName,posterEmail,posterTime,posterIP,smiliesEnabled,body,icon) VALUES ('-1',$ID_MEMBER,'$subject','$username','$settings[2]',$time,'$REMOTE_ADDR',$se,'$message','$icon')");
	$ID_MSG = mysql_insert_id();
	$request = mysql_query("INSERT INTO {$db_prefix}polls (question,option1,option2,option3,option4,option5,option6,option7,option8,votedMemberIDs) VALUES ('$question','$option1','$option2','$option3','$option4','$option5','$option6','$option7','$option8','')");
	$ID_POLL = mysql_insert_id();
	if ($ID_MSG > 0 && $ID_POLL>0)
	{
		$request = mysql_query("INSERT INTO {$db_prefix}topics (ID_BOARD,ID_MEMBER_STARTED,ID_MEMBER_UPDATED,ID_FIRST_MSG,ID_LAST_MSG,ID_POLL,locked) VALUES ($board,$ID_MEMBER,$ID_MEMBER,$ID_MSG,$ID_MSG,$ID_POLL,$locked)");
		if (mysql_insert_id() > 0)
		{
			$threadid = mysql_insert_id();
			$request = mysql_query("UPDATE {$db_prefix}messages SET ID_TOPIC=$threadid WHERE (ID_MSG=$ID_MSG)");
			$request = mysql_query("UPDATE {$db_prefix}boards SET numPosts=numPosts+1,numTopics=numTopics+1 WHERE (ID_BOARD=$board)");
			$mreplies = 0;
		}
	}

	// clear all the logs of people who read this thread
	$request = mysql_query("DELETE FROM {$db_prefix}log_topics WHERE ID_TOPIC=$threadid");
	$request = mysql_query("DELETE FROM {$db_prefix}log_boards WHERE ID_BOARD=$board");

	++$settings[6];
	$request = mysql_query("UPDATE {$db_prefix}members SET posts=posts+1 WHERE ID_MEMBER=$ID_MEMBER $doLimitOne");

	# Mark thread as read for the member.
	$request = mysql_query("INSERT INTO {$db_prefix}log_topics (logTime,memberName,ID_TOPIC) VALUES (".time().",'$username',$threadid)");

	if( $notify ) {
		include_once("$sourcedir/Notify.php");
		Notify2();
	}

	$yySetLocation = "$cgi";
	redirectinternal();
}

function Vote() {
	global$username,$subject,$message,$icon,$ns,$txt,$notify,$MaxMessLen,$db_prefix,$doLimitOne;
	global $settings,$board,$mreplies,$maxmessagedisplay,$enable_guestposting,$waction,$ID_MEMBER,$ubbcjspath ;
	global $cgi,$yySetLocation,$color,$sourcedir,$realname,$lock,$settings,$moderators;
	global $option,$poll,$start,$threadid;
	if($username == 'Guest') { fatal_error($txt['yse28']); } // Guests can't vote

	$request = mysql_query("SELECT votedMemberIDs,votingLocked FROM {$db_prefix}polls WHERE (ID_POLL='$poll' AND FIND_IN_SET('$ID_MEMBER',votedMemberIDs)=0) LIMIT 1");
	if (mysql_num_rows($request) == 0)
		fatal_error($txt['yse27']);

	if ($option == '')
		fatal_error($txt['yse26']);

	$tmp = mysql_fetch_row($request);
	if ($tmp[1] != '0')
		fatal_error($txt['yse27']);

	$votedMemberIDs = explode(",",$tmp[0]);

	$votedMemberIDs[] = $ID_MEMBER;
	$newIDs = implode(",",$votedMemberIDs);
	if (substr($newIDs,0,1)==',') {$newIDs = substr($newIDs,1); }

	$selectedoption = "votes$option";

	$request = mysql_query("UPDATE {$db_prefix}polls SET $selectedoption=$selectedoption+1,votedMemberIDs='$newIDs' WHERE ID_POLL='$poll' $doLimitOne");

	$yySetLocation = "$cgi;action=display;threadid=$threadid;start=$start";
	redirectexit();
}

function LockVoting()
{
	global $threadid,$start,$board,$settings,$cgi,$moderators,$username,$ID_MEMBER,$db_prefix,$doLimitOne;
	$request = mysql_query("SELECT t.ID_MEMBER_STARTED,t.ID_POLL,p.votingLocked FROM {$db_prefix}topics as t, {$db_prefix}polls as p WHERE (t.ID_TOPIC='$threadid' AND p.ID_POLL=t.ID_POLL) LIMIT 1");
	list ($memberID,$pollID,$votingLocked) = mysql_fetch_row($request);

	if ($settings[7] == 'Administrator' || in_array($username,$moderators) || $ID_MEMBER==$memberID)
	{
	if ($votingLocked == '1') { $votingLocked = '0'; }
	else if($votingLocked == '2' && $settings[7]=='Administrator') { $votingLocked = '0'; }
	else if($votingLocked == '2' && $settings[7]!='Administrator') { $fatal_error($txt['yse31']); }
	else if($votingLocked == '0' && $settings[7]=='Administrator') { $votingLocked = '2'; }
	else { $votingLocked = '1'; }

	$request = mysql_query("UPDATE {$db_prefix}polls SET votingLocked='$votingLocked' WHERE ID_POLL='$pollID' $doLimitOne");
	}
	$yySetLocation = "$cgi;action=display;threadid=$threadid;start=$start";
	redirectinternal();
}

function EditPoll (){
	global $username,$password,$txt,$img,$modSettings,$ID_MEMBER,$start,$db_prefix;
	global $board,$enable_notification,$yytitle,$ubbcjspath,$scripturl;
	global $enable_ubbc,$showyabbcbutt,$realname,$realemail,$imagesdir,$mbname;
	global $cgi,$color,$threadid,$settings,$moderators,$sourcedir;

	if ($username == 'Guest') { fatal_error($txt['yse28']); }
	if ($board == '' ) { fatal_error($txt[1]); }

	# Determine what category we are in.
	$request = mysql_query("SELECT b.ID_BOARD as bid,b.name as bname,c.ID_CAT as cid,c.name as cname,t.ID_MEMBER_STARTED FROM {$db_prefix}boards as b,{$db_prefix}categories as c,{$db_prefix}topics as t WHERE (b.ID_BOARD=t.ID_BOARD AND b.ID_CAT=c.ID_CAT AND t.ID_TOPIC='$threadid')");
	$bcinfo = mysql_fetch_array($request);
	$curcat = $bcinfo['cid'];
	$cat = $bcinfo['cname'];
	$currentboard = $bcinfo['bid'];
	$boardname = $bcinfo['bname'];

	if (($ID_MEMBER==$bcinfo['ID_MEMBER_STARTED'] && $modSettings['pollEditMode']=='2') || (in_array($username,$moderators) && in_array($modSettings['pollEditMode'],array('2','1'))) || $settings[7]=='Administrator')
		;// we're ok
	else
		fatal_error($txt[1]);

	$request = mysql_query("SELECT p.ID_POLL,p.question,p.option1,p.option2,p.option3,p.option4,p.option5,p.option6,p.option7,p.option8,p.votes1,p.votes2,p.votes3,p.votes4,p.votes5,p.votes6,p.votes7,p.votes8 FROM {$db_prefix}polls as p,{$db_prefix}topics as t WHERE (p.ID_POLL=t.ID_POLL && t.ID_TOPIC='$threadid') LIMIT 1");
	$pollinfo = mysql_fetch_array($request);
	
	$yytitle=$txt['yse39'];
	template_header();

	$msubject=$mname=$memail=$mdate=$musername=$micon=$mip=$mmessage=$mns=$mid='';

	$pollinfo["question"] = htmlspecialchars($pollinfo["question"]);
	for ($i = 1; $i <=8; $i++)
		$pollinfo["option$i"] = htmlspecialchars($pollinfo["option$i"]);

	print <<<EOT

<script language="JavaScript1.2" src="$ubbcjspath" type="text/javascript"></script>
<form action="$cgi;action=editpoll2;start=$start" method="post" onSubmit="submitonce(this);" name="postmodify">
<table  width="75%" align="center" cellpadding="0" cellspacing="0">
  <tr>
    <td valign=bottom colspan="2">
    <font size=2 class="nav"><B><img src="$imagesdir/open.gif" border="0" alt="">&nbsp;&nbsp;
    <a href="$scripturl" class="nav">$mbname</a><br>
    <img src="$imagesdir/tline.gif" border="0" alt=""><IMG SRC="$imagesdir/open.gif" border="0" alt="">&nbsp;&nbsp;
    <a href="$scripturl#$curcat" class="nav">$cat</a><br>
    <img src="$imagesdir/tline2.gif"  border="0" alt=""><IMG SRC="$imagesdir/open.gif" border="0" alt="">&nbsp;&nbsp;
    <a href="$cgi" class="nav">$boardname</a><br>
    <img SRC="$imagesdir/tline3.gif"  border="0" alt=""><IMG SRC="$imagesdir/open.gif" border="0" alt="">&nbsp;&nbsp;
    $txt[yse39]</b></font></td>
  </tr>
</table>
<table border="0"  width="75%" align="center" cellspacing="1" cellpadding="3" bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$txt[yse39]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]">
    <input type="hidden" name="threadid" value="$threadid">
    <input type="hidden" name="poll" value="$pollinfo[ID_POLL]">
    <table border=0 cellpadding="3" width="100%">
	<tr><td align="right"><font size=2><b>$txt[yse21]:</b></font></td><td align="left"><input type="text" name="question" size="40" value="$pollinfo[question]"></td></tr>
<tr><td>&nbsp;</td><td><font size=2>
$txt[yse22] 1: <input type="text" name="option1" size="25" value="$pollinfo[option1]"> ($pollinfo[votes1] $txt[yse42])<br>
$txt[yse22] 2: <input type="text" name="option2" size="25" value="$pollinfo[option2]"> ($pollinfo[votes2] $txt[yse42])<br>
$txt[yse22] 3: <input type="text" name="option3" size="25" value="$pollinfo[option3]"> ($pollinfo[votes3] $txt[yse42])<br>
$txt[yse22] 4: <input type="text" name="option4" size="25" value="$pollinfo[option4]"> ($pollinfo[votes4] $txt[yse42])<br>
$txt[yse22] 5: <input type="text" name="option5" size="25" value="$pollinfo[option5]"> ($pollinfo[votes5] $txt[yse42])<br>
$txt[yse22] 6: <input type="text" name="option6" size="25" value="$pollinfo[option6]"> ($pollinfo[votes6] $txt[yse42])<br>
$txt[yse22] 7: <input type="text" name="option7" size="25" value="$pollinfo[option7]"> ($pollinfo[votes7] $txt[yse42])<br>
$txt[yse22] 8: <input type="text" name="option8" size="25" value="$pollinfo[option8]"> ($pollinfo[votes8] $txt[yse42])
</font></td></tr>
<tr>
	<td align="right"><font size=2><b>$txt[yse40]:</b></font></td>
	<td><font size=2><input type=checkbox name="resetVoteCount"></font> <font size=1> $txt[yse41]</font></td>
</tr>
<tr>
	<td align="center" colspan="2">
    <font size="1" class="text1" color="#000000"><font style="font-weight:normal" size="1">$txt[yse25]</font></font><BR>
	<input type="hidden" name="waction" value="post">
	<input type="submit" name="post" value="$txt[105]" onClick="WhichClicked('post');" accesskey="s">
	<input type="reset" value="$txt[278]" accesskey="r">
	</td>
</tr>
<tr>
<td colspan=2></td>
</tr>
</table>
</td>
</tr>
</table>
</form>
EOT;
	footer();
	obExit();
}

function EditPoll2 ()
{
	global $username,$txt,$poll,$start,$threadid,$settings,$board,$ID_MEMBER,$db_prefix,$doLimitOne;
	global $cgi,$yySetLocation,$color,$sourcedir,$realname,$moderators,$modSettings;
	global $question,$option1,$option2,$option3,$option4,$option5,$option6,$option7,$option8,$resetVoteCount;

	if ($username == 'Guest') { fatal_error($txt['yse28']); }
	if ($board == '' ) { fatal_error($txt[1]); }

	# Determine what category we are in.
	$request = mysql_query("SELECT b.ID_BOARD as bid,b.name as bname,c.ID_CAT as cid,c.name as cname,t.ID_MEMBER_STARTED FROM {$db_prefix}boards as b,{$db_prefix}categories as c,{$db_prefix}topics as t WHERE (b.ID_BOARD=t.ID_BOARD AND b.ID_CAT=c.ID_CAT AND t.ID_TOPIC='$threadid')");
	$bcinfo = mysql_fetch_array($request);
	$curcat = $bcinfo['cid'];
	$cat = $bcinfo['cname'];
	$currentboard = $bcinfo['bid'];
	$boardname = $bcinfo['bname'];

	if (($ID_MEMBER==$bcinfo['ID_MEMBER_STARTED'] && $modSettings['pollEditMode']=='2') || (in_array($username,$moderators) && in_array($modSettings['pollEditMode'],array('2','1'))) || $settings[7]=='Administrator')
		;// we're ok
	else
		fatal_error($txt[1]);

	for ($i = 1; $i<=8;$i++)
		${"option$i"} = str_replace(array("&","\"","<",">"),array('&amp','&quot','&lt','&gt'),${"option$i"});
	$question = str_replace(array("&","\"","<",">"),array('&amp','&quot','&lt','&gt'),$question);

	if ($resetVoteCount=='on')
	$request = mysql_query("UPDATE {$db_prefix}polls SET votedMemberIDs='',votes1=0,votes2=0,votes3=0,votes4=0,votes5=0,votes6=0,votes7=0,votes8=0 WHERE ID_POLL='$poll' $doLimitOne");

	$request = mysql_query("UPDATE {$db_prefix}polls SET option1='$option1',option2='$option2',option3='$option3',option4='$option4',option5='$option5',option6='$option6',option7='$option7',option8='$option8',question='$question' WHERE ID_POLL='$poll' $doLimitOne");

	$yySetLocation = "$cgi;action=display;threadid=$threadid;start=$start";
	redirectexit();
}
?>
file|^|Sources/Post.php|^|37279|^|1008863614
<?php
/*****************************************************************************/
/* Post.php                                                                  */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$postplver="YaBB SE";

function Post (){
	global $username,$password,$enable_guestposting,$txt,$img,$title,$start;
	global $board,$quote,$enable_notification,$yytitle,$ubbcjspath,$scripturl;
	global $enable_ubbc,$showyabbcbutt,$realname,$realemail,$imagesdir,$mbname;
	global $cgi,$color,$threadid,$settings,$moderators,$db_prefix,$modSettings;
	if($username == 'Guest' && $enable_guestposting == 0) { fatal_error($txt[165]); }
	if( $board == '' ) { fatal_error($txt[1]); }
	$quotemsg = $quote;

	$threadinfo = array('locked' => 0, 'ID_MEMBER_STARTED'=>'-1');
	$mstate = 0;
	if ($threadid != ''){
		$request = mysql_query("SELECT * FROM {$db_prefix}topics WHERE ID_TOPIC=$threadid");
		$threadinfo = mysql_fetch_array($request);
		$mstate = $threadinfo['locked'];
	} else if ($title != $txt[464])
		fatal_error ($txt[472]);

	if( $threadinfo['locked'] != 0 ) { fatal_error($txt[90]); }	// don't allow a post if it's locked

	# Determine what category we are in.
	$request = mysql_query("SELECT b.ID_BOARD as bid,b.name as bname,c.ID_CAT as cid,c.name as cname FROM {$db_prefix}boards as b,{$db_prefix}categories as c WHERE (b.ID_BOARD=$board AND b.ID_CAT=c.ID_CAT)");
	$bcinfo = mysql_fetch_array($request);
	$curcat = $bcinfo['cid'];
	$cat = $bcinfo['cname'];
	$currentboard = $bcinfo['bid'];
	$boardname = $bcinfo['bname'];

	$notification = (!$enable_notification || $username == 'Guest') ? '' : <<<EOT
<tr>
	<td align="right"><font size=2><b>$txt[131]:</b></font></td>
	<td><font size=2><input type=checkbox name="notify"></font> <font size=1> $txt[yse14]</font></td>
</tr>
EOT;
	$lockthread = ($settings[7]!='Administrator' && !in_array($username,$moderators)) ? '' : <<<EOT
<tr>
	<td align="right"><font size=2><b>$txt[yse13]:</b></font></td>
	<td><font size=2><input type=checkbox name="lock"></font> <font size=1> $txt[yse15]</font></td>
</tr>
EOT;


	if ($title==$txt[464]) {$title=$txt[33]; }
	else if ($title==$txt[116]) {$title=$txt[25]; }
	$title = str_replace("\\","",$title);
	$yytitle=$title;
	template_header();

	$name_field = $realname == '' ? "<tr><td align=\"right\"><font size=2><b>$txt[68]:</b></font></td><td><font size=2><input type=text name=\"name\" size=25></font></td></tr>" : '';

	$email_field = $realemail == '' ? "<tr><td align=\"right\"><font size=2><b>$txt[69]:</b></font></td><td><font size=\"2\"><input type=\"text\" name=\"email\" size=\"25\"></font>" : '';

	$msubject=$mname=$memail=$mdate=$musername=$micon=$mip=$mmessage=$mns=$mid='';
	$form_message = '';
	$form_subject = '';
	if ($threadid != '' && $quotemsg != '')
	{
		$request = mysql_query("SELECT subject,posterName,posterEmail,posterTime,icon,posterIP,body,smiliesEnabled,ID_MEMBER FROM {$db_prefix}messages WHERE ID_MSG=$quotemsg");
		list($msubject,$mname,$memail,$mdate,$micon,$mip,$mmessage,$mns,$mi) = mysql_fetch_row($request);
		if ($mi != '-1')
		{
			$request = mysql_query("SELECT realName FROM {$db_prefix}members WHERE ID_MEMBER='$mi' LIMIT 1");
			if (mysql_num_rows($request) != 0)
				list($mname) = mysql_fetch_row($request);
		}
		$form_message = str_replace("<br>","\n",$mmessage);
		$form_message = "[quote author=$mname link=board=$currentboard;threadid=$threadid;start=$start#$quotemsg date=$mdate]\n$form_message\n[/quote]";
		$form_subject = "$msubject";
		if (!stristr(substr($msubject,0,3),"re:"))
			$form_subject = "Re:$form_subject";
	}
	else if ($threadid != '' && $quotemsg == '')
	{
		$request = mysql_query("SELECT subject,posterName,posterEmail,posterTime,icon,posterIP,body,smiliesEnabled,ID_MEMBER FROM {$db_prefix}messages WHERE ID_TOPIC=$threadid ORDER BY ID_MSG LIMIT 1");
		list($msubject,$mname,$memail,$mdate,$micon,$mip,$mmessage,$mns,$mi) = mysql_fetch_row($request);

		$form_subject = "$msubject";
		if (!stristr(substr($msubject,0,3),"re:"))
			$form_subject = "Re:$form_subject";
	}

	if(!$form_subject) { $sub = "<i>$txt[33]</i>"; }
	else { $sub = $form_subject; }
# Build the link tree
	$displayLinkTree = $modSettings['enableInlineLinks'] ? "<font size=\"1\" class=\"nav\"><B><a href=\"$scripturl\" class=\"nav\">$mbname</a> </b>&nbsp;|&nbsp;<b> " : "<font size=\"2\" class=\"nav\"><B><img src=\"$imagesdir/open.gif\" border=\"0\" alt=\"\">&nbsp;&nbsp;<a href=\"$scripturl\" class=\"nav\">$mbname</a><br>" ;
	$displayLinkTree .= $modSettings['enableInlineLinks'] ? "<a href=\"$scripturl#$curcat\" class=\"nav\">$cat</a> </b>&nbsp;|&nbsp;<b> " : "<img src=\"$imagesdir/tline.gif\" border=\"0\" alt=\"\"><IMG SRC=\"$imagesdir/open.gif\" border=\"0\" alt=\"\">&nbsp;&nbsp;<a href=\"$scripturl#$curcat\" class=\"nav\">$cat</a><br>" ;
	$displayLinkTree .= $modSettings['enableInlineLinks'] ? "<a href=\"$cgi\" class=\"nav\">$boardname</a> </b>&nbsp;|&nbsp;<b> " : "<img src=\"$imagesdir/tline2.gif\" border=\"0\" alt=\"\"><IMG SRC=\"$imagesdir/open.gif\" border=\"0\" alt=\"\">&nbsp;&nbsp;<a href=\"$cgi\" class=\"nav\">$boardname</a><br>" ;
	$displayLinkTree .= $modSettings['enableInlineLinks'] ? "$title ( $sub )</b></font>" : "<img SRC=\"$imagesdir/tline3.gif\" border=\"0\" alt=\"\"><IMG SRC=\"$imagesdir/open.gif\" border=\"0\" alt=\"\">&nbsp;&nbsp;$title ( $sub )</b></font>" ;

	print <<<EOT

<script language="JavaScript1.2" type="text/javascript">
<!--
function showimage()
{
	document.images.icons.src="$imagesdir/"+document.postmodify.icon.options[document.postmodify.icon.selectedIndex].value+".gif";
}
//-->
</script>
<form action="$cgi;action=post2" method="post" name="postmodify" onSubmit="submitonce(this);" enctype="multipart/form-data">
<table  width="75%" align="center" cellpadding="0" cellspacing="0">
  <tr>
     <td valign=bottom colspan="2">$displayLinkTree</td>
  </tr>
</table>
<table border="0"  width="75%" align="center" cellspacing="1" cellpadding="3" bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$yytitle</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]">
    <input type="hidden" name="threadid" value="$threadid">
    <table border=0 cellpadding="3" width="100%">
      $name_field
	  $email_field
      <tr>
        <td align="right"><font size=2><b>$txt[70]:</b></font></td>
        <td><font size=2><input type=text name="subject" value="$form_subject" size="40" maxlength="80"></font></td>
      </tr><tr>
	<td align="right"><font size=2><b>$txt[71]:</b></font></td>
	<td>
<select name="icon" onChange="showimage()">
	<option value="xx">$txt[281]
	<option value="thumbup">$txt[282]
	<option value="thumbdown">$txt[283]
	<option value="exclamation">$txt[284]
	<option value="question">$txt[285]
	<option value="lamp">$txt[286]
	<option value="smiley">$txt[287]
	<option value="angry">$txt[288]
	<option value="cheesy">$txt[289]
	<option value="laugh">$txt[290]
	<option value="sad">$txt[291]
	<option value="wink">$txt[292]
	</select>
	<img src="$imagesdir/xx.gif" name="icons" border="0" hspace="15" alt=""></td>
</tr>
EOT;
printPostBox($form_message);
# Attachment field added by Meriadoc
$attachmentFields = "";
if($modSettings['attachmentEnable']==1) {
$attachmentFields = "
<tr>
	<td align=\"right\" valign=top><font size=2><b>$txt[yse119]:</b></font><BR><BR></td>
	<td><input type=\"file\" size=48 name=\"attachment\"><br><font size=1>$txt[yse120]: $modSettings[attachmentExtensions]<br>$txt[yse121]: $modSettings[attachmentSizeLimit] KB</font><BR><BR></td>
</tr>";
}
if($username == 'Guest' && $modSettings['attachmentEnableGuest']==0) {
	$attachmentFields = "";
}
if($modSettings['attachmentMemberGroups']!="") {
	if(!in_array($settings[7],explode(",",trim($modSettings['attachmentMemberGroups'])))) {
		$attachmentFields = "";
	}
}
# end of this part...
print <<<EOT
$lockthread
$notification
<tr>
	<td align="right"><font size=2><b>$txt[276]:</b></font><BR><BR></td>
	<td><input type=checkbox name="ns" value="NS"> <font size=1> $txt[277]</font><BR><BR></td>
</tr>

$attachmentFields

<tr>
	<td align="center" colspan="2">
    <font size="1" class="text1" color="#000000"><font style="font-weight:normal" size="1">$txt[yse16]</font></font><BR>
	<input type="hidden" name="waction" value="post">
	<input type="submit" name="post" value="$txt[105]" onClick="WhichClicked('post');" accesskey="s">
	<input type="submit" name="preview" value="$txt[507]" onClick="WhichClicked('preview');" accesskey="p">
	<input type="reset" value="$txt[278]" accesskey="r">
	</td>
</tr>
<tr>
<td colspan=2></td>
</tr>
</table>
</td>
</tr>
</table>
</form>
EOT;
	doshowthread();
	footer();
	obExit();
}

function Preview (){
	global $name,$email,$subject,$message,$icon,$ns,$threadid,$notify,$enable_ubbc,$txt,$waction,$db_prefix;
	global $censored,$yytitle,$imagesdir,$cgi,$to,$from,$board,$username,$ubbcjspath,$postid,$color,$modSettings;
	global $sourcedir,$realname,$lock,$enable_notification,$settings,$realemail,$moderators,$start,$postid;
	if (strlen($subject) > 80) { $subject = substr($subject,0,80); }
	$subject = stripcslashes($subject);
	$message = stripcslashes($message);
	$subject = htmlspecialchars($subject);
//	$subject = str_replace("|","&#124;",$subject);
	$message2 = $message;
	$message2 = htmlspecialchars($message2);
	$message2 = str_replace("\t","&nbsp;&nbsp;&nbsp;",$message2);
	$message2 = str_replace("\r","",$message2);
	$message2 = str_replace("\n","<br>",$message2);
//	$message2 = str_replace("|","&#124;",$message2);
//	$message =~ s/\cM//g;
//	$message =~ s~\[([^\]]{0,30})\n([^\]]{0,30})\]~\[$1$2\]~g;
//	$message =~ s~\[/([^\]]{0,30})\n([^\]]{0,30})\]~\[/$1$2\]~g;
//	$message =~ s~(\w+://[^<>\s\n\"\]\[]+)\n([^<>\s\n\"\]\[]+)~$1$2~g;

//	&CheckIcon;

	// create the options at the bottom
	$notify = ($notify!='')?' checked':'';
	$ns = ($notify!='')?' checked':'';
	$lock = ($lock!='')?' checked':'';

	$name_field = $realname == '' ? "<tr><td align=\"right\"><font size=2><b>$txt[68]:</b></font></td><td><font size=2><input type=text name=name size=25 value=\"$name\"></font></td></tr>" : '';

	$email_field = $realemail == '' ? "</tr><tr><td align=\"right\"><font size=2><b>$txt[69]:</b></font></td><td><font size=2><input type=text name=email size=25 value=\"$email\">" : '';

	if ($username == 'Guest') {
		// we are doing a check to make sure the person posting, isn't using a name
		// that a member has already taken.
		$request = mysql_query("SELECT ID_MEMBER FROM {$db_prefix}members WHERE (memberName='$name' OR realName='$name') LIMIT 1");
		if (mysql_num_rows($request) > 0)
			fatal_error($txt[100]);

		// now make sure they aren't trying to use a reserved name
		$request = mysql_query("SELECT * FROM {$db_prefix}reserved_names ORDER BY setting");
		$matchword = $matchcase = $matchuser = $matchname = '';
		for ($i = 0; $i < 4; $i++)
		{	
			$tmp = mysql_fetch_row($request);
			${$tmp[0]}=$tmp[1];
		}
		$namecheck = $matchcase ? $name : strtolower ($name);

		while ($tmp = mysql_fetch_row($request)) {
			if ($tmp[0] == 'word')
			{
				$reserved = $tmp[1];
				$reservecheck = $matchcase ? $reserved : strtolower ($reserved);
				if ($matchname) {
					if ($matchword)
						if ($namecheck == $reservecheck) { fatal_error("$txt[244] $reserved"); }
					else
						if (strstr($namecheck,$reservecheck)) { fatal_error("$txt[244] $reserved"); }
				}
			}
		}
	}
	if($enable_ubbc)
   {
      $message2 = preparsecode($message2, $realname, $username);
	  $es = ($ns=='checked')?0:1;
      $message2 = DoUBBC($message2,$es);
   }
	$destination = $submittxt = '';
	if( $waction == 'previewmodify' ) {
		$destination = "modify2;start=$start;postid=$postid";
		$submittxt = $txt[10];
	}
	else if( $waction == 'previewim' ) {
		$destination = 'imsend2';
		$submittxt = $txt[148];
	}
	else {
		$destination = 'post2';
		$submittxt = $txt[105];
	}

	$csubject = $subject;
	
	# Load Censor List
	LoadCensorList();

	foreach ($censored as $tmpa=>$tmpb) {
		$csubject = str_replace($tmpa,$tmpb,$csubject);
		$message2 = str_replace($tmpa,$tmpb,$message2);
	}
	
	$yytitle = "$txt[507] - $csubject";
	
	template_header();
	print<<<EOT
<script language="JavaScript1.2" src="$ubbcjspath" type="text/javascript"></script>
<table border=0 width="75%" cellspacing=1 cellpadding="3" bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]">$csubject</font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]"><font size=2>$message2</font></td>
EOT;

print "</table><br>";
if ($waction!='previewim') {
print <<<EOT
<script language="JavaScript1.2" type="text/javascript">
<!--
function showimage()
{
	document.images.icons.src="$imagesdir/"+document.postmodify.icon.options[document.postmodify.icon.selectedIndex].value+".gif";
}
//-->
</script>
<table border="0"  width="75%" align="center" cellspacing="1" cellpadding="3" bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$yytitle</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]">
    <form action="$cgi;action=$destination" method="post" name="postmodify" onSubmit="submitonce(this);" enctype="multipart/form-data">
    <input type="hidden" name="threadid" value="$threadid">
	<table border=0 cellpadding="3">
      $name_field
      $email_field
	  <tr>
        <td align="right"><font size=2><b>$txt[70]:</b></font></td>
        <td><font size=2><input type=text name="subject" value="$subject" size="40" maxlength="80"></font></td>
      </tr><tr>
	<td align="right"><font size=2><b>$txt[71]:</b></font></td>
	<td>
<select name="icon" onChange="showimage()">
	<option value="xx">$txt[281]
	<option value="thumbup">$txt[282]
	<option value="thumbdown">$txt[283]
	<option value="exclamation">$txt[284]
	<option value="question">$txt[285]
	<option value="lamp">$txt[286]
	<option value="smiley">$txt[287]
	<option value="angry">$txt[288]
	<option value="cheesy">$txt[289]
	<option value="laugh">$txt[290]
	<option value="sad">$txt[291]
	<option value="wink">$txt[292]
	</select>
	<img src="$imagesdir/xx.gif" name="icons" border="0" hspace="15" alt=""></td>
</tr>
EOT;
} else {
print <<<EOT
	<table border=0 width="75%" align="center" cellpadding="3" cellspacing=1 bgcolor="$color[bordercolor]" class="bordercolor">
   <tr>
    <td class="windowbg" bgcolor="$color[windowbg]">
    <form action="$cgi;action=imsend2" method="post" name="postmodify" onSubmit="submitonce(this);">
    <table border=0 cellpadding=3>
      <tr>
        <td align="right"><font size=2><b>$txt[150]:</b></font></td>
        <td><font size=2><input type=text name="to" value="$to" size="20" maxlength="80">
        <font size=1">$txt[748]</font></font></td>
      </tr><tr>
        <td align="right"><font size=2><b>$txt[70]:</b></font></td>
        <td><font size=2><input type=text name="subject" value="$subject" size="40" maxlength="80"></font></td>
      </tr>
EOT;

}
printPostBox($message);
if ($waction != 'previewim') {
# Attachment field added by Meriadoc
$attachmentFields = "";
if($modSettings['attachmentEnable']==1) {
$attachmentFields = "
<tr>
	<td align=\"right\" valign=top><font size=2><b>$txt[yse119]:</b></font><BR><BR></td>
	<td><input type=\"file\" size=48 name=\"attachment\"><br><font size=1>$txt[yse120]: $modSettings[attachmentExtensions]<br>$txt[yse121]: $modSettings[attachmentSizeLimit] KB</font><BR><BR></td>
</tr>";
}
if($username == 'Guest' && $modSettings['attachmentEnableGuest']==0) {
	$attachmentFields = "";
}
if($modSettings['attachmentMemberGroups']!="") {
	if(!in_array($settings[7],explode(",",trim($modSettings['attachmentMemberGroups'])))) {
		$attachmentFields = "";
	}
}

	$notification = (!$enable_notification || $username == 'Guest') ? '' : <<<EOT
<tr>
	<td align="right"><font size=2><b>$txt[131]:</b></font></td>
	<td><font size=2><input type=checkbox name="notify" $notify></font> <font size=1> $txt[yse14]</font></td>
</tr>
EOT;
	$lockthread = ($settings[7]!='Administrator' && !in_array($username,$moderators)) ? '' : <<<EOT
<tr>
	<td align="right"><font size=2><b>$txt[yse13]:</b></font></td>
	<td><font size=2><input type=checkbox name="lock" $lock></font> <font size=1> $txt[yse15]</font></td>
</tr>
EOT;
print <<<EOT
$lockthread
$notification
<tr>
	<td align="right"><font size=2><b>$txt[276]:</b></font><BR><BR></td>
	<td><input type=checkbox name="ns" value="NS" $notify> <font size=1> $txt[277]</font><BR><BR></td>
</tr>

$attachmentFields

<tr>
	<td align="center" colspan="2">
    <font size="1" class="text1" color="#000000"><font style="font-weight:normal" size="1">$txt[yse16]</font></font><BR>
	<input type="hidden" name="waction" value="post">
	<input type="submit" name="post" value="$submittxt" onClick="WhichClicked('post');" accesskey="s">
	<input type="submit" name="$waction" value="$txt[507]" onClick="WhichClicked('$waction');" accesskey="p">
	<input type="reset" value="$txt[278]" accesskey="r">
	</td>
</tr>
EOT;
} else {
print <<<EOT
	<tr>
      <td align=center colspan=2>
       <input type="hidden" name="waction" value="imsend">
       <input type="submit" value="$submittxt" onClick="WhichClicked('imsend');" accesskey="s">
       <input type="submit" name="preview" value="$txt[507]" onClick="WhichClicked('previewim');">
       <input type=reset value="$txt[329]">
      </td>
     </tr>
EOT;
}
print <<<EOT
<tr>
<td colspan=2></td>
</tr>
</table></form>
</td>
</tr>
</table>
EOT;

footer();
	obExit();
}

function Post2 (){
	global $name,$email,$username,$subject,$message,$icon,$ns,$threadid,$txt,$notify,$MaxMessLen,$db_prefix;
	global $settings,$board,$mreplies,$maxmessagedisplay,$enable_guestposting,$waction,$ID_MEMBER,$ubbcjspath ;
	global $REMOTE_ADDR,$cgi,$yySetLocation,$color,$sourcedir,$realname,$lock,$settings,$moderators,$doLimitOne;
	global $attachment,$attachment_size,$attachment_name,$HTTP_POST_FILES,$modSettings;
	if($username == 'Guest' && $enable_guestposting == 0) {	fatal_error($txt[165]); }

	if ($threadid != ''){
		$request = mysql_query("SELECT locked FROM {$db_prefix}topics WHERE ID_TOPIC=$threadid");
		list($tmplocked) = mysql_fetch_array($request);
		if( $tmplocked != 0 ) { fatal_error($txt[90]); }	// don't allow a post if it's locked
	}

	# If poster is a Guest then evaluate the legality of name and email
	if ($username == 'Guest') {
		$name = trim($name);
		if ($name == '' || $name == '_' || $name == ' ')
			fatal_error($txt[75]);
		if (strlen($name) > 25)
			fatal_error($txt[568]);
		if ($email == '')
			fatal_error($txt[76]);
		if (!preg_match("/^[0-9A-Za-z@\._\-]+$/",$email))
			fatal_error($txt[243]);
	}

	if( !empty($threadid) && !is_numeric($threadid)) { fatal_error($txt[337]); }

	// did they toggle lock topic after post?
	$locked = (($settings[7]=='Administrator' || in_array($username,$moderators)) && $lock=='on')?1:0;

	$name = htmlspecialchars($name);
	$email = htmlspecialchars($email);
//	$name = str_replace("|","&#124;",$name);
//	$email = str_replace("|","",$email);

	//		$tempname = $name;
	//		$name =~ s/\_/ /g;

	if (trim($subject)=='')
		fatal_error($txt[77]);
	if (trim($message)=='')
		fatal_error($txt[78]);

	if (strlen($message)>$MaxMessLen) { fatal_error($txt[499]); }
	if( $waction == 'preview' ) { Preview(); }
	spam_protection();


	if (strlen($subject) > 80) { $subject = substr($subject,0,80); }
	$message = htmlspecialchars($message);
	$subject = htmlspecialchars($subject);

	if ($username != 'Guest')		# If not guest, get name and email.		
	{
		$name = $username;
		$email = $settings[2];
	}

   // Preparse code (zef)
   $message = preparsecode($message, $realname, $name);

   $message = str_replace("\r","",$message);
   $message = str_replace("\n","<br>",$message);


//	$subject = str_replace("|","&#124;",$subject);
//	$message = str_replace("|","&#124;",$message);
	$message = str_replace("\t","&nbsp;&nbsp;&nbsp;",$message);



	if ($username == 'Guest') 
	{
		# If user is Guest, then make sure the chosen name
		# is not reserved or used by a member.
		#
		$request = mysql_query("SELECT ID_MEMBER FROM {$db_prefix}members WHERE (memberName='$name' || realName='$name')");
		if (mysql_num_rows($request) != 0)
			fatal_error($txt[473]);

		// now make sure they arn't trying to use a reserved name
		$request = mysql_query("SELECT * FROM {$db_prefix}reserved_names ORDER BY setting");
		$matchword = $matchcase = $matchuser = $matchname = '';
		for ($i = 0; $i < 4; $i++)
		{	
			$tmp = mysql_fetch_row($request);
			${$tmp[0]}=$tmp[1];
		}
		$namecheck = $matchcase ? $name : strtolower ($name);

		while ($tmp = mysql_fetch_row($request)) {
			if ($tmp[0] == 'word')
			{
				$reserved = $tmp[1];
				$reservecheck = $matchcase ? $reserved : strtolower ($reserved);
				if ($matchname) {
					if ($matchword)
						if ($namecheck == $reservecheck) { fatal_error("$txt[244] $reserved"); }
					else
						if (strstr($namecheck,$reservecheck)) { fatal_error("$txt[244] $reserved"); }
				}
			}
		}
	}

	# Validate the attachment if there is one
	# By Meriadoc 12/11-14/2001

	// change all ' ' to '_'
	$HTTP_POST_FILES['attachment']['name'] = str_replace(' ','_',$HTTP_POST_FILES['attachment']['name']);
	// remove all special chars
	$HTTP_POST_FILES['attachment']['name'] = preg_replace("/[^\w_.-]/","",$HTTP_POST_FILES['attachment']['name']);

	if($HTTP_POST_FILES['attachment']['name'] != "") {
		if($HTTP_POST_FILES['attachment']['size'] > $modSettings['attachmentSizeLimit'] * 1024) { fatal_error("$txt[yse122] $modSettings[attachmentSizeLimit]."); }
		if($modSettings['attachmentCheckExtensions'] == "1") {
			if (!in_array(strtolower(substr(strrchr($HTTP_POST_FILES['attachment']['name'], '.'), 1)),explode(",",strtolower($modSettings['attachmentExtensions'])))) {
				fatal_error("$HTTP_POST_FILES[attachment][name].<br>$txt[yse123] $modSettings[attachmentExtensions].");
			}
		}
		// make sure they aren't trying to upload a nasty file
		$disabledFiles = array('CON','COM1','COM2','COM3','COM4','PRN','AUX','LPT1');
		if (in_array(strtoupper(substr(strrchr($HTTP_POST_FILES['attachment']['name'], '.'), 1)),$disabledFiles)) {
				fatal_error("$HTTP_POST_FILES[attachment][name].<br>$txt[yse130b].");
		}
		if(file_exists($modSettings['attachmentUploadDir'] . "/" . $HTTP_POST_FILES['attachment']['name'])) { fatal_error($txt[yse125]); }
		$dirSize = "0";
		$dir=opendir($modSettings['attachmentUploadDir']);
		while($file=readdir($dir)) {
			$dirSize = $dirSize + filesize($modSettings['attachmentUploadDir'] . "/" .$file);
		}
		if($HTTP_POST_FILES['attachment']['size'] + $dirSize > $modSettings['attachmentDirSizeLimit'] * 1024) { fatal_error($txt[yse126]); }

		$parts = isset($HTTP_POST_FILES['attachment']) ? preg_split("~(\\|/)~",$HTTP_POST_FILES['attachment']['name']) : array();
		$destName = array_pop($parts);

		if(!move_uploaded_file($HTTP_POST_FILES['attachment']['tmp_name'], $modSettings['attachmentUploadDir'] . "/" . $destName)) { fatal_error("$txt[yse124]"); }
		chmod ("$modSettings[attachmentUploadDir]/$destName",0644) || $chmod_failed = 1;
	} else {
		$HTTP_POST_FILES['attachment']['name'] = "NULL";
	}

	# If no thread specified, this is a new thread.
	# Find a valid random ID for it.
	$newtopic = ($threadid == '')?true:false;
	$time = time();
	$se = $ns?0:1;

	if($newtopic)	# This is a new topic. Save it.
	{
		$tmpname = ($HTTP_POST_FILES['attachment']['name']=="NULL")?"NULL":"'".mysql_escape_string($HTTP_POST_FILES['attachment']['name'])."'";
		$request = mysql_query("INSERT INTO {$db_prefix}messages (ID_MEMBER,subject,posterName,posterEmail,posterTime,posterIP,smiliesEnabled,body,icon,attachmentSize,attachmentFilename) VALUES ($ID_MEMBER,'$subject','$name','$email',$time,'$REMOTE_ADDR',$se,'$message','$icon','$attachment_size',$tmpname)");
		$ID_MSG = mysql_insert_id();
		if ($ID_MSG > 0)
		{
			$request = mysql_query("INSERT INTO {$db_prefix}topics (ID_BOARD,ID_MEMBER_STARTED,ID_MEMBER_UPDATED,ID_FIRST_MSG,ID_LAST_MSG,locked,numViews) VALUES ($board,$ID_MEMBER,$ID_MEMBER,$ID_MSG,$ID_MSG,$locked,0)");
			if (mysql_insert_id() > 0)
			{
				$threadid = mysql_insert_id();
				$request = mysql_query("UPDATE {$db_prefix}messages SET ID_TOPIC=$threadid WHERE (ID_MSG=$ID_MSG)");
				$request = mysql_query("UPDATE {$db_prefix}boards SET numPosts=numPosts+1,numTopics=numTopics+1 WHERE (ID_BOARD=$board)");
				$mreplies = 0;
			}
		}
	}
	else			# This is an old thread. Save it.
	{
		$tmpname = ($HTTP_POST_FILES['attachment']['name']=="NULL")?"NULL":"'".mysql_escape_string($HTTP_POST_FILES['attachment']['name'])."'";
		$request = mysql_query("INSERT INTO {$db_prefix}messages (ID_TOPIC,ID_MEMBER,subject,posterName,posterEmail,posterTime,posterIP,smiliesEnabled,body,icon,attachmentSize,attachmentFilename) VALUES ($threadid,$ID_MEMBER,'$subject','$name','$email',$time,'$REMOTE_ADDR',$se,'$message','$icon','$attachment_size',$tmpname)");
		$ID_MSG = mysql_insert_id();
		if ($ID_MSG > 0)
		{
			$request = mysql_query("UPDATE {$db_prefix}topics SET ID_MEMBER_UPDATED=$ID_MEMBER,ID_LAST_MSG=$ID_MSG,numReplies=numReplies+1,locked=$locked WHERE (ID_TOPIC=$threadid)");
			$request = mysql_query("UPDATE {$db_prefix}boards SET numPosts=numPosts+1 WHERE (ID_BOARD=$board)");
			$mreplies ++;
		}
	}

	// clear all the logs of people who read this thread
	$request = mysql_query("DELETE FROM {$db_prefix}log_topics WHERE ID_TOPIC='$threadid'");
	$request = mysql_query("DELETE FROM {$db_prefix}log_boards WHERE ID_BOARD='$board'");

	if($username != 'Guest') {
		++$settings[6];
		$request = mysql_query("UPDATE {$db_prefix}members SET posts=posts+1 WHERE ID_MEMBER=$ID_MEMBER $doLimitOne");

		# Mark thread as read for the member.
		$request = mysql_query("INSERT INTO {$db_prefix}log_topics (logTime,memberName,ID_TOPIC) VALUES (".time().",'$username',$threadid)");
	}

	# The thread ID, regardless of whether it's a new thread or not.
	$thread = $threadid;

	# Notify any members who have notification turned on for this thread.
	NotifyUsers();

	// turn notification on
	if ($notify != '')
	{
		include_once("$sourcedir/Notify.php");
		Notify2();
	}

	# Let's figure out what page number to show
	$start = (floor ($mreplies / $maxmessagedisplay))*$maxmessagedisplay;

//	$yySetLocation = "$cgi;action=display;num=$thread;start=$start";
	$yySetLocation = "$cgi";
	redirectexit();
}

function NotifyUsers (){
	global $subject,$threadid,$txt,$cgi,$db_prefix,$realemail;
	$request = mysql_query("SELECT notifies FROM {$db_prefix}topics WHERE (ID_TOPIC=$threadid && notifies!='') LIMIT 1");
	if (mysql_num_rows($request) != 0)
	{
		$tmp = mysql_fetch_row($request);
		$notifies = explode(",",$tmp[0]);
		foreach ($notifies as $not)
		{
			$request = mysql_query("SELECT emailAddress FROM {$db_prefix}members WHERE ID_MEMBER=$not LIMIT 1");
			if ($not != '' && mysql_num_rows($request) > 0)
			{
				list($email) = mysql_fetch_row($request);
				if ($email==$realemail && $email != '') { continue; }
                $send_subject=$txt[127].": ".$subject;
                $send_body=$txt[128].", ".$txt[129]." $cgi;action=display;threadid=$threadid\n\n".$txt[130];
				sendmail($email,$send_subject,$send_body);
			}
		}
	}
}


function doshowthread (){
	global $censored,$threadid,$enable_ubbc,$txt,$color,$db_prefix,$realNames;
	# Load Censor List
	LoadCensorList();
	$request = mysql_query("SELECT posterName,posterTime,body,smiliesEnabled FROM {$db_prefix}messages WHERE ID_TOPIC='$threadid' ORDER BY ID_MSG DESC");
	if (mysql_num_rows($request)!=0) {
		print <<<EOT
	<BR><BR>
	<table cellspacing=1 cellpadding=0 width="75%" align="center" bgcolor="$color[bordercolor]" class="bordercolor">
	<tr><td>
	<table class="windowbg" cellspacing="1" cellpadding="2" width="100%" align="center" bgcolor="$color[windowbg]">
	<tr><td class="titlebg" bgcolor="$color[titlebg]" colspan=2><font size=2 class="text1" color="$color[titletext]">
	<b>$txt[468]</b></font>
	</td></tr>
EOT;
		while (list ($tempname,$tempdate,$message,$es) = mysql_fetch_row($request))
		{
			LoadRealName($tempname);
			$tempdate = timeformat($tempdate);

			foreach ($censored as $tmpa => $tmpb)
				$message = str_replace($tmpa,$tmpb,$message);
			if($enable_ubbc) { $message = DoUBBC($message,$es); }
			print <<<EOT

<tr><td align=left class="catbg">
<font size=1>$txt[279]: $realNames[$tempname]</font></td>
<td class="catbg" align=right>
<font size=1>$txt[280]: $tempdate</font></td>
</tr>
<tr><td class="windowbg2" colspan=2 bgcolor="$color[windowbg2]">
<font size=1>$message</font>
</td></tr>
EOT;
		}
		print "</table></td></tr></table>\n";
	}
	else { print "<!--no summary-->"; }
}

function printPostBox($msg)
{
	global $txt,$enable_ubbc,$showyabbcbutt,$imagesdir,$ubbcjspath;
if( $enable_ubbc && $showyabbcbutt) {
	print <<<EOT
<tr>
<td align="right"><script language="JavaScript1.2" src="$ubbcjspath" type="text/javascript"></script>
<font size=2><b>$txt[252]:</b></font></td>
<td valign=middle>
<a href="javascript:bold()"><img src="$imagesdir/bold.gif" align=bottom width=23 height=22 alt="$txt[253]" border=0></a><a href="javascript:italicize()"><img src="$imagesdir/italicize.gif" align=bottom width=23 height=22 alt="$txt[254]" border="0"></a><a href="javascript:underline()"><img src="$imagesdir/underline.gif" align=bottom width=23 height=22 alt="$txt[255]" border="0"></a><a href="javascript:strike()"><img src="$imagesdir/strike.gif" align=bottom width=23 height=22 alt="$txt[441]" border="0"></a><a href="javascript:glow()"><img src="$imagesdir/glow.gif" align=bottom width=23 height=22 alt="$txt[442]" border="0"></a><a href="javascript:shadow()"><img src="$imagesdir/shadow.gif" align=bottom width=23 height=22 alt="$txt[443]" border="0"></a><a href="javascript:move()"><img src="$imagesdir/move.gif" align=bottom width=23 height=22 alt="$txt[439]" border="0"></a><a href="javascript:pre()"><img src="$imagesdir/pre.gif" align=bottom width=23 height=22 alt="$txt[444]" border="0"></a><a href="javascript:left()"><img src="$imagesdir/left.gif" align=bottom width=23 height=22 alt="$txt[445]" border="0"></a><a href="javascript:center()"><img src="$imagesdir/center.gif" align=bottom width=23 height=22 alt="$txt[256]" border="0"></a><a href="javascript:right()"><img src="$imagesdir/right.gif" align=bottom width=23 height=22 alt="$txt[446]" border="0"></a><a href="javascript:hr()"><img src="$imagesdir/hr.gif" align=bottom width=23 height=22 alt="$txt[531]" border="0"></a><a href="javascript:size()"><img src="$imagesdir/size.gif" align=bottom width=23 height=22 alt="$txt[532]" border="0"></a><a href="javascript:font()"><img src="$imagesdir/face.gif" align=bottom width=23 height=22 alt="$txt[533]" border="0"></a><br>
<a href="javascript:flash()"><img src="$imagesdir/flash.gif" align=bottom width=23 height=22 alt="$txt[433]" border="0"></a><a href="javascript:hyperlink()"><img src="$imagesdir/url.gif" align=bottom width=23 height=22 alt="$txt[257]" border="0"></a><a href="javascript:ftp()"><img src="$imagesdir/ftp.gif" align=bottom width=23 height=22 alt="$txt[434]" border="0"></a><a href="javascript:image()"><img src="$imagesdir/img.gif" align=bottom width=23 height=22 alt="$txt[435]" border="0"></a><a href="javascript:emai1()"><img src="$imagesdir/email2.gif" align=bottom width=23 height=22 alt="$txt[258]" border="0"></a><a href="javascript:table()"><img src="$imagesdir/table.gif" align=bottom width=23 height=22 alt="$txt[436]" border="0"></a><a href="javascript:trow()"><img src="$imagesdir/tr.gif" align=bottom width=23 height=22 alt="$txt[437]" border="0"></a><a href="javascript:tcol()"><img src="$imagesdir/td.gif" align=bottom width=23 height=22 alt="$txt[449]" border="0"></a><a href="javascript:superscript()"><img src="$imagesdir/sup.gif" align=bottom width=23 height=22 alt="$txt[447]" border="0"></a><a href="javascript:subscript()"><img src="$imagesdir/sub.gif" align=bottom width=23 height=22 alt="$txt[448]" border="0"></a><a href="javascript:teletype()"><img src="$imagesdir/tele.gif" align=bottom width=23 height=22 alt="$txt[440]" border="0"></a><a href="javascript:showcode()"><img src="$imagesdir/code.gif" align=bottom width=23 height=22 alt="$txt[259]" border="0"></a><a href="javascript:quote()"><img src="$imagesdir/quote2.gif" align=bottom width=23 height=22 alt="$txt[260]" border="0"></a><a href="javascript:list()"><img src="$imagesdir/list.gif" align=bottom width=23 height=22 alt="$txt[261]" border="0"></a><select name="txtcolor" onChange="showcolor(this.options[this.selectedIndex].value)">
	<option value="Black" selected>$txt[262]</option>
	<option value="Red">$txt[263]</option>
	<option value="Yellow">$txt[264]</option>
	<option value="Pink">$txt[265]</option>
	<option value="Green">$txt[266]</option>
	<option value="Orange">$txt[267]</option>
	<option value="Purple">$txt[268]</option>
	<option value="Blue">$txt[269]</option>
	<option value="Beige">$txt[270]</option>
	<option value="Brown">$txt[271]</option>
	<option value="Teal">$txt[272]</option>
	<option value="Navy">$txt[273]</option>
	<option value="Maroon">$txt[274]</option>
	<option value="LimeGreen">$txt[275]</option>
</select>
</td>
</tr>
<tr>
<td align="right"><font size=2><b>$txt[297]:</b></font></td>
<td valign=middle>
<a href="javascript:smiley()"><img src="$imagesdir/smiley.gif" align=bottom alt="$txt[287]" border="0"></a> <a href="javascript:wink()"><img src="$imagesdir/wink.gif" align=bottom alt="$txt[292]" border="0"></a> <a href="javascript:cheesy()"><img src="$imagesdir/cheesy.gif" align=bottom alt="$txt[289]" border="0"></a> <a href="javascript:grin()"><img src="$imagesdir/grin.gif" align=bottom alt="$txt[293]" border="0"></a> <a href="javascript:angry()"><img src="$imagesdir/angry.gif" align=bottom alt="$txt[288]" border="0"></a> <a href="javascript:sad()"><img src="$imagesdir/sad.gif" align=bottom alt="$txt[291]" border="0"></a> <a href="javascript:shocked()"><img src="$imagesdir/shocked.gif" align=bottom alt="$txt[294]" border="0"></a> <a href="javascript:cool()"><img src="$imagesdir/cool.gif" align=bottom alt="$txt[295]" border="0"></a> <a href="javascript:huh()"><img src="$imagesdir/huh.gif" align=bottom alt="$txt[296]" border="0"></a> <a href="javascript:rolleyes()"><img src="$imagesdir/rolleyes.gif" align=bottom alt="$txt[450]" border="0"></a> <a href="javascript:tongue()"><img src="$imagesdir/tongue.gif" align=bottom alt="$txt[451]" border="0"></a> <a href="javascript:embarassed()"><img src="$imagesdir/embarassed.gif" align=bottom alt="$txt[526]" border="0"></a> <a href="javascript:lipsrsealed()"><img src="$imagesdir/lipsrsealed.gif" align=bottom alt="$txt[527]" border="0"></a> <a href="javascript:undecided()"><img src="$imagesdir/undecided.gif" align=bottom alt="$txt[528]" border="0"></a> <a href="javascript:kiss()"><img src="$imagesdir/kiss.gif" align=bottom alt="$txt[529]" border="0"></a> <a href="javascript:cry()"><img src="$imagesdir/cry.gif" align=bottom alt="$txt[530]" border="0"></a>
</td>
</tr>
<tr>
	<td valign=top align="right"><font size=2><b>$txt[72]:</b></font></td>
	<td><textarea name=message rows=12 cols=60 ONSELECT="javascript:storeCaret(this);" ONCLICK="javascript:storeCaret(this);" ONKEYUP="javascript:storeCaret(this);" ONCHANGE="javascript:storeCaret(this);">$msg</textarea></td>
</tr>
EOT;
}
}
?>
file|^|Sources/Profile.php|^|37522|^|1008875952
<?php
/*****************************************************************************/
/* Profile.php                                                               */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$profileplver="YaBB SE";

function ModifyProfile (){
	global $user,$username,$txt,$yytitle,$settings,$img,$cgi,$timeformatstring,$color,$imagesdir;
	global $GenderMale,$GenderFemale,$allowpics,$facesdir,$userpic_limits,$facesurl,$allow_hide_email;
	global $MaxSigLen,$timeformatstring,$db_prefix;
	if($username != $user && $settings[7] != 'Administrator')
		fatal_error($txt[80]);
	
	$yytitle = $txt[79];
	$request = mysql_query("SELECT passwd,realName,emailAddress,websiteTitle,websiteUrl,signature,posts,memberGroup,ICQ,AIM,YIM,gender,personalText,avatar,dateRegistered,location,birthdate,timeFormat,timeOffset,hideEmail,ID_MEMBER FROM {$db_prefix}members WHERE memberName='$user'");
	$memsettings = mysql_fetch_array($request);
	$dr = ($memsettings['dateRegistered'] && $memsettings['dateRegistered'] != '0000-00-00') ? date("F j,Y h:i:s a",$memsettings['dateRegistered']) : $txt[470];
	if (isset($memsettings['gender'])) {
		if ($memsettings['gender'] == 'Male')
			$GenderMale = ' selected';
		else if ($memsettings['gender'] == 'Female')
			$GenderFemale = ' selected';
	}
	$signature = isset($memsettings['signature'])?$memsettings['signature']:'';
	$signature = str_replace("&lt;","<",$signature);
	$signature = str_replace("&gt;",">",$signature);
	list($uyear,$umonth,$uday) = explode("-",$memsettings['birthdate']);

	$memsettings['AIM'] = isset($memsettings['AIM'])?str_replace("+"," ",$memsettings['AIM']):'';

	// set up the default values
	$memsettings['realName'] = isset($memsettings['realName'])?$memsettings['realName']:'';
	$memsettings['location'] = isset($memsettings['location'])?$memsettings['location']:'';
	$memsettings['websiteTitle'] = isset($memsettings['websiteTitle'])?$memsettings['websiteTitle']:'';
	$memsettings['websiteUrl'] = isset($memsettings['websiteUrl'])?$memsettings['websiteUrl']:'';
	$memsettings['ICQ'] = isset($memsettings['ICQ'])?$memsettings['ICQ']:'';
	$memsettings['YIM'] = isset($memsettings['YIM'])?$memsettings['YIM']:'';
	$memsettings['timeFormat'] = isset($memsettings['timeFormat'])?$memsettings['timeFormat']:'';
	$memsettings['timeOffset'] = isset($memsettings['timeOffset'])?$memsettings['timeOffset']:'0';
	
	template_header();

	$proftime = date("h:i:s a",time());

	print <<<EOT
<form action="$cgi;action=profile2" method="POST" name="creator">
<table border=0 width="80%" cellspacing=1 bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]" height="30">
    &nbsp;<img src="$imagesdir/profile_sm.gif" alt="" border="0">&nbsp;
    <font size=2 class="text1" color="$color[titletext]"><b>$txt[79]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]" height="25"><BR><font size=1>$txt[698]</font><BR><BR></td>
  </tr><tr>
    <td class="catbg" bgcolor="$color[catbg]" height="25"><font size=2><b>$txt[517]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]">
    <table border=0 width="100%" cellpadding="3">
      <tr>
	<td width="45%"><font size=2><b>$txt[35]: </b></font></td>
	<td><font size=2><input type="hidden" name="userID" value="$memsettings[ID_MEMBER]"><input type="hidden" name="user" value="$user">$user</font></td>
      </tr><tr>
	<td width="45%"><font size=2><b>$txt[81]: </b></font><BR>
	<font size=1>$txt[596]</font></td>
	<td><input type="password" name="passwrd1" size="20"></td>
      </tr><tr>
	<td width="45%"><font size=2><b>$txt[82]: </b></font></td>
	<td><input type="password" name="passwrd2" size="20"></td>
      </tr><tr>
	<td width="45%"><font size=2><b>$txt[68]: </b></font><BR>
	<font size=1>$txt[518]</font></td>
	<td><input type="text" name="name" size="30" value="$memsettings[realName]"></td>
      </tr><tr>
	<td width="45%"><font size=2><b>$txt[69]: </b></font><BR>
        <font size="1">$txt[679]</font></td>
	<td><input type="text" name="email" size="30" value="$memsettings[emailAddress]"></td>
      </tr>
    </table><BR>
    </td>
  </tr><tr>
    <td class="catbg" bgcolor="$color[catbg]" height="25"><font size=2><b>$txt[597]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]">
    <table border=0 width="100%" cellpadding="3">
      <tr>
	<td width="45%"><font size=2><b>$txt[231]: </b></font></td>
	<td>
	<select name="gender" size="1">
	 <option value=""></option>
	 <option value="Male"$GenderMale>$txt[238]</option>
	 <option value="Female"$GenderFemale>$txt[239]</option>
	</select>
	</td>
      </tr><tr>
	<td width="45%"><font size=2><b>$txt[563]:</b></font></td>
	<td><font size=1>$txt[564]<input type="text" name="bday1" size="2" maxlength="2" value="$umonth">$txt[565]<input type="text" name="bday2" size="2" maxlength="2" value="$uday">$txt[566]<input type="text" name="bday3" size="4" maxlength="4" value="$uyear"></font></td>
      </tr><tr>
	<td width="45%"><font size=2><b>$txt[227]: </b></font></td>
	<td><font size=2><input type="text" name="location" size="50" value="$memsettings[location]"></font></td>
      </tr><tr>
	<td colspan=2>
	<BR><hr width="100%" size="1" class="windowbg3"></td>
      </tr><tr>
	<td width="45%"><font size=2><b>$txt[83]: </b></font><BR>
	<font size=1>$txt[598]</font></td>
	<td><font size=2><input type=text name=websitetitle size=50 value="$memsettings[websiteTitle]"></font></td>
      </tr><tr>
	<td width="45%"><font size=2><b>$txt[84]: </b></font><BR>
	<font size=1>$txt[599]</font></td>
	<td><font size=2><input type=text name=websiteurl size=50 value="$memsettings[websiteUrl]"></font></td>
      </tr><tr>
	<td colspan=2>
	<BR><hr width="100%" size="1" class="windowbg3"></td>
      </tr><tr>
	<td width="45%"><font size=2><b>$txt[513]: </b></font><BR>
	<font size=1>$txt[600]</font></td>
	<td><font size=2><input type=text name=icq size=20 value="$memsettings[ICQ]"></font></td>
      </tr><tr>
	<td width="45%"><font size=2><b>$txt[603]: </b></font><BR>
	<font size=1>$txt[601]</font></td>
	<td><font size=2><input type=text name=aim size=20 value="$memsettings[AIM]"></font></td>
      </tr><tr>
	<td width="45%"><font size=2><b>$txt[604]: </b></font><BR>
	<font size=1>$txt[602]</font></td>
	<td><font size=2><input type=text name=yim size=20 value="$memsettings[YIM]"></font></td>
      </tr><tr>
	<td colspan=2>
	<BR><hr width="100%" size="1" class="windowbg3"></td>
      </tr><tr>
	<td width="45%"><font size=2><b>$txt[228]: </b></font></td>
	<td><font size=2><input type=text name=usertext size=50 maxlength=50 value="$memsettings[personalText]"></font></td>
      </tr>
EOT;
if($allowpics) {
	$dir = opendir("$facesdir");
	$contents = array();
	while ($contents[] = readdir($dir)){;}  
	closedir($dir);
	$images = "";
	natcasesort ($contents);
	foreach ($contents as $line){
		$filename = substr($line,0,(strlen($line)-strlen(strrchr($line,'.'))));
		$extension = substr(strrchr($line,'.'), 1);
		$checked = "";
		if ($line == $memsettings[13]) { $checked = ' selected'; }
		if (stristr($memsettings[13],"http://") && $line == 'blank.gif') { $checked = ' selected'; }
		if (strcasecmp($extension,"gif")==0 || strcasecmp($extension,"jpg")==0 || strcasecmp($extension,"jpeg")==0 || strcasecmp($extension,"png")==0 ){
			if ($line == 'blank.gif') { $filename = $txt[422]; }
			$images .= "<option value=\"$line\"$checked>$filename</option>\n";
		}
	}
	if (stristr($memsettings[13],"http://")) {
		$pic = 'blank.gif';
		$checked = ' checked';
		$tmp = $memsettings[13];
	}
	else {
		$pic = $memsettings[13];
		$tmp = 'http://';
	}

	print <<<EOT
      <tr>
	<td width="45%"><font size=2><b>$txt[229]:</B></font><BR>
	<font size=1>$txt[474] $userpic_limits</font></td>
        <td>
        <script language="JavaScript1.2" type="text/javascript">
        function showimage(){
       			document.images.icons.src="$facesurl/"+document.creator.userpic.options[document.creator.userpic.selectedIndex].value;
        }
        </script>
        <select name="userpic" size=6 onChange="showimage()">$images</select>
        &nbsp;&nbsp;<img src="$facesurl/$pic" name="icons" border=0 hspace=15 alt="">
	</td>
      </tr><tr>
	<td width="45%"><font size="2"><B>$txt[475]</B></font></td>
	<td><input type="checkbox" name="userpicpersonalcheck"$checked>
	<input type="text" name="userpicpersonal" size="45" value="$tmp"></td>
      </tr>
EOT;
}
print <<<EOT
    </table><BR>
    </td>
  </tr><tr>
    <td class="catbg" bgcolor="$color[catbg]" height="25"><font size=2><b>$txt[605]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]">
    <table border=0 cellpadding="3" cellspacing="0">
EOT;
if ($allow_hide_email) { 
	$memsettings['hideEmail'] = ($memsettings['hideEmail']==1)?' checked':'';
	print <<<EOT
    <tr>
	<td width="45%"><font size=2><b>$txt[721]</b></font></td>
	<td><input type="checkbox" name="hideemail"$memsettings[hideEmail]></td>
    </tr>
EOT;
}
print <<<EOT
      <tr>
	<td width="45%"><script language="javascript" TYPE="text/javascript">
		<!--
		function reqWin(desktopURL){
        desktop =window.open(desktopURL,"name","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,width=480,height=200,resizable=no");
        }
		// -->
	</script><font size=2><b>$txt[486]:</b></font><BR>
	<a href="javascript:reqWin('help.php?help=12')" class="help"><img src="$imagesdir/helptopics.gif" border="0" alt="$txt[119]" align="left"></a><font size=1>$txt[479]</font></td>
	<td width="50">
	<input type="text" name="usertimeformat" value="$memsettings[timeFormat]">
	</td>
      </tr><tr>
	<td width="45%"><font size=2><b>$txt[371]:</b></font><BR>
	<font size=1>$txt[519]</font></td>
	<td><font size=1>
	<input name="usertimeoffset" size=5 maxlength=5 value=$memsettings[18]>
	<BR>$txt[741]: <i>$proftime</i></font></td>
      </tr><tr>
	<td colspan=2><hr width="100%" size="1" class="windowbg3"></td>
      </tr><tr>
	<td width="45%"><font size=2><b>$txt[85]:</b></font><BR>
	<font size=1>$txt[606]</font></td>
	<td><font size=2><textarea name="signature" rows="4" cols="50">$signature</textarea><BR>
	<FONT SIZE="1">$txt[664] <input value="$MaxSigLen" size="3" name="msgCL" disabled></FONT><BR><BR></font>
	<script language="JavaScript" TYPE="text/javascript">
	<!--
	var supportsKeys = false
	function tick() {
	calcCharLeft(document.forms[0])
	if (!supportsKeys) timerID = setTimeout("tick()",$MaxSigLen)
	}

	function calcCharLeft(sig) {
	clipped = false
	maxLength = $MaxSigLen
	if (document.creator.signature.value.length > maxLength) {
		document.creator.signature.value = document.creator.signature.value.substring(0,maxLength)
		charleft = 0
		clipped = true
	} else {
		charleft = maxLength - document.creator.signature.value.length
	}
	document.creator.msgCL.value = charleft
	return clipped
	}

	tick();
	//-->
	</script>	

	</td></tr>

EOT;
	$request = mysql_query("SELECT membergroup FROM {$db_prefix}membergroups ORDER BY ID_GROUP");
	$lines = array();
	while ($row = mysql_fetch_row($request))
		$lines[] = $row[0];
	if($settings[7] == 'Administrator') {
		$position='';
		foreach ($lines as $curl) {
			if($curl != $lines[1] && $curl != $lines[2] && $curl != $lines[3] && $curl != $lines[4] && $curl != $lines[5] && $curl != $lines[6]) {
				if($curl != $lines[0] && $curl != $lines[7]) { $position= "$position<option>$curl</option>"; }
				elseif($curl == $lines[0]) { $position= "$position<option value=\"Administrator\">$curl</option>"; }
				elseif($curl == $lines[7]) { $position= "$position<option value=\"Global Moderator\">$curl</option>"; }
			}
		}
		if($memsettings[7] == 'Administrator') { $tt = $lines[0]; }
		elseif($memsettings[7] == 'Global Moderator') { $tt = $lines[7]; }
		else { $tt = $memsettings[7]; }
		print <<<EOT
      <tr>
	<td colspan=2><hr width="100%" size="1" class="windowbg3"></td>
      </tr><tr>
	<td width="45%"><font size=2><b>$txt[86]: </b></font></td>
	<td><font size=2><input type=text name=settings6 size=4 value="$memsettings[6]"></font></td>
      </tr><tr>
	<td width="45%"><font size=2><b>$txt[87]: </b></font></td>
	<td><font size=2><select name="settings7">
	 <option value="$memsettings[7]">$tt
	 <option value="$memsettings[7]">---------------
	 <option value="">
	 $position
	</select></font></td>
      </tr><tr>
        <td width="45%"><font size=2><b>$txt[233]:</b></font></td>
        <td><input type="text" name="dr" size="30" value="$dr"></td></tr>
EOT;
	}
	print <<<EOT
	<tr><td align="center" colspan="2"><BR><input type=submit name=moda value="$txt[88]">
	<input type=submit name=moda value="$txt[89]"><BR><BR>
	</td>
      </tr>
    </table>
    </td>
  </tr>
</table>
</form>
EOT;
	footer();
	obExit();
}

function ModifyProfile2 (){
	global $HTTP_POST_VARS,$username,$settings,$txt,$allowpics,$emailnewpass,$MaxSigLen,$Cookie_Length;
	global $newpassemail,$yySetCookies,$password,$realname,$realemail,$pwseed,$cookieusername,$cookiepassword;
	global $usertimeoffset,$userID,$sourcedir,$scripturl,$cgi,$boardurl,$db_prefix,$yySetLocation;
//	foreach ($HTTP_GET_VARS as $key=>$value)
//		$member[$key]=trim($values);
	foreach ($HTTP_POST_VARS as $key=>$value)
		$member[$key]=str_replace(array("&","\"","<",">"),array('&amp','&quot','&lt','&gt'),trim($value));

	# make sure this person has access to this profile
	if($username != $member['user'] && $settings[7] != 'Administrator')
		fatal_error($txt[80]);
	if( $settings[7] != 'Administrator' ) {
		$member['user'] = $username;
		$member['settings6'] = $settings[6];
		$member['settings7'] = $settings[7];
	}
	if(!is_numeric($member['settings6'])) { fatal_error("$txt[749]"); }
	$user = $member['user'];
	if( isset($member['userpicpersonalcheck']) )
		$member['userpic'] = $member['userpicpersonal'];

	if($member['userpic'] == "") { $member['userpic'] = "blank.gif"; }
//	&fatal_error("$txt[592]") if($member['userpic'] !~ m^\A[0-9a-zA-Z_\.\#\%\-\:\+\?\$\&\~\.\,\@/]+\Z^);
	if(!$allowpics) { $member['userpic'] = "blank.gif"; }
	$queryPasswdPart = '';
	mt_srand(34028934023); //pseudo-random seed
	if( $member['passwrd1'] == '' && $emailnewpass && strtolower($member['email']) != strtolower($settings[2]) && $settings[7] != 'Administrator') {
		$member['passwrd1'] = crypt(mt_rand(-100000,100000));
		$newpassemail = 1;
	} else {
		if($member['passwrd1'] != $member['passwrd2']){ fatal_error("($member[username]) $txt[213]"); }
//		if($member['passwrd1'] == ''){ fatal_error("($member[username]) $txt[91]"); }
		if($member['passwrd1'] != ''){ $queryPasswdPart="passwd='".crypt($member['passwrd1'], substr($member['passwrd1'],0,2))."',"; }
//		&fatal_error("$txt[241]") if($member['passwrd1'] !~ /\A[\s0-9A-Za-z!@#$%\^&*\(\)_\+|`~\-=\\:;'",\.\/?\[\]\{\}]+\Z/);
	}
// the next is a stupid requirement - requiring a valid real name
//	if($member['name'] == ''){ fatal_error("$txt[75]");}
//	if(!preg_match("/^[\s0-9A-Za-z\[\]#%+,-|\.:=?@^_]+$/",$member['name'])){ fatal_error("$txt[242]"); }
//	if($member['name'] == '|'){fatal_error("$txt[75]"); }
//	if(length($member[name]) > 20){fatal_error("$txt[568]") };
	if($member['email'] == '') { fatal_error("$txt[76]"); }
	if(!preg_match("/^[0-9A-Za-z@\._\-]+$/",$member['email'])){ fatal_error("$txt[243]"); }
	if(preg_match("/(@.*@)|(\.\.)|(@\.)|(\.@)|(^\.)|(\.$)/",$member['email'])){ fatal_error("$txt[500]"); }

// this is also dumb - forcing a valid bday :P
//	if( $member['bday1'] != "") {
#		if ((!is_numeric($member[bday1]) || (!is_numeric($member[bday2]) || (!is_numeric($member[bday3]) || (strlen($member[bday3] < 4)){ fatal_error("$txt[567]"); }
//		if (!checkdate($member['bday1'],$member['bday2'],$member['bday3'])){ fatal_error("$txt[567]"); }
//	}
//	if ($member['user'] == "admin" && $member['settings7'] != "Administrator"){ fatal_error("$txt[680]"); }
	
	if($member['moda'] == $txt[88]) {
		if (strlen($member['signature']) > $MaxSigLen) { $member['signature'] = substr($member['signature'],0,$MaxSigLen); }
	    $member['icq'] = preg_replace("[^0-9]","",$member['icq']);
	    $member['bday1'] = preg_replace("[^0-9]","",$member['bday1']);
	    $member['bday2'] = preg_replace("[^0-9]","",$member['bday2']);
	    $member['bday3'] = preg_replace("[^0-9]","",$member['bday3']);
		$months = array(1=>"jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec");
	if($member['bday1']) { $member['bday'] = "$member[bday3]-$member[bday1]-$member[bday2]"; }
		else { $member['bday'] = ''; }
		$member['signature'] = str_replace("<","&lt;",$member['signature']);
		$member['signature'] = str_replace(">","&gt;",$member['signature']);
		$member['aim'] = str_replace(" ","+",$member['aim']);
		$member['yim'] = str_replace(" ","+",$member['yim']);
		if($settings[7] != "Administrator" || $member['dr']==$txt[470])
			$member['dr'] = $settings[14];
		else
			$member['dr'] = strtotime($member['dr']);
		# store the name temorarily so we can restore any _'s later
		$tempname = $member['name'];
		$member['name'] = str_replace("_"," ",$member['name']);

		if ( strlen($member['signature']) > 1000 ) { $member['signature'] = substr( $member['signature'], 0, 1000 ); }
		$member['usertimeoffset'] = str_replace(",",".",$member['usertimeoffset']);
		$member['usertimeoffset'] = preg_replace("[^\d*|\.|\-|w*]","",$member['usertimeoffset']);
		if (( $member['usertimeoffset'] < -23.5) || ( $member['usertimeoffset'] > 23.5)) { fatal_error($txt[487]); }

		$request = mysql_query("SELECT ID_MEMBER FROM {$db_prefix}members WHERE ('$member[name]'!='' && memberName!='$member[user]' && realName='$member[name]')");
		if (mysql_num_rows($request) > 0)
			fatal_error("($member[name]) $txt[473]");
		$request = mysql_query("SELECT ID_MEMBER FROM {$db_prefix}members WHERE (memberName!='$member[user]' &&  emailAddress='$member[email]')");
		if (mysql_num_rows($request) > 0)
			fatal_error("$txt[730] ($member[email]) $txt[731]");

		$request = mysql_query("SELECT setting,value FROM {$db_prefix}reserved_names WHERE 1");
		$reserve = array();
		$matchcase = $matchname = $matchuser = $matchword = 0;
		while ($row = mysql_fetch_row($request))
		{
			if ($row[0] == "word")
				$reserve[] = trim($row[1]);
			else
				${$row[0]} = trim($row[1]);
		}
		$namecheck = $matchcase ? $member['name'] : strtolower ($member['name']);

		foreach ($reserve as $reserved) {
			$reservecheck = $matchcase ? $reserved : strtolower ($reserved);
			if ($matchname) {
				if ($matchword) {
					if ($namecheck == $reservecheck) { fatal_error("$txt[244] $reserved"); }
				}
				else {
					if (strstr($namecheck,$reservecheck)) { fatal_error("$txt[244] $reserved"); }
				}
			}
		}

		# let's restore the name now
		//ToHTML($tempname);
		$member['name'] = $tempname;

		$hideEmail = 0;
		if (isset($member['hideemail']))
			$hideEmail = 1;
		$timeOffest = 0;
		if ($usertimeoffset != '')
			$timeOffest = $usertimeoffset;

        if (substr($member[websiteurl],0,7)!="http://") {

           $member[websiteurl]="http://".$member[websiteurl];
        }
		$request = mysql_query("UPDATE {$db_prefix}members SET $queryPasswdPart realName='$member[name]',emailAddress='$member[email]',websiteTitle='$member[websitetitle]',websiteUrl='$member[websiteurl]',signature='$member[signature]',posts=$member[settings6],memberGroup='$member[settings7]',ICQ='$member[icq]',AIM='$member[aim]',YIM='$member[yim]',gender='$member[gender]',personalText='$member[usertext]',avatar='$member[userpic]',dateRegistered='$member[dr]',location='$member[location]',birthdate='$member[bday]',timeFormat='$member[usertimeformat]',timeOffset=$timeOffest,hideEmail=$hideEmail WHERE memberName='$user'");

	if($newpassemail) {
		
	$request = mysql_query("DELETE FROM {$db_prefix}log_online WHERE identity='$username'");

	$yySetCookies = "Set-Cookie: $cookieusername=; expires=Thu, 01-Jan-1970 00:00:00 GMT;\n";
	$yySetCookies .= "Set-Cookie: $cookiepassword=; expires=Thu, 01-Jan-1970 00:00:00 GMT;\n";
	$yySetCookies .= "Set-Cookie: $cookieusername=; path=/; expires=Thu, 01-Jan-1970 00:00:00 GMT;\n";
	$yySetCookies .= "Set-Cookie: $cookiepassword=; path=/; expires=Thu, 01-Jan-1970 00:00:00 GMT;\n";
	$username = 'Guest';
	$password = '';
	$settings = array(7=>'');
	$realname = '';
	$realemail = '';
	$HTTP_COOKIE_VARS = array();
	
	$yytitle="$txt[245]";
	template_header();

		sendmail($member['email'],"$txt[700] $mbname", "$txt[733] $member[passwrd1] $txt[734] $member[user].\n\n$txt[701] $scripturl?action=profile;user=$member[user]\n\n$txt[130]");
		print <<<EOT
<BR>
<table border=0 width=100% cellspacing=1 bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$txt[97]</b></font></td>
  </tr><tr>
   <td class="windowbg" bgcolor="$color[windowbg]" align="left" cellpadding=3><font size=2>$txt[638]</font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg2]" valign=top><form action="$cgi;action=login2" method="POST">
    <table border=0>
      <tr>
        <td><font size=2><b>$txt[35]:</b></font></td>
        <td><font size=2><input type=text name="user" size=15 value="$member[user]"></font></td>
        <td><font size=2><b>$txt[36]:</b></font></td>
        <td><font size=2><input type=password name="passwrd" size=15></font> &nbsp;</td>
        <td><font size=2><b>$txt[497]:</b></font></td>
        <td><font size=2><input type=text name="cookielength" size=4 value="$Cookie_Length">
        <td><font size=2><b>$txt[508]:</B></font></td>
        <td><font size=2><input type=checkbox name="cookieneverexp"></font></td> &nbsp;</font></td>
        <td align=center colspan=2><input type=submit value="$txt[34]"></td>
      </tr>
    </table>
    </td>
  </tr>
</table>
EOT;
	footer();
	}
	else {
		if ( $member['user'] == $username ) {
			$Cookie_Exp_Date = 'Sun, 17-Jan-2038 00:00:00 GMT';
			$password = ($member['passwrd1']!= '')?crypt("$member[passwrd1]",$pwseed):$password;
			
			setCookie($cookieusername,$username, time()+30240000);
			setCookie($cookiepassword,$password, time()+30240000);

			LoadUserSettings();
			WriteLog();
		}
		ViewProfile();
	}
	} else {

		if(($settings[7] == 'Administrator' || $member['user'] == $username) && strcasecmp($member['user'],'admin') != 0) {
				$request = mysql_query("UPDATE {$db_prefix}messages SET ID_MEMBER='-1' WHERE ID_MEMBER='$userID'");
				$request = mysql_query("DELETE FROM {$db_prefix}members WHERE memberName='$member[user]'");
				$request = mysql_query("DELETE FROM {$db_prefix}log_topics WHERE memberName='$member[user]'");
				$request = mysql_query("DELETE FROM {$db_prefix}log_boards WHERE memberName='$member[user]'");
				$request = mysql_query("DELETE FROM {$db_prefix}log_mark_read WHERE memberName='$member[user]'");
				$request = mysql_query("DELETE FROM {$db_prefix}instant_messages WHERE (toName='$member[user]' AND deletedBy=0)");
				$request = mysql_query("DELETE FROM {$db_prefix}instant_messages WHERE (fromName='$member[user]' AND deletedBy=1)");
				$request = mysql_query("UPDATE {$db_prefix}instant_messages SET deletedBy=1 WHERE toName='$member[user]'");
				$request = mysql_query("UPDATE {$db_prefix}instant_messages SET deletedBy=0 WHERE fromName='$member[user]'");
				
		}

		if ( strcasecmp($member['user'],'admin') != 0)
		{
			$request = mysql_query("SELECT ID_TOPIC,notifies FROM {$db_prefix}topics WHERE notifies!=''");
			while ($row = mysql_fetch_row($request))
			{
				$entries = explode(",",$row[1]);
				$entries2 = array();
				foreach($entries as $entry)
					if (strcasecmp($entry,$userID)!=0)
						$entries2[] = $entry;
				$request2 = mysql_query("UPDATE {$db_prefix}topics SET notifies='".implode(",",$entries2)."' WHERE ID_TOPIC=$row[0]");
			}
		}
			
		if($settings[7] != 'Administrator') {
			include_once ("$sourcedir/LogInOut.php");
			Logout();
		}
		$yySetLocation = "$scripturl";
		redirectexit();
	}
}

function ViewProfile (){
    global $user, $modify, $userpic_width, $facesurl, $userpic_height, $allowpics, $txt, $color, $cgi, $GodPostNum;
	global $SrPostNum, $FullPostNum, $JrPostNum, $settings, $allow_hide_email, $imagesdir,$yytitle;
	global $username,$password,$pwseed,$action,$cookiepassword,$cookieusername,$db_prefix;

	$request = mysql_query("SELECT ID_MEMBER FROM {$db_prefix}members WHERE memberName='$user'");

	if(!$request || mysql_num_rows($request) == 0){ fatal_error("$txt[453] -- ".htmlentities($user)); }

	$yytitle = "$txt[92] $user";
    template_header();

	# get the member's info
	$request = mysql_query("SELECT passwd,realName,emailAddress,websiteTitle,websiteUrl,signature,posts,memberGroup,ICQ,AIM,YIM,gender,personalText,avatar,dateRegistered,location,birthdate,timeFormat,timeOffset,hideEmail,ID_MEMBER FROM {$db_prefix}members WHERE memberName='$user'");
	$memsettings = mysql_fetch_row($request);

	$icq = $memsettings[8];
	$memsettings[9] = str_replace("+"," ",$memsettings[9]);;
	$dr = "";
	if (!isset($memsettings[14]) || $memsettings[14] == "") { $dr = "$txt[470]"; }
	else { $dr = "$memsettings[14]"; $dr = timeformat($dr); }
	$datearray = getdate(time());
	$age = '';
	$isbday = false;
	if (!isset($memsettings[16]) || $memsettings[16] =='0000-00-00' || $memsettings[16]=='')
		$age = "N/A";
	else
	{
		$age = $datearray['year']-substr($memsettings[16],0,4)-(($datearray['mon']>substr($memsettings[16],5,2)||$datearray['mon']==substr($memsettings[16],5,2) && $datearray['mday']>=substr($memsettings[16],8,2))?0:1);
		$isbday = ($datearray['mon']==substr($memsettings[16],5,2) && $datearray['mday']==substr($memsettings[16],8,2));
	}
		
	if($isbday)
		$isbday = "<img src=\"$imagesdir/bdaycake.gif\" width=\"40\" alt=\"\">";
	else
		$isbday = '';

	$request = mysql_query("SELECT membergroup FROM {$db_prefix}membergroups WHERE 1 ORDER BY ID_GROUP");

	$membergroups = array();

	while ($row = mysql_fetch_row($request))
		$membergroups[] = $row[0];

	if($memsettings[6] > $GodPostNum) { $memberinfo = "$membergroups[6]"; }
 	elseif($memsettings[6] > $SrPostNum) { $memberinfo = "$membergroups[5]"; }
	elseif($memsettings[6] > $FullPostNum) { $memberinfo = "$membergroups[4]"; }
	elseif($memsettings[6] > $JrPostNum) { $memberinfo = "$membergroups[3]"; }
	else { $memberinfo = "$membergroups[2]"; }

	if($memsettings[7] != "") { $memberinfo = "$memsettings[7]"; }
	if($memsettings[7] == "Administrator") { $memberinfo = "$membergroups[0]"; }

	if ($username == $user || $settings[7] == "Administrator") {
		$modify = "&quot; <a href=\"$cgi;action=profile;user=$user\"><font size=2 class=\"text1\" color=\"$color[titletext]\">$txt[17]</font></a> &quot;";
	}

  	if ($memsettings[19] != "1" || $settings[7] == "Administrator" || $allow_hide_email != '1') {
		$email = "<a href=\"mailto:$memsettings[2]\">$memsettings[2]</a>";
	}
	else { $email = "<i>$txt[722]</i>"; }
	$gender = "";

	if ($memsettings[11] == "Male") { $gender = "$txt[238]"; }
	if ($memsettings[11] == "Female") { $gender = "$txt[239]"; }
	if($allowpics) {
	if (stristr($memsettings[13],"http://") ) {
		if ($userpic_width != 0) { $tmp_width = "width=$userpic_width"; } else { $tmp_width=""; }
		if ($userpic_height != 0) { $tmp_height = "height=$userpic_height"; } else { $tmp_height=""; }

		$pic = "<a href=\"$memsettings[13]\" target=\"_blank\" onClick=\"window.fopen('$memsettings[13]', 'ppic$user', 'resizable,width=200,height=200'); return false;\">";
		$pic = "<img src=\"$memsettings[13]\" $tmp_width $tmp_height border=\"0\" alt=\"\">";
	}
	else {
		$pic = "<a href=\"$facesurl/$memsettings[13]\" target=\"_blank\" onClick=\"window.fopen('$facesurl/$memsettings[13]', 'ppic$user', 'resizable,width=200,height=200'); return false;\">";
		$pic = "<img src=\"$facesurl/$memsettings[13]\" border=\"0\" alt=\"\">";
	}
	}

	$online = "$txt[113] ?";
	$request = mysql_query("SELECT identity FROM {$db_prefix}log_online WHERE identity='$user'");
	if (mysql_num_rows($request) > 0)
		$online = str_replace ("?","<i>$txt[686]</i>.",$online);

	$online = str_replace("?","<i>$txt[687]</i>",$online);
	if($memsettings[6] > 100000) { $memsettings[6] = "$txt[683]"; }


print <<<EOT
 <table border="0" cellpadding="4" cellspacing="1" bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td class="titlebg" colspan="2" bgcolor="$color[titlebg]">
    <table border="0" cellspacing="0" cellpadding="0" width="100%">
      <tr>
	<td width="220" height="30">
        <img src="$imagesdir/profile_sm.gif" alt="" border="0">&nbsp;
        <font size=2 class="text1" color="$color[titletext]"><B>$txt[35]: $user</b></font></td>
	<td align="center" width="200">
        <font size=2 class="text1" color="$color[titletext]">$modify</font></td>
	<td align="center" width="150">
        <font size=2 class="text1" color="$color[titletext]">$txt[232]</font></td>
      </tr>
    </table>
    </td>
  </tr><tr>
    <td bgcolor="$color[windowbg]" class="windowbg" width="420">
    <table border=0 cellspacing="0" cellpadding="2" width="100%">
      <tr>
	<td><font size=2><b>$txt[68]: </b></font></td>
	<td><font size=2>$memsettings[1]</font></td>
      </tr><tr>
        <td><font size=2><b>$txt[86]: </b></font></td>
        <td><font size=2>$memsettings[6]</font></td>
      </tr><tr>
        <td><font size=2><b>$txt[87]: </b></font></td>
        <td><font size=2>$memberinfo</font></td>
      </tr><tr>
        <td><font size=2><b>$txt[233]: </b></font></td>
        <td><font size=2>$dr</font></td>
      </tr><tr>
	<td colspan="2"><hr size="1" width="100%" class="windowbg3"></td>
      </tr><tr>
        <td><font size=2><b>$txt[513]:</b></font></td>
        <td><font size=2><a href="$cgi;action=icqpager;UIN=$icq" target=_blank>$memsettings[8]</a></font></td>
      </tr><tr>
        <td><font size=2><b>$txt[603]: </b></font></td>
        <td><font size=2><a href="aim:goim?screenname=$memsettings[9]&message=Hi.+Are+you+there?">$memsettings[9]</a></font></td>
      </tr><tr>
        <td><font size=2><b>$txt[604]: </b></font></td>
        <td><font size=2><a href="http://edit.yahoo.com/config/send_webmesg?.target=$memsettings[10]">$memsettings[10]</a></font></td>
      </tr><tr>
	<td><font size=2><b>$txt[69]: </b></font></td>
	<td><font size=2>$email</font></td>
      </tr><tr>
        <td><font size=2><b>$txt[96]: </b></font></td>
        <td><font size=2><a href="$memsettings[4]" target=_blank>$memsettings[3]</a></font></td>
      </tr><tr>
	<td colspan="2"><hr size="1" width="100%" class="windowbg3"></td>
      </tr><tr>
	<td><font size=2><b>$txt[231]: </b></font></td>
	<td><font size=2>$gender</font></td>
      </tr><tr>
        <td><font size=2><b>$txt[420]:</b></font></td>
        <td><font size=2>$age</font> &nbsp; $isbday</td>
      </tr><tr>
        <td><font size=2><b>$txt[227]: </b></font></td>
        <td><font size=2>$memsettings[15]</font></td>
      </tr>
    </table>
    </td>
    <td bgcolor="$color[windowbg]" class="windowbg" valign="middle" align="center" width="150">
    $pic<BR><BR>
    <font size=2>$memsettings[12]</font></td>
  </tr><tr>
    <td class="titlebg" bgcolor="$color[titlebg]" colspan="2" height="25">
    &nbsp;<font size=2 class="text1" color="$color[titletext]"><b>$txt[459]:</b></font></td>
  </tr><tr>
    <td colspan="2" bgcolor="$color[windowbg2]" class="windowbg2" valign="middle">
    <form action="$cgi;action=usersrecentposts;userid=$memsettings[20];user=$user" method="POST">
    <font size=2>
    $online<BR><BR>
    <a href="$cgi;action=imsend;to=$user">$txt[688]</a>.<BR><BR>
    $txt[460] <select name="viewscount" size="1">
     <option value="5">5</option>
     <option value="10" selected>10</option>
     <option value="50">50</option>
     <option value="0">$txt[190]</option>
    </select> $txt[461]. <input type=submit value="$txt[462]">
	 </font></form></td>
  </tr>
</table>
EOT;

footer();
	obExit();
}


function usersrecentposts (){
	global $userid,$viewscount,$censored,$user,$membergroups,$settings,$username,$yyitle,$txt,$enable_ubbc;
	global $cgi,$img,$imagesdir,$enable_notification,$maxmessagedisplay,$color,$scripturl,$menusep,$db_prefix;
	$display = $viewscount;
	if (!is_numeric($display)){fatal_error($txt[337]);}

	# Load Censor List
	LoadCensorList();
	
	$request = mysql_query("SELECT realName FROM {$db_prefix}members WHERE ID_MEMBER=$userid LIMIT 1");
	list($realName) = mysql_fetch_row($request);

	$permit = 0;
	if ($settings[7]=='Administrator' || $settings[7]=='Global Moderator')
		$permit = 1;

	if ($display != '0')
		$request = mysql_query("SELECT m.*,t.numReplies,c.memberGroups,c.name as cname,b.name as bname,b.ID_BOARD FROM {$db_prefix}messages as m, {$db_prefix}topics as t, {$db_prefix}boards as b, {$db_prefix}categories as c, {$db_prefix}members as mem WHERE (m.ID_MEMBER=$userid && m.ID_TOPIC=t.ID_TOPIC && t.ID_BOARD=b.ID_BOARD && b.ID_CAT=c.ID_CAT && (FIND_IN_SET('$settings[7]',c.memberGroups)!=0 || $permit || c.memberGroups='') && mem.ID_MEMBER=m.ID_MEMBER) ORDER BY m.posterTime DESC LIMIT $display");
	else
		$request = mysql_query("SELECT m.*,t.numReplies,c.memberGroups,c.name as cname,b.name as bname,b.ID_BOARD FROM {$db_prefix}messages as m, {$db_prefix}topics as t, {$db_prefix}boards as b, {$db_prefix}categories as c, {$db_prefix}members as mem WHERE (m.ID_MEMBER=$userid && m.ID_TOPIC=t.ID_TOPIC && t.ID_BOARD=b.ID_BOARD && b.ID_CAT=c.ID_CAT && (FIND_IN_SET('$settings[7]',c.memberGroups)!=0 || $permit) && mem.ID_MEMBER=m.ID_MEMBER) ORDER BY m.posterTime DESC");

	$yytitle = "$txt[458] $user";
	template_header();
	print<<<EOT
<p align=left><a href="$cgi&action=viewprofile&user=$user"><font size=2><b>$txt[92] $realName</b></font></a></p>
EOT;
	$counter = 1;
	while ($row = mysql_fetch_assoc($request))
	{
		foreach ($censored as $tmpa=>$tmpb) {
			$row['body'] = str_replace($tmpa,$tmpb,$row['body']);
			$row['subject'] = str_replace($tmpa,$tmpb,$row['subject']);
		}
		$start = (floor($row['numReplies']/$maxmessagedisplay))*$maxmessagedisplay;
		if($enable_ubbc) { $row['body'] = DoUBBC($row['body'], $row['smiliesEnabled']); }
		$notify = $enable_notification ? "$menusep<a href=\"$scripturl?board=$row[ID_BOARD];action=notify;threadid=$row[ID_TOPIC];start=$start\">$img[notify_sm]</a>" :'';
		$row['posterTime']=timeformat($row['posterTime']);
		print <<<EOT
<table border=0 width=100% cellspacing=1 bgcolor="$color[bordercolor]">
<tr>
	<td align=left bgcolor="$color[titlebg]"><font class="text1" color="$color[titletext]" size=2>&nbsp;$counter&nbsp;</font></td>
	<td width=75% bgcolor="$color[titlebg]"><font class="text1" color="$color[titletext]" size=2><b>&nbsp;$row[cname] / $row[bname] / <a href="$scripturl?board=$row[ID_BOARD];action=display;threadid=$row[ID_TOPIC];start=$start"><font class="text1" color="$color[titletext]" size=2>$row[subject]</font></a></b></font></td>
	<td align=right bgcolor="$color[titlebg]"><nobr>&nbsp;<font class="text1" color="$color[titletext]" size=2>$txt[30]: $row[posterTime]&nbsp;</font></nobr></td>
</tr>
<tr height=50>
	<td colspan=3 bgcolor="$color[windowbg2]" valign=top><font size=2>$row[body]</font></td>
</tr>
<tr>
	<td colspan=3 bgcolor="$color[catbg]"><font size=2>
		&nbsp;<a href="$scripturl?board=$row[ID_BOARD];action=post;threadid=$row[ID_TOPIC];start=$start;title=Post+reply">$img[reply_sm]</a>$menusep<a href="$scripturl?board=$row[ID_BOARD];action=post;threadid=$row[ID_TOPIC];quote=$row[ID_MSG];title=Post+reply">$img[replyquote]</a>$notify
	</font></td>
</tr>
</table><br>
EOT;
		++$counter;
	}
if ($counter == 1) // there were no posts
	print "$txt[170]<br>";
print <<<EOT
<p align=left><a href="$cgi&action=viewprofile;user=$user"><font size=2><b>$txt[92] $realName</b></font></a></p></font>
EOT;
	footer();
	obExit();
}
?>
file|^|Sources/Recent.php|^|9410|^|1008718734
<?php
/*****************************************************************************/
/* Recent.php                                                                */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$recentplver="YaBB SE";

function LastPost (){
	global $settings,$scripturl,$txt,$censored,$recentsender,$db_prefix;
	# Load Censor List
	LoadCensorList();
	if (!isset($recentsender)) {$recentsender='';}

	$request = mysql_query("SELECT m.posterTime,m.subject,m.ID_TOPIC,t.ID_BOARD,m.posterName,t.numReplies,t.ID_FIRST_MSG FROM {$db_prefix}messages as m,{$db_prefix}topics as t,{$db_prefix}boards as b,{$db_prefix}categories as c WHERE (m.ID_TOPIC=t.ID_TOPIC && t.ID_BOARD=b.ID_BOARD && b.ID_CAT=c.ID_CAT && (FIND_IN_SET('$settings[7]',c.memberGroups)!=0 || c.memberGroups='' || '$settings[7]' LIKE 'Administrator' || '$settings[7]' LIKE 'Global Moderator')) ORDER BY m.posterTime DESC LIMIT 1");
	if (mysql_num_rows($request)==0)
		return;
	$row = mysql_fetch_array($request);
	$request = mysql_query ("SELECT subject FROM {$db_prefix}messages WHERE ID_MSG=$row[ID_FIRST_MSG] LIMIT 1");
	$row2 = mysql_fetch_array($request);
	if($recentsender == 'admin') {
		$row2['subject'] = (strlen($row2['subject'])>25)?(substr($row2['subject'],0,22)."..."):$row2['subject'];
		$post = "\"<a href=\"$scripturl?board=$row[ID_BOARD];action=display;threadid=$row[ID_TOPIC];start=$row[numReplies]\">$row2[subject]</a>\" (".timeformat($row['posterTime']).")\n";
	} else {
		$post = "$txt[234] \"<a href=\"$scripturl?board=$row[ID_BOARD];action=display;threadid=$row[ID_TOPIC];start=$row[numReplies]\">$row2[subject]</a>\" $txt[235] (".timeformat($row['posterTime']).")<br></font></td>\n";
	}

	foreach ($censored as $tmpa=>$tmpb)
		$post = str_replace($tmpa,$tmpb,$post);

	print $post;
}

function RecentPosts (){
	global $settings,$txt,$yytitle,$censored,$scripturl,$enable_ubbc,$enable_notification,$menusep,$db_prefix;
	global $cgi,$img,$color,$imagesdir,$realNames;
	$display = 10;

	$request = mysql_query("SELECT m.smiliesEnabled,m.posterTime,m.ID_MEMBER,m.ID_MSG,m.subject,m.body,m.ID_TOPIC,t.ID_BOARD,b.name as bname,c.name as cname,m.posterName,t.numReplies FROM {$db_prefix}messages as m,{$db_prefix}topics as t,{$db_prefix}boards as b,{$db_prefix}categories as c WHERE (m.ID_TOPIC = t.ID_TOPIC AND t.ID_BOARD = b.ID_BOARD AND b.ID_CAT=c.ID_CAT AND (FIND_IN_SET('$settings[7]',c.memberGroups)!=0 OR c.memberGroups='' OR '$settings[7]'='Administrator' OR '$settings[7]'='Global Moderator')) ORDER BY m.posterTime DESC LIMIT $display");

	$yytitle = $txt[214];
	template_header();

	LoadCensorList();
	$counter = 0;
	while ($row = mysql_fetch_array($request)) {
		$counter ++;
		$request2 = mysql_query("SELECT m.posterName,m.ID_MEMBER FROM {$db_prefix}messages as m,{$db_prefix}topics as t WHERE (m.ID_MSG=t.ID_FIRST_MSG && t.ID_TOPIC=$row[ID_TOPIC])");
		$row2 = mysql_fetch_array($request2);
		
		LoadRealName($row['posterName']);
		LoadRealName($row2['posterName']);
		if ($row['ID_MEMBER'] != '-1')
			$row['posterName'] = "<a href=\"$scripturl?action=viewprofile;user=$row[posterName]\">{$realNames[$row['posterName']]}</a>";
		if ($row2['ID_MEMBER'] != '-1')
			$row2['posterName'] = "<a href=\"$scripturl?action=viewprofile;user=$row2[posterName]\">{$realNames[$row2['posterName']]}</a>";

		$message = $row['body'];
		foreach ($censored as $tmpa => $tmpb) {
			$message = str_replace($tmpa,$tmpb,$message);
			$row['subject'] = str_replace($tmpa,$tmpb,$row['subject']);
		}
		if($enable_ubbc) { $message = DoUBBC($message,$row['smiliesEnabled']); }

		if($enable_notification)
			$notify = "$menusep<a href=\"$scripturl?board=$row[ID_BOARD];action=notify;threadid=$row[ID_TOPIC];start=$row[numReplies]\">$img[notify_sm]</a>";
		$row['posterTime'] = timeformat($row['posterTime']);

		print <<<EOT
<table border="0" width="100%" cellspacing="1" bgcolor="$color[bordercolor]">
<tr>
	<td align=left bgcolor="$color[titlebg]"><font class="text1" color="$color[titletext]" size=2>&nbsp;$counter&nbsp;</font></td>
	<td width="75%" bgcolor="$color[titlebg]"><font class="text1" color="$color[titletext]" size="2"><b>&nbsp;$row[cname] / $row[bname] / <a href="$scripturl?board=$row[ID_BOARD];action=display;threadid=$row[ID_TOPIC];start=$row[numReplies]">$row[subject]</a></b></font></td>
	<td align=right bgcolor="$color[titlebg]" nowrap>&nbsp;<font class="text1" color="$color[titletext]" size="2">$txt[30]: $row[posterTime]&nbsp;</font></td>
</tr>
<tr>
	<td colspan=3 bgcolor="$color[catbg]" class="catbg"><font class="catbg" size=2>$txt[109] $row2[posterName] | $txt[22] $txt[525] $row[posterName]</font></td>
</tr>
<tr>
	<td colspan=3 bgcolor="$color[windowbg2]" valign=top height=40><font size=2>$message</font></td>
</tr>
<tr>
	<td colspan=3 bgcolor="$color[catbg]"><font size=2>
		&nbsp;<a href="$scripturl?board=$row[ID_BOARD];action=post;threadid=$row[ID_TOPIC];start=$row[numReplies];title=Post+reply">$img[reply_sm]</a>$menusep<a href="$scripturl?board=$row[ID_BOARD];action=post;threadid=$row[ID_TOPIC];quote=$row[ID_MSG];title=Post+reply">$img[replyquote]</a>$notify
	</font></td>
</tr>
</table><br>
EOT;
}

	print <<<EOT
<font size="1"><a href="$cgi">$txt[236]</a>
$txt[237]<br></font>
EOT;
	footer();
	obExit();
}


function LastPostings (){

   global $settings,$scripturl,$txt,$censored,$recentsender,$db_prefix, $post, $dummy;

   $showlatestcount = 5;

   # Load Censor List
   LoadCensorList();
   if (!isset($recentsender)) {$recentsender='';}

   $request = mysql_query("SELECT m.posterTime,m.subject,m.ID_TOPIC,t.ID_BOARD,m.posterName,m.ID_MEMBER,t.numReplies,t.ID_FIRST_MSG FROM {$db_prefix}messages as m,{$db_prefix}topics as t,{$db_prefix}boards as b,{$db_prefix}categories as c WHERE (m.ID_TOPIC=t.ID_TOPIC && t.ID_BOARD=b.ID_BOARD && b.ID_CAT=c.ID_CAT && (FIND_IN_SET('$settings[7]',c.memberGroups)!=0 || c.memberGroups='' || '$settings[7]' LIKE 'Administrator' || '$settings[7]' LIKE 'Global Moderator')) ORDER BY m.posterTime DESC LIMIT 0,$showlatestcount");

   if( mysql_num_rows($request) > 0 ) {

      $post = "<table width=\"100%\" border=\"0\">";

      while ($row = mysql_fetch_array($request)) {

         $post .= "<tr>";
      
         $request3 = mysql_query ("SELECT name FROM {$db_prefix}boards WHERE (ID_BOARD=$row[ID_BOARD]) LIMIT 1");
         $temp = mysql_fetch_row($request3);
         $bname = $temp[0];

         if ($row['ID_MEMBER'] != -1) {                  
            $request4 = mysql_query ("SELECT realName FROM {$db_prefix}members WHERE ID_MEMBER=$row[ID_MEMBER] LIMIT 1");
            $temp2 = mysql_fetch_row($request4);
            $dummy = "<a href=\"$scripturl?action=viewprofile;user=$row[posterName]\">$temp2[0]</a>";
         } else {
            $dummy = $row['posterName'];
         }
         
         $post .= "<td align=\"right\" valign=\"top\" nowrap>[<a href=\"$scripturl?board=$row[ID_BOARD]\">$bname</a>]</td>";

         $request2 = mysql_query ("SELECT subject FROM {$db_prefix}messages WHERE ID_MSG=$row[ID_FIRST_MSG] LIMIT 1");
         $row2 = mysql_fetch_array($request2);

         $post .= "<td valign=\"top\"><a href=\"$scripturl?board=$row[ID_BOARD];action=display;threadid=$row[ID_TOPIC];start=$row[numReplies]\">$row2[subject]</a> $txt[525] $dummy</td><td align=\"right\" nowrap>".timeformat($row['posterTime'])."</td></tr>\n";

      }

      $post .= "</table>";

   } else {
      $post .= "---";
   }

   $post .= "</td>";

   foreach ($censored as $tmpa=>$tmpb)
      $post = str_replace($tmpa,$tmpb,$post);

   print $post;
}
?>file|^|Sources/Register.php|^|11009|^|1008888577
<?php
/*****************************************************************************/
/* Register.php                                                              */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$registerplver="YaBB SE";

function Register (){
	global $yytitle,$txt,$color,$cgi,$action,$allow_hide_email,$RegAgree,$emailpassword,$vardir,$db_prefix;
	$yytitle = "$txt[97]";
	template_header();
	print <<<EOT
<form action="$cgi;action=register2" method="POST" name="creator">
<table border="0" width="100%" cellspacing="1" bgcolor="$color[bordercolor]" class="bordercolor" cellpadding="2">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$txt[97]</b> $txt[517]</font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]" width="100%">
    <table cellpadding="3" cellspacing="0" border=0 width="100%">
      <tr>
        <td width="40%"><font size=2>* <b>$txt[98]:</b></font>
        <BR><font size="1">$txt[520]</font></td>
        <td><input type=text name=user size=20 maxlength=18></td>
      </tr><tr>
        <td width="40%"><font size=2>* <b>$txt[69]:</b></font>
        <BR><font size="1">$txt[679]</font></td>
EOT;
if ($allow_hide_email == 1) {
print <<<EOT
        <td><font size=2><input type=text name=email size=30> <input type="checkbox" name="hideemail"> $txt[721]</font></td>
EOT;
}
else {
print <<<EOT
        <td><input type=text name=email size=30>
        <BR><font size="1">$txt[679]</font></td>
EOT;
}
print "      </tr>\n";
	if( $emailpassword == "") {
		print <<<EOT
      <tr>
        <td width="40%"><font size=2>* <b>$txt[81]:</b></font></td>
        <td><font size=2><input type=password name=passwrd1 size=30></font></td>
      </tr><tr>
        <td width="40%"><font size=2>* <b>$txt[82]:</b></font></td>
        <td><font size=2><input type=password name=passwrd2 size=30></font></td>
      </tr>
EOT;
}
print <<<EOT
    </table>
    </td>
  </tr>
</table>
EOT;
if ($RegAgree) {
	$request = mysql_query("SELECT value FROM {$db_prefix}settings WHERE variable='agreement'");
	$temp = mysql_fetch_row($request);
	$fullagree = nl2br($temp[0]);
	print <<<EOT
<table border=0 cellspacing=1 cellpadding="5" bgcolor="$color[bordercolor]" class="bordercolor" width="100%" align="center">
  <tr>
    <td bgcolor="$color[windowbg2]">
    <font size=2><BR>$fullagree<BR><BR></font>
    </td>
  </tr><tr>
    <td bgcolor="$color[windowbg]" align="center"><font size=2>
    <B>$txt[585]</B> <input type=radio name=regagree value="yes">
    &nbsp;&nbsp;&nbsp; <B>$txt[586]</B> <input type=radio name=regagree value="no" checked>
    </font></td>
  </tr>
</table>
EOT;
}
	print <<<EOT
<BR><center><input type=submit value="$txt[97]"></center>
</form>
EOT;
	footer();
	obExit();
}

function Register2 () {
	global $HTTP_GET_VARS,$HTTP_POST_VARS,$mbname,$emailwelcome,$Cookie_Length,$emailpassword,$color,$cgi;
	global $hideemail,$yySetLocation,$scripturl,$yyTitle,$txt,$user,$regagree,$db_prefix,$webmaster_email;
	global $allow_hide_email;

	$hideemail = ($allow_hide_email && $hideemail=='on')?'1':'0';

	if(!preg_match("/^[\s0-9A-Za-z#%+,-\.:=?@^_]+$/",$user)) {fatal_error("$txt[240]"); }

	if($regagree == "no") {
        header("Location: $scripturl");
  	}
	$member = array();
    foreach($HTTP_GET_VARS as $key => $value)
		$member[$key] = str_replace("\n","",str_replace("\r","",trim($value)));
	foreach($HTTP_POST_VARS as $key=>$value)
		$member[$key] = str_replace("\n","",str_replace("\r","",trim($value)));

#	$member[username] = str_replace(list(" ","\t"),"_",$member[username]);
	if (strlen($member['user']) > 25) { $member['user'] = substr($member['user'],0,25); }
	if($member['user'] == '') {fatal_error("$member[user] $txt[37]"); }
	if($member['user'] == '_' || $member['user'] == '|') {fatal_error("$member[user] $txt[99]"); }
	if(strstr($member['user'],"guest")) { fatal_error("$txt[244] $member[user]");}
	//if(!preg_match("/A[0-9A-Za-z#%+,-\.@^_]+\Z/",$member['user'])) {fatal_error("$txt[240]");}
	if($member['email'] == ""){ fatal_error("$member[user] $txt[76]"); }
	$request = mysql_query("SELECT ID_MEMBER FROM {$db_prefix}members WHERE memberName='$member[user]'");
	if(mysql_num_rows($request) > 0) { fatal_error("($member[user]) $txt[100]"); }

	if( $emailpassword ) {
		srand(time());
		$member['passwrd1'] = crypt(mt_rand(-100000,100000));
	} else {
		if($member['passwrd1'] !=  $member['passwrd2']) { fatal_error("($member[username]) $txt[213]");}
		if($member['passwrd1'] == '') {fatal_error("($member[username]) $txt[91]");}
	}

	$request = mysql_query ("SELECT value FROM {$db_prefix}banned WHERE (type='email' && value='$member[email]')");
	if (mysql_num_rows($request) > 0)
		fatal_error("$txt[678]$txt[430]!");

	/* Check if the email address  or the username is in use */
	$request = mysql_query("SELECT realName FROM {$db_prefix}members WHERE emailAddress='$member[email]'");
	if (mysql_num_rows($request) > 0)
		fatal_error("$txt[730] ($member[email]) $txt[731]");
	$request = mysql_query("SELECT realName FROM {$db_prefix}members WHERE (memberName='$member[user]' || realName='$member[user]')");
	if (mysql_num_rows($request) > 0)
		fatal_error("($member[user]) $txt[473]");
	htmlentities($member['email']);

	$request = mysql_query("SELECT setting,value FROM {$db_prefix}reserved_names WHERE 1");
	$reserve = array();
	while ($row = mysql_fetch_array($request))
		if ($row['setting'] == 'word')
			$reserve[] = trim($row['value']);
		else
			${$row['setting']} = trim($row['value']);

	$namecheck = ($matchcase == '1') ? $member['user'] : strtolower($member['user']);

	foreach ($reserve as $reserved) {
		$reservecheck = ($matchcase=='1') ? $reserved : strtolower ($reserved);
		if ($matchuser=='1') {
			if ($matchword=='1') {
				if ($namecheck == $reservecheck) { fatal_error("$txt[244] $reserved"); }
			}
			else {
				if (strstr($namecheck,$reservecheck)) { fatal_error("$txt[244] $reserved"); }
			}
		}
	}

	$request = mysql_query("SELECT ID_MEMBER FROM {$db_prefix}members WHERE memberName='$member[user]'");
	if (mysql_num_rows($request) > 0){ fatal_error("$txt[100]"); }
    $requesttime = time();
	$queryPasswdPart = crypt($member['passwrd1'],substr($member['passwrd1'],0,2));
	$request = mysql_query("INSERT INTO {$db_prefix}members (memberName,realName,passwd,emailAddress,posts,personalText,avatar,dateRegistered,hideEmail) VALUES ('$member[user]','$member[user]','$queryPasswdPart','$member[email]',0,'$txt[209]','blank.gif','$requesttime','$hideemail')");

	$yytitle="$txt[245]";
	template_header();
	
	if( $emailpassword ) {
		sendmail($member['email'], "$txt[700] $mbname", "$txt[248] $member[user]!\n\n$txt[719] $member[user]\n\n $txt[492] $member[passwrd1]\n\n$txt[701]\n",$webmaster_email);

		print <<<EOT
<BR>
<table border=0 width=100% cellspacing=1 bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$txt[97]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]" align="left" cellpadding=3><font size=2>$txt[703]</font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]" valign=top><form action="$cgi;action=login2" method="POST">
    <table border=0 cellpadding="0" cellspacing="0">
      <tr>
        <td><font size=2><b>$txt[35]:</b></font></td>
        <td><font size=2><input type=text name="user" size=15 value="$member[user]"></font></td>
        <td><font size=2><b>$txt[36]:</b></font></td>
        <td><font size=2><input type=password name="passwrd" size=10></font> &nbsp;</td>
        <td><font size=2><b>$txt[497]:</b></font></td>
        <td><font size=2><input type=text name="cookielength" size=4 value="$Cookie_Length">
        <td><font size=2><b>$txt[508]:</B></font></td>
        <td><font size=2><input type=checkbox name="cookieneverexp"></font></td> &nbsp;</font></td>
        <td align=center colspan=2><input type=submit value="$txt[34]"></td>
      </tr>
    </table>
    </td>
  </tr>
</table>
EOT;
	}
	else {
	if( $emailwelcome ) {
		sendmail($member['email'],"$txt[700] $mbname", "$txt[248] $member[user]!\n\n$txt[719] $member[user], $txt[492] $member[passwrd1]\n\n$txt[701]\n$scripturl?action=profile;user=$member[user]\n\n$txt[130]",$webmaster_email);
	}
		print <<<EOT
<BR><BR><BR>
<center>$txt[431]</center>
<BR><BR>
<table border=0 width=300 cellspacing=1 bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$txt[97]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]" align="center"><font size=2><form action="$cgi;action=login2" method="POST">
    <input type=hidden name="user" value="$member[user]">
    <input type=hidden name="passwrd" value="$member[passwrd1]">
    <input type=hidden name="cookielength" value="$Cookie_Length">
    <input type=submit value="$txt[34]"></td>
    </form></font>
    </td>
  </tr>
</table>
EOT;
	}
	footer();
	obExit();
}

?>
file|^|Sources/RemoveOldThreads.php|^|3566|^|1008718739
<?php
/*****************************************************************************/
/* RemoveOldThreads.php                                                      */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$removeoldthreadsplver="YaBB SE";

function RemoveOldThreads (){
	global $settings,$txt,$db_prefix,$modSettings,$maxdays;
	if($settings[7] != "Administrator") { fatal_error($txt[1]); }

	$yytitle = "$txt[120] $maxdays";
	$threshold = time()-(24*60*60*$maxdays);
	template_header();
	$request = mysql_query("SELECT t.ID_TOPIC,t.ID_BOARD,t.ID_POLL FROM {$db_prefix}topics as t, {$db_prefix}messages as m WHERE (m.ID_MSG = t.ID_LAST_MSG AND m.posterTime < $threshold)");
	while ($row = mysql_fetch_row($request))
	{
		$msgs = 0;
		print "$txt[50] - $row[0]<br>\n";
		print "&nbsp;&nbsp;$txt[49]<br>\n";
	//Lines 48-56 all there to delete attachments on thread deletion - Jeff
		$result = mysql_query("SELECT attachmentFilename FROM {$db_prefix}messages WHERE ID_TOPIC=$row[0] AND attachmentFilename!=NULL");

	    if (mysql_num_rows($result)>0){
			while($attachRow = mysql_fetch_array($result)){
				unlink($modSettings['attachmentUploadDir'] . "/" . $attachRow['attachmentFilename']);
			}
		}
		$result = mysql_query ("DELETE FROM {$db_prefix}messages WHERE ID_TOPIC='$row[0]'");
		$msgs = mysql_affected_rows();
		$result = mysql_query("DELETE FROM {$db_prefix}polls WHERE ID_POLL='$row[2]' LIMIT 1");
		$result = mysql_query ("DELETE FROM {$db_prefix}topics WHERE ID_TOPIC='$row[0]'");
		$result = mysql_query ("UPDATE {$db_prefix}boards SET numTopics=numTopics-1,numPosts=numPosts-$msgs WHERE ID_BOARD=$row[1]");
	}
	print " <br>$txt[51]<br> <br>";
	footer();
	obExit();
}
?>
file|^|Sources/RemoveThread.php|^|3507|^|1008718740
<?php
/*****************************************************************************/
/* RemoveThread.php                                                          */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$removethreadplver="YaBB SE";

function RemoveThread2 () {
	global $username,$moderators,$settings,$txt,$cgi,$yySetLocation,$currentboard,$cgi,$threadid,$db_prefix;
	if (!(in_array($username,$moderators) || $settings[7]=='Administrator' || $settings[7]=='Global Moderator'))
		fatal_error("$txt[73]");
  
    //Lines 38-45 all there to delete attachments on thread deletion - Jeff
    $request = mysql_query("SELECT attachmentFilename FROM {$db_prefix}messages WHERE ID_TOPIC=$threadid AND attachmentFilename<>NULL");

    if (mysql_numrows($request)>0){
    while($row = mysql_fetch_array($request)){
      unlink($modSettings['attachmentUploadDir'] . "/" . $row['attachmentFilename']);

   }
}

	$request = mysql_query("SELECT ID_BOARD,numReplies,ID_POLL FROM {$db_prefix}topics WHERE ID_TOPIC=$threadid");
	$row = mysql_fetch_array($request);
	$request = mysql_query("DELETE FROM {$db_prefix}polls WHERE ID_POLL='$row[ID_POLL]' LIMIT 1");
	$row['numReplies']++;
	$request = mysql_query("UPDATE {$db_prefix}boards SET numTopics=numTopics-1,numPosts=numPosts-$row[numReplies] WHERE ID_BOARD=$row[ID_BOARD]");
	$request = mysql_query("DELETE FROM {$db_prefix}topics WHERE ID_TOPIC=$threadid");
	$request = mysql_query("DELETE FROM {$db_prefix}messages WHERE ID_TOPIC=$threadid");
	
	$request = mysql_query("DELETE FROM {$db_prefix}log_topics WHERE ID_TOPIC=$threadid");

	$yySetLocation = "$cgi";
	redirectexit();
}

?>
file|^|Sources/RepairBoards.php|^|18056|^|1008718743
<?php
/*****************************************************************************/
/* Repair.php                                                                */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$repairboardsphpver = "YaBB SE";

function RepairBoards() {
global $db_prefix,$fixErrors,$txt;

//Make sure the user is an admin
is_admin();


//print out the top of the webpage
template_header();


//Giant if/else. The first displays the forum errors if a variable is not set and asks if you would like to continue,
//the other fixes the errors.

		####Start displaying errors without fixing them.####

if(!isset($fixErrors)) { $fixErrors = "0"; }
if($fixErrors == "0") {
echo("
<table width=100% cellspacing=0 cellpadding=10 align=center bgcolor=#FFFFFF>
      <tr> 
        <td valign=TOP width=100%>
<table border=0 width=100% cellspacing=1 bgcolor=#6394BD class=bordercolor>
  <tr>
    <td class=titlebg bgcolor=#6E94B7><font size=2 class=text1 color=#FFFFFF><b>$txt[yse73]</b></font></td>
  </tr><tr>
    <td class=windowbg bgcolor=#AFC6DB>
$txt[yse74]:<p>
");

//grab all the posts in the db and order by topic id and msgid
//search for all messages and group by topic id and then msg id

$resultMsg = mysql_query("SELECT ID_TOPIC, ID_MSG FROM {$db_prefix}messages ORDER BY ID_TOPIC, ID_MSG");


//variable to be sure that salvage cats/boards only get created once
$createOnce = "0";

$topicOnce = "";
while($msgArray = mysql_fetch_array($resultMsg)) {

//get the topic ids from the topic table to compare and verify with the messages

	$resultTopics = mysql_query("SELECT ID_TOPIC,ID_FIRST_MSG,ID_LAST_MSG FROM {$db_prefix}topics WHERE ID_TOPIC = '$msgArray[ID_TOPIC]'");
	$topicArray = mysql_fetch_array($resultTopics);

	if($topicArray['ID_TOPIC'] == $msgArray['ID_TOPIC']) {

		//okay, the msg has a topic...now make sure that topic has good first/last msg

		if($topicOnce != $msgArray['ID_TOPIC']) {		
			$resultMsg2 = mysql_query("SELECT ID_MSG FROM {$db_prefix}messages WHERE ID_MSG = '$topicArray[ID_FIRST_MSG]'");
			$msgArray2 = mysql_fetch_array($resultMsg2);
			if($topicArray['ID_FIRST_MSG'] != $msgArray2['ID_MSG']) {
				echo("$txt[118] $topicArray[ID_TOPIC] $txt[yse75] $topicArray[ID_FIRST_MSG]<Br>");
			}

			$resultMsg2 = mysql_query("SELECT ID_MSG FROM {$db_prefix}messages WHERE ID_MSG = '$topicArray[ID_LAST_MSG]'");
			$msgArray2 = mysql_fetch_array($resultMsg2);
			if($topicArray['ID_LAST_MSG'] != $msgArray2['ID_MSG']) {
				echo("$txt[118] $topicArray[ID_TOPIC] $txt[yse76] $topicArray[ID_LAST_MSG]<Br>");
			}
		}
	}
	$topicOnce = $msgArray['ID_TOPIC'];
}



//Now work on the boards...order the topics by board, and then topic id. make sure the boards exist, or create them.

$resultTopics = mysql_query("SELECT ID_BOARD,ID_TOPIC,numReplies FROM {$db_prefix}topics ORDER BY ID_BOARD, ID_TOPIC");

//variable to be sure that boards only get created once
$createOnce = "0";

while($arrayTopics = mysql_fetch_array($resultTopics)) {

	//check that the board id of every topic exists

	$resultBoards = mysql_query("SELECT ID_BOARD FROM {$db_prefix}boards WHERE ID_BOARD = '$arrayTopics[ID_BOARD]'");
	$arrayBoards = mysql_fetch_array($resultBoards);

	if($arrayTopics['ID_BOARD'] == "0") {
		echo("$txt[yse78]: $txt[118] $arrayTopics[ID_TOPIC]$txt[yse79] $arrayTopics[ID_BOARD]. $txt[yse80]<br>");
	} elseif($arrayBoards['ID_BOARD'] != $arrayTopics['ID_BOARD']) {
		//There was no matching board: create board in the Salvage Area. Only do it once
		echo("$txt[118] $arrayTopics[ID_TOPIC] $txt[yse81] ($txt[yse82] $arrayTopics[ID_BOARD]).<br>");
	}

	//Count topics per board

	$resultTopics2 = mysql_query("SELECT ID_TOPIC,numReplies FROM {$db_prefix}topics WHERE ID_BOARD = '$arrayTopics[ID_BOARD]'");
	$numTopics = mysql_num_rows($resultTopics2);

	
	$totalReplies = 0;
	while($arrayReplies = mysql_fetch_array($resultTopics2)) {
		$totalReplies = $totalReplies + $arrayReplies['numReplies'];
	}

}


//Sort boards by cat id, make sure all cats exist, if they do not. Create them.

$resultBoards = mysql_query("SELECT ID_CAT,ID_BOARD FROM {$db_prefix}boards ORDER BY ID_CAT");

//variable to be sure that cats only get created once
$createOnce = "0";

while($arrayBoards = mysql_fetch_array($resultBoards)) {

	//check that the board id of every topic exists

	$resultCats = mysql_query("SELECT ID_CAT FROM {$db_prefix}categories WHERE ID_CAT = '$arrayBoards[ID_CAT]'");
	$arrayCats = mysql_fetch_array($resultCats);

	if($arrayCats['ID_CAT'] != $arrayBoards['ID_CAT']) {
		//There was no matching cat: create cat. Only do it once, and make it admin access only.
		echo("$txt[yse82] $arrayBoards[ID_BOARD] $txt[yse83] ($txt[yse84] $arrayBoards[ID_CAT]).<br>");
	}
}


echo("
<p><font size=2>$txt[yse85]<br>
<b><a href=?action=repairboards;fixErrors=1>$txt[163]</a> - <a href=?action=admin>$txt[164]</a></b><br>
</td></tr></table></td></tr></table>
");

} elseif($fixErrors == "1") {


		####End display of errors and now fix them####

echo("
<table width=100% cellspacing=0 cellpadding=10 align=center bgcolor=#FFFFFF>
      <tr> 
        <td valign=TOP width=100%>
<table border=0 width=100% cellspacing=1 bgcolor=#6394BD class=bordercolor>
  <tr>
    <td class=titlebg bgcolor=#6E94B7><font size=2 class=text1 color=#FFFFFF><b>$txt[yse86]</b></font></td>
  </tr><tr>
    <td class=windowbg bgcolor=#AFC6DB>
");


//grab all the posts in the db and order by topic id and msgid
//search for all messages and group by topic id and then msg id

$str = "SELECT ID_TOPIC, ID_MSG FROM {$db_prefix}messages ORDER BY ID_TOPIC, ID_MSG";
$resultMsg = mysql_query($str);


//variable to be sure that salvage cats/boards only get created once
$createOnce = "0";

$topicOnce = "";
while($msgArray = mysql_fetch_array($resultMsg)) {
	
//get the topic ids from the topic table to compare and verify with the messages

	$resultTopics = mysql_query("SELECT ID_TOPIC,ID_FIRST_MSG,ID_LAST_MSG FROM {$db_prefix}topics WHERE ID_TOPIC = '$msgArray[ID_TOPIC]'");
	$topicArray = mysql_fetch_array($resultTopics);

	if($topicArray['ID_TOPIC'] == $msgArray['ID_TOPIC']) {

		//okay, the msg has a topic...now make sure that topic has good first/last msg
		
		if($topicOnce != $msgArray['ID_TOPIC']) {		
			$resultMsg2 = mysql_query("SELECT ID_MSG FROM {$db_prefix}messages WHERE ID_MSG = '$topicArray[ID_FIRST_MSG]'");
			$msgArray2 = mysql_fetch_array($resultMsg2);
			if($topicArray['ID_FIRST_MSG'] != $msgArray2['ID_MSG']) {

				$resultFirstMsg = mysql_query("SELECT ID_MSG FROM {$db_prefix}messages WHERE ID_TOPIC = '$topicArray[ID_TOPIC]' ORDER BY ID_MSG ASC");
				if($firstMsgArray = mysql_fetch_array($resultFirstMsg)) {
					mysql_query("UPDATE {$db_prefix}topics SET ID_FIRST_MSG = '$firstMsgArray[0]' WHERE ID_TOPIC = '$topicArray[ID_TOPIC]'");
				} else {
                    //Lines 211-219 all there to delete attachments on thread deletion - Jeff
                    $request = mysql_query("SELECT attachmentFilename FROM {$db_prefix}messages WHERE ID_TOPIC=$topicArray[ID_TOPIC] AND attachmentFilename<> NULL");

                    if (mysql_numrows($request)>0){
                    while($row = mysql_fetch_array($request)){
                    unlink($modSettings['attachmentUploadDir'] . "/" . $row['attachmentFilename']);

                       }
                     }
					mysql_query("DELETE FROM {$db_prefix}topics WHERE ID_TOPIC = '$topicArray[ID_TOPIC]'");
				}
			}
	
			$resultMsg2 = mysql_query("SELECT ID_MSG FROM {$db_prefix}messages WHERE ID_MSG = '$topicArray[ID_LAST_MSG]'");
			$msgArray2 = mysql_fetch_array($resultMsg2);
			if($topicArray['ID_LAST_MSG'] != $msgArray2['ID_MSG']) {

				$resultLastMsg = mysql_query("SELECT ID_MSG FROM {$db_prefix}messages WHERE ID_TOPIC = '$topicArray[ID_TOPIC]' ORDER BY ID_MSG DESC");
				if($lastMsgArray = mysql_fetch_array($resultLastMsg)) {
					mysql_query("UPDATE {$db_prefix}topics SET ID_LAST_MSG = '$lastMsgArray[0]' WHERE ID_TOPIC = '$topicArray[ID_TOPIC]'");
					if(mysql_affected_rows() < 0) {echo("$txt[yse87] ID_LAST_MSG $txt[yse88] {$db_prefix}topics (ID_TOPIC = $topicArray[ID_TOPIC])"); }
				} else {
                    //Lines 233-241 all there to delete attachments on thread deletion - Jeff
                    $request = mysql_query("SELECT attachmentFilename FROM {$db_prefix}messages WHERE ID_TOPIC=$topicArray[ID_TOPIC] AND attachmentFilename<>NULL");

                    if (mysql_numrows($request)>0){
                    while($row = mysql_fetch_array($request)){
                    unlink($modSettings['attachmentUploadDir'] . "/" . $row['attachmentFilename']);

                       }
                     }
					mysql_query("DELETE FROM {$db_prefix}topics WHERE ID_TOPIC = '$topicArray[ID_TOPIC]'");
				}
			}
		}
} else {
		//first create a cat/board for the msg w/out topic
		//only do it once

	if($createOnce < 1) {
		$result = mysql_query("SELECT ID_CAT FROM {$db_prefix}categories WHERE name = 'Salvage Area' AND memberGroups = 'Administrator' ORDER BY ID_CAT DESC");
		$arraySalvage = mysql_fetch_array($result);
		if($arraySalvage['0'] == 0) {
			$insert = "INSERT INTO {$db_prefix}categories (name,memberGroups,catOrder) VALUES ('Salvage Area','Administrator','-1')";
			mysql_query($insert);
			if(mysql_affected_rows() < 0) { echo("$txt[yse89] $txt[yse82]"); }
		}
			$result = mysql_query("SELECT ID_CAT FROM {$db_prefix}categories ORDER BY ID_CAT DESC");
			$arrayCatNum = mysql_fetch_array($result);

			$insert = "INSERT INTO {$db_prefix}boards (name,description,moderators,ID_CAT) VALUES ('Salvaged Messages','Topics created for messages with non-existant topic ids','','$arrayCatNum[0]')";
			mysql_query($insert);
			if(mysql_affected_rows() < 0) { echo("$txt[yse89] $txt[yse84]"); }

			$createOnce = 1;
	}

		//create a topic for msgArray['ID_MSG']

		$resultFindLast = mysql_query("SELECT ID_MSG FROM {$db_prefix}messages WHERE ID_TOPIC = '$msgArray[ID_TOPIC]' ORDER BY ID_MSG DESC");
		$findLastArray = mysql_fetch_array($resultFindLast);

		$result = mysql_query("SELECT ID_BOARD FROM {$db_prefix}boards ORDER BY ID_BOARD DESC");
		$arrayBoardNum = mysql_fetch_array($result);

		$resultRepliesNum = mysql_query("SELECT ID_MSG FROM {$db_prefix}messages WHERE ID_TOPIC = '$msgArray[ID_TOPIC]'");
		$numReplies = mysql_num_rows($resultRepliesNum) - 1;

		$insert = "INSERT INTO {$db_prefix}topics (ID_TOPIC,ID_BOARD,ID_MEMBER_STARTED,ID_MEMBER_UPDATED,ID_FIRST_MSG,ID_LAST_MSG,numReplies) VALUES ('$msgArray[ID_TOPIC]','$arrayBoardNum','repairBoards','repairBoards','$msgArray[ID_MSG]','$findLastArray[0]','$numReplies')";
		$result = mysql_query($insert);
		if(mysql_affected_rows() < 0) { echo("$txt[yse89] $txt[118]. ID_TOPIC = $msgArray[ID_TOPIC], ID_MSG = $msgArray[ID_MSG]"); }
}
	$topicOnce = $msgArray['ID_TOPIC'];
}


//Now work on the boards...order the topics by board, and then topic id. make sure the boards exist, or create them.

$resultTopics = mysql_query("SELECT ID_BOARD,ID_TOPIC,numReplies FROM {$db_prefix}topics ORDER BY ID_BOARD, ID_TOPIC");

//variable to be sure that boards only get created once
$createOnce = 0;

while($arrayTopics = mysql_fetch_array($resultTopics)) {

	//check that the board id of every topic exists

	$resultBoards = mysql_query("SELECT ID_BOARD FROM {$db_prefix}boards WHERE ID_BOARD = '$arrayTopics[ID_BOARD]'");
	$arrayBoards = mysql_fetch_array($resultBoards);



	if($arrayTopics['ID_BOARD'] == "0") {
        //Lines 304-312 all there to delete attachments on thread deletion - Jeff
                    $request = mysql_query("SELECT attachmentFilename FROM {$db_prefix}messages WHERE ID_TOPIC=$topicArray[ID_TOPIC] AND attachmentFilename<>NULL");

                    if (mysql_numrows($request)>0){
                    while($row = mysql_fetch_array($request)){
                    unlink($modSettings['attachmentUploadDir'] . "/" . $row['attachmentFilename']);

                       }
                     }
		mysql_query("DELETE FROM {$db_prefix}topics WHERE ID_TOPIC = '$arrayTopics[ID_TOPIC]'");
		mysql_query("DELETE FROM {$db_prefix}messages WHERE ID_TOPIC = '$arrayTopics[ID_TOPIC]'");
	} elseif($arrayBoards['ID_BOARD'] != $arrayTopics['ID_BOARD']) {
		//There was no matching board: create board in the Salvage Area. Only do it once

		$result = mysql_query("SELECT ID_CAT FROM {$db_prefix}categories WHERE name = 'Salvage Area' AND memberGroups = 'Administrator' ORDER BY ID_CAT DESC");
		$arraySalvage = mysql_fetch_array($result);
		if($arraySalvage['0'] == 0) {
			$insert = "INSERT INTO {$db_prefix}categories (name,memberGroups,catOrder) VALUES ('Salvage Area','Administrator','-1')";
			if(!mysql_query($insert)) { echo("Error creating a category 2"); }
			$result = mysql_query("SELECT ID_CAT FROM {$db_prefix}categories WHERE name = 'Salvage Area' AND memberGroups = 'Administrator' ORDER BY ID_CAT DESC");
			$arraySalvage = mysql_fetch_array($result);
		}

		$insert = "INSERT INTO {$db_prefix}boards (name,description,moderators,ID_CAT,ID_BOARD) VALUES ('Repair Board ID $arrayTopics[ID_BOARD]','This board was automatically created by the Repair Boards function. It is for topics with bad boards.','','$arraySalvage[0]','$arrayTopics[ID_BOARD]')";

		if(!mysql_query($insert)) { echo("Error creating a board2"); }
	} 


	//Count topics per board

	$resultTopics2 = mysql_query("SELECT ID_TOPIC,numReplies FROM {$db_prefix}topics WHERE ID_BOARD = '$arrayTopics[ID_BOARD]'");
	$numTopics = mysql_num_rows($resultTopics2);
	mysql_query("UPDATE {$db_prefix}boards SET numTopics = '$numTopics' WHERE ID_BOARD = '$arrayTopics[ID_BOARD]'");
	if(mysql_affected_rows() < 0) {
		echo("$txt[yse87] $txt[yse90] $tst[yse82] $arrayTopics[ID_BOARD]");
	}

	$totalReplies = 0;
	while($arrayReplies = mysql_fetch_array($resultTopics2)) {
		$totalReplies = $totalReplies + $arrayReplies['numReplies'];
	}
	$result = mysql_query("UPDATE {$db_prefix}boards SET numPosts = '$totalReplies' WHERE ID_BOARD = '$arrayTopics[ID_BOARD]'");
	if(mysql_affected_rows() < 0) {
		echo("$txt[yse87] $txt[yse91] $tst[yse82] $arrayTopics[ID_BOARD]");
	}
}


//Sort boards by cat id, make sure all cats exist, if they do not. Create them.

$resultBoards = mysql_query("SELECT ID_CAT FROM {$db_prefix}boards ORDER BY ID_CAT");

//variable to be sure that cats only get created once
$createOnce = 0;

while($arrayBoards = mysql_fetch_array($resultBoards)) {

	//check that the cat id of every board exists

	$resultCats = mysql_query("SELECT ID_CAT FROM {$db_prefix}categories WHERE ID_CAT = '$arrayBoards[ID_CAT]'");
	$arrayCats = mysql_fetch_array($resultCats);

	if($arrayCats['ID_CAT'] != $arrayBoards['ID_CAT']) {
		//There was no matching cat: create cat. Only do it once, and make it admin access only.

		if($createOnce < 1) {
			$insert = "INSERT INTO {$db_prefix}categories (ID_CAT,name,memberGroups,catOrder) VALUES ('$arrayBoards[ID_CAT]','Repair Category ID $arrayBoards[ID_CAT]','Administrator','-1')";
			if($result != mysql_query($insert)) { echo("$txt[yse89] $txt[yse89]"); }
			$createOnce = 1;
		}
	}
}


//Last step-make sure all non-guest posters still exist

$resultMember = mysql_query("SELECT ID_MEMBER FROM {$db_prefix}messages WHERE ID_MEMBER != '-1'");

while($memberArray = mysql_fetch_array($resultMember)) {
	$resultGuest = mysql_query("SELECT ID_MEMBER FROM {$db_prefix}members WHERE ID_MEMBER = '$memberArray[ID_MEMBER]'");

	if(!@mysql_fetch_array($resultGuest)) {
		mysql_query("UPDATE {$db_prefix}messages SET ID_MEMBER = '-1' WHERE ID_MEMBER = '$memberArray[ID_MEMBER]'");
	}
}

$resultMember = mysql_query("SELECT ID_MEMBER_STARTED FROM {$db_prefix}topics WHERE ID_MEMBER_STARTED != '-1'");

while($memberArray = mysql_fetch_array($resultMember)) {
	$resultGuest = mysql_query("SELECT ID_MEMBER FROM {$db_prefix}members WHERE ID_MEMBER = '$memberArray[ID_MEMBER_STARTED]'");

	if(!@mysql_fetch_array($resultGuest)) {
		mysql_query("UPDATE {$db_prefix}topics SET ID_MEMBER_STARTED = '-1' WHERE ID_MEMBER_STARTED = '$memberArray[ID_MEMBER_STARTED]'");
	}
}

echo("
<p><font size=2>$txt[yse92]<p>
<a href=?action=admin>$txt[137]</a><br>
<a href=>$txt[236] $txt[237]</a><br>
</td></tr></table></td></tr></table>
");

}

footer();
obExit();
}
?>
file|^|Sources/Search.php|^|17419|^|1008718746
<?php
/*****************************************************************************/
/* Search.php                                                                */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$searchplver="YaBB SE";

function plushSearch1 (){
	global $yytitle,$txt,$censored,$curposlinks,$mbname,$imagesdir,$settings,$scripturl,$color,$db_prefix;
	$yytitle = $txt[183];
	template_header();
	LoadCensorList();

	$searchpageurl = $curposlinks ? "<a href=\"$scripturl?action=search\" class=\"nav\">$txt[182]</a>" : $txt[182];
	print <<<EOT
<script language="JavaScript1.2" type="text/javascript">
<!-- Begin
function changeBox(cbox) {
box = eval(cbox);
box.checked = !box.checked;
}
//  End -->
</script>
<script language="JavaScript" TYPE="text/javascript">
<!--
function checkAll() {
  for (var i = 0; i < document.searchform.elements.length; i++) {
  	if(document.searchform.elements[i].name != "subfield" && document.searchform.elements[i].name != "msgfield") {
    		document.searchform.elements[i].checked = true;
    	}
  }
}
function uncheckAll() {
  for (var i = 0; i < document.searchform.elements.length; i++) {
  	if(document.searchform.elements[i].name != "subfield" && document.searchform.elements[i].name != "msgfield") {
    		document.searchform.elements[i].checked = false;
    	}
  }
}
//-->
</script>
<table width="80%" align="center" border="0" cellpadding="3" cellspacing="0">
  <tr>
    <td><font size=2 class="nav"><img src="$imagesdir/open.gif" BORDER="0" alt="">&nbsp;&nbsp;<b><a href="$scripturl" class="nav">$mbname</a></b><br><img src="$imagesdir/tline.gif" BORDER="0" alt=""><img src="$imagesdir/open.gif" border="0" alt="">&nbsp;&nbsp;<b>$searchpageurl</b></font></td>
  </tr>
</table>
<form action="$scripturl?action=search2" method="post" name="searchform">
<table border=0 width="80%" cellspacing=1 cellpadding=4 bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]">$txt[183]</font></td>
  </tr><tr>
    <td bgcolor="$color[windowbg]">
    <font size="2"><B>$txt[582]:</B><br>
    <input type=text size=40 name=search>&nbsp;
    <select name="searchtype">
     <option value="allwords" selected>$txt[343]</option>
     <option value="anywords">$txt[344]</option>
     <option value="asphrase">$txt[345]</option>
    </select><BR>
    <B>$txt[583]:</B><br>
    <input type=text size=40 name=userspec>&nbsp;
    <select name="userkind">
     <option value="any">$txt[577]</option>
     <option value="starter">$txt[186]</option>
     <option value="poster">$txt[187]</option>
     <option value="noguests" selected>$txt[346]</option>
     <option value="onlyguests">$txt[572]</option>
    </select></font><br>
    <font size="2"><B>$txt[189]:</B><br></font><br>
    <table width="80%" border="0" cellpadding="1" cellspacing="0">
      <tr>
EOT;
	$request = mysql_query("SELECT b.ID_BOARD,b.name FROM {$db_prefix}boards as b, {$db_prefix}categories as c WHERE (b.ID_CAT=c.ID_CAT && (FIND_IN_SET('$settings[7]',c.memberGroups)!=0 || '$settings[7]'='Administrator' || '$settings[7]'='Global Moderator' || c.memberGroups=''))");
	$counter = 1;
	while ($row = mysql_fetch_row($request))
	{
		print "<td width=\"50%\"><font size=\"2\"><input type=checkbox name=\"brd$row[0]\" value=\"1\" checked><span id=\"spanbrd$row[0]\" style=\"cursor:hand;\" onClick=\"changeBox('document.searchform.brd$row[0]')\">$row[1]</span></font></td>";
		if( !($counter % 2) )
			print "</tr><tr>";
		$counter++;
	}
	print <<<EOT
	  <td></td>
      </tr>
    </table><BR>
    <INPUT TYPE="checkbox" ONCLICK="if (this.checked) checkAll(); else uncheckAll();" checked><font size="2"><i>$txt[737]</i></font>
    <BR><br><font size="2">
    <B>$txt[573]:</B></font><br>
    <table border="0" cellpadding="2" cellspacing="0">
      <tr>
        <td><font size="2">
        <input type=checkbox name=subfield value=on checked><span id="spansubfield" style="cursor:hand;" onClick="changeBox('document.searchform.subfield')">$txt[70]</span></font></td>
        <td><font size="2">
        <input type=checkbox name=msgfield value=on checked><span id="spanmsgfield" style="cursor:hand;" onClick="changeBox('document.searchform.msgfield')">$txt[72]</span></font></td>
      </tr>
    </table>
    <br>
    <table border="0" cellpadding="2" cellspacing="0">
      <tr>
        <td><font size="2">
        <B>$txt[575] $txt[574]:</B><br>
        <input type=text name=minripe value=0 size=3 maxlength=5> $txt[578] +
        <input type=text name=minage value=0 size=5 maxlength=5> $txt[579].
        </font></td>
        <td><font size="2">
        <B>$txt[576] $txt[574]:</B><br>
        <input type=text name=maxripe value=0 size=3 maxlength=5> $txt[578] +
        <input type=text name=maxage value=7 size=5 maxlength=5> $txt[579].</font></td>
      </tr>
    </table>
    <br>
    <table border="0" cellpadding="2" cellspacing="0" align="left">
      <tr>
        <td valign="bottom"><font size="2">
        <B>$txt[191]</B><br></font>
        <input type="text" size="5" name="numberreturned" maxlength="5" value="25"></td></tr><tr>
        <td valign="bottom">
        <input type="hidden" name="action" value="dosearch">
        <input type="submit" name="submit" value="$txt[182]"></td>
      </tr>
    </table>
   </td>
  </tr>
</table>
</form>
EOT;

	footer();
	obExit();
	
}

function plushSearch2 (){
	global $minripe, $minage, $maxripe, $maxage, $numberreturned,$userkind,$userspec,$searchtype,$search;
	global $subfield,$msgfield,$timeoffset,$settings,$yytitle,$txt,$maxmessagedisplay,$enable_notification;
	global $menusep,$scripturl,$cgi,$img,$color,$db_prefix,$imagesdir;

	$display = $numberreturned;

	// get the age of the latest post
	$request = mysql_query("SELECT posterTime FROM {$db_prefix}messages ORDER BY ID_MSG DESC LIMIT 1");
	list ($latestAge) = mysql_fetch_row($request);
	if(!is_numeric($minripe) || !is_numeric($minage) || !is_numeric($maxripe) || !is_numeric($maxage) || !is_numeric($display)) { fatal_error($txt[337]); }

	if( $userkind == 'starter' ) { $userkind = 1; }
	else if( $userkind == 'poster' ) { $userkind = 2; }
	else if( $userkind == 'noguests' ) { $userkind = 3; }
	else if( $userkind == 'onlyguests' ) { $userkind = 4; }
	else { $userkind = 0; $userspec = ''; }

	$userspec = trim($userspec);
	$userspec = preg_replace("/[^0-9A-Za-z#%+,-\.@^_]/","",$userspec);

	if( $searchtype == 'anywords' ) { $searchtype = 2; }
	else if( $searchtype == 'asphrase' ) { $searchtype = 3; }
	else { $searchtype = 1; }

	$searchsubject = ($subfield == 'on');
	$searchmessage = ($msgfield == 'on');

	$search = trim($search);
	$find = array("&","\"","<",">","\t","|");
	$replace = array("&amp;","&quot;","&lt;","&gt;","&nbsp;&nbsp;&nbsp;","&#124;");
	$search = str_replace($find,$replace,$search);

	$searcharray = array($search);
	if ($searchtype!=3)
	{
		$searcharray = array();
		foreach(explode(" ",$search) as $s)
			if (trim($s) != '')
				$searcharray[]=trim($s);
	}

	$curtime = $latestAge + (isset($settings[18])?(3600*$settings[18]):0) + (3600*$timeoffset);
	$mintime = $curtime - (($minage*86400)+($minripe*3600));
	$maxtime = $curtime - (($maxage*86400)+($maxripe*3600));

	$yytitle = $txt[166];
	template_header();

	$results = array();
	foreach ($searcharray as $query)
	{
		$where = '';
		$query = strtolower($query);
		if ($userkind == 1 && $userspec == '')
			$where = "(b.ID_CAT=c.ID_CAT && t.ID_BOARD=b.ID_BOARD && m.ID_MSG=t.ID_FIRST_MSG && (FIND_IN_SET('$settings[7]',c.memberGroups)!=0 || '$settings[7]'='Administrator' || '$settings[7]'='Global Moderator' || c.memberGroups='') && (INSTR(LOWER(m.subject),'$query') || INSTR(LOWER(m.body),'$query')) && m.posterTime <= $mintime && m.posterTime > $maxtime)";
		else if ($userkind == 1 && $userspec != '')
			$where = "(b.ID_CAT=c.ID_CAT && t.ID_BOARD=b.ID_BOARD && m.ID_MSG=t.ID_FIRST_MSG && m.posterName='$userspec' && (FIND_IN_SET('$settings[7]',c.memberGroups)!=0 || '$settings[7]'='Administrator' || '$settings[7]'='Global Moderator' || c.memberGroups='') && (INSTR(LOWER(m.subject),'$query') || INSTR(LOWER(m.body),'$query')) && m.posterTime <= $mintime && m.posterTime > $maxtime)";
		else if ($userkind == 2 && $userspec == '')
			$where = "(b.ID_CAT=c.ID_CAT && t.ID_BOARD=b.ID_BOARD && m.ID_TOPIC=t.ID_TOPIC && (FIND_IN_SET('$settings[7]',c.memberGroups)!=0 || '$settings[7]'='Administrator' || '$settings[7]'='Global Moderator' || c.memberGroups='') && (INSTR(LOWER(m.subject),'$query') || INSTR(LOWER(m.body),'$query')) && m.posterTime <= $mintime && m.posterTime > $maxtime)";
		else if ($userkind == 2 && $userspec != '')
			$where = "(b.ID_CAT=c.ID_CAT && t.ID_BOARD=b.ID_BOARD && m.ID_TOPIC=t.ID_TOPIC && m.posterName='$userspec' && (FIND_IN_SET('$settings[7]',c.memberGroups)!=0 || '$settings[7]'='Administrator' || '$settings[7]'='Global Moderator' || c.memberGroups='') && (INSTR(LOWER(m.subject),'$query') || INSTR(LOWER(m.body),'$query')) && m.posterTime <= $mintime && m.posterTime > $maxtime)";
		else if ($userkind == 3 && $userspec == '')
			$where = "(b.ID_CAT=c.ID_CAT && t.ID_BOARD=b.ID_BOARD && m.ID_TOPIC=t.ID_TOPIC && m.ID_MEMBER!=-1 && (FIND_IN_SET('$settings[7]',c.memberGroups)!=0 || '$settings[7]'='Administrator' || '$settings[7]'='Global Moderator' || c.memberGroups='') && (INSTR(LOWER(m.subject),'$query') || INSTR(LOWER(m.body),'$query')) && m.posterTime <= $mintime && m.posterTime > $maxtime)";
		else if ($userkind == 3 && $userspec != '')
			$where = "(b.ID_CAT=c.ID_CAT && t.ID_BOARD=b.ID_BOARD && m.ID_TOPIC=t.ID_TOPIC && m.ID_MEMBER!=-1 && m.posterName='$userspec' && (FIND_IN_SET('$settings[7]',c.memberGroups)!=0 || '$settings[7]'='Administrator' || '$settings[7]'='Global Moderator' || c.memberGroups='') && (INSTR(LOWER(m.subject),'$query') || INSTR(LOWER(m.body),'$query')) && m.posterTime <= $mintime && m.posterTime > $maxtime)";
		else if ($userkind == 4 && $userspec == '')
			$where = "(b.ID_CAT=c.ID_CAT && t.ID_BOARD=b.ID_BOARD && m.ID_TOPIC=t.ID_TOPIC && m.ID_MEMBER=-1 && (FIND_IN_SET('$settings[7]',c.memberGroups)!=0 || '$settings[7]'='Administrator' || '$settings[7]'='Global Moderator' || c.memberGroups='') && (INSTR(LOWER(m.subject),'$query') || INSTR(LOWER(m.body),'$query')) && m.posterTime <= $mintime && m.posterTime > $maxtime)";
		else if ($userkind == 4 && $userspec != '')
			$where = "(b.ID_CAT=c.ID_CAT && t.ID_BOARD=b.ID_BOARD && m.ID_TOPIC=t.ID_TOPIC && m.ID_MEMBER=-1 && m.posterName='$userspec' && (FIND_IN_SET('$settings[7]',c.memberGroups)!=0 || '$settings[7]'='Administrator' || '$settings[7]'='Global Moderator' || c.memberGroups='') && (INSTR(LOWER(m.subject),'$query') || INSTR(LOWER(m.body),'$query')) && m.posterTime <= $mintime && m.posterTime > $maxtime)";
		else
			$where = "(b.ID_CAT=c.ID_CAT && t.ID_BOARD=b.ID_BOARD && m.ID_TOPIC=t.ID_TOPIC && (FIND_IN_SET('$settings[7]',c.memberGroups)!=0 || '$settings[7]'='Administrator' || '$settings[7]'='Global Moderator' || c.memberGroups='') && (INSTR(LOWER(m.subject),'$query') || INSTR(LOWER(m.body),'$query')) && m.posterTime <= $mintime && m.posterTime > $maxtime)";


		$request = mysql_query("SELECT m.ID_MSG FROM {$db_prefix}boards as b, {$db_prefix}categories as c,{$db_prefix}topics as t, {$db_prefix}messages as m WHERE $where LIMIT $display");

		while ($row = mysql_fetch_row($request))
		{
			if (!isset($results[$row[0]]))
				$results[$row[0]]=1;
			else
				$results[$row[0]]++;
		}
	}
	$display = ($display < sizeof($results))?$display:sizeof($results);
	$results2 = arsort($results);

	$count = 0;
	foreach ($results as $msg => $counts)
	{
		if ($searchtype == 1 && $counts < sizeof($searcharray))
			continue;
		if ($count == $display)
			break;
		else
			$count++;
		$request = mysql_query("SELECT mes.ID_MEMBER as starterID, mes.posterName as starterName, m.subject, m.body, m.posterName, m.posterTime, m.smiliesEnabled, m.ID_MEMBER, t.ID_TOPIC, b.name as bname, b.ID_BOARD, c.name as cname FROM {$db_prefix}messages as m, {$db_prefix}topics as t, {$db_prefix}categories as c, {$db_prefix}boards as b,{$db_prefix}messages as mes WHERE (m.ID_TOPIC=t.ID_TOPIC && t.ID_BOARD=b.ID_BOARD && b.ID_CAT=c.ID_CAT && m.ID_MSG=$msg && t.ID_FIRST_MSG=mes.ID_MSG) LIMIT 1");
		$row = mysql_fetch_assoc($request);

		// create the "topic started by" string
		$starterString = "$txt[109] $row[starterName]";
		if ($row['starterID'] != '-1')
		{
			$request2 = mysql_query("SELECT memberName,realName FROM {$db_prefix}members WHERE ID_MEMBER='$row[starterID]' LIMIT 1");
			$row2 = mysql_fetch_array($request2);
			$starterString = "$txt[109] <a href=\"$cgi;action=viewprofile;user=$row2[memberName]\">$row2[realName]</a>";
		}

		$request = mysql_query("SELECT COUNT(*) FROM {$db_prefix}messages WHERE (ID_MSG < $msg && ID_TOPIC=$row[ID_TOPIC])");
		list($start) = mysql_fetch_row($request);
		$start = (floor($start/$maxmessagedisplay))*$maxmessagedisplay;

		foreach ($searcharray as $query)
         $row['body'] = preg_replace("/((\][^\[]*)|(^[^\[]*))(".str_replace("/", "\\/", quotemeta($query)).")/i","\\1<b>$query</b>",$row['body']);
			//$row['body'] = str_replace($query,"<b>$query</b>",$row['body']);

		$row['posterTime']=timeformat($row['posterTime']);

		$notify='';
		if($enable_notification) {
			$notify = "$menusep<a href=\"$scripturl?board=$row[ID_BOARD];action=notify;threadid=$row[ID_TOPIC];start=$start\"><img src=\"$imagesdir/notify_sm.gif\" border=0></a>";
		}

		if ($row['ID_MEMBER'] != -1)
		{
			$request2 = mysql_query("SELECT realName FROM {$db_prefix}members WHERE ID_MEMBER=$row[ID_MEMBER] LIMIT 1");
			list ($realName) = mysql_fetch_row($request2);
		}
		$namelink = isset($realName)?"<a href=\"$cgi;action=viewprofile;user=$row[posterName]\">$realName</a>":$row['posterName'];


      // And parse UBBC (Zef)
      $row['body'] = doUBBC($row['body'], $row['smiliesEnabled']);

		print <<<EOT
<table border="0" width="100%" cellspacing="0" cellpadding="0" bgcolor="$color[bordercolor]" class="bordercolor"><tr><td>
<table border="0" width="100%" cellpadding="2" cellspacing="1" bgcolor="$color[bordercolor]" class="bordercolor">
<tr>
	<td align="left" bgcolor="$color[titlebg]" class="title"><font class="text1" color="$color[titletext]" size=2>&nbsp;$count&nbsp;</font></td>
	<td bgcolor="$color[titlebg]"><font class="text1" color="$color[titletext]" size=2><b>&nbsp;$row[cname] / $row[bname] / <a href="$scripturl?board=$row[ID_BOARD];action=display;threadid=$row[ID_TOPIC];start=$start"><font class="text1" color="$color[titletext]" size=2>$row[subject]</font></a></b></font></td>
	<td align=right bgcolor="$color[titlebg]">&nbsp;<font class="text1" color="$color[titletext]" size=2>$txt[30]: $row[posterTime]&nbsp;</font></td>
</tr>
<tr>
	<td colspan=3 bgcolor="$color[catbg]" class="catbg"><font class="catbg" size=2>$starterString, $txt[105] $txt[525] $namelink</font></td>
</tr>
<tr>
	<td colspan=3 bgcolor="$color[windowbg2]" valign=top  height=80><font size=2>$row[body]</font></td>
</tr>
<tr>
	<td colspan=3 bgcolor="$color[catbg]"><font size=2>
		&nbsp;<a href="$scripturl?board=$row[ID_BOARD];action=post;threadid=$row[ID_TOPIC];title=Post+reply"><img src="$imagesdir/reply_sm.gif" border=0></a>$menusep<a href="$scripturl?board=$row[ID_BOARD];action=post;threadid=$row[ID_TOPIC];quote=$msg;title=Post+reply">$img[replyquote]</a>$notify
	</font></td>
</tr>
</table></td></tr></table><br>
EOT;
	}
print <<<EOT
$txt[167]<hr>
<font size=1><a href="$cgi">$txt[236]</a>
$txt[237]<br></font>
EOT;
	footer();
	obExit();
}

?>file|^|Sources/Security.php|^|4027|^|1008718748
<?php
/*****************************************************************************/
/* Security.php                                                              */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$securityplver="YaBB SE";

function is_admin (){
	global $settings,$txt;
	if($settings[7] != 'Administrator') { fatal_error($txt[1]); }
}

function is_admin2 (){
	global $settings,$txt;
	if($settings[7] != 'Administrator') { fatal_error($txt[134]); }
}

function banning (){
	global $txt,$settings,$username,$REMOTE_ADDR,$db_prefix;
	// # IP BANNING
	$remote_ip = $REMOTE_ADDR;
	$ipparts = explode(".",$REMOTE_ADDR);
	$request = mysql_query("SELECT value FROM {$db_prefix}banned WHERE (type='ip' AND (value='$remote_ip' OR value='$ipparts[0].$ipparts[1].$ipparts[2].*' OR value='$ipparts[0].$ipparts[1].*.*'))");
	if (mysql_num_rows($request) != 0) {
		$request = mysql_query("INSERT INTO {$db_prefix}log_banned (ip,logTime) VALUES ('$remote_ip',".time().")");
		$username = "Guest";
		fatal_error("$txt[678]$txt[430]!");
		return;
	}

	// # EMAIL BANNING
	if ($username != 'Guest') {
		$remote_ip = $REMOTE_ADDR;
		$request = mysql_query("SELECT value FROM {$db_prefix}banned WHERE (type='email' && value='$settings[2]')");
		if (mysql_num_rows($request) != 0) {
			$request = mysql_query("INSERT INTO {$db_prefix}log_banned (ip,email,logTime) VALUES ('$remote_ip','$settings[2]',".time().")");
			$username = "Guest";
			fatal_error("$txt[678]$txt[430]!");
		return;
		}
	}

    // # USERNAME BANNING
	if ($username != 'Guest') {
		$remote_ip = $REMOTE_ADDR;
		$request = mysql_query("SELECT value FROM {$db_prefix}banned WHERE (type='username' && value='$username')");
		if (mysql_num_rows($request) != 0) {
			$request = mysql_query("INSERT INTO {$db_prefix}log_banned (ip,email,logTime) VALUES ('$remote_ip','$settings[2]',".time().")");
			$username = "Guest";
			fatal_error("$txt[678]$txt[430]!");
		return;
		}
	}
}

function CheckIcon (){
	global $icon;
	$icons = array("xx","thumbup","thumbdown","exclamation","question","lamp","smiley","angry","cheesy","laugh","sad","wink");
	if (!in_array($icon,$icons))
		$icon = "xx";
}

?>
file|^|Sources/SendTopic.php|^|6271|^|1008718750
<?php
/*****************************************************************************/
/* SendTopic.php                                                             */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$sendtopicplver="YaBB SE";

function SendTopic ()
{
	global $threadid,$board,$cgi,$txt,$img,$imagesdir,$sourcedir,$color,$settings,$username,$db_prefix;
	if ($board=="_" || $board=="" || $board==" "){ fatal_error($txt[709]); }
	if ($threadid=="_" || $threadid=="" || $threadid==" "){ fatal_error($txt[710]); }

	$request = mysql_query("SELECT * FROM {$db_prefix}messages WHERE ID_TOPIC=$threadid ORDER BY ID_MSG LIMIT 1");
	$row = mysql_fetch_array($request);

	$yytitle = "$txt[707]&nbsp; &#171; $row[subject] &#187; &nbsp;$txt[708]";
	template_header();

print <<<EOT
<form action="$cgi;action=sendtopic2" method="post">
<table border=0  align="center" cellspacing=1 cellpadding="0" bgcolor="$color[bordercolor]" class="bordercolor">
  <tr>
    <td width="100%" bgcolor="$color[windowbg]" class="windowbg">
    <table width="100%" border="0" cellspacing="0" cellpadding="3">
      <tr>
        <td class="titlebg" bgcolor="$color[titlebg]" colspan="2">
        <img src="$imagesdir/email_sm.gif" alt="" border="0">
        <font size=2 class="text1" color="$color[titletext]"><b>$yytitle</b></font></td>
      </tr><tr>
        <td bgcolor="$color[windowbg]" class="windowbg" align=right valign=top>
        <font size=2><B>$txt[715]</B></font>
        </td>
        <td bgcolor="$color[windowbg]" class="windowbg" align=left valign=middle>
        <input type="text" name="y_name" size="20" maxlength="40" value="$settings[1]">
        </td>
      </tr><tr>
        <td bgcolor="$color[windowbg]" class="windowbg" align=right valign=top>
        <font size=2><B>$txt[716]</B></font>
        </td>
        <td bgcolor="$color[windowbg]" class="windowbg" align=left valign=middle>
        <input type="text" name="y_email" size="20" maxlength="40" value="$settings[2]">
        </td>
      </tr><tr>
        <td bgcolor="$color[windowbg]" class="windowbg" align=center valign=top colspan="2">
        <hr width="100%" size="1" class="windowbg3">
        </td>
      </tr><tr>
        <td bgcolor="$color[windowbg]" class="windowbg" align="right" valign="top">
        <font size=2><B>$txt[717]</B></font>
        </td>
        <td bgcolor="$color[windowbg]" class="windowbg" align="left" valign="middle">
        <input type="text" name="r_name" size="20" maxlength="40">
        </td>
      </tr><tr>
        <td bgcolor="$color[windowbg]" class="windowbg" align=right valign=top>
        <font size=2><B>$txt[718]</B></font>
        </td>
        <td bgcolor="$color[windowbg]" class="windowbg" align=left valign=middle>
        <input type="text" name="r_email" size="20" maxlength="40">
        </td>
      </tr><tr>
        <td bgcolor="$color[windowbg]" class="windowbg" align=center valign=middle colspan=2>
	<INPUT TYPE="hidden" NAME="board" VALUE="$board">
	<INPUT TYPE="hidden" NAME="threadid" VALUE="$threadid">
        <input type="submit" name="Send" value="$txt[339]">
        </td>
      </tr>
    </table>
    </td>
  </tr>
</table>
</form>
EOT;

footer();
	obExit();
}

function SendTopic2 (){
	global $threadid,$board,$y_name,$r_name,$y_email,$r_email,$yySetLocation,$cgi,$txt,$mbname,$db_prefix;
	if ($board=="_" || $board=="" || $board==" "){ fatal_error($txt[709]); }
	if ($threadid=="_" || $threadid=="" || $threadid==" "){ fatal_error($txt[710]); }

	$y_name = trim($y_name);
	$r_name = trim($r_name);

	if ($y_name=="_" || $y_name=="" || $y_name==" "){ fatal_error($txt[75]); }
	if ($y_email==""){ fatal_error($txt[76]); }
	if (!preg_match("/^[0-9A-Za-z@\._\-]+$/",$y_email)) { fatal_error($txt[243]); }
	
	if ($r_name=="_" || $r_name=="" || $r_name==" "){ fatal_error($txt[710]); }
	if ($r_email==""){ fatal_error($txt[76]); }
	if (!preg_match("/^[0-9A-Za-z@\._\-]+$/",$r_email)) { fatal_error($txt[243]); }

	$request = mysql_query("SELECT * FROM {$db_prefix}messages WHERE ID_TOPIC=$threadid ORDER BY ID_MSG LIMIT 1");
	$row = mysql_fetch_array($request);

	sendmail($r_email,"$txt[118]:  $row[subject] ($txt[318] $y_name)","$txt[711] $r_name,\n\n$txt[712]: $row[subject], on $mbname. $txt[713]:\n\n$cgi&action=display&threadid=$threadid\n\n\n$txt[714],\n$y_name",$y_email);

	$yySetLocation ="$cgi&action=display&threadid=$threadid";
	redirectexit();
}
?>file|^|Sources/Subs.php|^|29929|^|1008783731
<?php
/*****************************************************************************/
/* Subs.php                                                                  */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$subsplver="YaBB SE";

### Set the Cookie Exp. Date and the Current Date###
$Cookie_Exp_Date = "Sun, 17-Jan-2038 00:00:00 GMT"; # default just in case
#&SetCookieExp;
#&get_date;

$currentboard = $board;
if (($board != "") && (!preg_match("/\A[\s0-9A-Za-z#%+,-\.:=?@^_]+\Z/",$board))){ fatal_error($txt[399]); }

$pwseed = 'ys';

$printurl = $boardurl."/Printpage.php";
$reminderurl = $boardurl."/Reminder.php";
$scripturl = $boardurl."/index.php";
$cgi = $scripturl."?board=".$board;

$yyheaderdone = 0;	// this is used to make the fatal error thing work better

$endComment = '<font size=1 color=silver>';
list($start_time,$waste) = explode(" ",microtime());

function totalTime($comment) {
	global $start_time,$waste,$endComment;
	list($now,$waste) = explode(" ",microtime());
	$endComment .= "$comment: ".($now-$start_time)."<br>";
	$start_time = $now;
	return $endComment."</font>";
}

function footer() {
	global $yytemplate,$yycopyin,$yytemplatemain,$yycopyright,$settings,$yyVBStyleLogin,$yynews;
//	if ($settings[7]=='Administrator')
//		print totalTime("Seconds to process this directive: ");
	for($i = $yytemplatemain; $i < sizeof($yytemplate); $i++) {
		$curline = $yytemplate[$i];
		if( !$yycopyin && strstr($curline,"<yabb copyright>")) { $yycopyin = 1; }
		$tags = array();
		while (preg_match ("/<yabb\s+(\w+)>/",$curline,$tags))
		{
			$temp = "yy$tags[1]";
			if (function_exists($temp))
			{
				ob_start();
				$temp();
				$str = ob_get_contents();
				$curline = preg_replace("/<yabb\s+$tags[1]>/",$str,$curline);
				ob_end_clean();
			}
			else
			{
				$curline = preg_replace("/<yabb\s+$tags[1]>/",$$temp,$curline);
			}
		}

		print "$curline";
	}
	# Do not remove hard-coded text - it's in here so users cannot change the text easily (as if it were in .lng)
	if($yycopyin == 0) {
		print "<center><font size=5><B>Sorry, the copyright tag <yabb copyright> must be in the template.<BR>Please notify this forum's administrator that this site is using an ILLEGAL copy of YaBB!</B></font></center>";
	}
}

function fatal_error($e, $t = null) {
	global $txt, $color,$yytitle,$yyheaderdone;
	if ($t == null)
		$yytitle = $txt['106'];
	else
		$yytitle = $t;
	if (!$yyheaderdone)
		template_header();
	print <<<EOT
<table border=0 width="80%" cellspacing=1 bgcolor="$color[bordercolor]" class="bordercolor" align="center" cellpadding="4">
  <tr>
<td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$yytitle</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]"><BR><font size=2>$e</font><BR><BR></td>
  </tr>
</table>
<center><BR><a href="javascript:history.go(-1)">
 $txt[250]</a></center>
EOT;
	footer();
	obExit();
 }

function template_header() {
    global $yytemplate,$yyboardname,$yytitle,$yyuname,$yyim,$yytime,$yymenu,$yymain,$yycopyright;
	global $yynews,$yySetCookies,$menusep,$enable_notification,$enable_news,$username,$db_prefix;
	global $maintenance,$txt,$mbname,$date,$settings,$cgi,$img,$scripturl,$helpfile,$realname,$yyheaderdone;
	global $yycopyin,$yytemplatemain,$yytitle,$yyVBStyleLogin,$timeformatstring,$timeoffset,$modSettings;

	// print stuff to prevent cacheing of pages
	header ("Expires: Mon, 26 Jul 1997 05:00:00 GMT");
	header ("Last-Modified: " . gmdate("D, d M Y H:i:s") . " GMT");
	if ($modSettings['disableCaching']==1)
	{
		header ("Cache-Control: no-cache, must-revalidate");
		header ("Pragma: no-cache");
	}

	$yymenu = "<a href=\"$scripturl\">$img[home]</a>$menusep<a href=\"$helpfile\" target=_blank>$img[help]</a>$menusep<a href=\"$cgi;action=search\">$img[search]</a>";
	if($settings[7] == 'Administrator') { $yymenu = $yymenu.$menusep."<a href=\"$cgi;action=admin\">$img[admin]</a>"; }
	if($username == "Guest") { $yymenu .= $menusep."<a href=\"$cgi;action=login\">$img[login]</a>$menusep<a href=\"$cgi;action=register\">$img[register]</a>";
	} else {
		$yymenu .= "$menusep<a href=\"$cgi;action=profile;user=$username\">$img[profile]</a>";
		if($enable_notification) { $yymenu .= "$menusep<a href=\"$cgi;action=shownotify\">$img[notification]</a>"; }
		$yymenu .= "$menusep<a href=\"$cgi;action=logout\">$img[logout]</a>";
	}

	if($enable_news=='1') {
		$request = mysql_query("SELECT value FROM {$db_prefix}settings WHERE variable='news'");
		$temp = mysql_fetch_row($request);
		$news = $temp[0];
		$newsmessages = explode("\n",str_replace("\r","",trim($news)));
		// if we've disabled the fader....
		srand(time());
		// then some fuck-nut decided we should display a random news item 
		$newstring = '';
		if (sizeof($newsmessages) == 1)
			$newstring = $newsmessages[0];
		elseif (sizeof($newsmessages) > 1)
			$newstring = $newsmessages[floor(rand(0,(sizeof($newsmessages)-1)))];
		$yynews = "<b>$txt[102]:</b> ".DoUBBC($newstring);
	}
	if($username != "Guest") {
		$request = mysql_query("SELECT COUNT(*) FROM {$db_prefix}instant_messages WHERE (toName='$username' && deletedBy!=1)");
		$temp = mysql_fetch_row($request);
		$mnum = $temp[0];
		if($mnum == "1") { $yyim = "$txt[152] <a href=\"$cgi;action=im\">$mnum $txt[471]</a>."; }
		else { $yyim = "$txt[152] <a href=\"$cgi;action=im\">$mnum $txt[153]</a>."; }
		if($maintenance) { $yyim .= "<BR><B>$txt[616]</B>"; }
	}
	$yytemplate = file ('template.html');
	if (!sizeof($yytemplate)){ die ("$txt[23]: template.html"); }

	$yyboardname = $mbname;
	$time = isset($settings[18])?$settings[18]:0;
	$yytime = date($timeformatstring,time()+(($timeoffset+$time)*3600));
	// display their username if they haven't set their real name yet.
	$tmp = ($realname=='')?$username:$realname;
	$yyuname = ($username == 'Guest') ? "$txt[248] <b>$txt[28]</b>. $txt[249] <a href=\"$cgi;action=login\">$txt[34]</a> $txt[377] <a href=\"$cgi;action=register\">$txt[97]</a>." : "$txt[247] <b>$tmp</b>, ";
	$yycopyin = 0;

	$yyVBStyleLogin = '<br>';
	if ($modSettings['enableVBStyleLogin']=='1' && $username=='Guest')
	{
		$yyVBStyleLogin =<<<EOT
<form action="$cgi;action=login2" method="post"><br><input type=text name="user" size="7"> <input type=password name="passwrd" size="7"> <select name="cookielength"><option value="60">$txt[yse53]</option><option value="1440">$txt[yse47]</option><option value="10080">$txt[yse48]</option><option value="302400">$txt[yse49]</option><option value="$txt[yse50]" selected>$txt[yse50]</option></select> <input type="submit" value="$txt[34]"><br>$txt[yse52]</form>
EOT;
	}

	for( $yytemplatemain = 0; $yytemplatemain < sizeof($yytemplate); $yytemplatemain++ ) {
		$curline = $yytemplate[$yytemplatemain];
		if(strstr($curline,"<yabb main>")) { $yytemplatemain++; break; }
		if( !$yycopyin && strstr($curline,"<yabb copyright>")) { $yycopyin = 1; }
		$tags = array();
		while (preg_match ("/<yabb\s+(\w+)>/",$curline,$tags))
		{
			$temp = "yy$tags[1]";
			if (function_exists($temp))
			{
				ob_start();
				$temp();
				$str = ob_get_contents();
				$curline = preg_replace("/<yabb\s+$tags[1]>/",$str,$curline);
				ob_end_clean();
			}
			else
			{
				$curline = preg_replace("/<yabb\s+$tags[1]>/",$$temp,$curline);
			}
		}

		print "$curline";
	}
	$yyheaderdone = 1;
}

function datediff($now, $old, $format='seconds')
{
  $datearray1 = getdate($now);
  $datearray2 = getdate($old);
  $seconds = $now - $old;	// Diff In Secs
  $minutes = (int) round ($seconds / 60);
  $hours = (int) round ($seconds / 3600);
  $days = (int) round ($seconds / 86400);
  $years = $datearray1['year']-$datearray2['year']-(($datearray1['yday']>$datearray2['yday'])?0:1);

  return $$format;
}

function timeformat ($logTime){
	global $timeformatstring,$username,$settings,$timeoffset,$txt,$db_prefix;
	if (!isset($GLOBALS['todayMod'])) 
	{
		// pre-load variable so we don't query too much
		$req = mysql_query("SELECT value FROM {$db_prefix}settings WHERE variable='todayMod'");
		list($GLOBALS['todayMod'])=mysql_fetch_row($req);
	}
	$time = isset($settings[18])?$settings[18]:0;
	$time = ($timeoffset+$time)*3600;
	$nowtime = $time+time();
	$time += $logTime;
	if ($GLOBALS['todayMod']=='1')
	{
		$t1 = getdate($time);
		$t2 = getdate($nowtime);
		if ($t1['yday']==$t2['yday'] && $t1['year']==$t2['year'])
			return $txt['yse10'].date(" h:i:sa",$time);
	}
	if ($username == 'Guest' || $settings[17]=='')
		return date($timeformatstring,$time);
	return date($settings[17],$time);
}

function jumpto (){
	global $board,$txt,$settings,$scripturl,$db_prefix;
	$request = mysql_query("SELECT name,ID_CAT FROM {$db_prefix}categories WHERE (FIND_IN_SET('$settings[7]',memberGroups)!=0 OR memberGroups='' OR '$settings[7]'='Administrator' OR '$settings[7]'='Global Moderator')  ORDER BY catOrder");

	$selecthtml = "<select name=\"values\" onChange=\"if(this.options[this.selectedIndex].value) window.location.href='$scripturl' + this.options[this.selectedIndex].value;\">";

	$selecthtml .= "<option value=\"\">$txt[251]:</option>\n";
	while ($row = mysql_fetch_row($request))
	{
		$selecthtml .= "<option value=\"\">-----------------------------</option>\n";
		$selecthtml .= "<option value=\"#$row[1]\">$row[0]</option>\n";
		$selecthtml .= "<option value=\"\">-----------------------------</option>\n";
		$request2 = mysql_query("SELECT name,ID_BOARD FROM {$db_prefix}boards WHERE ID_CAT=$row[1] ORDER BY boardOrder");
		while ($row2 = mysql_fetch_row($request2))
		{
			if ($board == $row2[1])
				$selecthtml .= "<option value=\"?board=$row2[1]\" selected> =>$row2[0]</option>\n";
			else
				$selecthtml .= "<option value=\"?board=$row2[1]\"> =>$row2[0]</option>\n";
		}
	}
	$selecthtml .= "</select>";
	return $selecthtml;
}

function sendmail($to,$subject,$message,$from = null) {

    global $mailtype,$webmaster_email;
	if ($from==null){ $from=$webmaster_email; }
	$mail_result = mail ($to,$subject,$message,"From: $from\r\n");
    return $mail_result;
}

function spam_protection (){
	global $timeout,$REMOTE_ADDR,$txt,$db_prefix;
//	if (!$timeout){ return (false); }

	$time = time();
	$ip = $REMOTE_ADDR;

	$request = mysql_query("DELETE FROM {$db_prefix}log_floodcontrol WHERE ($time-logTime > $timeout)");
	$request = mysql_query("SELECT ip FROM {$db_prefix}log_floodcontrol WHERE ip='$REMOTE_ADDR' LIMIT 1");
	if (mysql_num_rows($request) == 0)
	{
		$request = mysql_query("INSERT INTO {$db_prefix}log_floodcontrol (ip,logTime) VALUES ('$REMOTE_ADDR',$time)");
		return (false);
	}
	else
	{
		fatal_error("$txt[409] $timeout $txt[410]");
		return (true);
	}
}

function SetCookieExp () {
	global $Cookie_Length,$Cookie_Exp_Date;
	# set to default if missing
	if ($Cookie_Length == "") { $Cookie_Length = "120"; }
	$expires = ($Cookie_Length*60);   
	$Cookie_Exp_Date = gmdate ("D, d-M-Y H:i:s GMT",(time()+$expires));
}

/**
 * Preparses a message, puts [url] tags around urls etc.
 * @param $message the message to parse the code in
 * @return the preparsed code
 */
function preparsecode($message, $realname, $username)
{
   global $settings, $ext;

   if(strstr($realname, "[") || strstr($realname, "]") || strstr($realname, "'") || strstr($realname, "\""))
      $realname = $username;

   $codes = array(
      '/(^|[ \n\r\t])((http(s?):\/\/)(www\.)?([a-z0-9_-]+(\.[a-z0-9_-]+)+)(:[0-9]+)?(\/[^\/ \)\(\n\r]*)*)/is',
      '/(\/me) (.*)([\r\n]?)/i'
   );
   $codesto = array(
      '\1[url=\2]\2[/url]',
      "[me=$realname]\\2[/me]\\3"
   );
   $message = preg_replace($codes, $codesto, $message);
   $message = str_replace("\r","", $message);

   // Check if all quotes are closed
   preg_match_all("/(\[quote([^\]]+)?\])/", $message, $regs);
   $quoteopen =  count($regs[0]);
   preg_match_all("/(\[\/quote\])/", $message, $regs);
   $quoteclose =  count($regs[0]);

   if($quoteopen > $quoteclose)
   {
      $toclose = $quoteopen - $quoteclose;
      for($i = 0 ; $i < $toclose ; $i++)
         $message .= "[/quote]";
   }
   elseif($quoteclose > $quoteopen)
   {
      $toopen = $quoteclose - $quoteopen;
      for($i = 0 ; $i < $toopen ; $i++)
         $message = "[quote]$message";
   }
   return $message;
}

/**
 * Parses both smilies and kB code as required
 * @param $message the message to parse the code in
 * @param $boarddata the data array of the current board
 * @param $code whether or not to parse kB codes
 * @param $smilies same for smilies :-)
 */
function doUBBC($message,$enableSmilies = 1)
{
   global $settings, $text;

//   $message = str_replace('&','&amp',$message);
//   $message = str_replace('<','&lt',$message);
//   $message = str_replace('>','&gt',$message);
//   $message = str_replace("\"", '&quot',$message);
//   $message = str_replace('\"','"',$message);
//   $message = str_replace("\'","'",$message);
   $message = str_replace('$','&#36;',$message);
   $message = str_replace('[[','{<{',$message);
   $message = str_replace(']]','}>}',$message);

   $message = "[/code]".$message."[code]";

   $patterns = array(
      '/(^[^(\[\/code\])(\[\/php\])]+|\[\/code\]|\[\/php\])(.*)(\[code\]|\[php\]|$)/Uise',
      '/(^\[\/code\]|\[code\]$)/i',
      '/\[code\][\n\r]*(.+?)[\n\r]*\[\/code\]/is',
      '/\[php\][\n\r]*(.+?)[\n\r]*\[\/php\]/esi'
   );
   $replace = array(
      "'\\1'.doparsecodesmilies('\\2',$enableSmilies).'\\3'",
      "",
      "<font size=1><b>Code:</b></font><table border=0 cellspacing=1 cellpadding=2 width=\"100%\"><tr><td class=quote><font face=\"Courier new\">\\1</font></td></tr></table>",
      "phphighlight('\\1')"
   );

   $message = stripslashes(preg_replace($patterns, $replace, addslashes($message)));

   $message = str_replace('{<{','[',$message);
   $message = str_replace('}>}',']',$message);
//   $message = stripslashes($message); // Maybe you'll have to uncomment this
   $message = str_replace("  ","&nbsp; ",$message);
   $message = str_replace("\t","&nbsp; &nbsp; ",$message);
	$message = str_replace("\n\r","<br>",$message);
	$message = str_replace("\r","<br>",$message);
	$message = str_replace("\n","<br>",$message);
//   $message = preg_replace("/\[img\](.*)\[\/img\]/i","<img src=\"$1\" border=0 alt=\"\">",$message);
   return $message;
}

/**
 * This function is being called by the above function (in a regexp) and will parse
 * smilies and tags as desired outside [code] and [php] tags.
 * @param $message the message to parse the code in
 * @param $boarddata the data array of the current board
 */
function doparsecodesmilies($message,$enableSmilies = 1)
{
   global $codefromcache, $codetocache, $smileyfromcache, $smileytocache, $text, $scripturl,$imagesdir;

   if(gettype($codefromcache) != "array" || gettype($smileyfromcache) != "array")
   {
      $codefromcache = array(
         '/([a-z_-][a-z0-9\._-]*@[a-z0-9_-]+(\.[a-z0-9_-]+)+)/is',
         '/\[url\](.+?)\[\/url\]/is',
         '/\[url=(.+?)\](.+?)\[\/url\]/is',
         // '/\[email\](.+?)\[\/email\]/is',
		// '/\[email=(.+?)\](.+?)\[\/email\]/is',
         '/\[b\](.+?)\[\/b\]/is',
         '/\[i\](.+?)\[\/i\]/is',
         '/\[u\](.+?)\[\/u\]/is',
         '/\[s\](.+?)\[\/s\]/is',
         '/\[move\](.+?)\[\/move\]/is',
         '/\n?\[quote author=(.+?) link=(.+?) date=(.+?)\]\n*/ei',
         '/\[\/quote\]/i',
         '/\n?\[quote\]\n*/i',
		 '/\[me=([^\]]+)\](.+?)\[\/me\]/is',
         '/\[img\](.+?)\[\/img\]/i',
         '/\[color=([\w#]+)\](.*?)\[\/color\]/is',
         '/\[black\](.+?)\[\/black\]/is',
         '/\[white\](.+?)\[\/white\]/is',
         '/\[red\](.+?)\[\/red\]/is',
         '/\[green\](.+?)\[\/green\]/is',
         '/\[blue\](.+?)\[\/blue\]/is',
         '/\[font=(.+?)\](.+?)\[\/font\]/is',
         '/\[size=(.+?)\](.+?)\[\/size\]/is',
		 '/\[pre\](.+?)\[\/pre\]/is',
		 '/\[left\](.+?)\[\/left\]/is',
		 '/\[right\](.+?)\[\/right\]/is',
		 '/\[center\](.+?)\[\/center\]/is',
		 '/\[sub\](.+?)\[\/sub\]/is',
		 '/\[sup\](.+?)\[\/sup\]/is',
		 '/\[tt\](.+?)\[\/tt\]/is',
		 '/\[table\](.+?)\[\/table\]/is',
		 '/\[tr\](.+?)\[\/tr\]/is',
		 '/\[td\](.+?)\[\/td\]/is',
		 '/\[ftp\](.+?)\[\/ftp\]/is',
		 '/\[ftp=(.+?)\](.+?)\[\/ftp\]/is',
       // Edited by Zef 11/27/2001
		 '/\[glow=(.+?),(.+?),(.+?)\](.+?)\[\/glow\]/eis',
		 '/\[shadow=(.+?),(.+?),(.+?)\](.+?)\[\/shadow\]/is',
       '/\[email\](.+?)\[\/email\]/is',
          '/\[hr\]/i',
          '/\[flash=(\S+?),(\S+?)\](\S+?)\[\/flash\]/is',
          '/\[list\]/',
          '/\[\/list\]/',
      );

      $codetocache = array(
         '[url=mailto:\1]\1[/url]',
         //"<a href=\"mailto:\1\">\1</a>",
         //"<a href=\"mailto:\1\">\2</a>",
         "<a href=\"\\1\" target=_blank>\\1</a>",
         "<a href=\"\\1\" target=_blank>\\2</a>",
         "<b>\\1</b>",
         "<i>\\1</i>",
         "<u>\\1</u>",
         "<s>\\1</s>",
         "<marquee>\\1</marquee>",
         "'<br><font size=1><b><a href=\"$scripturl?action=display;\\2\">Quote from: \\1 on '.timeformat('\\3').'</a>	</b></font><table border=0 cellspacing=1 cellpadding=2 width=\"100%\"><tr><td class=quote>'",
         "</td></tr></table>",
         "<br><font size=1><b>Quote:</b></font><table border=0 cellspacing=1 cellpadding=2 width=\"100%\"><tr><td class=quote>",
         "<font class=meaction>* \\1 \\2</font>",
         "<img src=\"\\1\" alt=\"\">",
         "<font color=\"\\1\">\\2</font>",
         "<font color=\"#000000\">\\1</font>",
         "<font color=\"#FFFFFF\">\\1</font>",
         "<font color=\"#FF0000\">\\1</font>",
         "<font color=\"#00FF00\">\\1</font>",
         "<font color=\"#0000FF\">\\1</font>",
         "<font face=\"\\1\">\\2</font>",
         "<font size=\\1>\\2</font>",
         "<pre>\\1</pre>",
		 "<div align=\"left\">\\1</div>",
		 "<div align=\"right\">\\1</div>",
		 "<div align=\"center\">\\1</div>",
		 "<sub>\\1</sub>",
		 "<sup>\\1</sub>",
		 "<tt>\\1</tt>",
		 "<table>\\1</table>",
		 "<tr>\\1</tr>",
		 "<td>\\1</td>",
		 "<a href=\"\\1\" target=_blank>\\1</a>",
         "<a href=\"\\1\" target=_blank>\\2</a>",
		 "'<table style=\"Filter: Glow(Color=\\1, Strength='.(('\\2'<400)?'\\2':400).')\" width='.(('\\3'<400)?'\\3':400).'\>\\4</table>'",
		 "<span style=\"Filter: Shadow(Color=\\1, Direction=\\2); width: \\3 px; \">\\4</span>",
            "\\1",
            "<hr>",
            "<object classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" width=\\1 height=\\2><param name=movie value=\\3><param name=play value=true><param name=loop value=true><param name=quality value=high><embed src=\\3 width=\\1 height=\\2 play=true loop=true quality=high></embed></object>",
            "<ul>",
            "</ul>"
      );
      // Uncomment the code below to make it more revolutionary ;)
      /*$replacements = $DB->query("SELECT searchfor, replaceby, kind FROM kb_replacements WHERE kind <= 2");
      while($replacement = $DB->fetch($replacements))
      {
         if($replacement[kind] == 2)
         {
            $useit=1;
            $disallow = explode(',', $boarddata[disallowtags]);
            if($boarddata[disallowtags])
            {
               for($i=0;$i<count($disallow);++$i)
                  if(strstr($replacement[searchfor], $disallow[$i]))
                     $useit = 0;
            }
            if($useit)
            {
               $from = quotemeta($replacement[searchfor]);
               $from = str_replace('\$\$','(.*?)', $from);
               $from = str_replace('/','\/', $from);
               $to = str_replace('$','\\', $replacement[replaceby]);
               $codefromcache[] = "/$from/is";
               $codetocache[] = $to;
            }
         }
         else
         {
	   $smileyfromcache[] ='/((\][^\[]*)|(^[^\[]*))('.str_replace('|','\|', quotemeta(str_replace("<", "&lt;", str_replace(">", "&gt;", $replacement[searchfor])))).')/is';
            //$smileytocache[] = "\\1<img src=\"images/smilies/".$smiley[replaceby].".gif\" alt=\"$smiley[searchfor]\">";
            $smileytocache[] = "\\1[img]images/smilies/".$replacement[replaceby].".gif[/img]";
         }
      }
      */

      // Instead we use:
      $smiliesfrom = array("::)", ">:(", ">:D", ":)", ";)", ':D', ';D', ':(', ':o', '8)', ':P', '???', ':-[', ':-X', ':-*', ":\'(",':-\\',"^-^","O0");
      //  :-/ :-* :'(
      $smiliesto = array('rolleyes', 'angry', "evil", "smiley", "wink", 'cheesy', 'grin', 'sad', 'shocked', 'cool', 'tongue', 'huh', 'embarassed', 'lipsrsealed', 'kiss', 'cry','undecided','azn','afro'); // You'll get the idea

      // This smiley regex makes sure it doesn't parse smilies within code tags (so [url=mailto:David@bla.com] doesn't parse the :D smiley)

      for($i=0 ; $i < count($smiliesfrom); $i++)
      {
         $smileyfromcache[] ='/(((\][^\[]*)|(^[^\[]*))([^\w]|^))('.str_replace('|','\|', quotemeta(str_replace("<", "&lt;", str_replace(">", "&gt;", str_replace("\/", "\\\/", $smiliesfrom[$i]))))).')/s';
        $smileytocache[] = "\\1[img]$imagesdir/$smiliesto[$i].gif[/img]";
      }
   }

	if ($enableSmilies)
		$message = parsesmilies($message);
   $message = parsecode($message);

   // List items
   $itemcode = array(
      '*' => '',
      '@' => ' type="disc"',
      '+' => ' type="square"',
      'x' => ' type="square"',
      '#' => ' type="square"',
      'o' => ' type="circle"',
      '0' => ' type="circle"'
   );

   $message = preg_replace("!\\[([*@+x#o0])\\]!Uie", '\'<li\'.$itemcode[\'\\1\'].\'>\'', $message);

   return $message;
}

/**
 * Parses the special KeyBulletin code (also being used in UBB, YaBB, iB and other boards)
 * and returns it parsed (duh).
 * @param $message the message to parse the code in
 * @return the parsed code
 */

function parsecode($message)
{
   global $codefromcache, $codetocache;

   if(!strstr($message, '[') && !strstr($message, '://') && !strstr($message, '@') && !strstr($message, '/me'))
      return $message;

   if(gettype($codefromcache) != "array")
      return $message;

   $message = preg_replace($codefromcache, $codetocache, $message);

   return $message;
}

/**
 * Parses smilies in the specified $message
 * @param $message the message to parse
 * @return the parsed code
 */
function parsesmilies($message)
{
   global $smileyfromcache, $smileytocache;

   $oldmessage = "";
   while($oldmessage != $message)
   {
      $oldmessage = $message;
      $message = preg_replace($smileyfromcache, $smileytocache, $message);
   }

   return $message;
}

function KickGuest (){
	global $yytitle, $txt, $reminderurl, $color, $cgi, $Cookie_Length;
	$yytitle = $txt[34];
	template_header();
	print <<<EOT
<table border=0 cellspacing=1 bgcolor="$color[bordercolor]" class="bordercolor" align="center">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$txt[633]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]"><font size=2><BR>
    $txt[634]<BR>
    $txt[635] <a href="$cgi;action=register">$txt[636]</a> $txt[637]
    <BR><BR></font></td>
</tr><tr>
    <td class="titlebg" bgcolor="$color[titlebg]"><font size=2 class="text1" color="$color[titletext]"><b>$txt[34]</b></font></td>
</tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]"><font size=2><form action="$cgi;action=login2" method="POST">
    <table border=0 align="left">
      <tr>
        <td align="right"><font size=2><b>$txt[35]:</b></font></td>
        <td><font size=2><input type=text name="user" size=20></font></td>
      </tr><tr>
        <td align="right"><font size=2><b>$txt[36]:</b></font></td>
        <td><font size=2><input type=password name="passwrd" size=20></font></td>
      </tr><tr>
        <td align="right"><font size=2><b>$txt[497]:</b></font></td>
        <td><font size=2><input type=text name="cookielength" size=4 maxlength="4" value="$Cookie_Length"></font></td>
      </tr><tr>
        <td align="right"><font size=2><b>$txt[508]:</b></font></td>
        <td><font size=2><input type=checkbox name="cookieneverexp"></font></td>
      </tr><tr>
        <td align=center colspan=2><BR><input type=submit value="$txt[34]"></td>
      </tr><tr>
        <td align=center colspan=2><small><small><a href="$reminderurl?action=input_user">$txt[315]</small></small></a><BR><BR></td>
      </tr>
    </table>
    </td>
  </tr>
</table></form>
EOT;
	footer();
	obExit();
}

/**
 * Highlights passed $code (only works in PHP4+)
 * @param $code code to be parsed
 * @return the php code parsed code
 */
function phphighlight($code)
{
   if (floor(phpversion())<4)
      $buffer=$code;
   else
   {
      $code = stripslashes($code);
      $code = stripslashes($code);
      $code = str_replace("&gt;", ">", $code);
      $code = str_replace("&lt;", "<", $code);
      $code = str_replace("&#36;", "\$", $code);
      $code = str_replace("&quot;", "\"", $code);
      if (!strstr($code,'<?')) {
         $code="<?php\n".trim($code)."\n?>";
         $addedtags=1;
      }
      ob_start();
      $oldlevel=error_reporting(0);
      highlight_string($code);
      error_reporting($oldlevel);
      $buffer = ob_get_contents();
      ob_end_clean();
      $buffer = str_replace("&quot", "\"", $buffer);
     }

   return "<font size=1><b>PHP:</b></font><table border=0 cellspacing=1 cellpadding=2 width=\"100%\"><tr><td class=quote>".addslashes(addslashes($buffer))."</td></tr></table>";
}


function WriteLog (){
	global $REMOTE_ADDR,$username,$db_prefix;
	$logTime = time();
	$identity = $username;
	if($username == 'Guest') { $identity = $REMOTE_ADDR; }	
	$request = mysql_query ("DELETE FROM {$db_prefix}log_online WHERE (logTime < ".($logTime - 900)." or identity='$identity')");
	$request = mysql_query ("INSERT INTO {$db_prefix}log_online (identity,logTime) VALUES ('$identity',$logTime)");
}

function ClickLog (){
	global $HTTP_REFERER,$HTTP_USER_AGENT,$REMOTE_ADDR,$REQUEST_URI,$ClickLogTime,$db_prefix;
	$logTime = time();
	$threshold = time() - ($ClickLogTime*60);
	$request = mysql_query ("INSERT INTO {$db_prefix}log_clicks (ip,logTime,agent,fromUrl,toUrl) VALUES ('$REMOTE_ADDR',$logTime,'$HTTP_USER_AGENT','$HTTP_REFERER','$REQUEST_URI')");
	$request = mysql_query ("DELETE FROM {$db_prefix}log_clicks WHERE logTime<$threshold");
}

function redirectinternal () {
	global $currentboard,$sourcedir;
	if( $currentboard != '') {
		if( isset($num) ) {
			include_once("$sourcedir/Display.php");
			Display();
		}
		else {
			include_once ("$sourcedir/MessageIndex.php");
			MessageIndex();
		}
	}
	else {
		include_once ("$sourcedir/BoardIndex.php");
		BoardIndex();
	}
	obExit();
}

function redirectexit (){
	global $yySetLocation;
	header("Location: ".str_replace(" ","%20",$yySetLocation));
	obExit();
}

function Sticky ()
{
	global $threadid,$sticky,$moderators,$settings,$username,$txt,$cgi,$yySetLocation,$db_prefix,$doLimitOne;
	if (!in_array($username,$moderators) && $settings[7] != 'Administrator' && $settings[7] != 'Global Moderator') { fatal_error("$txt[67]"); }
	if ($threadid == '') { fatal_error("No thread specified!"); }
	$newsticky = ($sticky == '1' ) ? 0 : 1;
	$request = mysql_query("UPDATE {$db_prefix}topics SET isSticky=$newsticky WHERE ID_TOPIC=$threadid$doLimitOne");
	$yySetLocation = "$cgi&action=display&threadid=$threadid";
	redirectexit();
}

function obExit()
{
	global $HTTP_ACCEPT_ENCODING,$modSettings;
	if (!$modSettings['enableCompressedOutput'])
	{
		ob_end_flush();
		exit;
	}
 	$html = ob_get_contents();
	ob_end_clean();
	$level = 1;
  
	// Check if zlib is installed
	if(function_exists("crc32") && function_exists("gzcompress"))
	{
	$encoding = '';
		// if so check what kind of gzipping can be used
		if(strpos(" ".$HTTP_ACCEPT_ENCODING, "x-gzip"))
			$encoding = "x-gzip";
		elseif(strpos(" ".$HTTP_ACCEPT_ENCODING,"gzip"))
			$encoding = "gzip";

		if ($encoding) // ok, encoding is accepted
		{
			header("Content-Encoding: $encoding");

			$size = strlen($html);
			$crc = crc32($html);

			$output = "\x1f\x8b\x08\x00\x00\x00\x00\x00";
			$output .= substr(gzcompress($html, $level), 0, -4);
			$output .= pack("V", $crc);
			$output .= pack("V", $size);
		}
		else
		$output = $html;
	}
	else
	$output = $html;

	echo $output;
	exit;
}
?>
file|^|Sources/versions.php|^|1866|^|1008718755
$GLOBALS['server_YaBBversion'] = "connection failed";
$GLOBALS['server_YaBBplver'] = "connection failed";
$GLOBALS['server_englishlngver'] = "connection failed";
$GLOBALS['server_adminplver'] = "connection failed";
$GLOBALS['server_boardindexplver'] = "connection failed";
$GLOBALS['server_displayplver'] = "connection failed";
$GLOBALS['server_icqpagerplver'] = "connection failed";
$GLOBALS['server_instantmessageplver'] = "connection failed";
$GLOBALS['server_loadplver'] = "connection failed";
$GLOBALS['server_lockthreadplver'] = "connection failed";
$GLOBALS['server_loginoutplver'] = "connection failed";
$GLOBALS['server_maintenanceplver'] = "connection failed";
$GLOBALS['server_manageboardsplver'] = "connection failed";
$GLOBALS['server_managecatsplver'] = "connection failed";
$GLOBALS['server_memberlistplver'] = "connection failed";
$GLOBALS['server_messageindexplver'] = "connection failed";
$GLOBALS['server_modifymessageplver'] = "connection failed";
$GLOBALS['server_movethreadplver'] = "connection failed";
$GLOBALS['server_notifyplver'] = "connection failed";
$GLOBALS['server_postplver'] = "connection failed";
$GLOBALS['server_profileplver'] = "connection failed";
$GLOBALS['server_recentplver'] = "connection failed";
$GLOBALS['server_registerplver'] = "connection failed";
$GLOBALS['server_removeoldthreadsplver'] = "connection failed";
$GLOBALS['server_removethreadplver'] = "connection failed";
$GLOBALS['server_searchplver'] = "connection failed";
$GLOBALS['server_sendtopicplver'] = "connection failed";
$GLOBALS['server_securityplver'] = "connection failed";
$GLOBALS['server_subsplver'] = "connection failed";
$GLOBALS['server_pollplver'] = "connection failed";
$GLOBALS['server_karmaphpver'] = "connection failed";
$GLOBALS['server_modsettingsphpver'] = "connection failed";
$GLOBALS['server_repairboardsphpver'] = "connection failed";file|^|Sources/index.php|^|66|^|1008718677
<?
include ("../Settings.php");
header("Location: $boardurl");
?>
file|^|Sources/ManageAttachments.php|^|9861|^|1008718695
<?php
/*****************************************************************************/
/* ManageAttachments.php                                                     */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

$manageattachmentsphpver = "YaBB SE";
is_admin();

function ManageAttachments (){
	global $yytitle,$txt,$color,$cgi,$img,$imagesdir,$db_prefix,$modSettings,$realNames,$scripturl;
	$yytitle = "$txt[yse201]";
	template_header();

	// now we need to collect the stats
	$request = mysql_query("SELECT attachmentSize FROM {$db_prefix}messages WHERE (attachmentFilename!=NULL || attachmentSize>0)");
	$attachmentNo = 0;
	$attachmentDirSize = 0;
	while ($row = mysql_fetch_row($request))
	{
		$attachmentDirSize += $row[0];
		$attachmentNo ++;
	}
	$attachmentSpace = ($modSettings['attachmentDirSizeLimit']=='')?$txt['yse215']:(round($modSettings['attachmentDirSizeLimit']-($attachmentDirSize/1024),2)." $txt[yse211]");
	$attachmentDirSize = round ($attachmentDirSize/1024,2)." $txt[yse211]";

	print <<<EOT
<table border="0" align="center" cellspacing="1" cellpadding="4" bgcolor="$color[bordercolor]" class="bordercolor" width="90%">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]" colspan="3">
		<script language="javascript" TYPE="text/javascript">
		<!--
		function reqWin(desktopURL){
        desktop =window.open(desktopURL,"name","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,width=400,height=200,resizable=no");
        }
		// -->
	</script>
    <font class="text1" color="$color[titletext]" size="1"><b>$txt[yse201]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]" colspan="3"><BR><font size="1">$txt[yse202]</font><BR><BR></td>
  </tr>

  <tr>
    <td bgcolor="$color[catbg]" class="catbg" height="25"><font size="2"><b>$txt[yse203]</b></font></td>
  </tr>
  <tr>
    <td bgcolor="$color[windowbg2]" class="windowbg2" width="100%" valign="top">
    <table border="0" cellspacing="0" cellpadding="3">
      <tr>
        <td>$txt[yse204]:</td><td>$attachmentNo</td>
      </tr>
      <tr>
        <td>$txt[yse205]:</td><td>$attachmentDirSize</td>
      </tr>
      <tr>
        <td>$txt[yse206]:</td><td>$attachmentSpace</td>
      </tr>
    </table><br>
    </td>
  </tr>
  <tr>
    <td bgcolor="$color[catbg]" class="catbg" height="25"><font size="2"><b>$txt[yse207]</b></font></td>
  </tr>
  <tr>
    <td bgcolor="$color[windowbg2]" class="windowbg2" width="100%" valign="top">
	<form action="$cgi;action=removeAttachmentsByAge" method=POST>
	$txt[72]: <input type=text size=40 value="$txt[yse216]" name="notice"><br>
	$txt[yse209] <input type=text value=25 size=4 name="age">$txt[579] <input type=submit value="$txt[yse138]"></form>
	<form action="$cgi;action=removeAttachmentsBySize" method=POST>
	$txt[72]: <input type=text size=40 value="$txt[yse216]" name="notice"><br>
	$txt[yse210] <input type=text value=100 size=4 name="size">$txt[yse211] <input type=submit value="$txt[yse138]"></form><br>
    </td>
  </tr>
  <tr>
    <td bgcolor="$color[catbg]" class="catbg" height="25"><font size="2"><b>$txt[yse208]</b></font></td>
  </tr>
  <tr>
    <td bgcolor="$color[windowbg2]" class="windowbg2" width="100%" valign="top">
<table border="0" cellspacing="1" cellpadding="4" bgcolor="$color[bordercolor]" class="bordercolor" width="100%">
      <tr>
          <td bgcolor="$color[windowbg2]" class="windowbg2" nowrap><b>$txt[yse213]</b></td>
		  <td bgcolor="$color[windowbg2]" class="windowbg2" nowrap><b>$txt[yse214]</b></td>
		  <td bgcolor="$color[windowbg2]" class="windowbg2" nowrap><b>$txt[279]</b></td>
		  <td bgcolor="$color[windowbg2]" class="windowbg2" nowrap><b>$txt[317]</b></td>
		  <td bgcolor="$color[windowbg2]" class="windowbg2" nowrap><b>$txt[118]</b></td>
		  <td bgcolor="$color[windowbg2]" class="windowbg2" nowrap><b>$txt[yse138]</b></td>
      </tr>
EOT;

$request = mysql_query("SELECT m.ID_MSG,m.posterName,m.posterTime,m.ID_TOPIC,m.ID_MEMBER,m.attachmentFilename,m.attachmentSize,mem.subject,t.ID_BOARD FROM {$db_prefix}messages as m,{$db_prefix}messages as mem, {$db_prefix}topics as t WHERE ((m.attachmentFilename!=NULL || m.attachmentSize > 0) && m.ID_TOPIC=t.ID_TOPIC && t.ID_FIRST_MSG=mem.ID_MSG)");
while ($row = mysql_fetch_array($request))
{
LoadRealName($row['posterName']);
$name = $realNames[$row['posterName']];
$name = ($row['ID_MEMBER']==-1)?$name:"<a href=\"$cgi;action=viewprofile;user=$row[posterName]\">$name</a>";
$date = timeformat($row['posterTime']);
$size = round($row[attachmentSize]/1024,2);
print <<<EOT
	<tr>
        <td bgcolor="$color[windowbg2]" class="windowbg2"><a href="$modSettings[attachmentUrl]/$row[attachmentFilename]" target="_blank">$row[attachmentFilename]</a></td>
	    <td bgcolor="$color[windowbg2]" class="windowbg2" align=right>$size$txt[yse211]</td>
	    <td bgcolor="$color[windowbg2]" class="windowbg2">$name</td>
	    <td bgcolor="$color[windowbg2]" class="windowbg2">$date</td>
	    <td bgcolor="$color[windowbg2]" class="windowbg2"><a href="$scripturl?board=$row[ID_BOARD];action=display;threadid=$row[ID_TOPIC]">$row[subject]</a></td>
 	    <td bgcolor="$color[windowbg2]" class="windowbg2"><a href="$cgi;action=removeattachment;msg=$row[ID_MSG]">$txt[yse138]</a></td>
      </tr>
EOT;
}
print <<<EOT
	</table>
	  <div align=right><a href="$cgi;action=removeallattachments">$txt[yse138] $txt[190]</a></div>
		<br>
	  </td>
  </tr>
</table>
EOT;
	footer();
	obExit();
}

function RemoveAttachmentByAge()
{
	global $txt,$color,$cgi,$img,$imagesdir,$db_prefix,$modSettings,$realNames,$scripturl,$age,$notice,$msg;

	$threshold = time()-(24*60*60*$age);
	$request = mysql_query("SELECT attachmentFilename,ID_MSG FROM {$db_prefix}messages WHERE (posterTime<$threshold && (attachmentFilename!=NULL || attachmentSize>0))");
	while ($row = mysql_fetch_array($request))
	{
		$row['body'].= "\n\n".mysql_escape_string($notice);
		$request2 = mysql_query("UPDATE {$db_prefix}messages SET attachmentFilename=NULL,attachmentSize=0,body='$row[body]' WHERE ID_MSG='$row[ID_MSG]'");
		unlink($modSettings['attachmentUploadDir'] . "/" . $row['attachmentFilename']);
	}
	ManageAttachments();
}

function RemoveAttachmentBySize()
{
	global $txt,$color,$cgi,$img,$imagesdir,$db_prefix,$modSettings,$realNames,$scripturl,$size,$notice,$msg;

	$threshold = 1024*$size;
	$request = mysql_query("SELECT attachmentFilename,ID_MSG,body FROM {$db_prefix}messages WHERE (attachmentSize>$threshold)");
	while ($row = mysql_fetch_array($request))
	{
		$row['body'].= "\n\n".mysql_escape_string($notice);
		$request2 = mysql_query("UPDATE {$db_prefix}messages SET attachmentFilename=NULL,attachmentSize=0,body='$row[body]' WHERE ID_MSG='$row[ID_MSG]'");
		unlink("$modSettings[attachmentUploadDir]/$row[attachmentFilename]");
	}
	ManageAttachments();
}

function RemoveAttachment()
{
	global $txt,$color,$cgi,$img,$imagesdir,$db_prefix,$modSettings,$realNames,$scripturl,$msg;

	$request = mysql_query("SELECT attachmentFilename,body,ID_MSG FROM {$db_prefix}messages WHERE ID_MSG='$msg'");
	$row = mysql_fetch_array($request);
	$row['body'].= "\n\n".mysql_escape_string($txt['yse216']);
	$request2 = mysql_query("UPDATE {$db_prefix}messages SET attachmentFilename=NULL,attachmentSize=0,body='$row[body]' WHERE ID_MSG='$msg'");
	unlink($modSettings['attachmentUploadDir'] . "/" . $row['attachmentFilename']);
	ManageAttachments();
}

function RemoveAllAttachments()
{
	global $txt,$color,$cgi,$img,$imagesdir,$db_prefix,$modSettings,$realNames,$scripturl;

	$request = mysql_query("SELECT attachmentFilename,body,ID_MSG FROM {$db_prefix}messages WHERE (attachmentSize>0 || attachmentFilename!=NULL)");
	while ($row = mysql_fetch_array($request))
	{
		$row['body'].= "\n\n".mysql_escape_string($notice);
		$request2 = mysql_query("UPDATE {$db_prefix}messages SET attachmentFilename=NULL,attachmentSize=0,body='$row[body]' WHERE ID_MSG='$row[ID_MSG]'");
		unlink($modSettings['attachmentUploadDir'] . "/" . $row['attachmentFilename']);
	}
	ManageAttachments();
}

?>
file|^|Sources/PackageGet.php|^|7578|^|1008718716
<?
/*****************************************************************************/
/* PackageGet.php                                                            */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

global $adminplver;
$adminplver="YaBB SE";

// verify the user is an administrator
is_admin();

function PackageGet()
{
   global $txt, $color, $scripturl, $yytitle;

	$yytitle = $txt['yse182'];
	template_header();
	print <<<EOT
<table border="0" cellpadding="0" cellspacing="6" align="center" width="100%">
  <tr>
    <td colspan=2 width="100%">
    <table border="0" cellpadding="5" cellspacing="1" align="center" bgcolor="$color[bordercolor]" class="bordercolor" width="100%">
      <tr>
        <td bgcolor="$color[titlebg]" class="titlebg" height="23" align="center" colspan="2">
        <font size="4" color="$color[titletext]">$txt[yse183]</font></td>
      </tr><tr>
        <td class="windowbg" bgcolor="$color[windowbg]" valign="middle" align="left" width="100%">
         <ul>
EOT;
   $servers = file("Packages/server.list");
   for($i=0 ; $i<count($servers) ; ++$i)
   {
     list($name, $url) = explode("|^|", $servers[$i]);
     echo "
       <li>$name
       <a href=\"$scripturl?action=pgbrowse;server=$i\">[ $txt[yse184] ]</a>
       <a href=\"$scripturl?action=pgremove;server=$i\">[ $txt[yse138] ]</a>
     ";
   }
   echo <<<EOT
 </td>
   </tr>
   </table></td></tr></table>
     <br><form action="$scripturl?action=pgadd" method="POST">
<table border="0" cellpadding="0" cellspacing="6" align="center" width="100%">
  <tr>
    <td colspan=2 width="100%">
    <table border="0" cellpadding="5" cellspacing="1" align="center" bgcolor="$color[bordercolor]" class="bordercolor" width="100%">
      <tr>
        <td bgcolor="$color[titlebg]" class="titlebg" height="23" align="center" colspan="2">
        <font size="4" color="$color[titletext]">$txt[yse185]</font></td>
      </tr><tr>
        <td class="windowbg" bgcolor="$color[windowbg]" valign="middle" align="left" width="100%">
            <b>$txt[yse186]:</b> <input type=text name="name" size=40 value="YaBB SE"><br>
            <b>$txt[yse187]:</b> <input type=text name="serverurl" size=50 value="http://"><br>
            <input type=submit value="Add">
         </td>
       </tr>
     </table>
     </td></tr></table>
     </form>
EOT;
  	footer();
	obExit();
}

function PackageServerAdd()
{
  global $name, $serverurl;

  $fp = fopen("Packages/server.list", "a");
  fputs($fp, "$name|^|$serverurl\n");
  fclose($fp);
  
  header("Location: $scripturl?action=packageget");
}

function PackageServerRemove()
{
  global $i;

  $servers = file("Packages/server.list");
  $fp = fopen("Packages/server.list", "w");
  for($i=0 ; $i<count($servers) ; ++$i)
    if($i != $server)
      fputs($fp, chop($servers[$i])."\n");

   header("Location: $scripturl?action=packageget");
}

function PackageBrowse()
{
  global $server, $yytitle, $txt;

  $servers = file("Packages/server.list");
  list($name, $url) = explode("|^|", $servers[$server]);
  $url = chop($url);
  $packages = array();
  $rf = fopen($url."/package.list", "r") or die("Could not connect to server");
  while(!feof($rf))
    $packages[] = fgets($rf, 4096);
  fclose($rf);

  if(count($packages)==0)
    die("An error occured, could not connect or packages.list does not exist");

  $yytitle = $txt['yse188'];
	template_header();
	print <<<EOT
<table border="0" cellpadding="0" cellspacing="6" align="center" width="100%">
  <tr>
    <td colspan=2 width="100%">
    <table border="0" cellpadding="5" cellspacing="1" align="center" bgcolor="$color[bordercolor]" class="bordercolor" width="100%">
      <tr>
        <td bgcolor="$color[titlebg]" class="titlebg" height="23" align="center" colspan="2">
        <font size="4" color="$color[titletext]">$txt[yse188]</font></td>
      </tr><tr>
        <td class="windowbg" bgcolor="$color[windowbg]" valign="middle" align="left" width="100%">
         <ol>
EOT;
  if(count($packages)==1 && !chop($packages[0]))
     echo "<li>$txt[yse189]";
  else
     for($i=0 ; $i<count($packages) ; ++$i)
     {
        list($name, $filename) = explode("|^|", $packages[$i]);
        echo "
          <li>$name
          <a href=\"$scripturl?action=pgdownload;server=$server;package=$filename\">[ $txt[yse190] ]</a>
        ";
      }
  echo <<<EOT
   </ol>
   <a href="$scripturl?action=packageget">[ $txt[193] ]</a>
   </td>
   </tr>
   </table></td></tr></table>
EOT;
  	footer();
	obExit();
}


function PackageDownload()
{
  global $server, $package, $yytitle, $txt;

  $servers = file("Packages/server.list");
  list($name, $url) = explode("|^|", $servers[$server]);
  $url = chop($url);
  $rf = fopen($url."/".$package, "rb") or die($txt['yse191']);
  $buffer = "";
  while(!feof($rf))
    $buffer .= fread($rf, 1024);
  fclose($rf);

  $fp = fopen("Packages/$package", "wb");
  fputs($fp, $buffer);
  fclose($fp);

  $yytitle = $txt['yse192'];
	template_header();
	print <<<EOT
<table border="0" cellpadding="0" cellspacing="6" align="center" width="100%">
  <tr>
    <td colspan=2 width="100%">
    <table border="0" cellpadding="5" cellspacing="1" align="center" bgcolor="$color[bordercolor]" class="bordercolor" width="100%">
      <tr>
        <td bgcolor="$color[titlebg]" class="titlebg" height="23" align="center" colspan="2">
        <font size="4" color="$color[titletext]">$txt[yse192]</font></td>
      </tr><tr>
        <td class="windowbg" bgcolor="$color[windowbg]" valign="middle" align="left" width="100%">
         $txt[yse193]<br><br>
      <a href="$scripturl?action=pgbrowse;server=$server">[ $txt[193] ]</a>
       </td>
   </tr>
   </table></td></tr></table>
EOT;
  	footer();
	obExit();
}
?>file|^|Sources/english.lng|^|49651|^|1008860217
<?php
###############################################################################
# English.lng                                                                 #
###############################################################################
# YaBB: Yet another Bulletin Board                                            #
# Open-Source Project started by Zef Hemel (zef@zefnet.com)                   #
# Software Version: YaBB 1 Gold - Release                                     #
# =========================================================================== #
# Software Distributed by:    http://yabb.xnull.com                           #
# Support, News, Updates at:  http://yabb.xnull.com/community/                #
# =========================================================================== #
# Copyright (c) 2000-2001 X-Null - All Rights Reserved                        #
# Software by: The YaBB Development Team                                      #
###############################################################################
$englishlngver="YaBB SE";

$txt[1] = "You are not allowed to access this section";
$txt[2] = "Admin";
$txt[3] = "Edit Categories (reorder/create/remove)";
$txt[4] = "Edit Boards (reorder/create/remove)";
$txt[5] = "View/Delete Members";
$txt[6] = "E-Mail Your Members";
$txt[7] = "Edit YaBB News";
$txt[8] = "Edit Member groups";
$txt[9] = "View all members";

$txt[10] = "Save";

$txt[11] = "YaBB Administrator";
$txt[12] = "Moderator";
$txt[13] = "YaBB Jr. Poster (over $JrPostNum posts)";
$txt[14] = "YaBB Full Poster (over $FullPostNum posts)";
$txt[15] = "YaBB Sr. Poster (over $SrPostNum posts)";
$txt[16] = "Additional member groups (one per line)";

$txt[17] = "Modify";
$txt[18] = "$mbname - Index";
$txt[19] = "Members";
$txt[20] = "Forum name";
$txt[21] = "Posts";
$txt[22] = "Last post";

$txt[23] = "Unable to open";
$txt[24] = "(No subject)";
$txt[25] = "Post reply";
$txt[26] = "Posts";
$txt[27] = "View Profile";
$txt[28] = "Guest";
$txt[29] = "Author";
$txt[30] = "on";
$txt[31] = "Remove";
$txt[32] = "Messages in this topic";
$txt[33] = "Start new topic";

$txt[34] = "Login";
$txt[35] = "Username";
$txt[36] = "Password";
$txt[37] = "You should fill in a username.";
$txt[38] = "Password field is empty";
$txt[39] = "Password incorrect";
$txt[40] = "Username does not exist.";

$txt[41] = "Manage Boards";
$txt[42] = "Action";
$txt[43] = "Order";
$txt[44] = "Full name";
$txt[45] = "Add board";
$txt[46] = "Reorder Boards";
$txt[47] = "Current boards";
$txt[48] = "Removing board";
$txt[49] = "Removing messages";
$txt[50] = "Removing topic";
$txt[51] = "Done.";
$txt[52] = "Manage Categories";
$txt[53] = "Current categories";
$txt[54] = "Change order";
$txt[55] = "Remove category";
$txt[56] = "Create new category";
$txt[57] = "Only access for membergroup(s)";
$txt[58] = "leave empty if none";
$txt[59] = "Create";
$txt[60] = "Removing category";
$txt[61] = "Removing category datafiles";
$txt[62] = "Board Moderator";
$txt[63] = "Remove Topic";
$txt[64] = "Topics:";
$txt[65] = "Next";
$txt[66] = "Modify message";
$txt[67] = "You are not allowed to change this message";
$txt[68] = "Name";
$txt[69] = "E-Mail";
$txt[70] = "Subject";
$txt[71] = "Message icon";
$txt[72] = "Message";
$txt[73] = "Only Moderators can use the direct remove function, please remove this message through the modify feature.";
$txt[74] = "This post has replies to it, you must first delete those...";

$txt[75] = "The Name field was not filled out. It is required.";
$txt[76] = "The E-Mail field was not filled out. It is required.";
$txt[77] = "The Subject field was not filled out. It is required.";
$txt[78] = "The Message Body was not filled out. It is required.";

$txt[79] = "Edit Profile";
$txt[80] = "You are not allowed to change this person's profile.";

$txt[81] = "Choose password";
$txt[82] = "Verify password";
$txt[83] = "Website title";
$txt[84] = "Website URL";
$txt[85] = "Signature";
$txt[86] = "Posts";
$txt[87] = "Position";
$txt[88] = "Change profile";
$txt[89] = "Delete user";

$txt[90] = "This topic is locked, you are not allow to post or modify messages...";
$txt[91] = "Password field empty";
$txt[92] = "View profile of";
$txt[93] = "You are not to lock or unlock this topic; you must be a moderator or administrator to do that...";
$txt[94] = "Total";
$txt[95] = "Posts:";
$txt[96] = "Website";
$txt[97] = "Register";
$txt[98] = "Choose username";
$txt[99] = "Username may only contain numbers and letters (example: yabber69)";
$txt[100] = "The username you tried to register already exists.";

$txt[101] = "Message Index";
$txt[102] = "News";
$txt[103] = "Home";

$txt[104] = "Lock/Unlock Topic";
$txt[105] = "Post";
$txt[106] = "An Error Has Occurred!";
$txt[107] = "at";
$txt[108] = "Logout";
$txt[109] = "Started by";
$txt[110] = "Replies";
$txt[111] = "Last post";
$txt[112] = "Keep current";
$txt[113] = "This member is:";
$txt[114] = "Administration Login";
$days = array('Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday');
$months = array('January','February','March','April','May','June','July','August','September','October','November','December');
$txt[116] = "Post+reply"; # There should be a + instead of spaces
$txt[117] = "Quote this post";
$txt[118] = "Topic";
$txt[119] = "Help";
$txt[120] = "Remove topic older than number of days:";
$txt[121] = "Remove message";
$txt[122] = "days old";
$txt[123] = "REMOVED";
$txt[124] = "Remove posts older than";
$txt[125] = "Notify";
$txt[126] = "Do you want a notification e-mail if someone replies to this topic?";
$txt[127] = "Topic reply";
$txt[128] = "A reply";
$txt[129] = "has been posted to a topic you are watching.\n\nView it at";
$txt[130] = "Regards,\nThe $mbname team.";
$txt[131] = "Notify of replies";
$txt[132] = "Move Topic";
$txt[133] = "Move to";
$txt[134] = "You are not allowed to move topics...";
$txt[135] = "Set censored words";
$txt[136] = "One word per line in the form: fuck=f**ck";
$txt[137] = "Admin functions";
$txt[138] = "This service is only for members...";
$txt[139] = "Pages";
$txt[140] = "Users active in past 15 minutes";
$txt[141] = "Guests";
$txt[142] = "Users";
$txt[143] = "IM Messages Index";
$txt[144] = "Instant Message";
$txt[145] = "Reply with quote";
$txt[146] = "Reply";
$txt[147] = "Instant Messaging is only for members";
$txt[148] = "Send message";
$txt[149] = "The user you tried to send a message to does not exist...";
$txt[150] = "To username";

$txt[151] = "No messages...";
$txt[152] = "you have";
$txt[153] = "messages";
$txt[154] = "Remove this message";

$txt[155] = "Maintenance Mode";
$txt[156] = "Our Board is currently in maintenance-mode";
$txt[157] = "Our Forums are currently in maintenance-mode. Please try again later. Thank you.";
$mtxt[1] = "Subject for display:";
$mtxt[2] = "Message for display:";
$mtxt[3] = "This board is in Maintenance Mode.";
$mtxt[4] = "Under Construction.";
$mtxt[5] = "Our board is currently in Maintenance Mode. Please call back later.";

$txt[158] = "Users online";
$txt[159] = "Private Message";
$txt[160] = "Jump to";
$txt[161] = "go";
$txt[162] = "Are you sure you want to remove this topic?";
$txt[163] = "Yes";
$txt[164] = "No";
$txt[165] = "To post you must be logged in if you don't have an account yet register.";

$txt[166] = "Search Results";
$txt[167] = "End of results";
$txt[168] = "Search Again";
$txt[169] = "Display Next Page";
$txt[170] = "Sorry, no matches were found";
$txt[171] = "Displaying Results";
$txt[172] = "to";
$txt[173] = "Search Completed for Topics started by";
$txt[174] = "matches were found";
$txt[175] = "Started by";
$txt[176] = "on";
$txt[177] = "Search Completed for posts posted in by";
$txt[178] = "Topic Title";
$txt[179] = "Message Snippet";
$txt[180] = "Searching for messages containing";
$txt[181] = "Word found";
$txt[182] = "Search";
$txt[183] = "Set Search Parameters";
$txt[184] = "Please choose <b>one</b> of the following";
$txt[185] = "Refine Parameters";
$txt[186] = "Search for topics started by someone";
$txt[187] = "Search for topics posted in by someone";
$txt[188] = "Search by Forum";
$txt[189] = "Choose a forum to search in, or search all";
$txt[190] = "All";
$txt[191] = "Display how many results?";

$txt[192] = "Email successfully sent";
$txt[193] = "Back";
$txt[194] = "reminder";
$txt[195] = "Message started by";
$txt[196] = "Title";
$txt[197] = "Post by";
$txt[198] = "End of Posts";
$txt[199] = "Post not found";
$txt[200] = "List of registered Members and Top $TopAmmount Posters.";
$txt[201] = "Please welcome";
$txt[202] = "Clean active log";
$txt[203] = "Are you sure you want to clean the active log?";
$txt[204] = "Your version of YaBB is";
$txt[205] = "The current version of YaBB is";
$txt[206] = "Ban Members";
$txt[207] = "Set Reserved Names";
$txt[208] = "YaBB Admin Center";
$txt[209] = "I love YaBB SE!";
$txt[210] = "ATTENTION! Your message couldn't be saved. Please try again.<br><br>Your Message:<br><br>";
$txt[211] = "Last Edit";
$txt[212] = "Would you like to deactivate Notification on this topic?";
$txt[213] = "Passwords aren't the same.";

$txt[214] = "Recent Posts";

$txt[215] = "browser not compatible with these buttons";
$txt[216] = "Edit Your Forum Template";
$txt[217] = "Layout/Board Settings";
$txt[218] = "Boards/Categories";
$txt[219] = "Members/Mailing";
$txt[220] = "Variable";
$txt[221] = "Messages/Actives";
$txt[222] = "Forum Preferences and Settings";
$txt[223] = "Sorry, you must register before using this feature.";

$txt[224] = "The username field does not accept / in the query string";
$txt[225] = "The username field does not accept \\ in the query string";
$txt[226] = "Optional Components";
$txt[227] = "Location";
$txt[228] = "Personal Text";
$txt[229] = "Personalized Picture";
$txt[230] = "Can't open directory";
$txt[231] = "Gender";
$txt[232] = "Picture/Text";
$txt[233] = "Date Registered";

$txt[234] = "View the 10 most recent posts on the board.";
$txt[235] = "is the most recently updated topic";
$txt[236] = "Return";
$txt[237] = "to the board index.";

$txt[238] = "Male";
$txt[239] = "Female";

$txt[240] = "Invalid character used in Username.";
$txt[241] = "Invalid character used in Password.";
$txt[242] = "Invalid character used in Name.";
$txt[243] = "Invalid character used in eMail.";

$txt[244] = "The username you tried to register contains a reserved name. Please try another username. Reserved name: ";
$txt[245] = "Registration successful";

$txt[246] = "About to remove topic";

$txt[247] = "Hey,";
$txt[248] = "Welcome,";
$txt[249] = "Please";
$txt[250] = "Back";
$txt[251] = "Please select a destination";

$txt[252] = "Add YABBC tags";
$txt[253] = "Bold";
$txt[254] = "Italicized";
$txt[255] = "Underline";
$txt[256] = "Centered";
$txt[257] = "Insert Hyperlink";
$txt[258] = "Insert Email";
$txt[259] = "Insert Code";
$txt[260] = "Insert Quote";
$txt[261] = "Insert List";

$txt[262] = "Black";
$txt[263] = "Red";
$txt[264] = "Yellow";
$txt[265] = "Pink";
$txt[266] = "Green";
$txt[267] = "Orange";
$txt[268] = "Purple";
$txt[269] = "Blue";
$txt[270] = "Beige";
$txt[271] = "Brown";
$txt[272] = "Teal";
$txt[273] = "Navy";
$txt[274] = "Maroon";
$txt[275] = "Lime Green";

$txt[276] = "Disable Smilies";
$txt[277] = "Check this if you'll be adding code (or don't like smilies).";
$txt[278] = "Reset Form";
$txt[279] = "Posted by";
$txt[280] = "Posted on";

$txt[281] = "Standard";
$txt[282] = "Thumb Up";
$txt[283] = "Thumb Down";
$txt[284] = "Exclamation point";
$txt[285] = "Question mark";
$txt[286] = "Lamp";
$txt[287] = "Smiley";
$txt[288] = "Angry";
$txt[289] = "Cheesy";
$txt[290] = "Laugh";
$txt[291] = "Sad";
$txt[292] = "Wink";
$txt[293] = "Grin";
$txt[294] = "Shocked";
$txt[295] = "Cool";
$txt[296] = "Huh";
$txt[297] = "Add Smilies";

$txt[298] = "Moderator";
$txt[299] = "Moderators";

$txt[300] = "Mark Topics as Read for this Board";
$txt[301] = "Views";
$txt[302] = "New";

$txt[303] = "View All Users";
$txt[304] = "View By Letter";
$txt[305] = "View";
$txt[306] = "Posters";
$txt[307] = "Email";

$txt[308] = "Viewing Members";
$txt[309] = "of";
$txt[310] = "total members";
$txt[311] = "to";
$txt[312] = "Viewing Members By Letter";
$txt[313] = "Viewing The";
$txt[314] = "Top Posters";
$txt[315] = "Forgot password?";

$txt[316] = "Inbox";
$txt[317] = "Date";
$txt[318] = "From";
$txt[319] = "Subject";
$txt[320] = "Outbox";
$txt[321] = "New Message";
$txt[322] = "Receive New Messages";
$txt[323] = "Preferences";
$txt[324] = "To";
$txt[325] = "Ignorelist";
$txt[326] = "Add one Username on each line.<br>Or enter * to ignore all messages.";
$txt[327] = "Notify by email";
$txt[328] = "Save Preferences";
$txt[329] = "Reset Form";

$txt[330] = "Topics";
$txt[331] = "Members";
$txt[332] = "Members List";
$txt[333] = "New Posts";
$txt[334] = "No New Posts";

$txt[335] = "Enter your name";
$txt[336] = "Enter your email address";

$txt[337] = "This field only accepts numbers from 0-9";

$txt[338] = "Send an email to the above email list";
$txt[339] = "Send";
$txt[340] = "Edit Ban List";
$txt[341] = "Set Reserved Names";
$txt[342] = "One word per line.";
$txt[343] = "Match all words";
$txt[344] = "Match any words";
$txt[345] = "Match as phrase";
$txt[346] = "Search -All- Members only";

$txt[347] = "This pages allows you to change every setting for your YaBB forum.  Be very careful with these settings, as they may render your YaBB dysfunctional.  Also note that some of these options are default options for guests only (such as time format).";
$txt[348] = "Maintenance Mode?";
$txt[349] = "Language Pack You Wish to Use";
$txt[350] = "Message Board Name";
$txt[351] = "Board URL";
$txt[352] = "Cookie Name - Username";
$txt[353] = "Cookie Name - Password";
$txt[354] = "Location of Sendmail Program";
$txt[355] = "Webmaster Email Address";
$txt[356] = "YaBB Directory";
$txt[357] = "Data Directory";
$txt[358] = "Members Directory";
$txt[359] = "Boards Directory";
$txt[360] = "Sources Directory";
$txt[361] = "Variables Directory";
$txt[362] = "Avatars Directory";
$txt[363] = "Images URL";
$txt[364] = "Help File";
$txt[365] = "Title BG Color";
$txt[366] = "Title Text Color";
$txt[367] = "Window BG Color";
$txt[368] = "Window BG Color #2";
$txt[369] = "Category BG Color";
$txt[370] = "Table Border Color";
$txt[371] = "Time Offset";
$txt[372] = "Number of Top Posters for Members List";
$txt[373] = "Members Per Page in Member List-All";
$txt[374] = "Maximum Topics to Display in the Message Index";
$txt[375] = "Maximum Messages to Display in a Topic Page";
$txt[376] = "Remove entries from user logs after _ days";
$txt[377] = "or";
$txt[378] = "Enable Bulletin Board Code?";
$txt[379] = "Enable News?";
$txt[380] = "Enable Guest Posting?";
$txt[381] = "Allow Email Notification?";
$txt[382] = "Show Latest Member on Board Index?";
$txt[383] = "Show Modification Date on Modified Posts?";
$txt[384] = "Show User Pics in Message View?";
$txt[385] = "Show User Text in Message View?";
$txt[386] = "Show Gender Image in Message View?";
$txt[387] = "Show News Fader on Board Index?";
$txt[388] = "News Fader Title Color";
$txt[389] = "News Fader News Color";
$txt[390] = "URL to News Fader file (fader.js)";
$txt[391] = "Use File-Locking?";
$txt[392] = "Lock EX";
$txt[393] = "Lock UN";

$txt[394] = "Mailprogram error.";
$txt[395] = "Send email to";
$txt[396] = "to ask for password";

$txt[397] = "The search field does not accept / or \\ in the query string";
$txt[398] = "Sorry, no matches were found";

$txt[399] = "The board field does not accept / in the query string";
$txt[400] = "The board field does not accept \\ in the query string";

$txt[401] = "no File-Locking";
$txt[402] = "Unix/Linux File-Locking";
$txt[403] = "Windows File-Locking";

$txt[404] = "Send Mails using";
$txt[405] = "sendmail";
$txt[406] = "SMTP";

$txt[407] = "SMTP-Server";

$txt[408] = "Minimum time between two postings from the same IP";
$txt[409] = "The last posting from your IP was less than";
$txt[410] = "seconds ago. Please try again later.";

$txt[411] = "Top";

$txt[412] = "Delete all messages in your IMBOX";
$txt[413] = "Are you sure you want to delete all messages?";

$txt[414] = "There are no topics with Notification marked.";
$txt[415] = "You are notified on replies in the following topics";
$txt[416] = "Activate checkboxes to <b><i>deactivate</i></b> Notification on Topic.";
$txt[417] = "Update Notifications";
$txt[418] = "Notification";
$txt[419] = "Show all Topics with Notification";

$txt[420] = "Age";
$txt[421] = "Use the <b>01/01/01 at 01:01:01<\/b> date\/time format.";
$txt[422] = "(no pic)";
$txt[423] = "Avatars URL";
$txt[424] = "YaBB Admin Options";
$txt[425] = "Your Version/Current Version";
$txt[426] = "Member Controls";
$txt[427] = "Forum Controls";
$txt[428] = "Forum Configuration";
$txt[429] = "Detailed Version Check";
$txt[430] = ", you are banned from using this forum";
$txt[431] = "Success! You are now a member of the Forum.";
$txt[432] = "Default Length for login cookies to last (in minutes)";

$txt[433] = "Insert Flash";
$txt[434] = "Insert Ftp Link";
$txt[435] = "Insert Image";
$txt[436] = "Insert Table";
$txt[437] = "Insert Table Column";
$txt[438] = "There are no topics with Notification.";
$txt[439] = "Marquee";
$txt[440] = "Teletype";
$txt[441] = "Strikethrough";
$txt[442] = "Glow";
$txt[443] = "Shadow";
$txt[444] = "Preformatted Text";
$txt[445] = "Left Align";
$txt[446] = "Right Align";
$txt[447] = "Superscript";
$txt[448] = "Subscript";
$txt[449] = "Insert Table Row";

$txt[450] = "Roll Eyes";
$txt[451] = "Tongue";

$txt[452] = "Mark ALL messages as read";

$txt[453] = "The user whose profile you are trying to view does not exist.";

$txt[454] = "Hot Topic (More than 15 Replies)";
$txt[455] = "Very Hot Topic (More than 25 Replies)";
$txt[456] = "Locked Topic";
$txt[457] = "Normal Topic";

$txt[458] = "Latest posts of: ";
$txt[459] = "Additional Information";
$txt[460] = "Show the last";
$txt[461] = "posts of this person";
$txt[462] = "GO";

$txt[463] = "All times are CST.  All dates are in MM-DD-YY format.";
$txt[464] = "Start+new+thread"; # + instead of spaces.
$txt[465] = "Print";
$txt[466] = "Message";
$txt[467] = "Profile";
$txt[468] = "Topic Summary";
$txt[469] = "Message";
$txt[470] = "N/A";
$txt[471] = "message";
$txt[472] = "This topic doesn't exist on this board.";

$txt[473] = "This name is already in use by another member.";

$txt[474] = "Select one or specify a web path (ex: <b>http://www.mypage.com/mypic.gif</b>) to your own image.";
$txt[475] = "I have my own pic:";
$txt[476] = "Userpic Width (0 = disable limit)";
$txt[477] = "Userpic Height (0 = disable limit)";
$txt[478] = "Text To Describe The Limits";

$txt[479] = "This selection will make dates throughout this Forum display in this format.";
$txt[480] = "01/31/01 $txt[107] 13:15:17";
$txt[481] = "31.01.01 $txt[107] 13:15:17";
$txt[482] = "31.01.2001 $txt[107] 13:15:17";
$txt[483] = "January 12th, 2001, 1:15pm";
$txt[484] = "01/31/01 $txt[107] 1:15pm";
$txt[485] = "31. January $txt[107] 13:15";
$txt[486] = "Time Format";
$txt[487] = "Time Offset must be between -23.5 and 23.5.";

$txt[488] = "Total Members:";
$txt[489] = "Total Posts:";
$txt[490] = "Total Topics:";
$txt[491] = "P.S. Your username is";
$txt[492] = "and your password is";
$txt[493] = "YaBB Current Version";
$txt[494] = "Users Version";
$txt[495] = "YaBB File";
$txt[496] = "YaBB Package";

$txt[497] = "Session Length in Minutes";
$txt[498] = "Maximum Allowed Characters in Posts";
$txt[499] = "Your message is too long. Please go back and shorten it, then resubmit.";

$txt[500] = "Please enter a valid email address.";

$txt[501] = "Maintenance Controls";
$txt[502] = "Recount All Board Totals";
$txt[503] = "All Board Totals have been recounted.";
$txt[504] = "Recount Membership";
$txt[505] = "Membership Total has been recounted.";
$txt[506] = "URL to YBBC JavaScript file (ubbc.js)";
$txt[507] = "Preview";
$txt[508] = "Always stay logged in";

$txt[509] = "Show Recent Posts Bar on Board Index?";
$txt[510] = "Show Members List Bar on Board Index?";

$txt[511] = "Logged";
$txt[512] = "IP";

$txt[513] = "ICQ";
$txt[514] = "Pager";
$txt[515] = "WWW";

$txt[517] = "Required Information";
$txt[518] = "This is the displayed name that people will see.";
$txt[519] = "Number hours to +/- to make displayed time in your local time.";
$txt[520] = "Used only for identification by YaBB. You can use special characters after logging in, by changing your displayed name in your profile.";

$txt[521] = "Use text menu instead of images?";
$txt[522] = "Show current position in forum as link instead of text?";
$txt[523] = "Show view profile button under post?";
$txt[524] = "Auto-link URLs?";

$txt[525] = "by";

$txt[526] = "embarrassed";
$txt[527] = "lips sealed";
$txt[528] = "undecided";
$txt[529] = "kiss";
$txt[530] = "cry";
$txt[531] = "Horizontal Rule";
$txt[532] = "Font Size";
$txt[533] = "Font Face";

$txt[535] = "Recipient";

$txt[560] = "You are not allowed to send IM to this user.";
$txt[561] = "New $mbname-Message: (SUBJECT)";
$txt[562] = "(DATE) SENDER has sent you the following Instant Message:\n\n->*<-\n\nMESSAGE\n\n->*<-";

$txt[563] = "Birthdate";
$txt[564] = "Month (MM)";
$txt[565] = "Day (DD)";
$txt[566] = "Year (YYYY)";
$txt[567] = "Invalid input in one or more of the Birthdate fields.";
$txt[568] = "Please shorten your name. It is too long ;)";

$txt[569] = "YaBB Newbie";
$txt[570] = "YaBB God (over $GodPostNum posts)";

$txt[571] = "Credits";

$txt[572] = "Search -All- Guests only";
$txt[573] = "Fields to Search";
$txt[574] = "Age since last post";
$txt[575] = "Min";
$txt[576] = "Max";
$txt[577] = "Any poster";
$txt[578] = "hours";
$txt[579] = "days";

$txt[580] = "BAD post num";
$txt[581] = ", our newest member.";

$txt[582] = "Search for";
$txt[583] = "by user";

$txt[584] = "Show and require agreement letter when registering?";
$txt[585] = "I Agree";
$txt[586] = "I Do Not Agree";

$txt[587] = "Default Time Format";
$txt[588] = "# Posts to become \"Junior Member\"";
$txt[589] = "# Posts to become \"Full Member\"";
$txt[590] = "# Posts to become \"Senior Member\"";
$txt[591] = "# Posts to become \"God Member\"";

$txt[592] = "There are invalid Characters in your personal userpic url or picture name.";

$txt[593] = "Rebuild the members list";
$txt[594] = "The membership list (memberlist.txt) has been rebuilt.";
$txt[595] = "Note: this will sort the list and the newest member will be the last entry after sorting.";

$txt[596] = "We suggest that you use 6 or more characters with a combination of letters and numbers.";
$txt[597] = "Additional Information";
$txt[598] = "This must be included if you specify a URL below.";
$txt[599] = "This must be a complete URL.";
$txt[600] = "This is your ICQ number.";
$txt[601] = "This is your AOL Instant Messenger nickname.";
$txt[602] = "This is your Yahoo! Instant Messenger nickname.";
$txt[603] = "AIM";
$txt[604] = "YIM";
$txt[605] = "Preferences";
$txt[606] = "Signatures are displayed at the bottom of each post or instant message. YaBBC code may be be used in your signature.";

$txt[607] = "Lock SH";
$txt[608] = "Delete Selected Members";
$txt[609] = "For purposes of security, YaBB asks that you please always use absolute paths. The '../' (parent directory) symbol is illegal. Please change your Settings.pl to use absolute paths instead of the '../' symbol.";
$txt[610] = "Repair All Boards and Topics";
$txt[611] = "YaBB must be in maintenance mode before you can use this feature.";
$txt[612] = "Repairing All Boards";
$txt[613] = "Processing Category";
$txt[614] = "Repairing Board";
$txt[615] = "Use Temporary Files When Appropriate";

$txt[616] = "Remember, this forum is in 'Maintenance Mode'.";


$txt[617] = "Are you sure you want to remove this board?";
$txt[618] = "Enable and Show 'Mark as Read' Buttons?";
$txt[619] = "Send welcome email to users when you do not have mail password turned on?";

$txt[630] = "Use 'Fake' File Truncation. This option should only be enabled if your server gives the error: 'truncate() not supported on this platform.'";
$txt[631] = "Please make sure you have 'fake truncation' turned on in your Settings.pl file.<br>\$faketruncation = 1;<br>Could not truncate file";

$txt[632] = "Disallow guests from doing anything but login or register?";
$txt[633] = "Warning!";
$txt[634] = "Only registered members are allowed to access this forum.";
$txt[635] = "Please login below or click";
$txt[636] = "-here-";
$txt[637] = "to register an account with $mbname.";

$txt[638] = "You've changed your email address. You will receive a new password by email.";
$txt[639] = "Email new password if a user changes his/her email address?";

$txt[640] = "Window BG Color #3";

$txt[641] = "Read";
$txt[642] = "times";

$txt[643] = "click to reorder the boards in this category";
$txt[644] = "This is your '$txt[208]'. You can modify your settings and template from here, as well as maintain your forum.<BR><BR>Please read the manual before you contact any form of support, and please be careful with these functions. You may also find answers to your problems on the <a href=\"http://yabb.xnull.com/community/\" target=\"_blank\">support forum</a> or the troubleshooting section of your manual.<br>You can also click the <img src=\"$imagesdir/helptopics.gif\" border=\"0\" alt=\"$txt[119]\"> symbol to find out how to use some functions.";
$txt[645] = "YaBB SE Stats";
$txt[656] = "Latest Member:";
$txt[657] = "Miscellaneous";
$txt[658] = "Total Categories:";
$txt[659] = "Latest Post:";

$txt[660] = "You've got";
$txt[661] = "Click";
$txt[662] = "here";
$txt[663] = "to view them.";

$txt[664] = "Max $MaxSigLen; characters remaining: ";

$txt[665] = "Total Boards:";
$txt[666] = "Check this box if you experience errors on an MS IIS server";
$txt[667] = "Check this box if you experience blank pages after posting (usually on MS IIS servers)";

$txt[668] = "Print Page";
$txt[669] = "Password Reminder";

$txt[670] = "Please place one news item per line. Some YaBBC tags, such as [b], [i] and [u] are allowed in your news, as well as smilies.";
$txt[671] = "This ID is used internally by YaBB.";
$txt[672] = "This is the name that will be displayed.";
$txt[673] = "List the membergroups you wish to give access to this category (it *is* case-sensitive). List multiple groups like this: group1,group2";
$txt[674] = "A board with the id";
$txt[675] = "already exists.";
$txt[676] = "A category with the id";
$txt[677] = "Edit your boards here. List multiple moderators as 'mod1s_username,mod2s_username' (these must be usernames and it *is* case-sensitive). Click the link on the category name and you can reorder the listing of the boards you see in that category. The board id is used internally by YaBB and to determine where posts are (see the url when viewing a board for an example).";

$txt[678] = "Sorry";

$txt[679] = "This must be a valid email address.";
$txt[680] = "The Administrator with username of 'admin' cannot be set to a different membergroup.";

$txt[681] = "Please inform the administrator of this forum to fix the \$facesdir setting immediately.";
$txt[682] = "This is your template for your YaBB forum.  You can change anything you like here, using HTML, and your Forum will automatically look different after you save the template.";

$txt[683] = "a whole lot";
$txt[684] = "Forum Administrators";
$txt[685] = "$mbname - Info Center";

$txt[686] = "online";
$txt[687] = "offline";
$txt[688] = "Send this member a private message";

$txt[689] = "Maximum allowed characters in signatures";
$txt[690] = "Time in minutes to log each click in your forum";

$txt[691] = "Total Clicks";
$txt[692] = "in the last $ClickLogTime minutes";
$txt[693] = "View forum access log";
$txt[694] = "IP Access";
$txt[695] = "Browsers";
$txt[696] = "Operating System";
$txt[697] = "This is a simple system that analyzes the log YaBB creates with each click someone makes in your forum. Use this as a rough estimate of the traffic, browser and operating system of $mbname visitors. The numbers in parenthesis beside each item is the number of occurrences of that item in your log.<P>You currently have logging set for $ClickLogTime minutes.";

$txt[698] = "This is your profile. You can choose which information to fill out, other than the required section. This information will be displayed in various places throughout $mbname.";

$txt[699] = "Reserved names will keep members from registering certain usernames or using these words in their displayed names. Choose the options you wish to use from the bottom before submitting.";

$txt[700] = "Welcome to";
$txt[701] = "You may change it after you log in by going to the profile page, or by visiting this page after you log in:";
$txt[702] = "Email Random Password to New Member Upon Registration?";
$txt[703] = "Thank you for registration. You will receive an email soon with your password. You may change the password after you login for the first time.";

##### do not translate these 3 lines except the words 'on', 'wrote', and 'code sample'
$txt[704] = '<BR><i>on DATE, <a href="QUOTELINK">AUTHOR wrote</a>:</i><table bgcolor="$color[bordercolor]" class="bordercolor" cellspacing="1" width="90%"><tr><td width="100%"><table cellpadding="2" cellspacing="0" class="quote" width="100%"><tr><td width="100%"><font face="Arial,Helvetica" class="quote" size="1">QUOTE</font></td></tr></table></td></tr></table>';
$txt[705] = '<BR><i>Quote:</i><table bgcolor="$color[bordercolor]" class="bordercolor" cellspacing="1" width="90%"><tr><td width="100%"><table cellpadding="2" cellspacing="0" class="quote" width="100%"><tr><td width="100%"><font face="Arial,Helvetica" class="quote" size="1">QUOTE</font></td></tr></table></td></tr></table>';
$txt[706] = '<BR><B>Code:</B><br><table bgcolor="$color[bordercolor]" class="bordercolor" cellspacing="1"><tr><td><table cellpadding="2" cellspacing="0" class="code"><tr><td><font face="Courier New" class="code" size="1">CODE</font></td></tr></table></td></tr></table>';
#####

$txt[707] = "Send the topic";
$txt[708] = "to a friend.";
$txt[709] = "The board is missing from the query.";
$txt[710] = "The topic is missing from the query.";
$txt[711] = "Dear";
$txt[712] = "I want you to check out the following topic";
$txt[713] = "To view it, please click the link below";
$txt[714] = "Thanks";
$txt[715] = "Your name";
$txt[716] = "Your email address";
$txt[717] = "Recipient's name";
$txt[718] = "Recipient's email address";

$txt[719] = "Your username is: ";

$txt[721] = "Hide E-Mail from public?";
$txt[722] = "hidden";
$txt[723] = "Allow users to hide their email from public (except admin)?";

$txt[724] = "IP banning: (e.g. 192.168.12.213 or 128.0.*.*) - one entry per line";
$txt[725] = "Email banning: (e.g. badguy@somewhere.com) - one entry per line";
$txt[7252] = "User name banning: (e.g. l33tuser) - one entry per line";

$txt[726] = "Match whole name only. If unchecked, will search for reserved words within name.";
$txt[727] = "Match case. If unchecked, search will be case insensitive.";
$txt[728] = "Check username.";
$txt[729] = "Check display name.";

$txt[730] = "That email address";
$txt[731] = "is being used by a registered member already. If you feel this is a mistake, go to the login page and use the password reminder with that address.";

$txt[732] = "Show Board Descriptions in the Message Index?";

$txt[733] = "Your password has been changed. It is now";
$txt[734] = "and your username is";
$txt[735] = "You can email anyone from this page. Your entire $mbname mailing list should appear below, but you may remove or add any email addresses you wish. Be sure that each address is separated in this fashion: 'address1; address2'.";

$txt[736] = "Are you sure you want to remove this category?";
$txt[737] = "Check all";
$txt[738] = "Below is a list of the category id's that you have. You may move them around (one per line) then submit to reorder them in that order. If you accidentally delete an id completely, you may type it back in and resubmit, and the category will reappear.";

$txt[739] = "Time in seconds to display each item in the news fader";
$txt[740] = "Show YaBBC Buttons on Posting and IM send Pages?";

$txt[741] = "Current forum time";

$txt[742] = "Total Clicks";
$txt[743] = "Total Unique Visitors";
$txt[744] = "Total Browsers";
$txt[745] = "Total Operating Systems";

$txt[746] = "Enable Members to Select Profile Avatars?";

$txt[747] = "could not be messaged. The usernames are either invalid, or they have you on their ignore list.";
$txt[748] = "(multiple recipients as 'username1, username2')";

$txt[749] = "The 'number of posts' box can only contain digits.";

$txt['yse1'] = "Failed to make backup of Settings.php";
$txt['yse2'] = "Installed 'Mods' Settings and Options";
$txt['yse3'] = "This page allows you to change the settings of mods installed in your forum.";
$txt['yse4'] = "Enable Sticky Topics";
$txt['yse5'] = "Server on which the database resides";
$txt['yse6'] = "Database Username";
$txt['yse7'] = "Database Password";
$txt['yse8'] = "Database Name";
$txt['yse9'] = "Enable Today Mod";
$txt['yse10'] = "<b>Today</b> at ";
$txt['yse11'] = "Edit Registration Agreement";
$txt['yse12'] = "This agreement is only displayed if you have toggled require agreement in your Forum Preferences and Settings.";
$txt['yse13'] = "Lock after Post";
$txt['yse14'] = "Check this if you wish to be notified of replies to this topic.";
$txt['yse15'] = "Check this if you wish to lock this thread after this post.";
$txt['yse16'] = "shortcuts (IE and NS6 only): hit alt+s to submit/post, alt+p to preview, or alt+r to reset";
$txt['yse17'] = "Enable Previous/Next Topic Mod";
$txt['yse18'] = "Previous Topic Link";
$txt['yse19'] = "Next Topic Link";
$txt['yse20'] = "Post New Poll";
$txt['yse21'] = "Question";
$txt['yse22'] = "Option";
$txt['yse23'] = "Submit Vote";
$txt['yse24'] = "Total Votes";
$txt['yse25'] = "shortcuts (IE and NS6 only): hit alt+s to submit/post, or alt+r to reset";
$txt['yse26'] = "You didn't select a vote option.";
$txt['yse27'] = "Either that poll doesn't exist, the poll has been locked, or you tried to vote twice.";
$txt['yse28'] = "This option is only available to registered members.";
$txt['yse29'] = "View results.";
$txt['yse30'] = "Lock Voting";
$txt['yse30b'] = "Unlock Voting";
$txt['yse31'] = "This was locked by an administrator.  You cannot unlock it.";
$txt['yse32'] = "Enable Polls";
$txt['yse33'] = "Show Polls as Topics";
$txt['yse34'] = "Disable Polls";
$txt['yse35'] = "Poll Mod Mode";
$txt['yse36'] = "Poll Posting Restrictions";
$txt['yse37'] = "Adminsitrators Only";
$txt['yse38'] = "Any Registered Member";
$txt['yse39'] = "Edit Poll";
$txt['yse40'] = "Reset Vote Count";
$txt['yse41'] = "Check this if you want to reset all vote counts to 0.";
$txt['yse42'] = "votes";
$txt['yse43'] = "Poll";
$txt['yse44'] = "Poll Editing Restrictions";
$txt['yse45'] = "Administrators and Moderators";
$txt['yse46'] = "Administrators, Moderators and Poll Creator";
$txt['yse47'] = "1 Day";
$txt['yse48'] = "1 Week";
$txt['yse49'] = "1 Month";
$txt['yse50'] = "Forever";
$txt['yse51'] = "Enable VB Style Login";
$txt['yse52'] = "Login with username, password and session length";
$txt['yse53'] = "1 Hour";
$txt['yse54'] = "Database Tables Prefix";
$txt['yse55'] = "Select the membergroups to whom you want to grant access to this category.  Hold down the ctrl key to select multiple entries.  Click the $txt[17] button when you are done.";
$txt['yse56'] = "MOVED";
$txt['yse57'] = "Please enter a brief description as to<br>why this topic is being moved.";
$txt['yse58'] = "Enable Compressed Output";
$txt['yse59'] = "This option will compress output to lower bandwidth<br>consumption, but it requires zlib to be installed.";
$txt['yse60'] = "Sorry, you don't have enough posts to modify karma - you need at least ";
$txt['yse61'] = "Sorry, you are not permitted to modify your own karma.";
$txt['yse62'] = "Sorry, you can't repeat an action within the wait time.  You must wait ";
$txt['yse63'] = "Sorry, this feature is disabled.";
$txt['yse64'] = "Disable Karma|Enable Karma Total|Enable Karma Positive/Negative";
$txt['yse65'] = "Restrict Admins to wait time";
$txt['yse66'] = "Set wait time in hours";
$txt['yse67'] = "Set the min # of posts needed to modify karma";
$txt['yse68'] = "Allowed membergroups (blank for all)";
$txt['yse69'] = "Karma Label|Karma Smite Label|Karma Applaud Label";
$txt['yse70'] = "Karma Mode";
$txt['yse71'] = "Inactive members for at least";
$txt['yse72'] = "days";
$txt['yse73'] = "Listing of board errors";
$txt['yse74'] = "The following errors are fouling up your board (blank if none)";
$txt['yse75'] = "has a bad first message";
$txt['yse76'] = "has a bad last message";
$txt['yse78'] = "Fatal Error";
$txt['yse79'] = "'s Board ID is";
$txt['yse80'] = "It, and any messages inside, will be deleted.";
$txt['yse81'] = "does not have a matching board";
$txt['yse82'] = "Board";
$txt['yse83'] = "does not have a matching category";
$txt['yse84'] = "Category";
$txt['yse85'] = "Would you like to fix these errors?";
$txt['yse86'] = "Fixing board errors";
$txt['yse87'] = "Error updating";
$txt['yse88'] = "in";
$txt['yse89'] = "Error creating a";
$txt['yse90'] = "the number of topics in ";
$txt['yse91'] = "the number of posts in ";
$txt['yse92'] = "All errors fixed! You will want to check on any created categories, boards, or topics to decide what to do with them.";
$txt['yse93'] = "Disable recent posts";
$txt['yse94'] = "Enable single post";
$txt['yse95'] = "Enable multiple posts";
$txt['yse96'] = "Sticky Topic";
$txt['yse97'] = "Locked Sticky Topic";
$txt['yse98'] = "Locked Poll";
$txt['yse99'] = "View All Inactive Members";
$txt['yse100'] = "Username/Email";
$txt['yse101'] = "by User:";
$txt['yse102'] = "by Email:";
$txt['yse103'] = "Disable output caching";
$txt['yse104'] = "Checking this box will make your board more secure.";
$txt['yse105'] = "Enable inline links";
$txt['yse106'] = "Enabling this will cause your current location to be down in a single line, as opposed to in a tree-like manner.";

$txt['yse110'] = "Attachments Mode";
$txt['yse111'] = "Disable Attachments|Enable All Attachments|Disable New Attachments";
$txt['yse112'] = "Display Attachment as Picture in Post";
$txt['yse113'] = "Check Attachment Extension";
$txt['yse114'] = "Allowed Attachment Extensions";
$txt['yse115'] = "Attachments Upload Path";
$txt['yse116'] = "Attachments URL";
$txt['yse117'] = "Max Attachment Size (in kB)";
$txt['yse118'] = "Max Attachment Folder Space (in kB)";
$txt['yse119'] = "Attach";
$txt['yse120'] = "Allowed file types";
$txt['yse121'] = "Maximum attachment size allowed";
$txt['yse122'] = "Your file is too large. The maximum attachment size allowed is";
$txt['yse123'] = "You cannot upload that type of file. The only allowed extensions are";
$txt['yse124'] = "There was an error saving your attachment, please try again.";
$txt['yse125'] = "Sorry! That filename is already taken. Please rename the file and try again.";
$txt['yse126'] = "The upload folder is full. Please try a smaller file and contact the <a href=mailto:$webmaster_email>administrator</a>.";
$txt['yse127'] = "Allow guests to post attachments?";
$txt['yse128'] = "Restrict attachments to member groups";
$txt['yse129'] = "To delete your attachment, leave this blank.";
$txt['yse130'] = "Check here to delete your attachment.";
$txt['yse130b'] = "That is a restricted filename. Please try a different filename.";

// Package manager
$txt['yse131'] = "Package manager";
$txt['yse132'] = "These are the files currently in your packages folder";
$txt['yse133'] = "NOTE that the package manager is very beta and to backup your files before trying it's features";
$txt['yse134'] = "Apply Mod";
$txt['yse135'] = "Use avatars";
$txt['yse136'] = "Add language";
$txt['yse137'] = "List files";
$txt['yse138'] = "Remove";
$txt['yse139'] = "Create a new package";
$txt['yse140'] = "Download packages";
$txt['yse141'] = "Package creator";
$txt['yse142'] = "Create package";
$txt['yse143'] = "Directory to pack";
$txt['yse144'] = "relative to your YaBB root directory";
$txt['yse145'] = "Root directory";
$txt['yse146'] = "the root directory, normally can be empty";
$txt['yse147'] = "Filename of package";
$txt['yse148'] = "Go!";
$txt['yse149'] = "Packing";
$txt['yse150'] = "You can download this package now from here";
$txt['yse151'] = "Download";
$txt['yse152'] = <<<EOT
Before you proceed you must be very sure that you want to do this. These mods come with no
warranty, and <b>might</b> screw up your board. Before proceeding make sure that:
<ul>
   <li>The modification is compatible with the current version you're running
   <li>You have backed up your current YaBB sources
   <li>You have a recent database backup
   <li>You only apply mods from trusted sources
   </ul>
EOT;
$txt['yse153'] = "Apply mod";
$txt['yse154'] = "Proceed";
$txt['yse155'] = "Applying mod";
$txt['yse156'] = "Extracting archive";
$txt['yse157'] = "Modification file was extracted, now the modification file which came with it should be applied.";
$txt['yse158'] = "Test (recommended)";
$txt['yse159'] = "Apply";
$txt['yse160'] = "Modification file was extracted, but this modification also comes with a php script which should be executed before it will work";
$txt['yse161'] = "Run";
$txt['yse162'] = "Modification file was extracted, this modification also comes with a textfile with additional instructions/information, it's recommended that you read it.";
$txt['yse163'] = "Read";
$txt['yse164'] = "Modding was done successfully. Everything should work now.";
$txt['yse165'] = "Wrote ";
$txt['yse166'] = "backup is called ";
$txt['yse167'] = "We're going to look for:";
$txt['yse168'] = "String <b>found</b>, I will now add:";
$txt['yse169'] = "String <b>not found</b>, there's probably an error in your mod.";
$txt['yse170'] = "String <b>found</b>, I will now replace it with:";
$txt['yse171'] = "Modification would have completed if this weren't a test, so if there were no errors, the mod could be applied, hit the back button in your browser.";
$txt['yse172'] = "Modification file was applied, ";
$txt['yse173'] = "Script output:";
$txt['yse174'] = "Additional notes";
$txt['yse175'] = "Instruction/Additional notes file";
$txt['yse176'] = "Extracting avatars";
$txt['yse177'] = "The avatars have been extracted, you can now use them.";
$txt['yse178'] = "Extracting language pack";
$txt['yse179'] = "The language pack has been extracted, you can now use it (by setting it in your settings).";
$txt['yse180'] = "List files in package";
$txt['yse181'] = "Files in archive";
$txt['yse182'] = "Package Get";
$txt['yse183'] = "Package servers";
$txt['yse184'] = "Browse";
$txt['yse185'] = "Add server";
$txt['yse186'] = "Server name";
$txt['yse187'] = "URL";
$txt['yse188'] = "Browse packages";
$txt['yse189'] = "No packages yet";
$txt['yse190'] = "Download";
$txt['yse191'] = "Could not connect to server or could not find file";
$txt['yse192'] = "Package downloaded successfully";
$txt['yse193'] = "Package has been downloaded successfully";
$txt['yse194'] = "Archiving";
$txt['yse195'] = "Skipping ";
$txt['yse196'] = " because it's a newer version or a version of the same age";
$txt['yse197'] = "Wrote ";
$txt['yse198'] = "Package Manager";

$txt['yse199'] = "Your Instant Messages";
$txt['yse200'] = "Enable SP1 style statistics on board index";

// attachment admin stuff
$txt['yse201'] = "Attachment Manager";
$txt['yse202'] = "From here you can administer the attached files on your system. You can delete attachments by size and by date from your system. Statistics on attachments are also displayed below.";
$txt['yse203'] = "File Attachment Statistics";
$txt['yse204'] = "Total Attachments";
$txt['yse205'] = "Total Size of Attachment Directory";
$txt['yse206'] = "Total Space Available in Attachment Directory";
$txt['yse207'] = "File Attachment Options";
$txt['yse208'] = "Attachment Log";
$txt['yse209'] = "Remove attachments older than";
$txt['yse210'] = "Remove attachments larger than";
$txt['yse211'] = "KB";
$txt['yse212'] = "Your curent uploads";
$txt['yse213'] = "Attachment Name";
$txt['yse214'] = "File Size";
$txt['yse215'] = "No maximum directory size is currently set";
$txt['yse216'] = "[attachment deleted by admin]";

$txt['yse217'] = "Live from www.yabb.info...";

$yycopyright = "<font face=\"Verdana, Arial\" size=\"1\"> $mbname | Powered by <a href=\"http://www.yabb.info/index.php?affiliate=$mbname;l=$boardurl;v=$YaBBversion\" target=\"_blank\">YaBB SE</a><BR>\n&copy; 2001-2002, YaBB SE Dev Team. All Rights Reserved.</font>";

$img[im_config_small] = "<img src=\"$imagesdir/im_sm_prefs.gif\" alt=\"$txt[323]\" border=\"0\">";
$img[im_new_small] = "<img src=\"$imagesdir/im_sm_newmsg.gif\" alt=\"$txt[321]\" border=\"0\">";

if( $MenuType == 1 ) {
	$menusep = ' | ';
	$img[admin] = $txt[2];
	$img[delete] = $txt[31];
	$img[email] = $txt[69];
	$img[email_sm] = $txt[69];
	$img[help] = $txt[119];
	$img[home] = $txt[103];
	$img[im_config] = $txt[323];
	$img[im_delete] = $txt[412];
	$img[im_inbox] = $txt[316];
	$img[im_new] = $txt[321];
	$img[im_outbox] = $txt[320];
	$img[im_reload] = $txt[322];
	$img[im_remove] = $txt[154];
	$img[im_reply] = $txt[146];
	$img[im_website] = $txt[515];
	$img[lock] = $txt[104];
	$img[login] = $txt[34];
	$img[logout] = $txt[108];
	$img[markallread] = $txt[452];
	$img[markboardread] = $txt[300];
	$img[message] = $txt[144];
	$img[message_sm] = $txt[144];
	$img[modify] = $txt[17];
	$img[newthread] = $txt[33];
	$img[newpoll] = $txt[yse20];
	$img[notification] = $txt[418];
	$img[notify] = $txt[131];
	$img[notify_sm] = $txt[131]; 
	$img[printt] = $txt[465];
	$img[profile] = $txt[467];
	$img[register] = $txt[97];
	$img[removetopic] = $txt[63];
	$img[reply] = $txt[146];
	$img[replyquote] = $txt[145];
	$img[reply_sm] = $txt[146]; 
	$img[search] = $txt[182];
	$img[sendtopic] = $txt[707];
	$img[viewprofile] = $txt[27];
	$img[viewprofile_sm] = $txt[27];
	$img[website] = $txt[515];
	$img[website_sm] = $txt[515];
}
else {
	$menusep = ' ';
	$img[admin] = "<img src=\"$imagesdir/admin.gif\" alt=\"$txt[2]\" border=\"0\">";
	$img[delete] = "<img src=\"$imagesdir/delete.gif\" alt=\"$txt[121]\" border=\"0\">";
	$img[email] = "<img src=\"$imagesdir/email.gif\" alt=\"$txt[69]\" border=\"0\">";
	$img[email_sm] = "<img src=\"$imagesdir/email_sm.gif\" alt=\"$txt[69]\" border=\"0\">";
	$img[help] = "<img src=\"$imagesdir/help.gif\" alt=\"$txt[119]\" border=\"0\">";
	$img[home] = "<img src=\"$imagesdir/home.gif\" alt=\"$txt[103]\" border=\"0\">";
	$img[im_config] = "<img src=\"$imagesdir/im_config.gif\" alt=\"$txt[323]\" border=\"0\">";
	$img[im_delete] = "<img src=\"$imagesdir/im_delete.gif\" alt=\"$txt[412]\" border=\"0\">";
	$img[im_inbox] = "<img src=\"$imagesdir/im_inbox.gif\" alt=\"$txt[316]\" border=\"0\">";
	$img[im_new] = "<img src=\"$imagesdir/im_new.gif\" alt=\"$txt[321]\" border=\"0\">";
	$img[im_outbox] = "<img src=\"$imagesdir/im_outbox.gif\" alt=\"$txt[320]\" border=\"0\">";
	$img[im_remove] = "<img src=\"$imagesdir/delete.gif\" alt=\"$txt[154]\" border=\"0\">";
	$img[im_reload] = "<img src=\"$imagesdir/im_reload.gif\" alt=\"$txt[322]\" border=\"0\">";
	$img[im_reply] = "<img src=\"$imagesdir/im_reply.gif\" alt=\"$txt[146]\" border=\"0\">";
	$img[im_website] = "<img src=\"$imagesdir/im_www.gif\" alt=\"$txt[515]\" border=\"0\">";
	$img[lock] = "<img src=\"$imagesdir/lock.gif\" alt=\"$txt[104]\" border=\"0\">";
	$img[login] = "<img src=\"$imagesdir/login.gif\" alt=\"$txt[34]\" border=\"0\">";
	$img[logout] = "<img src=\"$imagesdir/logout.gif\" alt=\"$txt[108]\" border=\"0\">";
	$img[markallread] = "<img src=\"$imagesdir/markread.gif\" alt=\"$txt[452]\" border=\"0\">";
	$img[markboardread] = "<img src=\"$imagesdir/markread.gif\" alt=\"$txt[300]\" border=\"0\">";
	$img[message] = "<img src=\"$imagesdir/message.gif\" alt=\"$txt[144]\" border=\"0\">";
	$img[message_sm] = "<img src=\"$imagesdir/message_sm.gif\" alt=\"$txt[144]\" border=\"0\">";
	$img[modify] = "<img src=\"$imagesdir/modify.gif\" alt=\"$txt[66]\" border=\"0\">";
	$img[newthread] = "<img src=\"$imagesdir/new_thread.gif\" alt=\"$txt[33]\" border=\"0\">";
	$img[newpoll] = "<img src=\"$imagesdir/new_poll.gif\" alt=\"$txt[yse20]\" border=\"0\">";
	$img[notification] = "<img src=\"$imagesdir/notification.gif\" alt=\"$txt[419]\" border=\"0\">";
	$img[notify] = "<img src=\"$imagesdir/notify.gif\" alt=\"$txt[131]\" border=\"0\">";
	$img[notify_sm] = "<img src=\"$imagesdir/notify_sm.gif\" alt=\"$txt[131]\" border=\"0\">"; 
	$img[printt] = "<img src=\"$imagesdir/print.gif\" alt=\"$txt[465]\" border=\"0\">";
	$img[profile] = "<img src=\"$imagesdir/profile.gif\" alt=\"$txt[79]\" border=\"0\">";
	$img[register] = "<img src=\"$imagesdir/register.gif\" alt=\"$txt[97]\" border=\"0\">";
	$img[removetopic] = "<img src=\"$imagesdir/remove.gif\" alt=\"$txt[63]\" border=\"0\">";
	$img[reply] = "<img src=\"$imagesdir/reply.gif\" alt=\"$txt[146]\" border=\"0\">";
	$img[replyquote] = "<img src=\"$imagesdir/quote.gif\" alt=\"$txt[145]\" border=\"0\">";
	$img[reply_sm] = "<img src=\"$imagesdir/reply_sm.gif\" alt=\"$txt[146]\" border=\"0\">"; 
	$img[search] = "<img src=\"$imagesdir/search.gif\" alt=\"$txt[182]\" border=\"0\">";
	$img[sendtopic] = "<img src=\"$imagesdir/sendtopic.gif\" alt=\"$txt[707]\" border=\"0\">";
	$img[viewprofile] = "<img src=\"$imagesdir/profile.gif\" alt=\"$txt[27]\" border=\"0\">";
	$img[viewprofile_sm] = "<img src=\"$imagesdir/profile_sm.gif\" alt=\"$txt[27]\" border=\"0\">";
	$img[website] = "<img src=\"$imagesdir/www.gif\" alt=\"$txt[515]\" border=\"0\">";
	$img[website_sm] = "<img src=\"$imagesdir/www_sm.gif\" alt=\"$txt[515]\" border=\"0\">";
}

?>
dir|^|YaBBHelp
dir|^|YaBBImages
dir|^|YaBBImages/avatars
file|^|YaBBImages/avatars/Alyson_Hannigan.jpg|^|2706|^|1008003664
 JFIF ,,   C 			





	


 C


















































  A A"            	
    } !1AQa"q2#BR$3br	
%&'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz        	
   w !1AQaq"2B	#3Rbr
$4%&'()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz   ? c3^/<I?a%aw\^xrGswbHbI''S/{q~_SUl-<G!&gbBw?)$8^(jZ	i|p.%A{A?iX/oo$i
b`?uYkOO
8F#  /Fi__PysJyd$ aW	<or~Go~4kxu*OL1=?lhCudh.v_#5&nOh;6%9 n?*co/\1os;`CGsqIs[I-H|dZTz]i#\2FHS;Srj7W|	/Osii7KiV5h6aM>ZEU$)5O/ Ox[K>wkg&CX0Wx'I&~1n}x#DF^;!Jo|GXaW;9?v1xOo]KbS]  8zRrT7Ur^O4] >/!Io/[JXK5[lFqiHY~jtZj}--.#+H|'Jl|?xJTX|#8t	? n9> |=%T9")!|:8+Kv	$5/f (/)	y~KGc*B$xE&}vam8=	_~> x:/m7rw:B3`7M+_lM6`WrF$&!	3.ui7x{R&/H!Y\i1<#{6-`,I<[)Z9u:KSzHk~R% 0cWV$^H8]%_)$w0cV"(>`>.?Io0nXArw~|'R?"c#*$#> ;GoU~G;H-^=B^j{["zna%Z5edQ x\p vVi\c W,4j[GpL5,.,u@X63yu:Zm70q\/K5[$[>M6QSJcA^6xF^%*jo?W6~%Uc~(xt:vT8Rj4t>8q
2KjQS7ISW?(j RN~?	/<El6"SIH?7-gP [z6[r;x\}rj	iO53R*P~T!8=,qP^&KO0tr:3SZ^lr;]qdys0mcp	E\q^m a3O'c9^o4,p ~>?UMZ]]!H4W-,@=kafo{
,9$fg9<IUfYY} p_KV:0q+t+1`3r>c~:_oz[cR\)e4pa5z_38+C( ( ( ( (file|^|YaBBImages/avatars/andreacorr.jpg|^|1407|^|1008003665
 JFIF  ` `   C 	!"$"$ C  @ @"            	
    } !1AQa"q2#BR$3br	
%&'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz        	
   w !1AQaq"2B	#3Rbr
$4%&'()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz   ? )*,hp$x~#46N7S3[+=M}]A5Z,QCx>V 72OZ)URDl=Ach}\wz(Vr|Xix	/V|?[^OkY5%P0rO^NFi sx-H@l5Rx1.f?Q~uNRl(V=Xk;W<rk.x^f"f$'Oigs`MmG;QxpG5xC75*m [WP3^G3[ <Zp*85EnTF(_<xoQ]~$MLn+4{t&<;>=ZX<*G>S>mJCN6}jWTpFU<QaekKO<sIIxM%u*o{u-kydsR4O!?V^;jxqhu5B/hry,ULwPvlvgnO.'vkeU*qbnz8KC4m7Mx>[sj6j~L;m]G<U@\<,X\c4%L= sSfile|^|YaBBImages/avatars/arnold_schwarzenegger.jpg|^|7420|^|1008003666
 JFIF ,,  	&Photoshop 3.0 8BIM     ,    ,    8BIM        x8BIM             8BIM
       8BIM'     
        8BIM     H /ff  lff       /ff         2    Z         5    -        8BIM     p                8BIM          @  @    8BIM        8BIM          A   A     1  z   JFIF  H H   &File written by Adobe Photoshop 5.0 Adobe d     			
  A A"   ?          	
         	
 3 !1AQa"q2B#$Rb34rC%Scs5&DTdEt6UeuF'Vfv7GWgw 5 !1AQaq"2B#R3$brCScs4%&5DTdEU6teuFVfv'7GWgw   ? 0pp_\KI%S|zn5{Y1X*}dkT1j0^a1ck,>[ l r3p	s
MAF#Uw392kI$#GQ[vM2T{~XI ?9 WhHhCDTw<<@aW	7`mR}6xwnV8N;'eZk% bfXOf rJ#Zc3}/KA 'bz5 Wu%[v'M-Q' 0Ye>e@<0{kU mca&
m{Ku#@_[7`==Oda3<9c xOngu}G"t#}? :Ulf:ll@L{ 6}Tq;Y 	G3hqt!Og6D]jaa&j9#zbLb@>:I+C_*+ Du?>?q|bV#C ~%eqe#/c|CV2/. $ c`SC`{}= MI|9 k?r"wN9Nyhg~ 6P?c	kK_ Z8w+l,nZO,n joqsv}se^OGjt R xoFP OG6$+UY.)}N5pxYk@sc~*Q\2BI+Cv&* b1W0.<JYL&#_!FQ8F1)_ixk? IwX7`:PnScOGUk
=3! cdXm!;qs[jV}q~;XtIhsc7Z,%{Gol117u0k+p cl\Gcd]~-s8GYik#u#T qb#hGe yI[s_I%)$IJI$RI$I%?8BIM          XICC_PROFILE   HLino  mntrRGB XYZ   	  1  acspMSFT    IEC sRGB                   -HP                                                 cprt  P   3desc     lwtpt     bkpt     rXYZ     gXYZ  ,   bXYZ  @   dmnd  T   pdmdd     vued  L   view     $lumi     meas     $tech  0   rTRC  <  gTRC  <  bTRC  <  text    Copyright (c) 1998 Hewlett-Packard Company  desc       sRGB IEC61966-2.1           sRGB IEC61966-2.1                                                  XYZ       Q    XYZ                 XYZ       o  8  XYZ       b    XYZ       $    desc       IEC http://www.iec.ch           IEC http://www.iec.ch                                              desc       .IEC 61966-2.1 Default RGB colour space - sRGB           .IEC 61966-2.1 Default RGB colour space - sRGB                      desc       ,Reference Viewing Condition in IEC61966-2.1           ,Reference Viewing Condition in IEC61966-2.1                          view      _.    \   XYZ      L	V P   Wmeas                            sig     CRT curv           
     # ( - 2 7 ; @ E J O T Y ^ c h m r w |                         %+28>ELRY`gnu|&/8AKT]gqz !-8COZfr~ -;HUcq~+:IXgw'7HYj{+=Oat2FZn		%	:	O	d	y						

'
=
T
j





"9Qi*C\u&@Zt.Id	%A^z	&Ca~1Om&Ed#Cc'Ij4Vx&IlAe@e Ek*Qw;c*R{Gp@j>i  A l   !!H!u!!!"'"U"""#
#8#f###$$M$|$$%	%8%h%%%&'&W&&&''I'z''((?(q(())8)k))**5*h**++6+i++,,9,n,,--A-v--..L.../$/Z///050l0011J1112*2c2233F3334+4e4455M555676r667$7`7788P8899B999:6:t::;-;k;;<'<e<<="=a==> >`>>?!?a??@#@d@@A)AjAAB0BrBBC:C}CDDGDDEEUEEF"FgFFG5G{GHHKHHIIcIIJ7J}JKKSKKL*LrLMMJMMN%NnNO OIOOP'PqPQQPQQR1R|RSS_SSTBTTU(UuUVV\VVWDWWX/X}XYYiYZZVZZ[E[[\5\\]']x]^^l^__a_``W``aOaabIbbcCccd@dde=eef=ffg=ggh?hhiCiijHjjkOkklWlmm`mnnknooxop+ppq:qqrKrss]sttptu(uuv>vvwVwxxnxy*yyzFz{{c{|!||}A}~~b~#G
k0WGr;i3d0c1f6n?zM _4
uL$hBd@iG&vV8nR7u\D- u`K8%yhYJ;.!
zpg_XQKFA=:8655679<?DINU\dlv)6DScs2F[p(@Xr4Pm8Ww)Km &File written by Adobe Photoshop 5.0 Adobe d     			
  A A"   ?          	
         	
 3 !1AQa"q2B#$Rb34rC%Scs5&DTdEt6UeuF'Vfv7GWgw 5 !1AQaq"2B#R3$brCScs4%&5DTdEU6teuFVfv'7GWgw   ? 0pp_\KI%S|zn5{Y1X*}dkT1j0^a1ck,>[ l r3p	s
MAF#Uw392kI$#GQ[vM2T{~XI ?9 WhHhCDTw<<@aW	7`mR}6xwnV8N;'eZk% bfXOf rJ#Zc3}/KA 'bz5 Wu%[v'M-Q' 0Ye>e@<0{kU mca&
m{Ku#@_[7`==Oda3<9c xOngu}G"t#}? :Ulf:ll@L{ 6}Tq;Y 	G3hqt!Og6D]jaa&j9#zbLb@>:I+C_*+ Du?>?q|bV#C ~%eqe#/c|CV2/. $ c`SC`{}= MI|9 k?r"wN9Nyhg~ 6P?c	kK_ Z8w+l,nZO,n joqsv}se^OGjt R xoFP OG6$+UY.)}N5pxYk@sc~*Q\2BI+Cv&* b1W0.<JYL&#_!FQ8F1)_ixk? IwX7`:PnScOGUk
=3! cdXm!;qs[jV}q~;XtIhsc7Z,%{Gol117u0k+p cl\Gcd]~-s8GYik#u#T qb#hGe yI[s_I%)$IJI$RI$I%?file|^|YaBBImages/avatars/blank.gif|^|807|^|1008003666
GIF89a    )!    ,         ;file|^|YaBBImages/avatars/brad_pitt.jpg|^|7071|^|1008003667
 JFIF ,,  xPhotoshop 3.0 8BIM     ,    ,    8BIM        x8BIM             8BIM
       8BIM'     
        8BIM     H /ff  lff       /ff         2    Z         5    -        8BIM     p                8BIM          @  @    8BIM        8BIM          A   A     1     JFIF  H H   &File written by Adobe Photoshop 5.0 Adobe d     			
  A A"   ?          	
         	
 3 !1AQa"q2B#$Rb34rC%Scs5&DTdEt6UeuF'Vfv7GWgw 5 !1AQaq"2B#R3$brCScs4%&5DTdEU6teuFVfv'7GWgw   ? v2ML`x"mzH	v+iik]}t>vq%"Xp`=v:-4P\#qor]=G4!Wan?.?b`Tt "Scw7~v=_.1_Ukkv7zf{ikqo=0t,%msv=3cRSlG_"l5I'x4I$So}1 siigvn@Za&&`7_\Zl7~CKw$a~^b	 k\^rOqR\1^N_a",:knYlF^f-pq?s~INt<<f^5/w'?{c25P6Z{6[33>m{ 1ORSYg6n%wzqH; d}]hvCu % M%8)$J1Z Z6k&-Nu `#_gH3~\" +gmL= 1w]CK  RGvCUq/qkoYexZok w$onhrJy mKta [ke40Z\V8'f@%  Y=[;?-4hxIMJ]:4:S]\}hi {A,osG.0#@N O~vI$SY C>V9tvo*Fa6Mnkv?==cf=N-MAuXHoem%>v8sO(L-g|7R6};wig}SqfDP ~\mMJmv\=Mw?D_$_sm~]zch#hYnI| IL8<	p(JsI$ I%)$IJI$RI$I%? 8BIM          XICC_PROFILE   HLino  mntrRGB XYZ   	  1  acspMSFT    IEC sRGB                   -HP                                                 cprt  P   3desc     lwtpt     bkpt     rXYZ     gXYZ  ,   bXYZ  @   dmnd  T   pdmdd     vued  L   view     $lumi     meas     $tech  0   rTRC  <  gTRC  <  bTRC  <  text    Copyright (c) 1998 Hewlett-Packard Company  desc       sRGB IEC61966-2.1           sRGB IEC61966-2.1                                                  XYZ       Q    XYZ                 XYZ       o  8  XYZ       b    XYZ       $    desc       IEC http://www.iec.ch           IEC http://www.iec.ch                                              desc       .IEC 61966-2.1 Default RGB colour space - sRGB           .IEC 61966-2.1 Default RGB colour space - sRGB                      desc       ,Reference Viewing Condition in IEC61966-2.1           ,Reference Viewing Condition in IEC61966-2.1                          view      _.    \   XYZ      L	V P   Wmeas                            sig     CRT curv           
     # ( - 2 7 ; @ E J O T Y ^ c h m r w |                         %+28>ELRY`gnu|&/8AKT]gqz !-8COZfr~ -;HUcq~+:IXgw'7HYj{+=Oat2FZn		%	:	O	d	y						

'
=
T
j





"9Qi*C\u&@Zt.Id	%A^z	&Ca~1Om&Ed#Cc'Ij4Vx&IlAe@e Ek*Qw;c*R{Gp@j>i  A l   !!H!u!!!"'"U"""#
#8#f###$$M$|$$%	%8%h%%%&'&W&&&''I'z''((?(q(())8)k))**5*h**++6+i++,,9,n,,--A-v--..L.../$/Z///050l0011J1112*2c2233F3334+4e4455M555676r667$7`7788P8899B999:6:t::;-;k;;<'<e<<="=a==> >`>>?!?a??@#@d@@A)AjAAB0BrBBC:C}CDDGDDEEUEEF"FgFFG5G{GHHKHHIIcIIJ7J}JKKSKKL*LrLMMJMMN%NnNO OIOOP'PqPQQPQQR1R|RSS_SSTBTTU(UuUVV\VVWDWWX/X}XYYiYZZVZZ[E[[\5\\]']x]^^l^__a_``W``aOaabIbbcCccd@dde=eef=ffg=ggh?hhiCiijHjjkOkklWlmm`mnnknooxop+ppq:qqrKrss]sttptu(uuv>vvwVwxxnxy*yyzFz{{c{|!||}A}~~b~#G
k0WGr;i3d0c1f6n?zM _4
uL$hBd@iG&vV8nR7u\D- u`K8%yhYJ;.!
zpg_XQKFA=:8655679<?DINU\dlv)6DScs2F[p(@Xr4Pm8Ww)Km &File written by Adobe Photoshop 5.0 Adobe d     			
  A A"   ?          	
         	
 3 !1AQa"q2B#$Rb34rC%Scs5&DTdEt6UeuF'Vfv7GWgw 5 !1AQaq"2B#R3$brCScs4%&5DTdEU6teuFVfv'7GWgw   ? v2ML`x"mzH	v+iik]}t>vq%"Xp`=v:-4P\#qor]=G4!Wan?.?b`Tt "Scw7~v=_.1_Ukkv7zf{ikqo=0t,%msv=3cRSlG_"l5I'x4I$So}1 siigvn@Za&&`7_\Zl7~CKw$a~^b	 k\^rOqR\1^N_a",:knYlF^f-pq?s~INt<<f^5/w'?{c25P6Z{6[33>m{ 1ORSYg6n%wzqH; d}]hvCu % M%8)$J1Z Z6k&-Nu `#_gH3~\" +gmL= 1w]CK  RGvCUq/qkoYexZok w$onhrJy mKta [ke40Z\V8'f@%  Y=[;?-4hxIMJ]:4:S]\}hi {A,osG.0#@N O~vI$SY C>V9tvo*Fa6Mnkv?==cf=N-MAuXHoem%>v8sO(L-g|7R6};wig}SqfDP ~\mMJmv\=Mw?D_$_sm~]zch#hYnI| IL8<	p(JsI$ I%)$IJI$RI$I%?file|^|YaBBImages/avatars/Bruce_Campbell.jpg|^|3240|^|1008003668
 JFIF ,,   C 			





	


 C


















































  A A"            	
    } !1AQa"q2#BR$3br	
%&'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz        	
   w !1AQaq"2B	#3Rbr
$4%&'()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz   ? 7|ILxq~F>eM>9eg`rNI'$W^>0iK)W>6mG	(
~hQ:Ea]q_bekMB(G,6#x w. @Pp6I;]@->h:+X0Cwo-;p	;@ 5#[Z@ 8^ |d~	|[?z>&i"'-X
nGB>[ 	>
hi [wImBONZS c|^aV~}i0lrL U@zx^&W/4[q.KIH,Nf&B |>(|c/x^
dYg3yC
j~Fh~cxJ,>qfJJ0r>L0<  h:o-FR]>	hbd,d'i`S`R+[iomSbB$1KQ2/ t_%KM#[V"_-GDVGwf<H@(@(?xd~_3Rto1&AlzK=7~' AK?Mgy-f	ClR/"4&xAocw{f<,a>#}+Ak4MOuoeC["pl|b?; ?R/1n9Q<3 j {?P1i!KkWE#rnU8 I70c?c|?ceaq13$~9Ksug?:)Dz^,!FF|spq - x|9k_]jcAJp}esnquyI`KfHsx _K4/h?kt 	xBW:\1YjM		<s ~g?`iRjcg?hHnqw$( _+m.!<1w$B>YcR=O>tzUrOW0p_wGejZ@ iUv3w0uoqM'o
$ZTY$U
[9$ ~pE ^Ry')c$O.~z}9RP4m7C<	~?	)uPnA] =?fm2<wlL6/}>9 ?	c|?a#A{bJLzv5.H0HyI>s$`zt][Lui\0q\k,x>w}>UVH=6slf=<Q?4y[b,lE'xVV'A`V~)gk[C
GkCXw3]\fk6,+H6.W^Fz/~6Z9u	#E]g
O'{ I|$xS_iFx|Ip4X+%#`_^
"~gU/_!;#<s_qoj7z&xW
UG'pd ~3{CQZ(_FF,X"?3$E ~+EA 3i#>
jW4&E!gN
Ig/x|9+|G }&@f3 F
{?K# v,M~	xz'QF_.LHwtfgGkS]jIn%s!vvnKo$ds<{n-|m_kWO.D=Tj:mde9 CO8:viG,G+r sme ~|%>
%HQf L`JdO7e &sZoG,2I5RTn%(xv[mkAo!V@#Rx&:_3I0xRH.VSu^0?vApvL/]'4u|%XI#X xiDX E'tt3IocfN@%/#e  hY[ud k_Ri-qqZY8%Fx8>E}q{M&31x{:-G4d	c<g# #tQE QE QE QE QE QE file|^|YaBBImages/avatars/Bruce_Willis.jpg|^|3054|^|1008003668
 JFIF ,,   C 			





	


 C


















































  A A"            	
    } !1AQa"q2#BR$3br	
%&'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz        	
   w !1AQaq"2B	#3Rbr
$4%&'()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz   ? 	9Qw9`/N@Zm
%/m{XwOs*f80%-k4WnUV7R{/?^:RqNWc
yVcU_l{H'g|;0xHSh-U]`|}G7[Gy(U{%@#9_!IGWIp>wk `AH'Haq={BXCUu(05C~Ur_] ZY'_5A a?uXi}6Pr;cXRiuwZZ#t+'TI4	rVE} f|y y-w<8*6O%tGO
 t
?]/ PSL,HIhZ s4TUhf/EV1z5NvSewN#xGW2!tl ##]? }?>{!8nnDbUHA
7wcl2nW|*1kgo(_HxOFX3p?~~ kMoL m5-CUG\px!A_V%>_z);BC.GQl>"YTde
lENVZ]_=s>6X9m\y L@OX|=mpi~q?Q_W_|9Zb8v |W?6 ~<RX$dH8  O.^jabT+ExG_ V)sH$sO? 5Z<;@JssO|/cy^0*>{3
Kk 
2SxWJ|M>0q*1s|%ZxZQ{M]Q^'T[ivQ+(~+[j/H-n,c;"r8>Q/S?w_	jXEunAx<dar"iG^_V,u*_']bIwO6wijFIPp90A?_n?8i G`odn;;Xi3~>5SaKwLS{]S"/jP_V~}"AB   |>35ch<3?VdymR{Zs"|0g#]4B!BSnF1}e =|8mO4NV.C;7m#~O&k|m4F{+P8q@,r.N~r6oqA
H2N6z'$oS	&XIih&/w8lLQHbG8( }+_$t_+|wvPj^2_y^~x?ifk!+`jM~y9g?M~^['|9Gsrrx}IF_KGK|X*xsJ^NMiTQE}Ifc(89oxGD.@Psze-1Zg16&wB 
v}~<.m7Z4fo4QprAY1 Q kWH6HCy<W|K?oT_Z=
?!$#{_(nMm;#Gn8$t_c)_RxuvZ~"aPu?^XIby+DxwF:EnzI}\)k'xg&;fOQ W5> ioU_x_e9[pylc\q\tGu||5\(+\ s,zt]?W]_]A`=: i) h$|I4`d=z6O A*aFs-v c_	`mz+HYo$xSvt?%KO
((((((file|^|YaBBImages/avatars/cameron_diaz.jpg|^|8488|^|1008003669
 JFIF ,,  <Photoshop 3.0 8BIM     ,    ,    8BIM        x8BIM             8BIM
       8BIM'     
        8BIM     H /ff  lff       /ff         2    Z         5    -        8BIM     p                8BIM          @  @    8BIM        8BIM    	      A   A     1  	   JFIF  H H   &File written by Adobe Photoshop 5.0 Adobe d     			
  A A"   ?          	
         	
 3 !1AQa"q2B#$Rb34rC%Scs5&DTdEt6UeuF'Vfv7GWgw 5 !1AQaq"2B#R3$brCScs4%&5DTdEU6teuFVfv'7GWgw   ? PU>W;`QlEa^uO\]~}.05K'ci;UC[nz6~n{ba ;?Vs<v% 9CmOsTrh(c	uN849iN|\q*.X}{I
9kA1WwNp@i+>c7[}%U\ fZ W_08&U{iFQl77WT*y! "vmwZF>zCHoYZvf\c8:4z=Sdu,~NM7cX2lk6:OTlh{C+c[kk6Y[MZc59CW}G;]Q7k{U-04I',W7g5%pu?n\Js"]_^[?Mn>-@m,e3}zG/}5 u Jv
&7`CY  <1!uY89uIZx.'$PGrsW'	a\twV1Y'sEne`H~EHP+<bd)h~QL8]okCgvg Azt}K0t6U7n7\JuoLG+kwZPs+3_[3( S{r,O52b2 7IJ [_Zzg|oNi8O}NF^%z7 5 Y>t|{MlwsZH [N92X40 =7T;-,.iVzmf]v<4  Hr"#/n:KYc^ Ww] km/~b4-hV,2<-svI: .?_K]?v^M0\ =Zn-`S?r\6l=vo{g2XUhu}Fs}/ULV65"nZ|u$S5_ [oZO9v>c\ 7`s]1?O>t\m][ll'}kT=l- 5 @1 ?NYv;Uce{ H6m8 C, cp h_u[ }uN'IV7@ wTy"rQMZAshf:,xmjTi$HkA} Z-hH,O-gCu,M+-y$Y[7}XT)|v
kZ!hX\9t .njUvaU[LSI$ I%)$IJI$RI$I%?8BIM          XICC_PROFILE   HLino  mntrRGB XYZ   	  1  acspMSFT    IEC sRGB                   -HP                                                 cprt  P   3desc     lwtpt     bkpt     rXYZ     gXYZ  ,   bXYZ  @   dmnd  T   pdmdd     vued  L   view     $lumi     meas     $tech  0   rTRC  <  gTRC  <  bTRC  <  text    Copyright (c) 1998 Hewlett-Packard Company  desc       sRGB IEC61966-2.1           sRGB IEC61966-2.1                                                  XYZ       Q    XYZ                 XYZ       o  8  XYZ       b    XYZ       $    desc       IEC http://www.iec.ch           IEC http://www.iec.ch                                              desc       .IEC 61966-2.1 Default RGB colour space - sRGB           .IEC 61966-2.1 Default RGB colour space - sRGB                      desc       ,Reference Viewing Condition in IEC61966-2.1           ,Reference Viewing Condition in IEC61966-2.1                          view      _.    \   XYZ      L	V P   Wmeas                            sig     CRT curv           
     # ( - 2 7 ; @ E J O T Y ^ c h m r w |                         %+28>ELRY`gnu|&/8AKT]gqz !-8COZfr~ -;HUcq~+:IXgw'7HYj{+=Oat2FZn		%	:	O	d	y						

'
=
T
j





"9Qi*C\u&@Zt.Id	%A^z	&Ca~1Om&Ed#Cc'Ij4Vx&IlAe@e Ek*Qw;c*R{Gp@j>i  A l   !!H!u!!!"'"U"""#
#8#f###$$M$|$$%	%8%h%%%&'&W&&&''I'z''((?(q(())8)k))**5*h**++6+i++,,9,n,,--A-v--..L.../$/Z///050l0011J1112*2c2233F3334+4e4455M555676r667$7`7788P8899B999:6:t::;-;k;;<'<e<<="=a==> >`>>?!?a??@#@d@@A)AjAAB0BrBBC:C}CDDGDDEEUEEF"FgFFG5G{GHHKHHIIcIIJ7J}JKKSKKL*LrLMMJMMN%NnNO OIOOP'PqPQQPQQR1R|RSS_SSTBTTU(UuUVV\VVWDWWX/X}XYYiYZZVZZ[E[[\5\\]']x]^^l^__a_``W``aOaabIbbcCccd@dde=eef=ffg=ggh?hhiCiijHjjkOkklWlmm`mnnknooxop+ppq:qqrKrss]sttptu(uuv>vvwVwxxnxy*yyzFz{{c{|!||}A}~~b~#G
k0WGr;i3d0c1f6n?zM _4
uL$hBd@iG&vV8nR7u\D- u`K8%yhYJ;.!
zpg_XQKFA=:8655679<?DINU\dlv)6DScs2F[p(@Xr4Pm8Ww)Km &File written by Adobe Photoshop 5.0 Adobe d     			
  A A"   ?          	
         	
 3 !1AQa"q2B#$Rb34rC%Scs5&DTdEt6UeuF'Vfv7GWgw 5 !1AQaq"2B#R3$brCScs4%&5DTdEU6teuFVfv'7GWgw   ? PU>W;`QlEa^uO\]~}.05K'ci;UC[nz6~n{ba ;?Vs<v% 9CmOsTrh(c	uN849iN|\q*.X}{I
9kA1WwNp@i+>c7[}%U\ fZ W_08&U{iFQl77WT*y! "vmwZF>zCHoYZvf\c8:4z=Sdu,~NM7cX2lk6:OTlh{C+c[kk6Y[MZc59CW}G;]Q7k{U-04I',W7g5%pu?n\Js"]_^[?Mn>-@m,e3}zG/}5 u Jv
&7`CY  <1!uY89uIZx.'$PGrsW'	a\twV1Y'sEne`H~EHP+<bd)h~QL8]okCgvg Azt}K0t6U7n7\JuoLG+kwZPs+3_[3( S{r,O52b2 7IJ [_Zzg|oNi8O}NF^%z7 5 Y>t|{MlwsZH [N92X40 =7T;-,.iVzmf]v<4  Hr"#/n:KYc^ Ww] km/~b4-hV,2<-svI: .?_K]?v^M0\ =Zn-`S?r\6l=vo{g2XUhu}Fs}/ULV65"nZ|u$S5_ [oZO9v>c\ 7`s]1?O>t\m][ll'}kT=l- 5 @1 ?NYv;Uce{ H6m8 C, cp h_u[ }uN'IV7@ wTy"rQMZAshf:,xmjTi$HkA} Z-hH,O-gCu,M+-y$Y[7}XT)|v
kZ!hX\9t .njUvaU[LSI$ I%)$IJI$RI$I%?file|^|YaBBImages/avatars/charisma_carpenter.jpg|^|8212|^|1008003670
 JFIF ,,  
Photoshop 3.0 8BIM     ,    ,    8BIM        x8BIM             8BIM
       8BIM'     
        8BIM     H /ff  lff       /ff         2    Z         5    -        8BIM     p                8BIM          @  @    8BIM        8BIM    	"      A   A     1  	   JFIF  H H   &File written by Adobe Photoshop 5.0 Adobe d     			
  A A"   ?          	
         	
 3 !1AQa"q2B#$Rb34rC%Scs5&DTdEt6UeuF'Vfv7GWgw 5 !1AQaq"2B#R3$brCScs4%&5DTdEU6teuFVfv'7GWgw   ? WetK-cs[f9^su*cq#4nn?7snuXTkxl``&*f^aqu#moqplDn0gB'GDRP|[OcqI@"w-OU\]k|<?[7Ob"`%#mS0aPXn8e>5YK[cdl %{Hn F4^isDrHinfRqo2F\123,fu .lW{]Z`tR/=vSSKKt~|=?q59*I$!}UH.f gT\4?[w+zj]X}KgzN^9>[gm6;6Ko\k>2`{i  C0F/z/N]-g{7h in]J>;['e >K,zoI7Ikv_d'T3F5-xbG=NZ[jd:A#V{}6Hh{fTW upXV.k+.A'(#4<^Um,1uuSsKd*ml;	yCv%{	It	?Ez@Q0S>OqV*d /j@|Q$VV?OVn?Be6Y}xn#'ik{m J_+sm$4t;}MYoN5vi0=!s2~?Ox/:sl?>XIe  zNqlm$;K\d<XvFvCp3.;s];z 	0O#.!?Sw:PgCLh.Nc]f'QMYg XNxG&>o~:ofi 6pMclk%o"YyuZIY[ekY.7sq:T6gd~ F^F3Vcgp_*I$7])t>u>:=1*\k;y| yzwHs~It* cv~	sZ1xhm7Z}FaKVZNF2:h 9 HDu\?^]-q#s H}qYKK@5ou11 Goc~k H n6A./yLzMvM+%#*l>Zph.k\Hh/c^[~Ui[cFnj1([%32 \+T++vZ}/k\.&8hUmfzQne64H{,s@5go&plxl8LGz4lo   0G?$JI%)$IJI$RI$I%?8BIM          XICC_PROFILE   HLino  mntrRGB XYZ   	  1  acspMSFT    IEC sRGB                   -HP                                                 cprt  P   3desc     lwtpt     bkpt     rXYZ     gXYZ  ,   bXYZ  @   dmnd  T   pdmdd     vued  L   view     $lumi     meas     $tech  0   rTRC  <  gTRC  <  bTRC  <  text    Copyright (c) 1998 Hewlett-Packard Company  desc       sRGB IEC61966-2.1           sRGB IEC61966-2.1                                                  XYZ       Q    XYZ                 XYZ       o  8  XYZ       b    XYZ       $    desc       IEC http://www.iec.ch           IEC http://www.iec.ch                                              desc       .IEC 61966-2.1 Default RGB colour space - sRGB           .IEC 61966-2.1 Default RGB colour space - sRGB                      desc       ,Reference Viewing Condition in IEC61966-2.1           ,Reference Viewing Condition in IEC61966-2.1                          view      _.    \   XYZ      L	V P   Wmeas                            sig     CRT curv           
     # ( - 2 7 ; @ E J O T Y ^ c h m r w |                         %+28>ELRY`gnu|&/8AKT]gqz !-8COZfr~ -;HUcq~+:IXgw'7HYj{+=Oat2FZn		%	:	O	d	y						

'
=
T
j





"9Qi*C\u&@Zt.Id	%A^z	&Ca~1Om&Ed#Cc'Ij4Vx&IlAe@e Ek*Qw;c*R{Gp@j>i  A l   !!H!u!!!"'"U"""#
#8#f###$$M$|$$%	%8%h%%%&'&W&&&''I'z''((?(q(())8)k))**5*h**++6+i++,,9,n,,--A-v--..L.../$/Z///050l0011J1112*2c2233F3334+4e4455M555676r667$7`7788P8899B999:6:t::;-;k;;<'<e<<="=a==> >`>>?!?a??@#@d@@A)AjAAB0BrBBC:C}CDDGDDEEUEEF"FgFFG5G{GHHKHHIIcIIJ7J}JKKSKKL*LrLMMJMMN%NnNO OIOOP'PqPQQPQQR1R|RSS_SSTBTTU(UuUVV\VVWDWWX/X}XYYiYZZVZZ[E[[\5\\]']x]^^l^__a_``W``aOaabIbbcCccd@dde=eef=ffg=ggh?hhiCiijHjjkOkklWlmm`mnnknooxop+ppq:qqrKrss]sttptu(uuv>vvwVwxxnxy*yyzFz{{c{|!||}A}~~b~#G
k0WGr;i3d0c1f6n?zM _4
uL$hBd@iG&vV8nR7u\D- u`K8%yhYJ;.!
zpg_XQKFA=:8655679<?DINU\dlv)6DScs2F[p(@Xr4Pm8Ww)Km &File written by Adobe Photoshop 5.0 Adobe d     			
  A A"   ?          	
         	
 3 !1AQa"q2B#$Rb34rC%Scs5&DTdEt6UeuF'Vfv7GWgw 5 !1AQaq"2B#R3$brCScs4%&5DTdEU6teuFVfv'7GWgw   ? WetK-cs[f9^su*cq#4nn?7snuXTkxl``&*f^aqu#moqplDn0gB'GDRP|[OcqI@"w-OU\]k|<?[7Ob"`%#mS0aPXn8e>5YK[cdl %{Hn F4^isDrHinfRqo2F\123,fu .lW{]Z`tR/=vSSKKt~|=?q59*I$!}UH.f gT\4?[w+zj]X}KgzN^9>[gm6;6Ko\k>2`{i  C0F/z/N]-g{7h in]J>;['e >K,zoI7Ikv_d'T3F5-xbG=NZ[jd:A#V{}6Hh{fTW upXV.k+.A'(#4<^Um,1uuSsKd*ml;	yCv%{	It	?Ez@Q0S>OqV*d /j@|Q$VV?OVn?Be6Y}xn#'ik{m J_+sm$4t;}MYoN5vi0=!s2~?Ox/:sl?>XIe  zNqlm$;K\d<XvFvCp3.;s];z 	0O#.!?Sw:PgCLh.Nc]f'QMYg XNxG&>o~:ofi 6pMclk%o"YyuZIY[ekY.7sq:T6gd~ F^F3Vcgp_*I$7])t>u>:=1*\k;y| yzwHs~It* cv~	sZ1xhm7Z}FaKVZNF2:h 9 HDu\?^]-q#s H}qYKK@5ou11 Goc~k H n6A./yLzMvM+%#*l>Zph.k\Hh/c^[~Ui[cFnj1([%32 \+T++vZ}/k\.&8hUmfzQne64H{,s@5go&plxl8LGz4lo   0G?$JI%)$IJI$RI$I%?file|^|YaBBImages/avatars/Christopher_Lambert.jpg|^|2635|^|1008003671
 JFIF ,,   C 			





	


 C


















































  A A"            	
    } !1AQa"q2#BR$3br	
%&'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz        	
   w !1AQaq"2B	#3Rbr
$4%&'()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz   ? ?W?>\~ 6_Zy'wv;3$I&/ bs\H>;GzLQ,aB_g6kA?	':=k>|!O7+o$PHFw_bb%OT~05LSO?<C $a 
HN	j(u;|_[yL1ZY\E#<Mz8W'Aru+ZG&6E`kFkYZ$
* 
kk$7 n^=
MM^;njN?*9jT.otpxoi|os v9
A ?_.	|C/NW|:&$c} cj7vcpK2uFvW?>+:SH++:]~5]xf]^}9uvjDlec6W??,gH{+ -L`m6^ F -]bG[tS_%^gxK^~_`55fB^s5:2>ri]PPU2)O	]M~xY9ze*j}PIkw;!3_(
ymV9E.Coh6q<rUSix."$ZwG laWpWfk~
xrZ^i1.:T k)`NXqFx7dS?;rSd$R0i?iJi8yQ]R_w,|o #& |0CUlF?WsU7|=9x^i	XoEtY)#$)V/ s<bR{**tld<v	>PFBy'=M|{|Bbv#77 g4rBFySpXf{;f3kG
Qm.Se{#Lz
	fPJpSv	>J[T2s[iF2z!dnn+6B"!r6|s'~'|N0iR'? 5m
f6aaYyo3z.Vq&?+/)?u9xR*9ACZsVl=Y4]NWG~Eg :
<,
ZZ4.!uHF ^ Na?M ,~Tgo(,Pu|f2^Wk>24KJl+8_Ri|9.mG#]gkw'W)Kvi[!w~Kf[nGvI3sx:0^d}*|>sI'z_z$N:c?ytM2aqtvF;~??k_]O{e+pzW]]s,rO^_E
k/]'kWrSqGOexAE$'Kdc }kYCpVN	{MZQs(!;cC9&0|e[EVfAEPEPEPEPEPfile|^|YaBBImages/avatars/Claudia_Schiffer.jpg|^|3488|^|1008003672
 JFIF ,,   C 			





	


 C


















































  A A"            	
    } !1AQa"q2#BR$3br	
%&'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz        	
   w !1AQaq"2B	#3Rbr
$4%&'()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz   ? 
|:i	~_~xgKo'%G.gp7SEEy<7JK|'|f$~o='
}7x
mM*k.Gla3Ke$Q]OI
2 *~bO8J=2[i 7AGq,ZjS ,w<_P~_No?4/]6}yg!6yJl_O_p<:}1]LByB*9}(b0@acSG/=f"w)W BV(`Z1
2	$1?e
t)j~ -TyY%n -O'kC!OcdJx6Lb `?I,tQrISJmd,ied5t!Yk9fkI|f;.0m` #k ~?
[<lq=F1?u?-~xz>o$.;BG_J8
[$n~:N<Eu'9b>gM}| 1=N:|)mf,QE~?eP&
<xQ :fgmXoX<VV/'c,[ 4?<?o? RM}ixq?&hpF]<c d <Issig|=hBF#Q9m5M5cN;	z.xqzEYRJRiZ}I|1:VF]8Rl#T;Cv
 F~n{;%*6RJS}#dKh}T<H${;WgYm0_KG-mw T|D*INwivSK!L[QsO?K]CCdd*8kwa=^O[|ff5sm*/n~
nZ }ux,EU},U{-wIyI =~?_/?;f]Bq\Eeq$Y2wU Nep.,T(qkGu xY>|1k\]JX<(
p=a4)ndkt_'[U:OE{_WgQ_'K&P{md cR'_-ki%o(p;XF xkMjeApz[c{?	Fi]FXNV)>P$C/3V
1T'R|-itLOHv_K~7%+Fg?J;KyndDUXT'vW#!?`-sH'	<1w*e(I?EE)Zj wg)]Kd>Ob="K}F7 (P'umxU|?[_GIe"@|A Wxbw-5YA3y2$)n~CZZYXF#yagC:M|~2%V	Nrd4   <S5sX]-1t`e?2@w q-uJwFhHH9zM_>Me|n9eq#ZxJ25X$#p 6Wh4/q";]o]7H@ TJ($)V} |Cd	zuG'"(O* 4_#T2"</9o>'x3S;	39pA"xb	u?	iZ{hf
ra\\k b;3Ym4V	qkapE$O_|'%~'_CH<?m5+BK<nk}eFFpF9 yV?<5[cfm1Fyo/WKM;@4IE<qBGq^
/j^$vZ\YLc	 >)bq;5OcaaZkk=Hg;J%Wq3IT#=A/ y|FC,8'?M_R|7iZIo)KImqu%# a?_oiUeGd+ T*p}3>2V;O?Lw^xo[
m J	> q_|CmLo2{ { :(U8&$eQ%v L\/V]h
(
(
(
(
(?file|^|YaBBImages/avatars/david_boreanaz.jpg|^|3104|^|1008003672
 JFIF ,,   C 			





	


 C


















































  A A"            	
    } !1AQa"q2#BR$3br	
%&'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz        	
   w !1AQaq"2B	#3Rbr
$4%&'()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz   ? OKfr\-p,"iHiK1ocx?yMn 2!c` #-u:B+}iXtp+:m9l`i h|3o_|W{W-.Ue;pOL|+!M7;j;_3axsR-(k Z^(~.Oo:}B+F3J;`%"r4ncueckvMROvqRdz8! IoEoqX24v.IYe\M( vZO,6_Q{Rgmb,vB7g]](-|4:$r UdmWBV@]\eI-~~?F
#Wvd*NfWVwpO*]~S~9Tu~hsoJ	Ut4edni9[h_GRel"$Px5)`qccwn@N27cz:noWc*>>t31w<) q50) ?
1~1ne]c]BR^cKX~W4N_kum2A!Wr G .5%h ==.|F" tQj7nn20k3L."kFq\w};3t-L^hg:q6rO[?#$%[Ic]uExw'A\ ecTQ}PRg`2;LYcSmd>au|a~0]jtxgpL:~`A%GcqO
MToXwc>LdMuvo"mWSn$7y&h .Tm9,s? |
]w%.m0 Z,!2|e b.- JIUd ~(Tu"7 ,v	8|E,UIF['7~iBsk{m|!F_'^2^[	JcyHbx~dO_!\OTdpJ{W#O6]hO4\4$1H(Ko^ z>?.iMy0IG[c8lI zg#h<_mgJh>:g_HwkKCklpu"83><>	( |u8XgR UlX4 |!%
'o{Kl0=@\'Gy/>ya,#?HS8 e
\Ada,A`U82 f/2Pi/H%)*8+?% xN/.9f+qj[_!}+Rp46z)lL 1kmgeyV{{ ]z3g<[Jn/O"
N|u
9u|x3&Y-$< 8'_?>[nn t#<HJ|)X7QE}QxO#YG;'{!Q8n si$xc	mAXKWRTvH?db?n/w,ajbk:	'|bQ/q|WHO+u=W `DPrx]dsk s4,Ge
*KVPz H4'W|9<	j_t;{+x5  ==:GR+WZY/uNrQWM6w g0|<oo}iZNKls=G#}A47ThYcPrP-OeSBPeMm"2$v X5RS1 A{&z?-NN.j9T7RZ-_d8?lx;#6&<Xy}x"Ao_]8FpgrE
(
(
(
(
(?file|^|YaBBImages/avatars/david_spade.gif|^|4251|^|1008003673
GIF89aA A            $%!  ! ) ! !! ) )!1 5 31 = 1!! .&1! :" 3+9!9+::,547.$:9+G F	J J V R A%D) D-J!L+ N%J1H5W%X5V=J1"I=$T<#b g'`/e;
`=k9t-w3XEJA1^F XH-VI1[S:kFkBmLhRpD~J{T`K-nF*oN-hT.gW=mZ>sJ!J)~L1xW'}Z3AA@_LGWR@WTXc^Lq\WofAiDqjTwk_xkVnmmfivlo|nfwe~{hxux8B'R)^&X'^=R5Z1^9J1V)Z=R8^1c&n7c)c9k1k9c9k9u5[8f9p<lFcBnFoTsFtVuYy\{UmDiNcFkB{DsBsN{ByTxexk|bymzuyjZBcBdLkBcNsJxB{JsJ{OsThJkRsJyB{NwNsRw[{auL{ZSxmvqzN^LR^Rw``sOZZZn`cognu,    A A   H*\hQ)EL!D)l
'$rMm
*pc)Qb/xbd/`Qinm&8)Hu))H]>y%
4Ny2E.`RcmmOv!BG7FoI"_!aVLJRT<$Ky)VWFr$DQ'{CxOWMGg*VXZJT=kYD#_dG!hQ<ECL-PeYu")rJhnuvR8]w7/z ^k+0G"L*GH2Zd#
71!E~{t19 )L2q{^E[&7 -y$0+q
Y~R@DkH"vh%Bxw(k>pV1)t!ED*Z8! ?B q2ti)gci*`8R{qA2 +cA"idq#(IAELE\4+bE/r(1\'+7[NL`"T<cq<l!*_z)+,4KQH"R	-XbN].Q/prWiQEHVB>/h< 	/.Y2q1G++"4pj*V2}bAT|.kqx|^~p"{0eIH7CP@>S0.Fm{aL"40sMp6c c0S!iARbRN'p`*q!h^8A"Z`*CX/
r]0('h@B$ByY:RNE.]8%DP q(<	>'8N)o@:J]Wtrqr z6?%(@P4D!sc*F1P
0D!a	|`HUO4'5mCSB8(@
E*XA
P	Xw/#/~ =sum@C8OIE0	PH(+`0 8N;Yxj&  _F:,r4x\T zn%8@. Xa
r,SE(dR#2!|hj*>SR`Q0	,0,=J	  qHNR0AApBC/f4@x0R9a0,b74gTri6vLZ<Z0`
Rq*Kz5R}nJ:H@Jp[8"m2>8'RpXaYa
Ox=tx)H!EhvI5k2,2Q](0W3
 n:c$eUq  (^ bmB?=Bpg|PZ lH&l L@1/a%3Y0'<6TB~(B?0La?b&-vbt+v A3u"	
7 ;$ka "<bS0Tapb=ShyVDND0A hX@7&inH,R0onXMc<1'oq	P[!ptvLPC x7dy&\"(*V-pxD#;Is[)H	0CZ +. q
T#[C15OzP &dAXN7ANbPW3g&':Gy"|0&	<`x07	2@6@@ J
M-&M  x3@@! |"yn<?{[	-f@5Dl`8 4@GFh	P`~01Fcdv;",0 -]]r-  - 9{ 
p,xxazF1,`qp-0 i 0`O0~p;.F`so0;p(|a1?J/ o V^Pr`!!~"F7l0,p,J<-y61	I &K. 	m M!y~j oP'8=PX08D`Yl1FJ	p',j  	( ; V`5Ip $7|
 m"c%p 	l@`\0`t%|`o@r	8jpLl @c&0&I`M0(A  HrqPj>S7&K0( 3 @Z148l@3J0TipsY&`dEXQPJ`*ykx0 	[0e1\c8 		P.p49UQ g2ph@  &`Q!,`B!sy=p&A \2  ()PC90iM(~@v\6@	0` `rL3
 	3Pap	? N@=P}|S@Q(K 
40`` _A`	` Eb	rJh0``	dA@ .4Z_oG Ic'fP TP`y@% %TjXz1~%	lzp% kz \!`#`P5
_"nu t0`eP\fZ:WY9#@j(h3
   ;file|^|YaBBImages/avatars/index.php|^|66|^|1008654035
<?
include ("../Settings.php");
header("Location: $boardurl");
?>
file|^|YaBBImages/admin.gif|^|454|^|1008718985
GIF89a8     Z   kBBB111kkk{                        !    ,  6     DlKom1C`		r&FG`J-
B@  tz Rvzd[gj?rrS:sa^z\zi@^
YZai@^w]]xbSx`Y L4Ep\6} rKE* C  b5Cr0c4m@2@c	OJ4*`< ;file|^|YaBBImages/admin_func.gif|^|799|^|1008718987
GIF89ag    ;@   1!xvsj|D]~Fl8;8;((yxd_|q<8<@<@[W]kQ|w{{?8QQQP[@WadOUVEKU8;Sc}JZS\                                                !    ,    g    4, KNOP=FUL50%
W<)./'83QGe+k$ZiRXY - ?hCDg@ e86a# 1&	IY<|]/lBgn'Mi"0J3ci7^2eG!8a2Vt)"FC
G&=mk|?z[
Maa}
%JI~6~Ix $-~9j|+aM:1 ,(D:^}; E2$]P(\]Q  ;file|^|YaBBImages/admin_lock.gif|^|816|^|1008718988
GIF89aX     Z   1  k9kkB sss!!! R RRR{ {91 Zk kJ  kB)c9{c                                          !    ,  V   @p8Trl:e2Q8>v(>znpdC `|}}			 vxy
} 	^wx_)$`;BBs'T! 7@,cS(`#0 qi\HnI.0`` #LXa6@zN(p[n/_F#nk9-J"@	,J@wkiFRjV`y)x!Qh3J|PjU:E}f@Z~=/S~K'W 
+@}_ kqq;)y"WcXy`EGwuTNAnxmQq^>5SQU@ H`xVpM!}kvwmtFNJg0 !af?'#W"H$O- ETVin@ ;file|^|YaBBImages/admin_move.gif|^|784|^|1008718989
GIF89aR     Z   !kc cc11cBBB1 9 BcZ  J {                                                                        !    ,  P   @pHTrl:IZP2zVnf+I`d{N~2`
			 	j  #$"k"HVFEIw:@q `4b

R-R4q>3A'i` J!
9q@.;EiM$R"3bXXB ,Lp`chB\tMffF9zp`El5F|O24`_<\8J^;e%B-	h.do|!GMzEV&0	'
8 ^^z7VlQi-Ab8 x aQ(|j<x  ;file|^|YaBBImages/admin_rem.gif|^|659|^|1008718989
GIF89a\     Z   999k{                        !    ,  Z     adlp{Yq<`+w`d*tJZOH0APa(4<0|No3 ]^&ddch_jlmotzqyz{x}I@BC5glqsq{J?7CkpmwJgh+pqI@ACv{U" \Ib"(3cF9	O]!OLFPMPUf\+Aj(y\J2	>=QD x	<nMd}zL+r 	"G;c/P	|z3+:T0cwqT}5%	<H0[r20V}8& ?:OwOa:*qMG>>o3mv]O7F(j@ ;file|^|YaBBImages/admin_sticky.gif|^|501|^|1008718990
GIF89a5    Zk     !   ,    5  @$dihVSEsdL;OH\H(44&6|qQHyt"i\~fm(?57FFHyyy<9>fW]y]__ba~~NOSUZi>HH`!T'O6$ARBnIFYrRe0
)RXkj-^<V,i .anQIYefK4l)PxeG_-YrC+6rB ;file|^|YaBBImages/administrator.gif|^|6128|^|1008718987
GIF89a    Zd:Q^Jm\A


D  4~Y%%%q#
aHiiW454"	GSrrBOpp77wwwK3 6GCDD[jjbccH;% VWV( V(C97gxxTU)jFGe8BBS6 U?``auC*%443RGNPOe:7)U2FD* D7S5
i)sG9uW {q+(wj8.FRRNTMR7Y6)zm^GG5kF6v6\/2g:*3 $Rq	%x{CzyIA(uFB( hA>'65$ /c0,eb9e\/sD.! [G [X/fJ k\tk3v |9c+A3rmDxYDffzb VJ9<C~mlpSy<@P31F(cRNJq9rE^53[#{jA-jP `(XV9{7H)&oR*aFzYwe}}               !    ,  s    H`A L#JhpaX\wh2pY@\2"g'8seE II:!OF,)KF5MZV0*CdNdk#YvY&0aUp'vI  6%AR1IP1I1b5JUsmF@tajfd@5j}"C;ajSW J]$CAGL-4i'Sdy1b,P@=`_;G
*QFcKr A=dag(aT9K!MQ"}(x_|W5&KCPaWBAN0h ybfp Cl'fBy"r- 2l'0T_'I"P>)Z	-W,9B!Bn*f`7K0(R@*XFA6@EBM(D*pH-!v24@0A(y6]5pA"E (`1Auf4KAgy8dH0QP;3C]0`8C7e $$4cy>YLlNd^O:xl@NF4K@C0CQS`[p1$5C38?=d9$toD yM,<]H!1G>uC^xQ]psmS30R{|k(~{C3Ab;[|fs4%cl#p 5=DD~`@0>9CgW PvY eb= 0b@Q'D!Bx& "q(# xp	0xB(@1X j0Z(!mY7R`'c@9LQ5<s/>~F~#A/'o%D| sL G\h)LA4%b8QxpH$O  
Qx0KR}  gk$nS0D	}xB/=T#l@0DqSF-(L-7; 0PS%tnRm@`J`(FJ D~^)p@cYfNj/SH#OxB>zPinCM4
18R?<@-h@KZ)327 pFg0QGp}>jU\l%zl `A`
dI+!E 0T:`gmbMP
\ {eI^ ZU@%j8NBv9#+6VEui2#k,&65$B4r0k98|X*'4fR.[u%"5| `0p
$9'pF(X.ixv  rL!xaA@OEHz@C)a.`EC*eq@)sEbTfpsG"xD|Qt|KzHQ&f=9	xXFDwl,vE(ud^03mhXSB$4aD]j?0']S^vK$z~!}9iM(;>VZ?lM"@MF[N	&Mfy(iU1YP;l8Hq["sg.E>pMK&1m:]
N-ivvw]zi>"$}yN<fTO<nu@:p(P.4(o>g&/0!`@	: cwOUo73{w%c'
Vqk~^;r9 0 /\~!XJPY78od9p[ Ep~}gD {wu@~Afwd7@x7pX ~~Br~yZx	{/P+@p;z0!80  >},8U703` 99+pG~=cx% C.pFW7W|Nhv`W@uup5@6`69U!3shGthW0'P x'PdeEPXExG0'}\  ~WEcD8 5p   P}pl6 7G0Dp@yX/8(~f@6y %7P:Ip4?f|cupq['tH 9y( Gy6yBBBPB0hGrivtia1up@(@Wpwip. . C p`*9u!vnf^z8)ythtgp''p).P7xcWy ptv6wmGGy9' '2wp)oWpps/P|	V,9ubwa 5c9U)w'Hx( Qy{y9lI<yyI5)y)xvyG a/`ENyyDG@9y/`:
lF 9}8/0/pIg~9bi@7+@zl z3/`nSY	 yoil	}0y^gD:i	oZa9l
X	[	Cp]p	9YZwoyy$8D0^)X|
J{]otHxL88~hhE%:u7xXxvxTH: 4
>xJvX=j:~%P^KZTO41*>B$Ov--$OJ J:d [z@3*O(M.k&K6W6-k*S:kH{J*8~3;F[/; ^]bK]k`@ jm 0kr lk`@ z@ki~[k\P k}%O^tk k tj[ih{\Ka[ \[  +jk[Kg+[ *{d+c[{\JP 	<;K<\k \\L	4*0,1,35L6<<9&*`C4`FLEH<LSlS<E|&P&J[d\SEg[ w[U	UT1}|}l<1t]uv]x]U[E[\[|[,d<eu+`|JDL	)T  <,|\ < `, 	| , @ll,\\l|LL<	PI=-,+-.]8M4!=" lFG"m<6R ,9
@0>=dLY<3-&mA1 zz|{(gaJLl- `< (\ 	`}|@t\",LL3]ck*<#|&|+Lz}WB+lkM-ZQM])kK #x#^ $N? KT8NL[C u}GK \ L/WN^|v>t_;NlNYN}]|E%Yk=P.#m`	[
N-!+l+L|~\c.z8L- #>'LW.E.^,- >IemN]|4Na[\mf\U^v# 
Z e[Wu[J>;&0@Eg1gL&9$PK
@^1BTd
^KT O&B7x3,LF[fa*A[. ,11 	 A,a1 U$#U?,+K\1UoMtO*19! ;file|^|YaBBImages/aim.gif|^|138|^|1008718991
GIF89a       {{  !   ,       7P)1n}pnm\aGAoLTED<
" ;file|^|YaBBImages/angry.gif|^|945|^|1008718992
GIF89a       )) 1) 1)11           !   ,        ` .(Xa( H!5"8  X 3   0i"ISd( &(hAIi) Ui.Bc+0  ;file|^|YaBBImages/assist.gif|^|131|^|1008718993
GIF89a    r]/pE   ,       Px
0JNhsEEA +^L
m6\Q-zcA
JJy:+! f$  ;file|^|YaBBImages/attachment.gif|^|928|^|1008718993
GIF89a       k!   ,      @} H  ($    @L F4` @ SDx"/cD!3sgG*:=u\GPT*Tk6|HrD@h4 ]A@ ;file|^|YaBBImages/azn.gif|^|245|^|1008718994
GIF89a   1)           11))                                              !   ,       r$c*HM6a<2F -2,F M+B 3GtF(QWFxL#B!yB@	{"~	

=}y
|)@(*'#! ;file|^|YaBBImages/ban.gif|^|135|^|1008718994
GIF89a         /0/g       !   ,      @Lh/ )jM@mFP
d	1#F|n#h	
=1t-+7pqk =w hM ;file|^|YaBBImages/bar.gif|^|799|^|1008718995
GIF87a    R,         ;file|^|YaBBImages/bdaycake.gif|^|3226|^|1008718996
GIF89aF A   	",'& 0%1 D W b #Y *j .r 3l 8y4e7}*8ABZAyBnQt)EN6Yw.kwH)=Z[U6Mb8Uq0lUB3YSZ[MbMfnIdxOxzeU[ySrmgGvh|;=
CHSZ&I'Z%^8D2_4P'b)`#z-|4f8g8xB4H^VUNtB|Umwwbgws/>4 !+FLQR]ShmbtgdrwQitQXc|sofg}yw {ls '>#^TyGqYt%8&cEPNmMM~n16FVe,5KqLv            !   ,    F A   HA*\pNH%fxq}
)>=FS $m\i2%EHHD`6fFFH3G)H"1z%:hHQ-u=F`#C)rVmB"q RE
2mjP/H!.,e
{L8Bnd@(X*CEAitF E\[ $ xKoom1sh4j`s-(4C}JwmA.>|^Ae\GP
">#T}iCBAe&OA}3} 1e! {cxcFb	3He{f!@3:<p>yL*[><{)a>v:{,StN>s>{v%{INeC-f6S!|< h>iZK*f'4G)*;,i>~ey , )	b`:2 n2d*RF">bg=D+cHm$B 3>F)H.qz| 0C4wKpQ>/ EI @2$P2C2f_CC`mat-<2;)tw,2Fz	#>[KN8rJb\X+6;./]O>s+LHB
-bEF ^ByHTo)_C<C#>PQ%9bI>_A[p'!yH.t0ta|;9qfe:|cWG>`6!C^9*d$axip^jP>vu]E!vBBb*2
j =Q"`=f}@F'VtR>w("0"!Cl@h[hWdc0uNnA4#HTHDeU
Qbt`M~m(`U` EpG/RbA+PP,>c-b^$F	xxqE(d>q[Fhp6dt
1#-lNIC#<Xc`g;y1`T.QXsEY1$&'

RG;x40F%C>FC6Ej=!8@PB\&z#GBQ%R:QU0#+l#>	#+Rz2T>67, \qLkGa5ZCGyG$70'pkc&59(<zSD,g}Ajhk0BDn0	\p	\,,># &F40{=7ov5/t+ *a
hfhw.?2L.[DX/P25z``2`%0lI]#WDw6_MxxHr]\ =~%d+}l&XD#-{@m`b+C%y,w	1[af( 
p*JEG;axg(5p0w&
`au2
`B+vBV]<nV1U`LO5&h `4o WZjlHa6@>F	n>Q|5XHsVj>,|RQUi6VTP}p`2\dgA!/pEV04\\H;akD/`WfFd {< #r0G)tA*t	`B7keQe)(xrAq}g8r_a~-
T|AZB0P]b8i(@	@(@A{"D:kTp1X #o_( =A 
nc|Pv`>#;8|Xw?e&VLFP8|y nWG/'p
 p,Q	 ;{#D@P~1b(C_oX ;file|^|YaBBImages/bg.gif|^|5094|^|1008718997
GIF89aXd                (  7  G  X  h  w            	*'#-(:*="2%6'95M8R;V>Z-B/D,@0F2IA^?\NrQuTzV~SyCaEeKmHiMo\[^Yba`cdeef!	  ? ,    Xd  pH,rl:tJZvzxL.zn|N~ 
H*\P#JH`# CJ)F&Se!2er@J`
p$ a8pNA_!00 MPB0Pp4k@Z
F4Q8h`A3"Lx {3 QH;\p8;^M7h;c#nf9+6Cy(E``N~P0~r*O	2d(! 8W1CpWC` V	@0p/h =w3d mo8*p0y w> GAM7+v [ls2P_p,wBkTP+	G'1&!h7Cov)!)EBy7pAQ	(dHzY0A~XVX`5B*	L*uf7a |pA	.$n*Tr;0T0:W]	uRkYJo*``C8pAA	o@tFBC2p>`2\uH1vdPCvP/z72[s);w'w8dC9|5pPJGx`4,
%[	N@' hPl_B t9wqp+z^!;l3HVBy 	P;z9
/o0],AV4cI <V@se m
xf }O $$>J Ob*LpiO{TPX9V/I; j&S(xv&0%K3d@<\,@@+[W@C	L@@(bHK _8<X?-Q[">;dc0	f |nh&y,(Y_ 6+S@ZiC~(A	$p<7	F=269-0#$ba6Pbj1e7%7WFlu2x/`rn@.myH
NdcY:Hc]m:t3j 6
P @-3(pQ@Xl`Ati'tJ78p'i-mq72]5@S
H'<@2x.yT`<;hPPwAEqH
*H@%6 Ds=fV*nM+TH\03DT7dsj+n(AThl0Cm1W`Gf|\\		jz\e8p
xUUS*8 >*GwcY`L.s@5A,tUJL2($EXEV27xEDyf&,&:R^-6P8.Nus,A3sR0e
2l1%P ue
HeR'WlP`8RFdHj77} Rz\t )($!h J9E
S
.414X?~$	,*H{)j4_8+)+pZ$4~}GY1 f
>@	P@A GLnp?jc2B:oE	kS^6GJ,MzPl`0_(m^4EUbb
5iX@de" @@ R@mZW )h#-LsC]JZof_\
XUT;x.-N5a#PND2E@<3(c, @9' v?@=G!n9~JP! Nc[y<GI$O U;||Ajd@TV< x64p" *`e8|C1(P9a|,$@25,R,7pc*$Pfw(3 m`+%xuB:2#WPhbwD9~7'vwoC* hTp5f3`Yn5%G1w;pBJlkM8$)~Bb]%G!Ogq8\52avt72,dS?(&m(75(00s+5P
vT-E<50Fu vwX*0~H;8`>ez2#5o'(/@>dEgP_r".Pj_t&5}'"Q41Px3<JHV7?AS 6@C7D+75&MAX'gL$ &1},tYYC+m)6pUx?0t75Ni&D3rBpbv*/0pet-g`qs;`7!3 :&}%P'nTnm-0Y''9&>07!4!$MS@L[!^`#2`EU2oD*n&Ow'Lc);Z&. p+;G_^)`r88` )U`WCD*9P >,Y)a$)0$X` T[3@1*48).P$`~G%LERufaO2E{D.1)\YdXA v2Fwt96/p5+PY0@Gz (E4)n *	eoAkQ@`kEy|@&scUp$8fF1jqOybXMI`uXD3 <#cn)#Pjp" 3Ma'#&I&*9`y"Dcu&P& UUp("-m<o
`'\G-%I'Er?0A*0v-@5Ql'b=V73 ?5#?sI~Xp.k4PE, $p4@Mj`u(30-H, Pm&<{2}90d4A!9\d89!JKT=1eD-Q!@ L? A@)"i^a 61$m$/og.`k=gIe,I43000(SoFK;M(xH*@&3@Fpz]q/@Z$z	pCTvB7&B4@/?D6A."9$P1H4o$ P/9 '$:k'E74e-&R>gv*OQF_P8n2<>[E&3[v |uLZ<sM:=`7['m1`A"T+s64dd-nEl=$=P1Q&\zXs\#='P <PO9K{pFo5rv:0sV#yJyd, 1(L`*R<<@9!8:V<+0b"1ie[8$A Y  < !p  |A P q ` Na   ` E0q= } m@ P  p = ) &}! Q
1 f q WqJ >Al?A pcV! P  P@` ^\- 1  u]]!! 
b-APP  
P b3Q 06p	L]  P
`A&k} aLM2}=]}=]}=]}=]} >^~
 ;file|^|YaBBImages/blank.gif|^|807|^|1008718998
GIF89a    )!    ,         ;file|^|YaBBImages/board.gif|^|261|^|1008718999
GIF89a    zxU~n@X$ocH@qVxx:__-   !  ,       'diAT*E$,`BrI8@<fZ
T4QB;Rh4Cl?pb`,"B{M<{k#o00! ;file|^|YaBBImages/bold.gif|^|163|^|1008718999
GIF87a       k,      @XI%tB hdr&J!A|XJD(mL0Rh*<Mirbve ;file|^|YaBBImages/cat.gif|^|265|^|1008719000
GIF89a    fU{Xj:$fgHqV~~=__-  



w     !  ,       'di0A)c$P8!-4`lUF(X#*blLXElGcU '}h6Dcq=	{}#orn#r00! ;file|^|YaBBImages/catbg.gif|^|871|^|1008719001
GIF87a 1 w  ,     1                  4 4 CPW	\UX 4  Cq  thb&          (tZZ
  TJ
  T@,<     (      @,<5                                                                                                                                                                                                                                                                              @     @  @ 8$   x7@    @ R RX@   @  @ |h     |     \E   [`!    !         tVFL BX	)H@bE3fGB F\Y0[8]@W ;file|^|YaBBImages/catbg.jpg|^|4820|^|1008719002
 JFIF  H H  Photoshop 3.0 8BIM      H     H    8BIM        x8BIM             8BIM
       8BIM'     
        8BIM     H /ff  lff       /ff         2    Z         5    -        8BIM     p                8BIM          @  @    8BIM        8BIM             1     L  f   JFIF  H H   &File written by Adobe Photoshop 5.0 Adobe d     			
  1 "   ?          	
         	
 3 !1AQa"q2B#$Rb34rC%Scs5&DTdEt6UeuF'Vfv7GWgw 5 !1AQaq"2B#R3$brCScs4%&5DTdEU6teuFVfv'7GWgw   ? v%5S#lI>S"|BH))'-8BIM          XICC_PROFILE   HLino  mntrRGB XYZ   	  1  acspMSFT    IEC sRGB                   -HP                                                 cprt  P   3desc     lwtpt     bkpt     rXYZ     gXYZ  ,   bXYZ  @   dmnd  T   pdmdd     vued  L   view     $lumi     meas     $tech  0   rTRC  <  gTRC  <  bTRC  <  text    Copyright (c) 1998 Hewlett-Packard Company  desc       sRGB IEC61966-2.1           sRGB IEC61966-2.1                                                  XYZ       Q    XYZ                 XYZ       o  8  XYZ       b    XYZ       $    desc       IEC http://www.iec.ch           IEC http://www.iec.ch                                              desc       .IEC 61966-2.1 Default RGB colour space - sRGB           .IEC 61966-2.1 Default RGB colour space - sRGB                      desc       ,Reference Viewing Condition in IEC61966-2.1           ,Reference Viewing Condition in IEC61966-2.1                          view      _.    \   XYZ      L	V P   Wmeas                            sig     CRT curv           
     # ( - 2 7 ; @ E J O T Y ^ c h m r w |                         %+28>ELRY`gnu|&/8AKT]gqz !-8COZfr~ -;HUcq~+:IXgw'7HYj{+=Oat2FZn		%	:	O	d	y						

'
=
T
j





"9Qi*C\u&@Zt.Id	%A^z	&Ca~1Om&Ed#Cc'Ij4Vx&IlAe@e Ek*Qw;c*R{Gp@j>i  A l   !!H!u!!!"'"U"""#
#8#f###$$M$|$$%	%8%h%%%&'&W&&&''I'z''((?(q(())8)k))**5*h**++6+i++,,9,n,,--A-v--..L.../$/Z///050l0011J1112*2c2233F3334+4e4455M555676r667$7`7788P8899B999:6:t::;-;k;;<'<e<<="=a==> >`>>?!?a??@#@d@@A)AjAAB0BrBBC:C}CDDGDDEEUEEF"FgFFG5G{GHHKHHIIcIIJ7J}JKKSKKL*LrLMMJMMN%NnNO OIOOP'PqPQQPQQR1R|RSS_SSTBTTU(UuUVV\VVWDWWX/X}XYYiYZZVZZ[E[[\5\\]']x]^^l^__a_``W``aOaabIbbcCccd@dde=eef=ffg=ggh?hhiCiijHjjkOkklWlmm`mnnknooxop+ppq:qqrKrss]sttptu(uuv>vvwVwxxnxy*yyzFz{{c{|!||}A}~~b~#G
k0WGr;i3d0c1f6n?zM _4
uL$hBd@iG&vV8nR7u\D- u`K8%yhYJ;.!
zpg_XQKFA=:8655679<?DINU\dlv)6DScs2F[p(@Xr4Pm8Ww)Km &File written by Adobe Photoshop 5.0 Adobe d     			
  1 "   ?          	
         	
 3 !1AQa"q2B#$Rb34rC%Scs5&DTdEt6UeuF'Vfv7GWgw 5 !1AQaq"2B#R3$brCScs4%&5DTdEU6teuFVfv'7GWgw   ? v%5S#lI>S"|BH))'-file|^|YaBBImages/center.gif|^|152|^|1008719002
GIF87a       k,      @MI%}e*zp,M:h>p~h6ws:9gZ	k0( ;file|^|YaBBImages/cheesy.gif|^|937|^|1008719003
GIF89a       )) 1) 1)11           !   ,        ` .(Xa(%|x 50pG$#   L@A g|Y)iT( v%Z@7i 4Zr}@VcVSzUR-Yf0a@ ;file|^|YaBBImages/code.gif|^|163|^|1008719005
GIF87a       k,      @XI% mh*f(xG4DZo$L*[gTe&S".gc;xC/n] ;file|^|YaBBImages/construction.gif|^|253|^|1008719005
GIF89a( (       nnn!    ,    ( ( bxJYy2-4C*Y\vYPxP!96aVp)3wXI>K-%H7 Pgw7f('5exF'H@Si!`qQ:Kz6Hx{I{55K)eY3L]=z2-^ym0R  ;file|^|YaBBImages/cool.gif|^|934|^|1008719006
GIF89a       )) 1) 1)11           !   ,      @ ` HPC"Fl@`  2@qa 4p@(0?.HG it  B e\Pe Bpi &LPoQ tT1" qJdrM"w|
 ;file|^|YaBBImages/cry.gif|^|299|^|1008719006
GIF89a   )) 1)11          Bk  1)    !NETSCAPE2.0   !  ,       fI)3;)	`|q $&z[\3R'A5nWK(l@,OW.v-7l50!AWCXi"zy !  ,	     S !  ,	     GP]E !  ,     &k ;file|^|YaBBImages/delete.gif|^|1234|^|1008719007
GIF89a>        Z c999k{!   ,    >  @ %H*DH80Q"E <x` CnR\2,H`%6X @D(	 YX"k/p, "}z6nrR<c#Kk8&0isAvH*bX^(5dU3N85kg{M@>=ab1v.G)4~=C @^	<; ;1<gh#Iyq[YmYZA[QxGAG)t_t F=(mH.ea)`s8l;	lFnOq6=#sEDWd!p_ `~)aifey{a ;file|^|YaBBImages/email.gif|^|1225|^|1008719008
GIF89a7        Z c11ccc1cck{cc!   ,    7  @ 3H*` lx@"0(@ ?Z 9r ,  4(P@8m gO @
 'H!<  B1jq@0r` RH![i~t xx]&L@*Vx/+f$ re/R`mXJ
CPa%>K<'(-JA)iviS4XyscIu6/^C& 8|(=hl PWVKT}UjR$A]Z&bpPk"kZV}5[m+pGW[1jPm,&uE	f#ie 16uPFSoTR\v`)&V ;file|^|YaBBImages/email_sm.gif|^|937|^|1008719009
GIF89a       11ccc1cccZcc!   ,      @ 	(@X``HT 8< b		,D` &K^D!Ej"b s *U &/A
d	uT4VH[+$?<"  +@@ ;file|^|YaBBImages/email2.gif|^|1002|^|1008719009
GIF87a         { ) ) )ccccccccck     c,      @ %HA	$4h`@DH . p4  A>nAIBqaC	)>,P@b+J3\i 0@*Lu"VT'M-x4@|
$r@
  Y(V,Lk	52?s@p_CM ;file|^|YaBBImages/embarassed.gif|^|949|^|1008719010
GIF89a       )) 1) 1)11     s  {    !   ,        ` 2(Xa( HE @q G"I D&Vs78PfC IIIUC@g`!* b! bFv`LsU^ ;file|^|YaBBImages/evil.gif|^|267|^|1008719011
GIF89a                          )) 111)           !   ,      @ qdibEM]0K{uX~	Dr|K&$9K%t	[Gy4`	@l 8Ei@E#-IbZ+.`d-0
-4ehjlM"7up{lnMw! ;file|^|YaBBImages/exclamation.gif|^|171|^|1008719011
GIF89a     Zll!   ,      @XH	T1@p Ax0@x|	1S{GM*fC:iKThR>:}64g/ ;file|^|YaBBImages/face.gif|^|198|^|1008719012
GIF89a       ZZZc  k    1111cc!   ,       sIm}ePIKrM@AR#!C8ifhCCN<h:W-]@c"    ;file|^|YaBBImages/fade.gif|^|572|^|1008719013
GIF89a2     !   ,    2  qbHrL	DbsdJT^jwd9e~t~'Hgx8X8(Yx	Ii	:*ZyJj
Zk;+{<,\L|l<,M=m]}-N>>n^~>._Oo<h0!"ta)FF-vq <)e$Sd%2k53M7yB=+(J2}jiTKZ*T[Rd5,ju[.te7\r[/.1f+K95wh?.Ot:ukM9{n|3<rK^z{G=<'O|Go?~}@  *XQ ;file|^|YaBBImages/Female.gif|^|141|^|1008719013
GIF89a    oUop{      !  	 ,       :0IS2Sc1YCqDE z.
00T,C0YL ;file|^|YaBBImages/flash.gif|^|1066|^|1008719014
GIF87a       )1c)ccJJJRRRc cccccck{ { ccc  cJJc c,      @ ?H>@p!"( @&X &2`A(( 	G^!Xp>'hp!8zDPyJu4x!< B
fz0VA
\T2  
>8@ eKTU*+Ucz @[_F@
4(`CrZ]xc$V[!1\0	BxrB8|PP;hj _= ;file|^|YaBBImages/ftp.gif|^|989|^|1008719015
GIF87a        {    )c)))k{{ {{{c,      @ H,X @ "p@" (\#Cf@ $DHF]RdP .a.0`&M b<`)\-[d -r-@aSQ*Hj@SEjZJYMqM.(zV6cS ;file|^|YaBBImages/glow.gif|^|989|^|1008719015
GIF89a       9J9J9J9JBJBRBRJRJZJZksss{{{!   ,      @ +H
*LX0 0h ! Zd(A3\52t8`N8sbJ 
 ?-
` QZlP( Qw)u+J^e@$|U"8$ +	N	0` ` 37:/ u}m`-@usH
VC ;file|^|YaBBImages/grin.gif|^|940|^|1008719016
GIF89a       )) 1)11          !  
 ,        @*(H@P@@0E    @ <0$ (rc8'H: x`(Q h@uAL }
@YtL|'V*	\ ;file|^|YaBBImages/guest.gif|^|1297|^|1008719017
GIF89a                
		
-$8:  :&%$$.1.1(%1,164-959"f"0g0=l=?aEB ])I6)U8-X14kuk"l%h&g9u)r)v9b,&|)#FHNA/\D'zQmY-uE'}T,}Y2w`ku(yj,GGGWKB[I[VSVKSyNl|b_ba_ohRfa_rfc]cbcicnjjja`tjk{pbrqnqso~xqlzuzK"C,C=O>P+E%W3E7J<M9W8k8gC/S5J3S=Z1L;@;T?f?fET_JCTDWFZHnNvUHeOfLaScVkXiTx^r_ycz++%%++77!!,,33==??;CC7LOAAMMWWZZVdYYccllnejr{$18)7&	;?39<UISS(X)BKTfh1z"n'z$^`egbdI[X] b}hqo m!v$l!|$~ V~86'0#;(1!4-.7/">IigGGO.5@\~lj         ;@!   ,        	H@;*TA 4(FqA:|;#bAau @PJs7l7z|GS@|eO^@Bdpb@x36CGzXBevbq3k0!E)Y
WYb|mf
"[2[feR1BPv5FV|,Z&@ 5Yhli5FaLI/	KPV*i"E

-2a2 @zZUAB8B*I@	%pFZL\2"2<$tE0&!bH#(rrHup"0H![!GI;!JJ'a1GvoprI	- Y.Raq^D!+"8x 0V\QHaL,rCt:DF,O@ ;file|^|YaBBImages/help.gif|^|1169|^|1008719018
GIF89a0        Z cBBBRRRZZZcccksss{!   ,    0  @ /H<*` 
, c;.8 0(OBr%/d	
 py& 	`@*]PB XVC	@@h5Kri]:Vmkm[@C18#F`K(3tsR)!JN^Z%\ssVxw<w,$haKNca/HQ#nnX|6JA0aV>^G~ef	  {WUq_7K`Lvhy6zvJ'8!L@v$b0(c4bccB ;file|^|YaBBImages/helptopics.gif|^|938|^|1008719019
GIF89a       c!k)k)s1s9{B{BJRRZckks{!   ,      @ H@p@"EL F"H@   pa 
(0A 88RACJ8hH$)X8hr(' ,@5D tfG(i ;file|^|YaBBImages/home.gif|^|1274|^|1008719020
GIF89a5        Z c{1ZJZ!Z)cc!!9kRc)!!!JZ!J!Z!k)!s9)))))1)9)Zs)Z)c9)k)k){ ))B11111119191B1J1Z1k1k1k1 999B9J9R99kBBBJBRBRBRBZBsB{BBBB9JcJcJ RRRsRRR9ZZZ{ZZBccccc1kkkkk!sssssk{{9{1JBkkJBk{k!  } ,    5  @ H&/?x939jb xBGH&CY9N&X`R @tQ8AuhM m4KX 8Z$!5Qd4Lu(WqEy:JLZ+^o*|#eZk 1L:Li`
60A@\c{$I^?}f)q<8(0ni
d[I3yF;g~qv1>< %A' K,_} [!|Wt 1`aWG!H[J%$_\eE
 8d0q5tBbnh D)< CQ` ==wtx5$qwY0A	p Rl&&rA']d'wgxoXj&(~(B ;file|^|YaBBImages/hotthread.gif|^|165|^|1008719020
GIF89a       k !   ,      @RI+
  Gha	eu@C@YPhR<8,%5 |  ;file|^|YaBBImages/hr.gif|^|151|^|1008719021
GIF87a       k,      @LI%_'XGx
@,F`\~Z/*QQ%1ZU%;g n" ;file|^|YaBBImages/huh.gif|^|955|^|1008719022
GIF89a       )) 1) 1)11         !   ,           P *Tx`B|HQ+"c9~,@dHJ42@$Y   y;u A z&8Pi :-SV]k
eh0`s W \2 [kkfXp@ ;file|^|YaBBImages/icqadd.gif|^|288|^|1008719022
GIF89a$   qpr``JJ770# &         !   ,    $   I8J,[ tSvbF8t ._p2VXb!q,nMq\V%hJ'iN^}]}56 \]]b%yC.	VDby#4W6cd_C&LJ:zDAst(9wm1.T	1+HINP?+,% ;file|^|YaBBImages/im_config.gif|^|2035|^|1008719024
GIF89ap         c Z cckks!!!))))c1111s1{1B9999BBBJJJJRRRRZZZZccccckkkkkssss{  {{{{  !   ,    p  @ !H*\CA HKD">Z HQ	&K8  0cISKnSI+(BQ z 0ZBHbdy @ )BD)@ @bKVQ8Co )(Q!xab*;Yre3kg!<d@E%><$L[Iv9_1 [$G2#\p$g`3z( I	t djQx[PO-UwqXL@0P!@p%aQA K!M!Q%![r)x0VDi@,1lLD9CdD1X	Lqj14nBi$n0O+8@0pK  I@ LiC
ea: d0A)DD``/aA	&pEV0T7r'&V#pVYYM GSvHL  8m\s	V^Q#8J$(!K!20LpaR[ G)R@;jI@D<d(26|@,4l8:? 	M*:%\dKt[a)(`ALFDl%OfoS K$[1HZKH#N^zj9 mCp	NfxL,1&7Rn)Lm6K@,q	@Qs-IDWT -`W s{WKA{Jlau V8	`TaWDKJD,;XXi5Wl+YViIR A ;P9;+
F % P%3HL8 Pp	 08`	FbZDGbMu1 F JT0-H/|` xAD
]h^Qz*c"@Pb0u(Cs&3:Ar<DzF 1%Qb 2*'IDL/uF8[r@TL2f:4yd	 ;file|^|YaBBImages/im_delete.gif|^|1674|^|1008719025
GIF89aO        Z cckks!!!)))1111s1{9999BBBJJJJRRRRZZZZcccckkkkkssss{{{{    1)  c )!  B ,    O  @ H*\P C"J1G#%&H 8X#K,)01"% O 9l1Ey  "h
CL$U9XKEN<8:@qx{_|
Lo0HP	xa1Iaj3g ]zH#X!(wTQ- (En
By@zX;IQ.Y49s&3?DUF~zF%8@H Pr;xpT	p C&~*Bf^z<RCd USW^V7T) AwPG^OIu$"{<8	^xkz64tAUjV *j46AeZL$A}$YPr9Z}AyZDl8*ByV"F!'JzFS!` IhJp[90II(6UP/0+ @$FR:BYa. 20$Hn@PW^JsBHG_A0P@)lfynby7pepM7Z7h@gO[:3ZwgD@bC	'J^xn8w>7B"A;(:O{NR73|/o#O"P@ ;file|^|YaBBImages/im_inbox.gif|^|1792|^|1008719026
GIF89aK        Z cckks!!!!!!)!!))!1)!1))11!11)1111s1{91199)9919999B91BB1BB9BBBJB9JJBJJJJRJZRRRRRZRZRRZZZZckkZkkckkkksBkkskcss9ssZsskssss{{{{{sJR{RJRR{{!   ,    K  @ 	H*\0E#*D	4!6=8R'M<e0c$	-IlO^8@ckX  PT?*T4& @	E# %
!A,/_|
^BB&	)H'WE(C&8$^TD|Q#gN*U* 5F8q*tBL:!w?t$]vGh#rD8(-$$AA[<"Wx*!.("MH9#<r!{q*EtTXdlS;aB@rr S)c"VH  	xxe\	V`AW)B+*7Qw)j{TDh2
2\@ ^F 8R$"F[$PR`K4AV(nE+mJB "pN<E
L"'Y+dMy+:D
/C6C<C-8p[IkJ50ID"ir@
 @GF!k#F &l@HX	b(2t/IS}IXQD](RQe"	hf9u#7p\>(]%SUf*RVk7t!q@M |H   8S}~H5T@QTDr&Ih @,41^v~9L0Ip
*zxOj=BB   nS^S!UK ,IlA, 6z =!	 ;file|^|YaBBImages/im_new.gif|^|1845|^|1008719026
GIF89a_         B Z cckks!!!)))11111{111s1{9999BBBJJJJRJRRRRZZZZcccccccckkkkkssss{{{{{!  J ,    _  @ H*\aA"H(3.:dH9KTR0ctM\!$@
CdtXd%6  @rC JdTK* 0@QKp=` @ 	1[L8!HhA+^a!6$""HjFrC3'7S<R@6x(*e  `A P\B 4
T@?."Hvd;n")`{$G?Tl9%D
h`Y /!~ZieG"q!EN80J)X2*e	$`Hf3 \Y@0PWWH@M8yC7
#;TyCHe,T U
%icN8D l7.vSF-a  %(] PYKnVy0I$b,~	dje@u()HDA'@{&6+xU;uk"D neD aK-yF0Lo
Tff%	 #QrYv'M18AFLQO1d "+	Rd@ =k&Yg1S
 Ft yD]#,
eKAvVjDyH`@	^qxR$C<UhpK%Av 7t5TUTp5})-Q	*TYes-`%p 4q =Zga[0|J }}R_@hJR= 0}~R0zim E`$aM DD=bWEG!)(@zp>*Jv|`XqND@H"Hb>{$  ;file|^|YaBBImages/im_outbox.gif|^|1810|^|1008719027
GIF89aR        Z c ckks{{!!!!))))BB)1111s1{19999JJ9BBBBJJJJJJRRRRZZZZcccckkkkkssss{{{{!  S ,    R  @ H*\T"JC< T8rWN
*.c9QD4ReDqT` 0p T2\5a @ 8@ @e   "XHWhl8(E'TA+^#X0K	&3JJ0CIi,]^I|6"oJn6[[" Uke(k@T%;jIW dIK
8i>J7 }]{ 7!D68yE(L6Uxk(<qQD"G%H9(0bX`
\<@L4A")Qf$9tyf$~BBPD=	IslR!soNH&5C.)qR,A0CvI7F R1)FDKFg_@GDP

0k&^VVKO>8!2@AhJ#2gR$.kGA6v*E3xpRgK/K!jN/!Q40$3eV%meADoDPB	p0CD)nv#aA\qC
-TsDD UDe,!! A{& ++`[)TUM]^S0 koA-G5 DnN[+tivTu xB (PEeCflkn7(ox
Qd'ue}5{t(1uc:R'0P	6
{p(gZ\O%U$`%/"HB^PA	`ZEPQTP@ TXP\(L
W'A	^ ;file|^|YaBBImages/im_reload.gif|^|1736|^|1008719028
GIF89aP        Z cckks!!!1111s1{9999B  BBBJJJJRRRRZZZZc 1c1 cccckkkkks  ssss{{{{11c1  c    1c!  G ,    P  @ H*\p H"JBE!(8H#S6 A0c\"j`E x"?Bh O1  (T rU<$i X:Q$R+>nOLOHtJ5F#F mgH51EZ%Aje$7	$T%kl}e  HRehADGON1B$ rK_ ;@CdDm`QL 5w)cj <Qj%H	AC("A0
4E@c4$Zx!vU9N4UlM!V3t9[A HRRK5tGqux'2(QDwWz	J4R{@$=Pgp]w]niuD?@XjC j2*E~.,gjv I')`.URf> Oa `pQ~aIJ6aZvB+P	"6QEPQHmc
i$M$h }-S?  aicM JDh)V4@J@ZF OMh^zQ2(vU[mE 3|UH@'|URJqTV 1[L@ ` 1xV$)+t'P{pRK11Q?C3$T1^?:
ynz6ay4z{^)$I	q)f^7IT k7O^D?pC
hBO 0 o?lA ;file|^|YaBBImages/im_reply.gif|^|1282|^|1008719029
GIF89a7        Z c11111{BBBJJJJRkkkks  sss{{1 c1c c1c c c!  ( ,    7  @ QH*D !0 @q	$4(X`  CBD"R@`0&8s @?PB P+@%lP G.@|PpC JBn t` L[*| 58QB	x`E i]U; (p!H"']^p};]i0	`G1$Hm{5L?{C&C'@OU`Xhp5 }@&8hp)uJ# R ,LlskPH\DEo$hc V=uSYsdu&ney84Ol
H4='xhZ%e$6^`_VJ_@ ;file|^|YaBBImages/im_sm_newmsg.gif|^|950|^|1008719029
GIF89a         B!!!11{11BBBJRccccccc{!   ,      @ <P@P@
8p
 4q@Ep( 0@ `ABPI%I	T\!6adBS4}*`@,k<J%Z?	 X`%[QVl ;file|^|YaBBImages/im_sm_prefs.gif|^|956|^|1008719030
GIF89a         c)ccsss{    !   ,      @ #HP D p! 2lH0    dH 80Kbi$y@O88!KgZQ,iF `T"$`!sU,8 F.m ;file|^|YaBBImages/im_www.gif|^|1360|^|1008719031
GIF89aC        Z c{1ZJZ!Z)cc!!9kRc)!!!JZ!J!Z!k)!s9)))))1)9)Zs)Z)c9)k)k){ ))B11111119191B1J1Z1k1k1k1 999B9J9R99kBBBJBRBRBRBZBsB{BBBB9JcJcJ RRRsRRR9ZZZ{ZZBccccc1kkkkk!sssssk{{9{1JBkkJBk{k!  | ,    C  @ H*\(J:,
<1 C	 d;yR\.PMe\`I8@0gh9 A(S 0:l,d.`R-@aA(2@`2j:w{d.0s#KLc3klq0U3F4X^2fR!%*l@aDw<HQ*X9YJ! !
L1wxcb{]<k.5/M)
qgP&v6`1h ]|xc 8Fr",GzGUM
[\A@	.|DX -beI5E
 8d0WWT}%\S55eQs|h D)< CQ` epzxy_m	P%0Es"eTz:gUXAIM6z~-QubqZAZ&K"[,Y(mf ;file|^|YaBBImages/img.gif|^|1041|^|1008719023
GIF89a       s !1!Z!s 1k)9199c1Bs1RB9Z9sZJ9cZZccksZJssss{1s{{cc{{{scs{!  > ,        H">XC (|Ha3 =B!(S2B*AC)jjx1GIa,V @O A4@ a$(Wa{40@ 
0hvc:(D ?v ;nQ#Fng&0` #39R]Zs=tj)m/ou@  ;file|^|YaBBImages/ip.gif|^|1018|^|1008719033
GIF89a                ?8?08O ` h p  x h  P_ pP/@_?@@ H` Xp0@`0PpOHOOP`OXo_`p`p 88@ @ @ H P X@XX ` x0X0P0X ` p p x0X/` x0xPx@``xO`     00??/0 P _ o p0`?pO P/_/`?o?oPP   ?/?O`oo@PoPp_pW                              W                                                                                                                                                                                                                                                                     !   ,        C	3*g<O@P&lQdJ!,I3RPL K8A0$ Y`	
	iPAG+-:F$\(C*Q%a%R8@2f!ErlHxC"3!I0-v33nnYf8ii%rt5/*e@v@ ;file|^|YaBBImages/italicize.gif|^|155|^|1008719034
GIF87a       k,      @PI%; ZhXlJD`x3Xwx E!2*Ri3t[>	TtTx0 ;file|^|YaBBImages/kiss.gif|^|369|^|1008719034
GIF89a   )) 1)11           s  1) kkR                                 !NETSCAPE2.0   !<  ,       h`%BYhUlqPDQ"17ASl!BWI\*NrsKDy&XX	\KkEMd_v)P0)M	&)! !  ,     `UE(*QI4% !,  , 	    `UDUTD6
Tp !  , 	    `%TMc8N ;file|^|YaBBImages/lamp.gif|^|936|^|1008719035
GIF89a                o`  / / ?0 0 ?@?_/`P_ ` _ o_`@pW[   ???OOP_OPPPPoopp @0/@o                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 !  g ,        H`%3d,"F	4,<CCI(+FX+?xH,\ !RTB	)Sp(h,GX`MDQAB!N3 HD0P(z58\=dk11  ;file|^|YaBBImages/laugh.gif|^|937|^|1008719036
GIF89a       )) 1) 1)11           !   ,        ` .(Xa(%|x 50pG$#   L@A g|Y)iT( v%Z@7i 4Zr}@VcVSzUR-Yf0a@ ;file|^|YaBBImages/left.gif|^|150|^|1008719036
GIF87a       k,      @KI%}e*zp,M:h>p~#
l:wHTMuZn-4x  ;file|^|YaBBImages/lipsrsealed.gif|^|954|^|1008719037
GIF89a        !! )! )) 1) 1)11           !   ,        H:` C	P8a	hH0,9@  \*5e ,Xr.`   <Xz  
X BSR*5L  !Bf 	,\rp7n^R+0  ;file|^|YaBBImages/list.gif|^|159|^|1008719038
GIF87a         k,      @TI-mAC8e~+`xm c
%/
R9 CilVp ;file|^|YaBBImages/lm.gif|^|5791|^|1008719039
GIF89aAd      """7775R":K/>$=T-:Q&;[D\*CS)E_KbVz%JcJl&Kk:Oe@@@QQQHZhbbcsssSfte
hr(mnfwofOuhwdoW4!	  ; ,    Ad  pH,rd&'tJ.z/Wz>|#y=U~QkCmzxjNvFVBfE:=88<:8]GG99=8=:5;n=aX<v9=>;>55412/.)+Liv9{UVq>r$.13~"mwtP6~!#DT @@@*0%+_VULOd>tc-\l$*aG=@@x&@PYMp;"/x` 00WW$lkWQ<`p ^rP{{l CMXu#l2k%M6ots>0,a%x:%DT!euwt1%q0 &X	bfJ-5 AS~yF%A
4x#Z1@:XGrfhpAu
1,6d/]1bdvqn_PZ^EgH;.H{PCUq.!=pw)cG	"@Bz3%
"$(8Tw_S7eL9J*(_: -5zPqmO7'#p.9beQ"@ o9I5b\`hAC}euV0p@4$Nhd}=B"8.tiN	!<%f>		`DV@?XPOc-1mI,n:u\3A|\:m+ZJ/
-> LRxm
kFM, CS2bK[D5k^-	8`oG/4vU@N`.`\-v@BQ/Jm.;e}t	/2Rs{C	{9"a3^@@ d@(A	jnU~y'  .52c/@2 |-@6	IQ\O<`U b!\N_9(d f v 9384`>Y"r ]2@e9 l; C1%"eFn}` ?: PcA1gp3'6qlR|g%(Lz\  rWSUH EZSttB9I3%t(8L";}"6)C>H
P;v
(F@&!f.hf38RSd2vBc:j=u6 RJ.r@#9z~/+-v	R0u` 681l@ L [%	4Ol iP(_"zY2&U(;@K\`3T.7`w`$,
^9\KF*R\I0Uud&P [&(&'80	) >!	JRE4T$HM6ZB	aCl6
6@ lPX* yu0  :0SQ5|lS*2?i[2viTV{   )>|!A,P	 VU@uV"WLQ1CU[Bm*o*k|P@~[X3AFs!.e#2*^e)LP%m	NV  Tg _ `~8"[q"^ 3<{V22djC;A.se['  Q HxnXZi]Bs  ` np5WguYhqg7Kl0$mE2w,VfBiT"@A ><AZpQp*  [.  (6*khMNox8N	` gWV\c2 hT!O8+7ZbF6
K
 `
@
J`t .WM,t%/] _pL]7{y#-q-<>5(cU"H  ybP5@~  .Al{j^ + @at:[lcu4C-gs\/pW 7XLq6	 zO}_ j&olfttBq;`t6(wr'xbqWU FAq`4<YcvA
V@PWr?sXW[5 0 y; q {30~+@S7~ `-0XXr=yB0 ,/hJhPhGPPf'rwMC}f6?p6;LiF.47U7zvxv(u<9 t(wE UqQflO;{%xH^Uq~U(r6wop\DF c8d'&d[e^;#8  p:rl`c*ptb'
p5 3yu9~-v\F
<`2Sg`'@1`N7;"eyso;zpw;@hl&k\ihDb	l[HwwX=_48OeOCAN (azI{4=k9
Xk=P_xCp( h6*=`t xBgE	[8u=pe|
b+\c:vN}4`
}pg@X @fgU{*j( fuK[\ tTh|<=XXF7t<@m!^ow'edY&w`H` Rx`lx#2HqE9opFP78HqN	Yora#WlhW0&~!9rWr[=PrH8N8T{%df#&k%QjzzlYvM)YY y^&1h4]6%f.yJv,S8HDi8Pd$}sOF#m&ZsPTc ?@0,s|DJ	`u% fie`3$,1|]TZVJ9\zC:&}
`_xr>P?piLT 
\v|OEh0-ynz=;sUj]S17yj	yW:@EiS_HP`pJaZ8'!++q	U`0+4T:Df8L5 ~Jd
(U["JVGKUr*c]#6.'q;JF ^ !!0H1BY>WI>;"7j*WFuw$zvbagEFiI|AsT?%WjNFkFd3jT`%G{P[}:U:YY/mQ;N0uLAIp8,060E&U P  J-`oaB0iiG`{+Lek!r'v)PAU=MRjq6I%B6pQ0rP70 D05S0D8 { ;-`U@;bgU aiM
WyARNT`*-4@7E@Ytk*pAqk{{^+j7&)s5uM[V0"EBriJPj@s'*HC9pP^:p+`vv9,2@0{Lp)Wko{p) pulW, p|uq|'X/tyBvpy\\U/[c2=$&|*<0rC2E: 7NlmtmXo;WXYeE=-ykX.&2P'-X+@,3tx b!..\$uB;7R($\(Rj40~Q`PGx2`)^	5-Xp6BPpp-*2+`MIv=T<\q<'S\:j ?mw1Px?HIM4 $lLtl9AN{ P#mqU x-G7-{Gp,rh-plM[(=Lw5,9nlsET14mx6mSU=3v[(Q MnX5&po9}ok`-0</^2.>z9m+P X/gh.IP1 ,Cu=?0=+FW@0,02>NB<\@>=@yN{> >}fUtA ytgoP-v~d6P}-OESE[]\ :sTpVGAr|-NE|h e^7,Yc3T;#N,0NLSu{U10L n<*-0+[M>o*_0pHPwS/+V<D #SOTOWua,lDgj(AqK=UjQ;84@ny95AE{h>tpZOk_|O>}~v??	.@?__A  ;file|^|YaBBImages/lock.gif|^|1043|^|1008719039
GIF89a&                   111999JJJRRRZZZcccsssIs;{?G^Yj,NPTPb]A]Ufgxnhwvit~}                              I                                                                                                                                                                                                                                                                                                                                                                                                                                                                        !  ` ,    &    H	GI6pC`1b	(4x$D-R  M.|8'RDBTe0 `%J6U	HTYiW 6$J:viR`"DnpK5 D-Z%xd\7pB/_ KF\bp`b"<;.f`<3bn
v83(XHK ;file|^|YaBBImages/locked.gif|^|960|^|1008719040
GIF89a       !!!1  J RRRk9kBkB)ksss1 RZk { {9k 9 c   c!  " ,      @ EH"(@bC	"6 	H 
*&TXBb F   882B	'SlypQ*M"HGj5@ ".dP20:L) nAe5RE ;file|^|YaBBImages/locked_poll.gif|^|267|^|1008719042
GIF89a   Rsk#4@1@J!'0l c}|zc9j:{9QckB)1 G  XXX!!!   !   ,      @&xey0DpP\cBa $vv!x;cEY\$FJ3*%Q`?Vl=?UE+c02bH1Z/Z! ;file|^|YaBBImages/lockedsticky.gif|^|264|^|1008719041
GIF89a   k   c c k 9Rk:{9ckB)1 J   RRR!!!   !   ,      @`&d"mp'_F xa;xdRYip}TXcFA$ eQ"fg[UWX^<?5XQnkkn	kln
1`u! ;file|^|YaBBImages/login.gif|^|1187|^|1008719042
GIF89a0        Z c                    RRRk{!   ,    0  @ 9Ht "00@1d 5|A0BY
 jis'918!2*] jUU+[X@]kU2KW);p+>k3hYlhM:Tl
d(ac'6Np /m0xh,(@3$dlXwP2vKZ0tnN>}Vd	 6@i_AXNF5 
pg4imnlM9(D:#@(C#Z%YP@ ;file|^|YaBBImages/login_bindex.gif|^|173|^|1008719043
GIF89a                     RRR               !  	 ,      @Z0IhS1E)$)Zy&0Ckm aH$*r8(
A:`8\YAC.\4M
;Q  <]'" ;file|^|YaBBImages/login_sm.gif|^|1018|^|1008719044
GIF89a       N---, MH5-;+O-&` $A00& }z'Oj}df^Sq,Esp]p]eU-,,`t&s]b3;$9>:$=H6nv]V-C\"?>+h6E<6>2!/!	   XJ8754'WZ  5+u) \;6.v&2 +"&n#x)[N;EC67)#]& x)(*#KF7^AQ Yl8^^
 }_-$98"^0#vgy;@4!.(m-2)                                                                                                                                                                                                                                                                                                                                                                        !   ,      @ 	L &8b,c={0 <i@@>VPr5$a9B& CN d:}8DBAwdxT`D~t-p`6 UhP@
0) (
@pL]!"B'CBB
h`AB6SDr0H1'a6ffxK		i@ ;file|^|YaBBImages/logo.gif|^|12968|^|1008719046
GIF89a9`   	t4B<2XgZbZWi|(@FD_t##lf<JcNqdp!=]&nHC:1Sk\ny"8K20festtZDn\T@Yg%.z4_GXaRdo|5:?	kCEODr^)E_TyG~~genRyNh\AXnBlw'&,Y}Yw-9Qyh||}%Jc,%#\1Odc=Ol7THLMYk?etm~>|CRITPJ8Zx$Dl8kwfkdMLC'61<642AxDz	_o}fX>lTte>Pb}|rsXZ[^*CSVTScdd^p<Mml[kskmnL<d.1PV|-=]4nq}	F>< 0@Kb[*+.1+#&Ml7;4FDD_oOp$=T1WtzLj l_Z%!wWNQT7l$ydXR\ rl*"!>L<fW~T~M^n=r->Rmr|!     ,    9`   H*\#JH3j CI(S\0cI8s@
J&5i$"?VuKp3=CyrMJ.I`#:#\f/\|#O~mB%Q+0[v#K,HbWJf1A9N0mR:qTqYt"T8y>;  Id?aBUm$wr;t3,I2_I?AFEJ7sf?8?L2<d1Tu3109g|'$O7	!d(Y\(QHI\$%	h%]ae7qB!)8c7s@ic<cp*vBd7,rfT8_|j,GZu?9#G9!X8<F5sxvJ,	|$<lP0N	M|!<.3[@kej%
[+TUhM^w)
sYmoW	,}t |	\HVH  0$(&,t&	'9##}8jJ$mp@)`W[Htl0bD(mXc ?p`KeaXpL)0$sbIXF*x[73|/tpk*>Y\ii-EU	fIX,/&XzS/}r8P =vH^\DEKT-a1;FdOP{3vG'kihFjUQ <|xMD, |Z#'<HX| R	R}Pq=TpR	rR_	Oy@ENzNl/	aS
/"22J$})c%/i\r;>!t3AgYoP0I@Cp,7O"T(Cy*@*P|e,cySR%b)Z0iK_rDfff(OyJX6.iZ\G3LS%/7p>hD,I&/er xAN\v:Mn`FYb(YH.	8?pIsx(rY&:jSvBLjnM7?iLsSPqJTE=Te*U5FRTt`-Wi
UaWMk>\i. (5b|cEORhe(#D_Xv ,zU mMuVV` yRa'yQ=yP
jA1qZ}p[o]{oh*A(=Xmou[!Av7!Hp|k
^#6QC(PKLOfYDLnmPao${pw
8p@o
3">@d*3aN2ePTAHf2 )8y]%C^2(\e=?U3AA9i]]0Dwi3(.7NA3O3HjW|`81 BskUAhh2(Ph_ZpC%5 0Sa8
L'YtZt8k},g"[rhm V[6f Ne$;ah<,AY2'g/2>A^4hAb\3[T)g4
1wiUs<)oAddZ
)[<cS-/{c 0SpU6@hA3NZ6(P) K>Mo|@:_AI,O)@+2	| A,pDa413 v?n.E# K:y`Vuqc3{9L!}cFf,Rw2s-wt?X=0j3l7RiF_shu3X'^w2PjN SpWjExeP*P "4qyrS=wzJ6u-{s@{MU pQM%pU"%7|w|geR 'gYv}e>Wr7}Uf~9w~Oee@WigFuT{NV=@	Yt7g2k 8dXpiHfmbu.sTh0s){chg
Si)@= P`k xua6I@(4cy@KHX@wo(vPPrwf6P6 =ee|7pY&}wqP"rU04fOstXfFgN)`Nus5U08sW-tc
;g
U0]iS@[idpe\f  g(s(ss{g3{zz-@uP`ueoj2W||)tA<	HoHX=Dz{{Gg{dikxza
|6l``Pg{|%dpsXX|t~N>q3f eIFf(c 09R(P %xy}HusgL+9-1`F'NcxJf
vitt-` osw@xagGvzA	m Ae=qcz ywvh`tbYzgd 6@R} ds b7)`rt()|2 U . i6.3sHw}h?qL`WN  Lq	)Rrs=6u^z8J wFux'S``)={u{4m4mQ}	@c=QS2v	)sgvp gw8Gk_u3m6K: a{'qww(XsgPE`&avu5hZV.@=PhXvt0+#`tZu|bTx Y h680tuWixsxGsTww`t*	'BvZ~)Fax!@%xzI@v{vdfiT~ I`_ epa}yYM


eUr#gg eTp4 fGGsXf
 ,  &~>s\0   
`|3@W>|b \@l@3vXwt0Xup'(q^iy	(20 g%08xh	OHVQTUJh;zwCK_z
y#rtX~})d!YiCzIYwez) g
@K0\Aq rn"u]3P@ L@
t q9.Kggrt\'jq=kghgu2oI+($vZI`zwzw=& .{oyrt'nzH3jBRswHV }))~@ nrV~ \hPNyfMwft{ZH
hF%1~h>
tI3w) dxgiuf6ehOpwA0S3z\ Xw@kh'qHaPpJkdP 1rN`d&6`vbX|a`@/-Rf``	:Oi@;yNP_ %`iV OA@e=Lp@ d pv&]KeIu'uFg#(sqsFF <mM]*@bDXVH'U@ hrwlZk%?dLg 0.lK1sF `- g 6@m%;Pq@KJp @5ddn`pPe\pKQ@ 0Ll, 9	hPPOov0pNh]\Irvxok\P'V})Hzpx@nYj HgI6Xh'WhMgdX@SnO@
g 3 ~7P %P60	P	lq==
^pPA k@
A  U0p8p=`P	+>5 	0	`PL i	wjQu~WY)&XQo_Vx|H\InV31c =n&p	t:ZK_qgdn
K% +L0N  N `
=0A0 UP,Py'h`	D0 0g
@nt A
90PPYPhkrFwf^Sehu q*C#i/o\hUPz^6 LPl &SJfnI5IR9%?2UBLPL]%	 8)$*8t=kP"AUx":UU&2iX!8@ZFf";bC	gE c37Qv-5UR<PLj\r1*E4)ZLv5yd'L)3HIknkZpSngV$m/G,yrU?gJyCDnfx53e Ebqk:@c*0I
g&'*f^8f- Bv&2d&JQ"8BtX%V8(!fHjgd5zxB 3/!G]V
yL@F	#pDf	 X,BFh
hh>WE<Fl4A2&5,`Z2RhI!<Rk 1`%h!TNdVZuE
9s.;uL^&0@R(@4hD1$6PHVd`'ph"bq^E!dx6^$PG'CrH5]IIr!2IVA?V9b.i4at1 +j@&5i5\bH!\)/S(QIh$3< ;nhA@LRR-k
[!>X`-$N5KoW.g48@*)! HA00 VV`%~RYVjq65j"j)n8dP4 #(Ns|T#5rA[Kxf.#\PBG 
x@h14 bT	%ZZ^42T
@y&C bQyeZ8A
Nd@;gJu,v[Vo	WuH,o
q3dF8<0JT( 7c(r	v4Z9A_D9j0tN"9"qiaXdLdmT'<C3,DcCY%J@TdX(qJ@A^4zF t4@` 0E	y OL87ZR
D0(f<W\<c&(?TI!h7\p1gnTs4 h@+:R@5x^&4cAy ihLAC%C:ZJ>HE4RW "9 P":=4"ULlpLU3x`t! %R.	(-`L	G "(Q@Q0dCF)B0dpOFFxGEdCs*J
i[TAn<MPGJm170rEWkc.Nw1@. qLXA5\B&Z: %u/8,@/76(A`a[$cX g7(Pd@/lP }WF4vJ/x q1x`(a#h1 kQ[XzraEH4`TJG%1@)PZ\PIe
-|1r/\o*g
X9fzn#=R0*b{D`y v ?b  ,x>ITb;q"@P2	$a;>D
.a# sA *DYDpFVbO_`!aF&4ehiC<q<H0q_D1ao1ha?))#C8,:	5n^2~cusB*vIu}C0u``@&h#WxJl",`c)#$`0p!
NR@b	N #V RoPa <0J@4 t@DXC 7JW; W  1LN28D  '[ t1fiL	9G OQP0PZ@5-x[)[95Q5WxVsiH:^@18h aBh:"Kb,h}L:xZW P$\ #@?h6`*Ah?hXZ8D*I`h(jv 2HH.8APC0XFpP xGl1NqrWJh5UFHPPOSJ/3R;Z#p2;BXK#4qD 8
(c5GF(D@ @X'{Jq4Q  @q`}p(H{ *ZF@:LD(*I, P&yJKq((1DH>jTD "uPa0j(</+P^8w)N #@@o` oW()@8|7,:N|8GEl 1p-Q0&Z$t)4x<P4:`*Q}%q@P"\P)'"4DM,fXG Y)!kT3PAH{ZH"dMD@x7 }MEFPpaGiG?p=,,|H1A8#SvQGDhZhS';SA4xL y \I&;g' @	 ,@04M*z))R4)PM!( Vc;oK.T;I*+50RZ*9STx\xL<Ia3-x	p?LM[PV#4h=[4`GrR0 `,Bt.,qyN@0"sRK9D.3v$HE^RkO0 -FU)]uXL")-XCiSM N%Z}%mZm`7pZeUZM}N@ZZ}mDJM7MM4ZeWm* }Hz}pUCSF`MZJp%L7HZW`ZZ7P7p|U|u[87xz;M4k5od;Z[u[^U\I+ 7II_ u__```I 6_`.`5a}Fh_`m 8``_77`f`_EhXbhX (R/DPF)WSa"pb@;(;C6d\HdCFdC>dGH.dD^dDdHdIO"`FdGdKeRNRdP^MdKVXh;d"eU~U^BdpeX~dJPeJTCNfJa6HdIfOnfJfW0:Icpd
6wd_VfFX\|g}g~g/gg~hNhh/@hg.hhh^|FhX5f<hcT3p|Y6hiji=(ii	-5 -h!h)OE^QKP`OS[hhknj6lj>l|ve` @LY!6NU[ijPP
p/HkHh9c FmNjjk~j=8jig~m=Hfh@$P$l~c(KikkpUQ >mk9H`IT&><Mm= ~9&lcp\X<V[xfxQ6c= n|nAL[~`QYi}^VpMyok>Tcq)l=.r/`"j|ghHM6"Grh98\/po9`phgXx@YDVjkPHfTQ 98* hoMw|~P IXwxj89%pwM@\,$J[\=K`^pQ%Zpj?=TVMs=\`v"`uW>Mr/o^s8<8hhpIsss? =;0o~)%AYH6~6E0Mq=%h"?vbqp\\ww(I@fg7vGwwwK"Tv}v=<` s|feVkiuq\H>\9 T8cTq/S8yS8<hSz9.qhZg9/1|=|c% vzhlFnvn?((KVmpfpgo8ww=""?(:8h/Q/{3c`Q V6o,| I^cCQFi-ic6^b% <rZm$9$bCRIpAN,pQ,j(EGDx|*VaC
Qk$a*I*QE&9|nh^x
;\yq7-zX1P/FK*yXLI.w
/@Q6+M8yL.R
s{\SZD1)\r,#fV1\llo`/	20VQ0 HX^ZI
$,eH-vKshfa@rByv+^bq1%A/l[@SA":P4AL)/| A#<L)bw(tp}UT H$2mXX2*@"Mlr^("4|b1"	+J"Ha
P(;nR$%j|)yW-r S/_M]+42GS$XE	s)tM1;yat.RBR tZWXp:M~X#/|l,dy/#nBs&V1rL8*\Y@NQ7|dcVg|jB/1!w@n1n^pFyiFb=x|@U$2 FwJy)F[FkyH_@"GOCSC'Ku~T,!SUz`!|L$h*F.?*QpCrWur7>xa	:.*};L0TF-Jq6T.ClAvkTAlDC<wDSVs`r@*
y>$^"dX).PFl"=R5*p2CPF!U@!9#3Mrt!2H~@>$,c)YhOI 3F!h"dE<&2	Tr b9\o2mr(hLYD+f7u35XG8|2L'>2'@I0aS=(ButO@  ;file|^|YaBBImages/logout.gif|^|1236|^|1008719046
GIF89a8        Z cRRRks  {  {                          !  ! ,    8  @ CH*H@$b9x ?|)2(S*  0 /c9 S<{:Th(9sha"d 8+6ceQKxe	_q@`*^T"GnfF9%6XPm S *[6e%(N81q=}M>9P k8wc"D X~ I<>JoC8e0 `igWF[RM5 WD %Of2GO"VF[niaA27@k7TmV$na6o-'L6%sTt'%<b)h&ixp& ;file|^|YaBBImages/Male.gif|^|143|^|1008719047
GIF89a    1ct+x28eWk   !   ,       <Ije]Vv	4@Q-UQle" M c(N q)' 8|5 ;file|^|YaBBImages/markread.gif|^|1947|^|1008719048
GIF89a{        Z cRJc!99kZcccks!!!!!!!))))kc))1111s1{19999kc9s{9BBBBBBBJJJJZRJskJJJJ{RRRR{RRRZZZZZccccckkkkkkssss{{{{{!  , ,    {  @ Y(P*\#JHQ?FG5dACd&H0(S6mG@
J7G"E@HT:Z`I2+HgARcoa%2U#^2slM7	C)6HL3ksWS&`59iM;J:5RTNKF  @x^G V{7^
- nM
!lC$?uY PO6qm`F6Vn%!WJ.[quR_$EcDb"mEn1V#q8}%bFL"xENN/FPK[
gF ,4"Z	)I A( u`B5Qx d deT 	e	B5>ax&Ux8W]QW7ju9hx}GM*h{!|45UL>9D$C-* DTSqBHjcagp0[3USNe$c`E w;\k&aZ nA
K(/ LZ,XR|!cALK"2R^%Q\\pOX$T;
+bPBT>ttmJC>fe)!5'R`"[_cl@}8cU.N9Pu]NXeRVlP	vQGqNZb~m]m|g4D!) jUF cAW	NZG<S0>mxM]<S"'
Og {HBOSDAL2xN0lr@WO2+%	 `bxf5xD'-PL 	X*Z:I!aq':Fb(6L1Y}LTl @z $L"F:d#{4	 ;file|^|YaBBImages/menu_im.gif|^|1412|^|1008719048
GIF89aN         B Z c!!!11BBBccccccck{!  $ ,    N  @ IH*\8l0 A
8P<)(SK ^	"8o)BP@ & :U*
 ^
*\fUkv~h	4oAaR@ GH	]Xo~t;1AwS^c4jx3NjA.6Aa+K>%Ur:I@{kWe^qJs uP
@ A&`DD1 Q:TSaWuxzUX#EY,8pWB^4 Htm7fHDI,L;5dM!D)eO>0 5a	yQwGhR1-	rw=beVz^'WqW'qYh(id@yXg}i'Ye'xNIIXma^WxYbi|hQex] NH25T
k7X'J}F 
<  h*AB,:mRWg- ;file|^|YaBBImages/menu_np.gif|^|1397|^|1008719049
GIF89aN         ! Z cJRRRZZZZcccckkkkksss{{{{{!  + ,    N  @ WH*\p	""  D  AIH&MXr%K0c<a7Oip@ 0 ptP< *T9tkW?;6ldE!!  K^;PB K-^$<#e!7&adMS^Mhc'M wkwq_ c$D(WP	%3O|
y ZhPu{_z;qbjWUGg,h6QF1eQSyr^^ %Oh+&v, E4Ad.$L1dN( 
>0 !5`B't$dygeBP:19X_5q0DXZQ`IvU`U]xtH"^~2X9GYe7`H%QMQXnvT |R~*b[A!a@SE]hS(V!>} \p$x 
rKa2lz{<  ;file|^|YaBBImages/message.gif|^|1107|^|1008719050
GIF89a>                   ```_p_x`x/`o_o` ` h px //0PW`op                              W                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    !  < ,    >    yH*\c$0Hb3JXG6DxaR~\F.bT8LA&[8((6`)DH*p*VyXUkGOp`f`# SZm\r+U.Wdco],nKf7$Vyx7wcG+bJqj]-DU+_][kLuV0D!<_CF>0[_Bv4^BhR@ ;file|^|YaBBImages/message_sm.gif|^|919|^|1008719051
GIF89a         B!!!11BBBccccccc!   ,      @t ( $@$pP $0@
2\h $Wp D @
zLQcU>J6Zhs *@p@g@ ;file|^|YaBBImages/modify.gif|^|1286|^|1008719051
GIF89aA        Z c111BBBks  sss{1 c1c c1c c c!   ,    A  @ ?H*\X@Dd(P8p! =!$I%'f 0eK*'j (I= CpSL>*XXx`!@$H hp
1/ljwz7o|W~ha+^#'<pXgwD$^`XscQwovEzdQxL
mJ7jV
<O:y._iQ
J6_`Wh@p\Ai`~CI`fe&1(J3)`XE hsG [G.T\to#_PTnEy`Pq+MF=uu]%`mfoWw5Ttj'fVz{JUMY 6F*4X ;file|^|YaBBImages/move.gif|^|168|^|1008719052
GIF87a       k,      @]I%@] h_~&^uiv|'P f t9,Wk*rGfV=Kbm;l,$ ;file|^|YaBBImages/moved.gif|^|178|^|1008719053
GIF89a       k!   ,      @_IO\qC0>m10_^ Ct8gnXI W`1 u1b<0I  ;file|^|YaBBImages/mysql.gif|^|1775|^|1008719053
GIF87aX    Mt Ty Rx Qw Z~ Y~ Y} V{ Uzb ` _ ^ ]^ekjmmjosoq#x"t)y/{9?AGMPVUWZ]gm} d c beg	j	ijlnporstv x$x&{+~.1447;=>ACDFKRSZ]adhikqqsuy}~6;BOaehkps~   	 #$')+.129:<?GS]bdmopz|{~    G ,    X    HCR
#JH"BH7<13( CT(
% 1#c0-xs
  O):~ (H $1~* B#hjT0`-s'aFtgASmk#2P>I\hKB&> `@
;>1)< $89$'CXPj kQs $ pg+rc/);NL6`if]Rk6Yf	 qH|8h"nq]tABpBLsI	  AQq&(5ABtU\_A&T6lhGMQ<`5`Ns 5X7 K5w<a
h@htIDc4y4L>M4:c|Rblpdh2^@@9hs;2A3:dP|4F ]"B|AEdA S?3L4>lB,5$%pA$@AxAH33,94
t.-
h FA<@@`OM7=p L\1G>,0;(@QVA3. O9 c1]=@	( !6I)4>E J6#0+tN>r3?sO&@z(
b Alr^QB_LA L2(s=+*33C10rJ^ \I }\@ B! rE,"K9L9lM-CMp?E"(2%FH p
T P!I@  ;file|^|YaBBImages/new.gif|^|932|^|1008719054
GIF89a 	      !!))))11119999BBBBJJRRZZcckkss!   ,     	   %H @
  0 4h BJ4&8x	'xrFp	Bd`SeN-!NtFFLt`LNs*Nx1U8
 ;file|^|YaBBImages/new_none.gif|^|1035|^|1008719056
GIF89a`       999BBBJJJRRRZZZccckkksss{{{Z!   ,    `  @   *\ @$P`B9pHS<hrI@dBB7vI((k
8 RQ-#<5&W]t	B-	X$Fl-p} {
&dX&L-Kw.w'[ng5rtCyk\,qVMWs/.=hG+&<\+_0  ;file|^|YaBBImages/new_poll.gif|^|1736|^|1008719056
GIF89a\        Z c!ckks!!!1111s1{9999BBBJJJJRRRRsRZZZZcccckkkkkkkssss{{{{B    !  H ,    \  @ H*\@C"J8#> D"r$$ITy0[H5^!2a	6:#/ d$C  dN1DCD X@q T50 %]p !BXV#KL9	PCJ*?IdjW)`QbMD*+bA  D]Ib0@[nhF0*C;jnG\YDB.80=ZkUZ6@ QY TG1%pip	bD505$RJ}v"?`]KA2	]"$oG%TSxU PG lxU
sG]5fK, @	{%N] 8YwI4Ue{gZ8@ P$!k4!lPfu&hD4SE6"k.[.'A@A|Wd&$	d47E7~##u;$,b!VQH$Y NTD$VA Qf Y]eumxOP*W@)g@ OtxqE5pM04
ztF(Q]Z)y \0Su1   	@x10y"1c\=R
1Ize
?J:@%A(8 Dz|n(G4:	 #D*+41C6/oh`BB ;file|^|YaBBImages/new_some.gif|^|1026|^|1008719057
GIF89aM         !JRRRRZZZZcccckkkksss{{{{Z!   ,    M  @   *\!C (h	(0cAG'	@i2$ Hl 8oT #9eLD*U  M9eT Tj.ZpJW4mH.Ku)g2p:jj-\f7.EtD%I9i 3J$ZcYeM3  ;file|^|YaBBImages/new_thread.gif|^|1814|^|1008719058
GIF89ae        Z cckks!!!1111s1{9999BBBJJJJRRRRZZZZsZcccc{ckkkkkkksssss{{{{{!  M ,    e  @ H*\!I"J8I$1DK@&	r$I$\,s	6%(G+EG @D
JHRDi$# (G8(j"dT h `IQ#%4 "L{p
?|1%53kMAL4#j$5S$Bb,*iD&L8
"I 1`"%L PG&kEL hHE~}?mh><PH %`M758iF= `	7p@Be'D(*9Zi0PO_l@G]Q'8XR'  H4u//1C_8E[9QpU   0 5U@HtX<dg'r51@1}5~<V6ITB'!jW'DOC:$k&622,'bb~-J!@fd"tf+o`@PPO<VD& 6|L1h*0k%1 cUIsLd-[,Ko
6 qit\)sw (U*!#Jam!14 $jnH|9N9c%YpQ\ 9&V+}TDfsSHI`B0A!c>' 1tELg'+0|(PR1FTjvDJ-_?Cx@z-,?s`|TXBz|O$ERxCS* P'XEI>pj@h
W0g(C
h@		 ;file|^|YaBBImages/news.gif|^|910|^|1008719055
GIF89a                   f  fff     i                              f                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              !   ,       k =H:p4`!,(9N9r	2 IW 0$)"_H)&PI>UEjk@ ;file|^|YaBBImages/notification.gif|^|1362|^|1008719059
GIF89aU        Z ck{))BR!   ,    U  @ 1H*\ "D A 
,"L9R('\@ad/YrI&pri` 
Q H4)F#,]ERfUAiTb+qA lDpp`j,
+b+q$,X'L2kCmF qSFY3 .. p`)sOHHG )%\bHC:6c'cNOL^,p*]S6a`,_q'P (`PGH&UR| _,0oUhivxT$2Q$AlIU'#v$w8Oa@DIEGz=Ec3NK_ r AWac5_*tckXaDw>XG5`Sdr`\-fNYwleWUU5TM_Y(}B~>L-/\ (@k*>Y ;file|^|YaBBImages/notify.gif|^|1592|^|1008719060
GIF89aJ        Z cckks!!!) )))1111s1{99 9999BBBJRRRRZ9 ZZZZcccckJ kkkkkssss{R {c9{{ {{9{{{{c {  9{9 {!  Q ,    J  @ E(\#BtS8RG  XB	!S\y$% qD!Rg^x2HH$bGG&-25<^AW du0pK
R\D+ y> $+^( 1@I d.%$D"  t]D& $Ap>*qF&_Yb@D2bt	'$~OrWS~ AL!xZ2AX4A   %TJY!l ZEHE@L%Z0FT  `D !CoEJV5QWeETE F) B?VAqE.4|E1 D~:^wu7*C
xF~ytaVZdq0{F_}Zj&D!DD{NTAP+U7Qe1U!P RhwG680g^%	X %	4MCh  m U$z@Kf+c2`#kq[GG}7[5R&rHFU.TW BH OMq1jpK)DpMiR^/dB@fQ]l&e<J&@ .@7v]{wzw}By ;file|^|YaBBImages/notify_sm.gif|^|1205|^|1008719060
GIF89a5        Z c) 99 Z9 kJ k{R {c9{{ {{9{c {  9{9 {!   ,    5  @ ;H&< l83j!cG  8b@2 A.) @ pZ	r ~Z:4C/HP > PH Dn@P HtC f1<xWB  `au%Rc~WEp :ps!Ao!6SDUhQe5{Fhw0_N_p A
>  PNUSa[G8}$54KY`?C\biAraETD]HBHo=XP`rkY6l9h=4M>%A8$y&\pr@L6PF)5U ;file|^|YaBBImages/off.gif|^|1042|^|1008719061
GIF89a    !!!)!!1!)1!)9)19)1B999BBBJJJRRRZZZccckkksss{{{!   ,      @ 5HPJ @4p	$  E D 	lxp
.xH@F
dBd E$MN ac%%dPeB9PpZC"N4 a#:92B#[K
4
Rh J{^h20A2`a<4u9CE6,mCbD+&EL?E;YZ UMrn5: IUb,8 ;file|^|YaBBImages/old_sticky.gif|^|942|^|1008719062
GIF89a        Rsk!   ,      @ #H`
`C$X@ 
 !*$@8 ieH08 1AE
g8q@X@GH-
XPyS;%V	& q9h 	 dYVF @. v9 ;file|^|YaBBImages/on.gif|^|1051|^|1008719062
GIF89a    !!!)!!1!)1!)9!19)1B19J1BR9BR9BZ9JZJJJJRRRRZZZZcccckkkkssss{{{{!  . ,      @ ]HPj 	*\aC PHBAQ)X40ChB ?	Q"EG<" C00C:\qb8Z0BK `9 dRD%2$@oB^&86lU"09h1(=j:Prfv/	0pK[&\w~(`(I bHD ;file|^|YaBBImages/online.gif|^|1224|^|1008719063
GIF89a                nw r1"f";m;PGGyTkaD kn,_|>JB S Vwb+L1X&O/\aV`_amlnsj|wzy|{vtu}|}Vzcehg`{tvzy%%:9"",,44??u,w%rE$_fIL@@JJPP[[j|ioRRZZgXddeejjmmm~#?=!&/:5:MydAE@CFE^Vdvy|y}whhqvd}~dvzs!~,MV=6,33,0:QrsWGOlds*9Vzhz            ;   !   ,        	&iS'MJqpP"F qHQP	$C"u+TP%J[U*UMIbmiC.&ZgMF@?*)#lh"M
$sI$r,pB(<x\!"P@?jb3f*xRF<r,Bd1`>p,,^Wh>3/ bDSRX4gDQay	08QRK.B42:	#2B#<N/-9<J,K	!;N:sJ"0:$
(G1CL/p'yD ;file|^|YaBBImages/open.gif|^|153|^|1008719064
GIF89a       k!   ,      @F@8  cu(	pUE
CF-ad6<V*O=PZ_ ;file|^|YaBBImages/php.gif|^|1397|^|1008719065
GIF89aX      ggiSSTDDE$^b~rszTWi_huySbTcVeUdVeVdZiZhYhYgZh[i_mTa!&;\iZgJTcp]ilzxEKf8;H!! ..-
888   !  2 ,    X  @@pH,rd
0hdkBHd
+C4EDD*|.wy:S'-!.t-n$%=F5>825MG'#$9 7-.5  	-!<
06#%I.. *$&7[HO2[X=D
-#2d 7F384eIE. LPaOvXpFV7. P
Xh/0Q Sn F	.Hl*!	pHBH#bPh)LpObD@.#`E
hc'A `@>>Q 3!$u|r,"y C)XuKsXB$}`bViNPzF@
a!4zjB l9A(0L5~11@ |_DIs`w  S`Gp@6rK`AQxNBppS f,*s H'$xB
1 AViX <@dI C~Aba\~YAl@|24BdUe\pC <4\@f  %4
 BpX4H.4`X0|vh{N  7[h&@ x4'6+A P8I2+CP7\qPk@  AM$0Z8P@vF
&'8g40:)@" 1o7Q @$`Cpr0A; C  C`( 9Dl"J,ZEM9B.@~7X&xD(2rP`a/8g4Rt+:x.)D1Y7=n  A7HQ8vr'$D0:},|d 	h{#E -DD .Ld@\/	m`K"Scv!,	P ,s"	IIRC8 PM }@ @ B3H	& ;file|^|YaBBImages/pmon.gif|^|946|^|1008719065
GIF89a                   /0/o_`_cdhqrrsrtswtvw|w|x~z~{|}w__//__@@PP`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 !  g ,        (ABBt p!	A|H,VDlH-Y`R.,YB-V(H*Lq)M,ib$92,)x25hX80b@Aa	F@`@ ;file|^|YaBBImages/poll.gif|^|929|^|1008719066
GIF89a       !RskkkB    !   ,      @~ HP`,H @ (8X 	,X*^T!D-b,X0J 1F)2 @M@X F>JX*'y)U:T Pf] ;file|^|YaBBImages/poll_left.gif|^|114|^|1008719067
GIF89a     Z!  	 ,      @0=$`U&
P0Q!8%E ;file|^|YaBBImages/poll_middle.gif|^|100|^|1008719067
GIF89a     Z!  	 ,      @0ChDhH)% ;file|^|YaBBImages/poll_right.gif|^|115|^|1008719068
GIF89a     Z!  	 ,      @ 0yiI!`N&0!:I ;file|^|YaBBImages/pre.gif|^|151|^|1008719068
GIF87a       k,      @LI%}e*zp,M:h>p~l: t!7TtnKNU&D  ;file|^|YaBBImages/print.gif|^|1577|^|1008719069
GIF89aD           B Z cc)k9ks!!!!!J))Z11111c1s1{99999s9BBBBJJJRRRRRRRRZZZZZZcccccckkkkkkkssss{{{c!  U ,    D  @ XE	(\#*`_$
G |B(CR  $e$DDf$lh'>p A  6y3iI>sK.W'P`(	]p=xd@(B/)Lpa*Re#$Xr I=B  
7If?Mb@	IbImH5|0S>u2 AH_?W7zAG;1y`IL| @+T2%T
!a La%U(ApC+0 V%C jX%i x" <{u4DU[o@E qDYUOTIT`'F$Q%mXf%mnMP]9LKaA'utRQpry76t!6sT$@?L@*)WBK8H0 T)J3G>t7G*-0KCqGFgWM=L`c^QUTvY|IZ$Hb@$ `uU%7`PAP\Q4V_GFcGl Ddb!&01M)x/8IMq>5X SAOJa"UV!A]K$pp`lGFv [VE
fLp
.Pjvplmx	!,  ;file|^|YaBBImages/profile.gif|^|1299|^|1008719070
GIF89a:        Z c!!!111BBBRRRcccksss{!   ,    :  @ 7H*$"Ppa""80CC& 8ae0_2@ 0rr@PP*V*%0Qb;3F`@tM!8t|G=D+^1DVmZjK8?@c<im4w.oHHkE nJmJ9S
KW/n(EJxC+B`6\v  <{8 w'YG$a`'K&aLA tvF5uta4J+mSUQW@ A},`f]P}Sx^7QUZrGyD]]W]w!97[ r)QFt5'{c7myuU"VAlN*)JiRz-(f ;file|^|YaBBImages/profile_sm.gif|^|198|^|1008719071
GIF89a       !!!111JJJcccsss!   ,      @s 48> ,J Li CY '1)([pW)%U+H(NrA_ N=!Q%	&"1  4W;O!ZU ;file|^|YaBBImages/profile2.gif|^|1134|^|1008719071
GIF87aB          c !!!!!)))1111111BBBJJJRRRZZZccck9Rsss{{{19BR  ksJJ  !{ !  ) ,    B  @ WH*\8+L 1` 'L``G C 9HIvLyRJ,X0
HRB	*:LxPI$ZU%W"@Ah*| v 1b@0du,u 
R(%:S
TKJ2pV
0 (D -^c sBe B<'E|@)>d]RE:`3
(0Dd{S|r78Q0@y<_^QR.p@!
%Lx@H!p
!Ds-Z@ ;file|^|YaBBImages/question.gif|^|172|^|1008719072
GIF89a     Z!   ,      @YH	tA p  aDQNhjUYUqb:
l<UBjS"PDaw@q0Yv-,=  ;file|^|YaBBImages/quote.gif|^|1251|^|1008719073
GIF89a<        Z c111RRRZscccc{kkkkkks{{!  ' ,    <  @ OH*4#
xHb #2jF3,A%PRP 0@4 I&	r~gN9EAM98(CD@U>" /",YFGF?, x^	p@A0M@ ]ai!r\wFr[ S&{g_w]K"jra9~`
?J,M
.02%Vk#)@\'PQhZUI0WVHQ(TVi_ESF58jEVVX'qgeM%p#eHR6ADOcVpTe%wDF5Y]'vS\K,kprrsIhPW| ;file|^|YaBBImages/quote2.gif|^|213|^|1008719073
GIF89a       111ccc)sk!   ,       I}}en!@"E(7"NnGH:Fx4hmTBCH m(>X$brNuE
x4zVlRS-%7@(c}  ;file|^|YaBBImages/re_top.gif|^|1146|^|1008719078
GIF89aT       B9!JB!RJ)ZR)cZ1kZ1sc9{k9sB{J1)JJRRZRZZck1){1)0/!   ,    T    s A*\' 3jh0
0x (7J18|P@8npAKvI!
/eRE5 		(s";Xg"=p}bkO(DKXG^
a%[`Tm0 h`YtKv1  @\|:}os6u^n]V1[WW RKW1FiG]x<mVYle_db-TTQbP@XTY(!j(bJ(. ;file|^|YaBBImages/red_folder.gif|^|965|^|1008719074
GIF89a    B%"J&"R.*Z/*b72k61s>9{?9HBPJQJRJZS[SbSaZbZcZlctk{z!  & ,        M`@\0@B !@=\`%4H@P8 1bD0dpA"B<`B!B	 C
(
hH)V0 VYF0h 6e0`]

8h]6X  ;file|^|YaBBImages/register.gif|^|1321|^|1008719075
GIF89aB         c Z c!!111BBBJJJRRRcccksss{{{{!  " ,    B  @ EH*\(,xp#2 BI$'9%K!@Lh P
 @t q="5ai<+H5 Xj*i
(H.T v*oNuanA{wW6@+^0#Kn(U5r,kVP`C0!]]"[nlk%H`!6UH+[p;%zt^=dhzpB
k%Xw | 0@m_f1j 6 	@Ui@h`D]K.qs`QX5Pt[O9d]~%`5Y`*@07S>I\t	%FTjBgWBy&jJu @xGyEzzJ|b(%Ji*fZ ;file|^|YaBBImages/remove.gif|^|1139|^|1008719076
GIF89a:                   kmznww{w~pxvxwx6Bt8=8=MV    "6=6==AMG\U5[ch{                                                                                                                                                                                                                                                                                                                              !   ,    :    1	XF4aBc#JH1bF-*C	OFF2A
0cbE3C@CBC~\IBB0zRBC?X*tpd[ *[mbz+w\pJ<GP\YCF&vb#3M @~Pph!@-EGh&UL@&7q2B5kmow:Z!/tPvwL:&` ?"~q.\Qo18P_}ED?PC64.aL ;file|^|YaBBImages/reply.gif|^|1618|^|1008719076
GIF89aE        Z cckks!!!)))11111{1s1{9999BBBJJJJRJRRRZcccckkkkks  ssss{{{{{1 c1c c1c c c!  P ,    E  @ (\#.t !I0BG 9'N(0c K$2D2B
*Dt J$hS!M# P*+ *x+Uo@pK[&Hc+^8a@	@Vj(:/`22x #  dI4m4d@N\Q|/'J}hw#X|y$I'11@A
7bb`J YcE}' GRgRMCKV2  i ` $! 1VV
x  B <%S a2EZW  P e51TOe)TKU%u; BpQq03 psgxrM(4AzAw~'x':ew6iX%Q@N!A6K'`~A*@. '9!B	>$n;n21FQY!Lt
C1pQK380@eRum>4v FI! &pM	k8  W\1yNYqh=vTeAUR;(1 |EU#Rr SNPfV&`BJUi@ (@pUw3IWY5+Ue;4@h'sY#tp5tOTB</ZV-!WngXp@y ;file|^|YaBBImages/reply_sm.gif|^|1282|^|1008719077
GIF89a7        Z c11111{BBBJJJJRkkkks  sss{{1 c1c c1c c c!  ( ,    7  @ QH*D !0 @q	$4(X`  CBD"R@`0&8s @?PB P+@%lP G.@|PpC JBn t` L[*| 58QB	x`E i]U; (p!H"']^p};]i0	`G1$Hm{5L?{C&C'@OU`Xhp5 }@&8hp)uJ# R ,LlskPH\DEo$hc V=uSYsdu&ney84Ol
H4='xhZ%e$6^`_VJ_@ ;file|^|YaBBImages/right.gif|^|158|^|1008719079
GIF89a       k!   ,       KI%}e*@,6| 'I9qi<e$dUS`L.v  ;file|^|YaBBImages/rolleyes.gif|^|413|^|1008719079
GIF89a  	 )) 1)11                 !NETSCAPE2.0   !  ,       hI	3:) h}a#e"h+$#"yAA
 U@,E;(`BZX@iZ]FMl`jcm  !  ,     
! !  ,     !G3UN !<  ,     
$M' !  ,  	   :GbQH(F(` !H  ,  	   Id&Jr !  ,  	   :GbVH()` ;file|^|YaBBImages/sad.gif|^|944|^|1008719080
GIF89a       )) 1) 1)11           !   ,      @ ` H@AC
H d<#6h(	$Pb#oBd`D (2C]P Jx11 4||s" !\`@42(!  ;file|^|YaBBImages/search.gif|^|1335|^|1008719081
GIF89a;           1  { Z c){!{!1ZJZ!R)9kBZR!!!JZ!J!J)))))))1)9)c9){ )B11c191k1 9999BBBBB9JRsJcRJcJJJJ Rk1RRRZZZZZZZRZsZ1ZkZZ)Zc1 c11ccccccccc{kkkkkRkk)kk1sss{RsRsk{{JBBZJc1kkcBk{kc c!   ,    ;  @ 	H*,D^T E 
?BH&K
"CD 9z!hF 1R?M:C)?UC@/C $-H**-,@*Z`A
u#KLkDAH;]hq!kG 	 2uK8H$GH~HOcG	0($p&<\?k3sl3FV%y&iAE	 @}<!f+,`g83 dD;\%J(4t%B_DXDBHq#GPG/RH-$%ug2LD `VX_c)yf
HkL	o0AB_EeXS_QrAx`TAU)aua 7O#S!jZmkZ ;file|^|YaBBImages/selogo.gif|^|10059|^|1008719082
GIF87a2 w  ,    2             LT_DSbK\kI^sL`tVdo[dlScsSfyVhvTi}]gp[ht]l{_qalxdq|jt}NjUlYs[zcsbvdxivmyl|e|`j~r{r}^\kecllntzz~sqwuy|{hiomrsqzvs|{}qqvuz}|~         tVF 	(C&\Pa"6z$IXbiTJT GEdII,Aj`/lfC4iJ8gF%=$JD*%:hIH-PH$*`r
XgiT;nmK-]rG<xO"K1sgtCNM[uxMvmzo6*,4QR(U8#WIBdaIsfC%AZ~J:d*D:*X`J,jadFW[v58^|&=!cMngZj(&m0=hc=0C;.%$M-fu!%B$A	TxWS%QATVU5&U(#UI&pI_(aUY|',r^&W`v(Z&&bj,b1x;*^T*_X\=)	#6DKX51I!EaHD	&8rIF	&l~w9'kE.(*/^cRV)zij*\C/%FNjJTnWUAFRDaRLrmL!m$2Qj8zIM-&bxJ-'~1{T	I'G{xG dmvYs{[ob:/7iV!.1d8d/c$xb9y,bmAIxDJD,+\9f!AuQ#1tvL849S;3c'ry&B.-ix'jp'*YyQHMEkQlwF-a!hv&c C$0bGi@mtJJg:%thfq#8eQO!	D]Q9""8acBhC	IdY &0VX9a#s0C-^7lx#61;HZQBC8 ff(`hcp4:tXAur '8r3:\-9'f(#f0r 09>^7aZ|1MY$72n@G;h8}(&ks3h]gH 2ZK9%WIirA1z~^\R(!o1peEG<r@W,D+qt(g4M
,DqS@!@B0'DukHr~,lC'@y2DhBK.2r Ww:972tyORrT[0)VjNXqvCk[a\%:13 Wy&X?x8H=.;+ZDoL\J6`jC0/`7$YRwHCLR>DY3F$p,WZ r?zi):UzGm0w0g4o`#%@?sUszcBN5U	Ip@+t`mnxG#[."7S+f$PAa`VFe$CM9A:TLC:\	b&wc&<\q"xX]
!{n4^o*
d:KUtuQ2A;
*ty6Q3@w#1W8L;52F~t7+ 0h`L#A?Z&wFHF2hgl7wAybcznkPzZ3+^m&Wd0+!z7h:#5	n0HD=pP2(7p 
]re #o`#t^TO'	J B20 h`:fh H
cCXF<h|foGl/:?Hhr^wh/x$qPk<kBRFHH-oW!R"F4
<o 6f0K (tX$[w3o@j@RhH9RDLDvP)03p3<0@Q`<0p`i0~00&xx@P?yy*i,&qii	j0q;Bez ^ap]+W@)`{9P @@= @``Yg,CmP
\`&D7P7p%`d*\`7`o ]3"0%	
'	 Pj_@XX`;UUrx[p)P<UXXa 7HUi(!5(zrzz@XtIP0X o@FP
3gu`E	&= 'g0%Lml't1@J#9m:gP:[`0#_:puf@pH#=@Q$V cMt;fX X`Cp@<a c Z9<hpU6DHhi(3y8"cP8U0] <@][	`8~	I:0J ~/`~mIp#p`pXda/"@
o%^3i6V_S5up<bp@>-L	'XYggg rzB1qg).f5$3]0v3=	gdShR?	20xG
&9`&8<agXPJe1)	:?<c0h"ap` k"		Q	> PLf Ez@3<t0MPMFa(yQa~@uyhU|tq3W4{5taR	`UcpW${@@^Vgb6x/@X/J gP= Zci^1 @34t0~ *p$%	Ew@hgJ4rP<'	@pfodG4pyo'Hzwjzyq9O&gt@Pd6x ;09
s|@r"Zfwz d0 @DT[7
( %poRvv* Gwxb"?)*
byxCec]YcI?&^P)yvwuBYaP*)$0YcvNIuD);U{GsTg @;en !uPLGF) n	&=PZI$h||9R+,`@skp8 \z
v)
sh;@stP+5
	<X]7pbP*o
s@~5*|[;{`$ @~ 	w`]dO@
^iaJIi`RK\ /Lf?iz<U
LbrwY>[ E7_*pe(_o`{{;"w :@RD?H`	#jg
8TKaF
-?w;B)#$p(6c9PV/+jQp,IP
yTtWS5XJ]Y|@MF|; ?o
"T@d@Pk+fe/g"a]\b@1p5`}oea9vL\7npT Iqfal|g'*E.^CbL=`Men;_)}^`&9DM&n`` wPEXJ[Y_"#-ga1w=IQ	m4tcWMTb"DQbPws0et]T
lEi$wP m===@odp
.D keD);C`"3m@U?x[GdG[zxZ\h@kP&1	@gp{] 1+
/&B$$] t#$ 0^E) 7lPJ	pd

   a0?3HS|tV @dd^kIfTw q$D`@
SnzWMw)}8
A&&AtXp<	_X/dW,T4kO  vY 9P?SN] DD	Z  h`^-=Pu0)\~p % Hx"/&p*hL_amk[]maB >kn )\a1=3MnKX#v	wKr0dl 9d ;# 1P2	[P++@pb4SXPCZM;o):DHx<HF39o>'UT]VbYY	)`,@P`&ptp'0OEM }P) y3;0+&B7wmd#7-X4/Td-V`Q",XpcvI2I,:tD3fL.Xx1:k]F795D4z0KS*Xym[f&\8/fx5%GZX3:EFifu<]6=t7pJq6egSXUnG3nK;0t1"6aJps'$ !Q$2n&li~%oa"@%&!(LFp#M$$qy;X;#*@lJQ1Rf,niK+O/YLsS223<4>AKOu\dp7F`$c.`.wz zj/p% |1$`HH6P(`%kRLk*	>!hmwZI*dk`:eR`k(ZFxO<=KVK[9/5Kh|S8N;>MmAEQE7H]fMesNpXB%Mez+o`,\%ysV#PHYdEI#oQ9	X&0"VInum=FvC(18NVwR!4d@J)LDdQVM'sY(clfI5ygzXF#hIa~:X%n?c#"	LA05a+\kWa!H/`#"$a0hQq0"	Lh 0z.@2;?b` ixeX1,;;(47(&X13=z%S=\oI<=}O5{MlWgPiP6~'g?l%sLLlb9
<1*WDh`"`07xJ ,qtk,D5&, B,q.ZhE:1tF,#V*dcVS@B Y1HG6xG=} 	2QTd@)N*\:
J:G2C$Y" 9+a{j+rceJC2d`XW3aeP#,	bP"@s1{q@N$B/HB3h\pNIRiPuse49uA 82A9cCQ.uE"?n44GAjHtQ%5)#;RS]KcZx
iN%
rCE=H5RJk-D4^`
CvZ4C:c@P@ZhRUcC >azC2A$ b6X2&ex4+qSCqbSFqn:P-j56Y]Imo8K+.1=bUDkl8>#8<ArpC8"	iUjbxQb0 Bz7a,/v,05Z#Q840')`N?.I5:d"HdN.v8RMi2\8J
5c25ws h5Z
0A#(4"bY0F10`{He(6|=\c
3P7?h);~<<['qjcbB-mC>	M9|.QkdU'bQ&[G;<cY!bg[ At|A?BLu1D*
yCgza,5'0n4CA
,L=}]tI_=duS~Lbi*2ctx0
8=+k8TntnonRF{% 
b%-"5	:`1x0IpF@Rv\9@23HI/6Z7k15K:cCdj>#[8Lr@,?(cAlVhu9VC8ZpW(i $2p8D:` 7tk 0F.p@(2FMD%r,P" GrbHP#VlE(*Z=(A#>	(	jQxXt?9k@*b8D?txA*(EYw.cOh55zq@ P)6h6H=PaD4zw8A0LDMp7R@?
*A8H0PII*@:h^"D_`r6SX?10L+D;]V<8{BB0%~I
 HLD % <"h Md  $8;

K*LH%Tp=0\,hNl0018,Z=#[J^(_,2#BgJ4\'[SY{<00#Z(N9+ $xX
P"P ,HlCp MQ %0~<UF7P~y3EU;xR)R*/:[NN6E$O`4COSO>!qp	n.)*;Y.<R(T72 %hTGUHT =CPC(mUQ}"Q	P(Vp#(uN)NlUUUaV/q)(NN0OA>2J3e>426rZ(|4q(].>8>XLC4TXHxxMT| MKMG'!A{X`
@eJm=6u)UX}YYY#Jdef:	SSe+O$K\2qC@42:1Y$,!"HF R[EXK=C'h'!iGZ|XM=5YP7j,jE}h-i2"Vh;Z:s9/0Y5YU6e]mF [E[]u['!r[0VZ\p3\AUgezJBC)Z
 ;file|^|YaBBImages/selogo.jpg|^|6397|^|1008719083
 JFIF   d d   Ducky     A   &Adobe d    
    
P      		
	



	
  2                                   !0@P1"2`#3B        1!AQaq"2B0b#3@RrP4                      !1AQa 0q@P    t_YWPbk9`R{%SPIU$R&R
R$2`B
$% #'Qbt .}y2[)gYrv^}w2.nsg"e "C&	H)d BR
R>{up'+6.U8#Sy5aY.uIt/XLHdT-HJAJG1VrlxqjA|3XH:Q?a;9eJj2R! Y*BR
R2#"UeynzaVS+S 9'e
67^8"e "C&(_9HJAJFvUVT+5TSfNog^jIQ+AXAA))05%R	H)HCYjl+%3ADJAA))0JAK!R  _#l+uq|l:Cw: dF|<([Zebz^'N'2<OG'vf+HF\j>[ey2a~dQcHLKKbB[Oejf<6aCuSUOtnRUXXN]Xg+2O	zoRSiqVbQ
!diQxp_DJJ^E;,)FR6!+0U[Ekq@'G.rbn>Ky* ,|UD8+tD1}J*qq;9Sx083dY#uZ@PUuRT0;iR[}?/Hvl2QODoh2f2W*YFPC LdYlyrbUdyW%UQ0=u(T?_  OOOr}:tBS&CChzO:zwhO}&A@Pnc&M&LF%  M&M&ddE[F('NC:G(&LCh=z+wu2(">NG% ?/ ?/ ?OG@W @ |2xZ2Qcpo_O;wO#.:soVk}\\bfWuWuWuTby3}<m^jF_P e/Ca1%$] HY]Z#	[=A\{Y^Y&7WbDfFVK3V;]LQNMH%`$2eS!65m
yyIK?2N'\";msPVd[q\Y9DXQMg2$^TPDcg "p: -Ra!@&b$BhwJlW-"t" q@3CeNH-<pa{ A5Y~nLyXe jdMS!3mbv>C8(*yP'_20Y(;nA3p	+2[2/ 01g	f Y>rJ"MC/tJ!fbB{}. ?!28iHf[CiS$4/!SY{Bi{3y9vmuDAw/QcO)<D_}\-KM_P4%e v<_F5Nlo xW|r89`
  'F~)AQ1or%\0uN0p ^e/WR[5Q^WB~  ?!UdK a`-&%*>S
u#	mW,A=_df>7 D4nmW%alofnbBS})j{[+!y_^rgN;$_/`c(6r+asn'OYt:91Xq[sn`VCD5u]b)Tv]UBNQ.MlAA,&Xn`L*0/uw7!Xi)7'vn7y}%j/+::3-Ws0.*RA6B]@k~epUDlELz]P:6To_)g)bOiM~F|8Z`S~}N%*m!E e#cVnV0y`+[ZrG5
!?CB8`7<d7oVbwPM{W,J}v?0D Y6OIuL0J j[\P,oH"sD3AO*zHnC+nD"O}7w\_ZhrTP})vbg ^60*1j l`4!E1
sF"FhaWT{3dF- OLFc!ia?x5jf8gaE YlP=wla$vR.	qh~D}	tV=#gKpG2NK|$f+&zgUoW4!(Jr3UtMe [` HAtc15`pML;vG0} je=!}X9 F`\c:'~bXB7(?*8}&|n~,T/%oCW5f\Nx;bl/9Z16GQt{'ohhhxHhBw ?!XHkB\Y)Q]J!ash3$
4-
E|.fFu-&[h2tZ,CriBMt:8:#o+J`KKhL%Jey ?!--.7 /CG121,E!Zv~uTWxh#d)4D>UJ%4:Ht4cSCy[G\KJGRq` P9     31 ( Io(z*A([|$%_R2lL(Vi~#]([Pw&RgQ%		o(Y&@o#m %_DH~? ?`~Y%TAA{{ YER
*g~@PT_BVzf#K~
HjzSh:o _+.G#Q2z	$gd:`3 qo[iT
xaC3wZv*\5 !!B!UwaPeU="5Y9=R~S*	S5EkYEj%r F@.6:<KPQDrQLnv[iR{0oP,70>\ROQ~VoGx2jurJ
Q\QAPQe)Jzn9vo"
'V_7GXlxj ChB!B
)+0fT2!noQtwl,s7%v+h^2f!Iq"# d-+wo6a^ZPLi 'K
0e~:uZ%EhYn]{ 2C/&Gd6	faMs'@^@C5IjS?22!;l#bkJVn`u(PXDByj-2g2yK0j[B%'Rs?=`v&c8#k\S%*l=z$YT.S(~3mxEl9+8:wRRpqKIhweg5jJT4Oy8+XM\Svk)W $X+h  XHWGf3CPvkCN+pT v5 "F@<p9`E,j^HeYbcQYX!L3UooxQNAtP/8}`E5G(?"y/BgNZYT	j]'e	>"rIn@l'AWf:?cFW~1Bz!CmbPXdMAzH[QKj@ R9(#G bsZ0"f25~h\YoQ9
 pB!5 b. y_	 V[	l=*r&a]L]u|`_H
*0qA7vjs0x3MMNWlH] \~?.Xtpa+>%Q/x-5 !
[Q8`Y8LWUB!ByL}9}/ffB{a6!B!? ?K]	 9Yt*"e:A!eJ	A-eP=/xw~lXT<&Sl//{u/::]#	oy(*i"bUCPER)7__\g;6LE\B)\u(o0Am:SzH2fQw::;,!DI1T/"a\F_TM))QhA[XgzTN[RQY-w%&__1gCSR>GW| ?6MiW_[
B`n\pO%$5X,cb$B0HRlIHJ0OX.@qkmxf-"9r-wOa\mD%xLLfa24Xy*H'EK/1W8%0h*ME\f:'iA{yu-Ec%e%3B
tty,mAxXCyxfile|^|YaBBImages/sendtopic.gif|^|1895|^|1008719084
GIF89ah        Z cckks!!!)))11111c1s1{9999BBBJJJJRRRRZZZZcc1cccccckkkkkssss{{{{cc!  L ,    h  @ (\#JH"XB"IJN\")6o"  ?< J d0INC"A0U.~+6Dj!G;JWdmaW#y~&N2Ga3kCc=xicp&A(T?.]{xIt -^]T:Kg  @F%TFc'|H#A*#  A$6s
rU8\HY^0Dm:"qf52D@7(RI*`K.VM1F\pQ L RV E/ w h ]Z&|9)#i@{<- 'Dw[<@ZBXU]YhqeACi5_0p]Og&
2[nh`j2j;%^i0@9kiVZUB 080
'B1[l0:
% i]GeO(rHQ%m9]1L"01,3q-1dQ@sQ-DT7@eY4uEU#Uk~ QA(VTK5l^dv"GVx)!j2PN&1{<~INC }_eW`	Yd7zm`
_CyU	YeaOhZ& @g'w
l=w-$
mG8 =aoQ01."fB KV$&B$\GAx`6tvxCHD|Q FA @)EXX"x^"HF0gcS \ @ ;file|^|YaBBImages/settings.gif|^|264|^|1008719085
GIF89a          `ppp  `/`                                             !   ,      @`$di @0{EH0B"qF(}>Ep`(:@
dH >L[(_)__ nE/d0.f~6,RS3z kUy$:<>@BV9?AS! ;file|^|YaBBImages/shadow.gif|^|178|^|1008719085
GIF89a       k!   ,       _I%}e*tMAF"n:UN@AA9=
EeZ&yqZn$<>wnj ;file|^|YaBBImages/shocked.gif|^|824|^|1008719086
GIF89a  	                          !NETSCAPE2.0   !  ,       UI	j 7DLcEj:v\J %4 zjGdwVY7X3?5X !  ,  	   ) ITeG !  ,     1 T5gmaD !  ,     3I $vT&qjzpJ)W[RLHZ|dEg !  ,     ; $#N EI 
.mN2CC$ISh*;$ !  ,     3I $vT&qjzpJ)W[RLHZ|dEg !  ,     ; $#N EI 
.mN2CC$ISh*;$ !  ,     3I $vT&qjzpJ)W[RLHZ|dEg !  ,     ; $#N EI 
.mN2CC$ISh*;$ !  ,      1!$#
 &0"C SYq0 !  ,  	   P1)X `6y aFzi ;file|^|YaBBImages/size.gif|^|178|^|1008719087
GIF89a       k!   ,       _I%}tglbw1
OO0`<VvrE$RDI*6iO,t>,.ND~n\ ;file|^|YaBBImages/smiley.gif|^|944|^|1008719088
GIF89a       )) 1) 1)11           !   ,        ` .(Xa(%|x 50pG$#   L@A g|Y)iT( T*J(7p @,ZWYr}z^uY	_:p B  ;file|^|YaBBImages/star.gif|^|900|^|1008719089
GIF89a         3  f       3  33 3f 3 3 3 f  f3 ff f f f   3 f      3 f      3 f   3  3 33 f3 3 3 33 33333f3333333f 3f33ff3f3f3f3 333f3333 333f3333 333f333f  f 3f ff f f f3 f33f3ff3f3f3ff ff3ffffffffff f3ffffff f3ffffff f3fffff   3 f   3 333f333f f3fffff 3f 3f 3f   3 f   3 333f333f f3fffff 3f 3f 3f   3 f   3 333f333f f3fffff 3f 3f 3f$                                                                                                                     !   ,       a 	(0a5U
SY~FbvTFIh&9gL^[jr:E(g5Y*T,-  ;file|^|YaBBImages/staradmin.gif|^|961|^|1008719090
GIF89a    i  o* w# t- q0 u4 z8 ? = ? L N I S S S \ ] f f N L S _W0c d p t { w  ^0xm3]FbKiKiWp@x\icku   3$UT^Xcj|t}$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                !  O ,        (0zH"I"AL@FB$KlA QB-^t X#;n`?p  00$4@ Xu)&PG$(B]00bBX ;file|^|YaBBImages/stargmod.gif|^|561|^|1008719090
GIF89a    1)+$NBMA6.3,7/XL;3UJ>6OED;^ROEMDUKTJSIbWbW[QZPbWbWj_nci_mctjwmzp{q}sqi|swumzr}}ux                                                                                                                                                            !  K ,       KDFKG>D'JB/+177?DD-CHHIB53=AEG!$ @>BB;1*"6
 >5).2*,0<%&8t@(R	h
 ;file|^|YaBBImages/starmod.gif|^|562|^|1008719091
GIF89a    \ s]D:\:o`}`uG!%p hCd~VjO%#i ,zs?qRJ))`jzufY6xV_9F|l4EtfXsk'l(tBuT]6oLsQ(}L$                                                                                                                                    ! ! ,       !D"!.>)5OJ86  H3S$$'.
F/H-0BB:>Q61++M%C/K? &>@51	NP2A ;+L<4,#EA+9Q!QDR ;file|^|YaBBImages/sticky.gif|^|172|^|1008719091
GIF89a       k  !  
 ,      @YPI
h   hUhF (a`l2m(@MI~A62$|AFl  ;file|^|YaBBImages/strike.gif|^|164|^|1008719093
GIF87a       k,      @YI% mh*f*zsx|,TiC'uRGm:((3
].,ekK~  ;file|^|YaBBImages/sub.gif|^|163|^|1008719093
GIF87a       k,      @XI%q B8~0(A|?@0RR%ViC?k'p_m:ar**m ;file|^|YaBBImages/sup.gif|^|164|^|1008719094
GIF87a       k,      @YI% z_ h_r|Sn~H2Qd$/&eQ&zL-6-g6gn=o~  ;file|^|YaBBImages/table.gif|^|167|^|1008719095
GIF87a       k,      @\I% r!ByGkn|pH)Sfrv*ZGj*,h*y}fqw)r ;file|^|YaBBImages/td.gif|^|177|^|1008719095
GIF87a       9k,      @fI-0r!Cyp L+pUdOA\VQzLjLoVF[{~W9e%{{ ;file|^|YaBBImages/tele.gif|^|246|^|1008719096
GIF89a          ===bbbk!   ,       I}}0M)T$'ByO @
@  Q +xApa da=dvwKj|Z~gT\UmOxsxb/IKyL oV&1$=X' y ;file|^|YaBBImages/thread.gif|^|162|^|1008719097
GIF89a       k!   ,      @OI+
MF7 Gha70VMafr.X"(Fmh6 tN |{)c0hoD ;file|^|YaBBImages/thumbdown.gif|^|1003|^|1008719097
GIF89a                !  $  050<
9';'< ;+;+<+?3]@'A3H J$B3F5C:F<Q:c d#$f%.c$5j*>q/5s1:~8:OFOHTFPOTHS RT!TT"U_)Um.Bo0Fr4P~>T>T>< >$;<KZ>AMCTDTEWTDQ^XYX_[^QbTbUfWhYmZi]tY@ZMfOmWt^f~f~g~ktoupmqnwipvsutsuvvwwt{vzz{|z|hK                                                                                                                                                                                                                                                                                                                     !   ,        1	|p@  $'e@cF&f!,$:XPMaSFCB
	1D|L	C$F9XFXOG%
-:4C%J"1$#y #	TTh :tERrq&`@P,>JJc ;file|^|YaBBImages/thumbup.gif|^|1003|^|1008719098
GIF89a                !  $  050<
9';'< ;+;+<+?3]@'A3H J$B3F5C:F<Q:c d#$f%.c$5j*>q/5s1:~8:OFOHTFPOTHS RT!TT"U_)Um.Bo0Fr4P~>T>T>< >$;<KZ>AMCTDTEWTDQ^XYX_[^QbTbUfWhYmZi]tY@ZMfOmWt^f~f~g~ktoupmqnwipvsutsuvvwwt{vzz{|z|hK                                                                                                                                                                                                                                                                                                                     !   ,        1	1P	)ThDLAt(CH T`:$>H9!3`"$t	?&
)Yr5;F`#{UbI S|	0x
"ED.nS&v4!b@AKpt !14a\X)q P ;file|^|YaBBImages/tline.gif|^|68|^|1008719099
GIF89a            !   ,      @XfJopD ;file|^|YaBBImages/tline2.gif|^|79|^|1008719100
GIF89a            !   ,        ^<p"{q&ma*RZ ;file|^|YaBBImages/tline3.gif|^|93|^|1008719100
GIF89a)                !   ,    )  @.3^dSjo3iuZbK/9|4\bp>L ;file|^|YaBBImages/tongue.gif|^|947|^|1008719101
GIF89a       )) 1) 1)11          11 !   ,        ` .(Xa(%|x 50pG$#   L@A g|Y)iT( T*J(7A p   fjhj[| mZ
$@ ;file|^|YaBBImages/tr.gif|^|179|^|1008719102
GIF87a       9k,      @hI-z C6ygy_i pH,erTg,[/I:hgE6mL~WVgp.?7\vU0ze!(|| ;file|^|YaBBImages/undecided.gif|^|945|^|1008719102
GIF89a        )) 1) 1)11BB            !   ,        (@6(x(  $HE(P  G*Y Df	V7U*O@w4 ,m@  O!4f h"mZZ&V-Bd;0  ;file|^|YaBBImages/underline.gif|^|173|^|1008719103
GIF89a       !   ,       ZI%}e*4 6(~(6G I69O$SVq1/ljx]S`NyE  ;file|^|YaBBImages/url.gif|^|1044|^|1008719104
GIF89a          c  )c )c) ))))cZZZcccksss!   ,        9HA8PXC (tb#N\h.>@ 
` 9` /`rfYI\8tB z  %	@R#h`</x fRl!TxKa'
>_U8MZ@qLl *@;%wf+kH
vm	H|q'p(_s K8  ;file|^|YaBBImages/vcss.gif|^|1547|^|1008719104
GIF89aX    sG6dT|LLL,,,   }}}!UMdD]]]&YEp<<<lzmmmfc f{JJJJ333#Zfff_m6<0mW+YFL<LR[H$,#	|>1999N^  f3 a  3JZX{sf(  f f f f f f f f f f f f f f f f f f f f f f f f f f f f f f f f f f f f f f f f f f f f f f!
Valid CSS! !   ,    X   $$ %GF+%  	
 <!xEI-&`
P P&@B`M  C H`8DTIJ.L@${$ po
#i9tp*|C1$(0) 0pXd`A@: 6@H.RIH7i  ,l  xM7 kGAZu;p8u)12701< c 6J>jXN+Q`	98t/@"x% K,e9.U"WR8%`5aA =&9 %&@FlYFpw@dWwbenH`Z % 	p"\"IY`m_W9	B(ESIq9	T	#@H'K s7M"C@[E  <p3=mDH,DVRO,D@Y%6)ejQ7GA  D/fZZH W0z2iJ42:KNl<zpr-1{^Cl>(?!lG,Wl
g0Q !
  ,  $     	
 	   L  ~@  ,n y;Aj{r$DAgi[7Bs%ebi^; 'Z*P?D$w+T#aDMr 7;#P/D6Q<BD	$o L{0+XC ;file|^|YaBBImages/veryhotthread.gif|^|165|^|1008719105
GIF89a       k  !  	 ,      @R0Ik
h  Gha	eu@C@YPhR<8,%5 |  ;file|^|YaBBImages/vhtml.gif|^|2328|^|1008719106
GIF89aX   )))111999BBBJJJRRRZZZccckkksss{{{{{sskkZZ     kc!9)9)J!J!c1Z)R)s9k1B{9cZRJB{skZRJ9){Z1ZB!RZc1B1{kR{RsZ1ckR)RBZcJ!k)ZZcZRcJZcs9R!sRZZcZkRB!Bc{c1RZJ{9sZ)s1J9kR!{kcRZcZcs9JZ)!ZcBk1{RZckcR)ccJ{9ZJ!BckZ){sskRZRZ911))!k{sRssRRJ{ BJJZscB{9sZ9BJ JskRJ{1k)cRJ BZ9k!ZJJ B{cBs!R 9 1{ 1 ){BBJ99J                                                                                                                                                   !   ,    X  @ -H-HZ#FE  ,[+#dJyX_(s	LcN(}Hy<3(O$pT% g="}yf$9[jNB+bkb 3[H Znzu+VVj|uoV\"L[kYsH&y8S4j5g@uE;
szqO\z(k Nr:E, jKQCocL-N|tn<EH"Am&0docyb0!#3bL,0^F@AFgl4a(AYD3(0%Iv(OJ!fe_yAs1)]xaih&Vp$E]2%rEtVSbQP08(U(Z"OEE8L8AXs]}GGGJF3JFAF8Fm<_z<GqT>I@]`hlQI `/CX(b0h Ae5%X%qyUlW&7G#18fo(*m2r+o.LV e&lL$$OalWB%X3%0uvbK.G"*6pi4E y`Llm &c[x!X1n52!UA(w+Nx~7GG\0Rbq.pgz~^es^l6[P#+b]0 3B@	N_T {F	sK1)~Tc+ d  p 9B
{b0*+yC%:?`	 Hq] X2~1\2HH4EP ^d@Y  v 2\gT `aU[HKk+-3K)qDf.1R9%ExbvF1@rc"$X$
E1pi&oC0xa	k\`HFRc# \1
X*H&]4"j /|^F!?	TT[uZ~x (	U4	 MVdXC#<[CRmN% E%{'  '!>B#,4# cbyiAWC 0A	p6 jd[LWyyI^&<(,@:dL
},f3Y(xg3rVb  ;file|^|YaBBImages/wink.gif|^|944|^|1008719107
GIF89a       )) 1) 1)11           !   ,        ` .(Xa(%|x 50pG$  $P   cL&)SQv*Z(6p @,jTgLYr}z^uY	c:p B  ;file|^|YaBBImages/www.gif|^|999|^|1008719107
GIF89a    {1ZJZ!Z)cc!!9kBZRc)!!!JZ!J!Z!k)!s9)))1)9)Zs)Z)c9)k)k){ ))B11111119191B1J1Z1k1k1k1 999B9J9Z99kBBBJBRBRBZBsB{BBBB9JcJcJkJ RRRsRRR9ZZZ{ZZBccccc1kkkkkk!sssssssk{9{1JBkkJBk{k!  t ,      @ H"B@a",007r	"c%A2<  N8cq	\\T,T44pADf @X"H.i~2glB0[r`C CH$LPbD0$0hP 	+$h@ \ 
If]M'  ;file|^|YaBBImages/www_sm.gif|^|999|^|1008719108
GIF89a    {1ZJZ!Z)cc!!9kBZRc)!!!JZ!J!Z!k)!s9)))1)9)Zs)Z)c9)k)k){ ))B11111119191B1J1Z1k1k1k1 999B9J9Z99kBBBJBRBRBZBsB{BBBB9JcJcJkJ RRRsRRR9ZZZ{ZZBccccc1kkkkkk!sssssssk{9{1JBkkJBk{k!  t ,      @ H"B@a",007r	"c%A2<  N8cq	\\T,T44pADf @X"H.i~2glB0[r`C CH$LPbD0$0hP 	+$h@ \ 
If]M'  ;file|^|YaBBImages/xx.gif|^|962|^|1008719109
GIF89a                _`_`p??opp`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        !  : ,        )8P^(t!u$dHE&\	"0`P0EG-P B'NiD.:Y3M
.VDH
EA7'(sDB(1UjP+	f!bW4pKW*,XA+F ;file|^|YaBBImages/yim.gif|^|873|^|1008719109
GIF89a       3  f         3 33 f3 3 3 3  f 3f ff f f f   3 f      3 f      3 f      33 3f 3 3 3 3 33333f33333333 f33f3ff3f3f3f3 333f3333 333f3333 333f3333  f3 ff f f f f 3f33ff3f3f3f3f ff3fffffffffff f3ffffff f3ffffff f3ffffff  3 f     333f3333 f3ffffff 3f 3f 3f  3 f     333f3333 f3ffffff 3f 3f 3f  3 f     333f3333 f3ffffff 3f 3f 3f                                                                                                                        !   ,       F i	H*,X  @f,@Qc)$hQD6I2@-~48Hs0  ;file|^|YaBBImages/yse.gif|^|11355|^|1008719111
GIF89ax     9!!!)!1!!1!)1!)9!1B))))1B)1J)9J11119J19R1BR9999BZ9Jc9JkBBBBJkBRkBRsJJJJZsJZ{JcRRRRcRcRkZZZZkZsZsccccscsc{kkkk{ksssss{{{{{!   ,    x @ H*\#JH3j CI(F20XiC-ShO/8b
2D~'Ca0c:iU$=zISzI$KbZu;7q9jQ	EqLAr!'&*(j}d EK!8<y"CnUb|X`E$a Iq"0 '12d7^9rG^=}u]xw\|D_fFx|I]0'!i1UDuXY10ATV:<q#Z9%O4GoC+2%SdOx'5\`k4
w  Dy^|I/dVNB)eTTZ9S^Y`eI&
Q!'<ZTcIe_%]f|2aDr$ Q4	2xt'ZFxvi2.z SK&,
lf7+oFZ@Ip=gf8DUZ0np0/qQxZFV1z5CE(E}
"cE'2#l1jl. X`D%d&K4PP6`uY($74A?_DT>1:A+~2E

j!}k@j.dVaU{SW?Y"A^xc{UH~:k[@APAG4Q  &pC}4;C
!X@!5X=0  (P	%p %@]7L$rd+IIkj	+T)*].>y2RP"8Y	<B0"\Bvu 4@h,@@Dd 7  P 0[Tx@%__^FL33`2 OaE*2 M"Wp(lL{F?@eg4r(2b| U:$XV	dPh&A.0d 9 *Xh  @D@ c<@EH`@(T $vM@
0 
 9R?]R@d@ ZA<06fd`@@d <	R0@oTi7@tX@ @=0A	B@Fi H  ,p5 xfH{?(F+dul<OI)P)	]c }}d'KZf7zr:S5R\d6w]RZhk!
JTLA/T6|5@j{04VZcFpIYO/}pU!+5Dys.epdKdWpNG8*	x;e&%
88
tti]\oq>`LYK8+ACc+:x<
.x22p n#\}F NNDOJZ"Ap,8#b`C,SYK2"ir{D@m4x -gJZiM e0z!`/&Ig6ug@4@GQ~V fJeJoz2~ #og[=@7k( 	4w
m7R#+A	G18!^9QG nB\tL1wSF"P*zM^R0RYCty	7`Qis%u[=2,V	   2!YNmV&P0@*t@X%l	Kx)@u~!QXaw8:/'I_D?@#S(V *.]a?	,9Ag230A4%\4\X hV?@yUwyI"/@VOFPlmB(#&8; $hl$RJ=!3 s 0FP ?$`.PT8%OP&@Dg P  @`U9 JL#2;!C@O+$feUu6_Y:}@'a`L+~(0 MMe D@Wb#K1Ok.6`4A`xK = V7K0 LT;Yeaddx[ ?  eQ	P60  !@P; $@	 R p=?ASedUW06 x\1xBiEVV&0?qYY@M~; @Yu5^ "9$Y&y(*,Z)(}Aa`9i|.	ZC*{lc;>wt2{[Cr6"[QL }wQXh\eA50#QU@gF)/`FSZ1cQP&Vptk9g@J1<	Q/YQHA)bG7G&	%)qv1kI`!jyOg5@ '@G#p]CD@3b,kFQ3*|:S:AOc9)IItdi "+6]S]2/0,[/SF0pj#'pI-!D]QjY&j2% fA|fro<!~#(z&(GoGi|vKIA*Z2'0) _r 8mpJ'BfH38dk"dl{feC 8 : (Bh2N`#jJdUnZ)sguzQ}Z!B
!ybX!E%1^0C  #2#'DRGXio*#zE+=TmF0%eVu29GA*2\jA^11Rq&G?2 '7W#Fzud80)Db!2j[3-:j2, 3ve:0zPz+mW,	+^a`q	Q2UgU="<vAd	nfpS"OZ'`IPjq
[cBhpC+Uk,/)F9Q.~'=I[8[rZ^e@C-lBtEBJztV#Ki(G Ew.%aIhXBbF=09,-)Vj+_Ge8^iq9qG~P,22s;Q\4XPUSS& (E\, Xdx@gZ/uC^2C'jS`T9:K4{41\[L;Hi	,H%6? &R0yC; =P0L<;@QKpUTBZv${
q[R[CY1`V%JJq!H5nsS++7kC^p)cH+vxPKPCMpG # !@(@UVR`XH<y6	  	 M -54 2==A W2r=/,8.Sq-/a@rl4a
[1s5mC-ABo#%k '%` PMCW	V)  qW=0=  96P@5R6	#h9r|D+)rIt]1|1Fs`<m"[@]$J0!@]=y7,  %P4p#Q`FH S [><`yw5'GF(/;IbmIrb""#{`cRAu1=9K@?3?GP % xO;`x\`q7?
 @ 
 )MM0F{$g-CA&A;R!VH#)/01~D-A8e^bBp,P0 . Ln(0Ui ,J!! D
@Vl& DPQTf{Zvty 7$QsCm4h*uHTfC^G;y(!}'=Q5K`Q!?tU6&T9s6Pg`w=pC`syA.p7Xp8  F
0y,M$ X6@@yM`Uo0wTOs 7U:5T:0aC@k< =HN$ 8H(`N%  WDD@TM\65aNa.IU/P@4 y  1Q><7!K<3 M!MPR-Ap3hq"An  4Vy8! *!10GPP"y;a7^ <LnyUW}O`(izYw~?_?_qYR(k=AR@ba4O+1%Y0mBndA%fY;%5 Y7gB$^FnW7WxaeF)@el^$XA	.dC%NXBFp$Bq)O"0b8z2I'Qhyhe+|x'S.>1dJQuA/Z&e=ZjMF1nUiEy/C-Ozx @G :xeCj< $!'VB$:G#ag1a^ kqJ(Sf&u[[;s"pHwjMbH-^qR
#S.l0
j.B(Xkn	 0tC"
z;
@#`6Xa$:G,DrH"+AdxL6> zx@lrJO!4$)A 5C#B5kH"4$rb+!
/!5tN9|N<';AI,D+rTRKRVnNPxh7(NHlMedlL z0;] euhk5	nphrT]4M5`{b^8(``+P	n.8J|Hz(_%_@O0%&+jwg>[;;APANlM&/j8z N sSN;%=Vi*S=.'	=A&`g}WC*Np}!DtF-:z#J]@A[]\V~ VlFXk(1x!?>A6Hilzj.`>"1fSbpP)	Xv'#9;B 7"Pk`W2,dc^]87'A?# F#J2Y]`VDA:8V0e!%6[J6p
0+ZQV@_a)^Vy2hT
?1%I|;dw0"iQ B>0!	}VP7}p@8A4Cxc/p'u+(6a X3@@%LD@~L*42}x18-4q@Mkb|_d%yO\+m~)y(/_-d
`phr
))E`8T1c&`4gMhd368@R )9t;2etRjfnSS~: F&_okIJP,!%xA@N$\3c)<I 5
p`M<K:S,
5+W2GBaX)FUvmCH^(`P@$Ya*"AX$G?*t
C@3`gj	p&nbMs)c56%ZJ$8T3eQ5/j-(le&U	##F]apn_+_^9gs)@	7"J 7 41= ^OE$;Q`XBCpa@~1B	_(Y0@9%3{l&\3YGt"uF'= sl)K\!;%:Gxg?:Rv 9-P"B'PQV>vaA=1{td+k%%f#Xh8?Xx,7,D; 
^L*H
op( hT+ 	X)2(gG86g< AG8]550V{71a^maPQdtSFv|kx
 
F8$ gN+P
Jh  B@Pa,dA@M"`3AqC"+wW|~lN8Zz P5	`n5/1TvZ7!p	O\@KHS$@+ KB %4 P5@$)8+ ``<)4'p"(;$8- pL&a :	0"$
 t'X!< "l#L%lBe,h  `<@h*;%"X*;(  !  D'@<H^SXE:":$|:_>f{;*R `a,Yefj0l4*h% "8HL	(@zp<ds&+9 0    HC[C  LE3DR!-p:(
+A6L"$ 
 ;q`Y3oLK*JeA!y TE EhG P< ~;<)C    @ P 	 RCD$h880H5*M[]10 )!|7{
IqHZd`m2d1N*"NH $';	  H28CpG{G #\DD` 
,"5(S"$b$^N 	i'+'-`P gQP+5PQ=
u.(    9rH2 8$h<) P?)9%L]!=# 
I8X^Z {]}"adSsDEm/? h8-L0
 "X8) H
L(&,/ |SRI(MJ`e
5S0(rW.!mK`w88  0\U,  ""Mh.X!(S~{A"51A \1W1  ;Ax$2=ZThW @` l @HX<UHU 
@  PF  ~8X gEIOYs"YYV"Ne\-p&Z0X`H+ CR-K,S@`  %%(&YMI!06``*(8
`,/%@8;@]3`H(QB4*@U  G^N%(Z7(8`rx	0BWg6j.[	!c&yrIZ,S%P%`@a` `9@8# . H OePL&KV$'6#[NBRY
`	 #1,hk^.q5l 5e&P <|dH%d Nd#@Q\W(2Dr!e+R!' @~q.tt0-Li[M&.('[j/|d@5?  OH %P d^GX M?PP"h]%)uPl0L	K*0nl~llllf* UG|x^PL bwh aF, 	(tZ  `>OhL@	 ->)xCmj-p WMJ>7tX +@ m Y,P$(p 0G"Rk" A)n70]jNL4| (SC (G{LXfG~d4K!!rOrwXm	to  lNGd `R~CR9&#:Wr<WhMU] 8X%LxLLh VaXxGNd F&U;o@+3;RsT_C ((\p Dk!0L+ud8de's9Ougw/Nt~CNV[,D0lXavSvwg/s8$<! Y!GvwO[@Pu-8Rlxxxxxxyy/y?yOy_yoyyy/  ;file|^|YaBBImages/clip.gif|^|862|^|1008719004
GIF89a    f3 f3 f3 ffffff3f 3333f333     f 3  f3 f3 f3 ffffff3f 3333f333     f 3  f3 f3 f3 ffffff3f 3333f333     f 3  ffffff3f ffffff3f ffffff3f fffffffffff3ff f3f3f3f3ff33f3 f f f f ff 3f  3333f333 3333f333 3333f333 3f3f3f3ff3f33f 33333333f33333 3 3 3 3 f3 33      f 3      f 3      f 3   f f f ff f3 f  3 3 3 3f 33 3         f  3   !Made with GIMP !
  ,       ) CP@{*,a!>tqD#RxQ#F
 ;file|^|YaBBImages/info.gif|^|974|^|1008719032
GIF89a         3  f       3  33 3f 3 3 3 f  f3 ff f f f   3 f      3 f      3 f   3  3 33 f3 3 3 33 33333f3333333f 3f33ff3f3f3f3 333f3333 333f3333 333f333f  f 3f ff f f f3 f33f3ff3f3f3ff ff3ffffffffff f3ffffff f3ffffff f3fffff   3 f   3 333f333f f3fffff 3f 3f 3f   3 f   3 333f333f f3fffff 3f 3f 3f   3 f   3 333f333f f3fffff 3f 3f 3f                                                                                                                        !   ,        	A*<xD[)le-"X,~4Y`kUglfEDu^$Vf!dTAriX$*"/^feqeC4BWWQ+^;>,o@  ;file|^|YaBBImages/index.php|^|66|^|1008719032
<?
include ("../Settings.php");
header("Location: $boardurl");
?>
file|^|YaBBImages/afro.gif|^|158|^|1008718991
GIF89a!                 !   ,    !   c80I]{'^hBjEx|	@/Hf8R=64?al%LN)b9_PN,wm/Y|}l 	 ;file|^|YaBBImages/heart.gif|^|1270|^|1008719018
GIF89a!      kk

c_XpgY\q<I=

{    t      k    %.  c  (1  [    00    S    &0      L    *3;  C  3  '0  b]R+  jeZ#    ZUKUQIRMD]ZQeaZibUmh]e`UrlbZ;'bE3

B+MIAqj]]XMM1 \B3\LDJE=<'qTAmjajM:bI;^@-UPFS5"aZM.6wsm~cScB-cc##tYJ[[00lQ@JJU9'3/-{{--RR|sYRF-7CCaMBwodSNkk2<D@:vvgI6@@$$|+&#;;|zwpmk#\F:##YUS55aawpeMMU>2SSQH=ss#"		..kkkebsx;65ff{{{{aa22A=3/,..7CW^<22u>>djJIII2:I22IQtt2'%!Made with GIMP !
  ,    !    	H*\X=xp .\<l($
|x"`0 '_lAS2` C#P  HAP:	M#hP& ,SDu1Z+0+nBmPuE#zt&CEL/'0|8jNg~? (FLuNy~@%LU7AE{W Ax8fwd7t (zb_wrAzk/Ty$z
6BITC* x g6s@B#h'HB1NCu!$#gx!$Ab!9eA,EnU5ZiP]
Pp&@ RB P@ ;file|^|YaBBImages/snow.gif|^|256|^|1008719088
GIF89a   !   ,      @x&J@
aa!t)FQ	5F5 0&f@  WDm	I,gZ&)HM\Bl@z |&YOUYh44xf.m@,1zKv
YhB	 ;;[ru
`It?'	 ;G^#:d5#D	~- ;file|^|YaBBImages/sticky_locked.gif|^|944|^|1008719092
GIF89a       1  k9kBkB)ksss1 RZk      !   ,      @ 1H (@ "XB4p"B" &,(rB rD9 ?*(U!@fcB84jA[R'	&=AKWJxF ;file|^|english.lng|^|49702|^|1008823914
<?php
###############################################################################
# English.lng                                                                 #
###############################################################################
# YaBB: Yet another Bulletin Board                                            #
# Open-Source Project started by Zef Hemel (zef@zefnet.com)                   #
# Software Version: YaBB 1 Gold - Release                                     #
# =========================================================================== #
# Software Distributed by:    http://yabb.xnull.com                           #
# Support, News, Updates at:  http://yabb.xnull.com/community/                #
# =========================================================================== #
# Copyright (c) 2000-2001 X-Null - All Rights Reserved                        #
# Software by: The YaBB Development Team                                      #
###############################################################################
global $YaBBversion;
require_once("Settings.php");
$englishlngver="YaBB SE";

$txt[1] = "You are not allowed to access this section";
$txt[2] = "Admin";
$txt[3] = "Edit Categories (reorder/create/remove)";
$txt[4] = "Edit Boards (reorder/create/remove)";
$txt[5] = "View/Delete Members";
$txt[6] = "E-Mail Your Members";
$txt[7] = "Edit YaBB News";
$txt[8] = "Edit Member groups";
$txt[9] = "View all members";

$txt[10] = "Save";

$txt[11] = "YaBB Administrator";
$txt[12] = "Moderator";
$txt[13] = "YaBB Jr. Poster (over $JrPostNum posts)";
$txt[14] = "YaBB Full Poster (over $FullPostNum posts)";
$txt[15] = "YaBB Sr. Poster (over $SrPostNum posts)";
$txt[16] = "Additional member groups (one per line)";

$txt[17] = "Modify";
$txt[18] = "$mbname - Index";
$txt[19] = "Members";
$txt[20] = "Forum name";
$txt[21] = "Posts";
$txt[22] = "Last post";

$txt[23] = "Unable to open";
$txt[24] = "(No subject)";
$txt[25] = "Post reply";
$txt[26] = "Posts";
$txt[27] = "View Profile";
$txt[28] = "Guest";
$txt[29] = "Author";
$txt[30] = "on";
$txt[31] = "Remove";
$txt[32] = "Messages in this topic";
$txt[33] = "Start new topic";

$txt[34] = "Login";
$txt[35] = "Username";
$txt[36] = "Password";
$txt[37] = "You should fill in a username.";
$txt[38] = "Password field is empty";
$txt[39] = "Password incorrect";
$txt[40] = "Username does not exist.";

$txt[41] = "Manage Boards";
$txt[42] = "Action";
$txt[43] = "Order";
$txt[44] = "Full name";
$txt[45] = "Add board";
$txt[46] = "Reorder Boards";
$txt[47] = "Current boards";
$txt[48] = "Removing board";
$txt[49] = "Removing messages";
$txt[50] = "Removing topic";
$txt[51] = "Done.";
$txt[52] = "Manage Categories";
$txt[53] = "Current categories";
$txt[54] = "Change order";
$txt[55] = "Remove category";
$txt[56] = "Create new category";
$txt[57] = "Only access for membergroup(s)";
$txt[58] = "leave empty if none";
$txt[59] = "Create";
$txt[60] = "Removing category";
$txt[61] = "Removing category datafiles";
$txt[62] = "Board Moderator";
$txt[63] = "Remove Topic";
$txt[64] = "Topics:";
$txt[65] = "Next";
$txt[66] = "Modify message";
$txt[67] = "You are not allowed to change this message";
$txt[68] = "Name";
$txt[69] = "E-Mail";
$txt[70] = "Subject";
$txt[71] = "Message icon";
$txt[72] = "Message";
$txt[73] = "Only Moderators can use the direct remove function, please remove this message through the modify feature.";
$txt[74] = "This post has replies to it, you must first delete those...";

$txt[75] = "The Name field was not filled out. It is required.";
$txt[76] = "The E-Mail field was not filled out. It is required.";
$txt[77] = "The Subject field was not filled out. It is required.";
$txt[78] = "The Message Body was not filled out. It is required.";

$txt[79] = "Edit Profile";
$txt[80] = "You are not allowed to change this person's profile.";

$txt[81] = "Choose password";
$txt[82] = "Verify password";
$txt[83] = "Website title";
$txt[84] = "Website URL";
$txt[85] = "Signature";
$txt[86] = "Posts";
$txt[87] = "Position";
$txt[88] = "Change profile";
$txt[89] = "Delete user";

$txt[90] = "This topic is locked, you are not allow to post or modify messages...";
$txt[91] = "Password field empty";
$txt[92] = "View profile of";
$txt[93] = "You are not to lock or unlock this topic; you must be a moderator or administrator to do that...";
$txt[94] = "Total";
$txt[95] = "Posts:";
$txt[96] = "Website";
$txt[97] = "Register";
$txt[98] = "Choose username";
$txt[99] = "Username may only contain numbers and letters (example: yabber69)";
$txt[100] = "The username you tried to register already exists.";

$txt[101] = "Message Index";
$txt[102] = "News";
$txt[103] = "Home";

$txt[104] = "Lock/Unlock Topic";
$txt[105] = "Post";
$txt[106] = "An Error Has Occurred!";
$txt[107] = "at";
$txt[108] = "Logout";
$txt[109] = "Started by";
$txt[110] = "Replies";
$txt[111] = "Last post";
$txt[112] = "Keep current";
$txt[113] = "This member is:";
$txt[114] = "Administration Login";
$days = array('Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday');
$months = array('January','February','March','April','May','June','July','August','September','October','November','December');
$txt[116] = "Post+reply"; # There should be a + instead of spaces
$txt[117] = "Quote this post";
$txt[118] = "Topic";
$txt[119] = "Help";
$txt[120] = "Remove topic older than number of days:";
$txt[121] = "Remove message";
$txt[122] = "days old";
$txt[123] = "REMOVED";
$txt[124] = "Remove posts older than";
$txt[125] = "Notify";
$txt[126] = "Do you want a notification e-mail if someone replies to this topic?";
$txt[127] = "Topic reply";
$txt[128] = "A reply";
$txt[129] = "has been posted to a topic you are watching.\n\nView it at";
$txt[130] = "Regards,\nThe $mbname team.";
$txt[131] = "Notify of replies";
$txt[132] = "Move Topic";
$txt[133] = "Move to";
$txt[134] = "You are not allowed to move topics...";
$txt[135] = "Set censored words";
$txt[136] = "One word per line in the form: fuck=f**ck";
$txt[137] = "Admin functions";
$txt[138] = "This service is only for members...";
$txt[139] = "Pages";
$txt[140] = "Users active in past 15 minutes";
$txt[141] = "Guests";
$txt[142] = "Users";
$txt[143] = "IM Messages Index";
$txt[144] = "Instant Message";
$txt[145] = "Reply with quote";
$txt[146] = "Reply";
$txt[147] = "Instant Messaging is only for members";
$txt[148] = "Send message";
$txt[149] = "The user you tried to send a message to does not exist...";
$txt[150] = "To username";

$txt[151] = "No messages...";
$txt[152] = "you have";
$txt[153] = "messages";
$txt[154] = "Remove this message";

$txt[155] = "Maintenance Mode";
$txt[156] = "Our Board is currently in maintenance-mode";
$txt[157] = "Our Forums are currently in maintenance-mode. Please try again later. Thank you.";
$mtxt[1] = "Subject for display:";
$mtxt[2] = "Message for display:";
$mtxt[3] = "This board is in Maintenance Mode.";
$mtxt[4] = "Under Construction.";
$mtxt[5] = "Our board is currently in Maintenance Mode. Please call back later.";

$txt[158] = "Users online";
$txt[159] = "Private Message";
$txt[160] = "Jump to";
$txt[161] = "go";
$txt[162] = "Are you sure you want to remove this topic?";
$txt[163] = "Yes";
$txt[164] = "No";
$txt[165] = "To post you must be logged in if you don't have an account yet register.";

$txt[166] = "Search Results";
$txt[167] = "End of results";
$txt[168] = "Search Again";
$txt[169] = "Display Next Page";
$txt[170] = "Sorry, no matches were found";
$txt[171] = "Displaying Results";
$txt[172] = "to";
$txt[173] = "Search Completed for Topics started by";
$txt[174] = "matches were found";
$txt[175] = "Started by";
$txt[176] = "on";
$txt[177] = "Search Completed for posts posted in by";
$txt[178] = "Topic Title";
$txt[179] = "Message Snippet";
$txt[180] = "Searching for messages containing";
$txt[181] = "Word found";
$txt[182] = "Search";
$txt[183] = "Set Search Parameters";
$txt[184] = "Please choose <b>one</b> of the following";
$txt[185] = "Refine Parameters";
$txt[186] = "Search for topics started by someone";
$txt[187] = "Search for topics posted in by someone";
$txt[188] = "Search by Forum";
$txt[189] = "Choose a forum to search in, or search all";
$txt[190] = "All";
$txt[191] = "Display how many results?";

$txt[192] = "Email successfully sent";
$txt[193] = "Back";
$txt[194] = "reminder";
$txt[195] = "Message started by";
$txt[196] = "Title";
$txt[197] = "Post by";
$txt[198] = "End of Posts";
$txt[199] = "Post not found";
$txt[200] = "List of registered Members and Top $TopAmmount Posters.";
$txt[201] = "Please welcome";
$txt[202] = "Clean active log";
$txt[203] = "Are you sure you want to clean the active log?";
$txt[204] = "Your version of YaBB is";
$txt[205] = "The current version of YaBB is";
$txt[206] = "Ban Members";
$txt[207] = "Set Reserved Names";
$txt[208] = "YaBB Admin Center";
$txt[209] = "I love YaBB SE!";
$txt[210] = "ATTENTION! Your message couldn't be saved. Please try again.<br><br>Your Message:<br><br>";
$txt[211] = "Last Edit";
$txt[212] = "Would you like to deactivate Notification on this topic?";
$txt[213] = "Passwords aren't the same.";

$txt[214] = "Recent Posts";

$txt[215] = "browser not compatible with these buttons";
$txt[216] = "Edit Your Forum Template";
$txt[217] = "Layout/Board Settings";
$txt[218] = "Boards/Categories";
$txt[219] = "Members/Mailing";
$txt[220] = "Variable";
$txt[221] = "Messages/Actives";
$txt[222] = "Forum Preferences and Settings";
$txt[223] = "Sorry, you must register before using this feature.";

$txt[224] = "The username field does not accept / in the query string";
$txt[225] = "The username field does not accept \\ in the query string";
$txt[226] = "Optional Components";
$txt[227] = "Location";
$txt[228] = "Personal Text";
$txt[229] = "Personalized Picture";
$txt[230] = "Can't open directory";
$txt[231] = "Gender";
$txt[232] = "Picture/Text";
$txt[233] = "Date Registered";

$txt[234] = "View the 10 most recent posts on the board.";
$txt[235] = "is the most recently updated topic";
$txt[236] = "Return";
$txt[237] = "to the board index.";

$txt[238] = "Male";
$txt[239] = "Female";

$txt[240] = "Invalid character used in Username.";
$txt[241] = "Invalid character used in Password.";
$txt[242] = "Invalid character used in Name.";
$txt[243] = "Invalid character used in eMail.";

$txt[244] = "The username you tried to register contains a reserved name. Please try another username. Reserved name: ";
$txt[245] = "Registration successful";

$txt[246] = "About to remove topic";

$txt[247] = "Hey,";
$txt[248] = "Welcome,";
$txt[249] = "Please";
$txt[250] = "Back";
$txt[251] = "Please select a destination";

$txt[252] = "Add YABBC tags";
$txt[253] = "Bold";
$txt[254] = "Italicized";
$txt[255] = "Underline";
$txt[256] = "Centered";
$txt[257] = "Insert Hyperlink";
$txt[258] = "Insert Email";
$txt[259] = "Insert Code";
$txt[260] = "Insert Quote";
$txt[261] = "Insert List";

$txt[262] = "Black";
$txt[263] = "Red";
$txt[264] = "Yellow";
$txt[265] = "Pink";
$txt[266] = "Green";
$txt[267] = "Orange";
$txt[268] = "Purple";
$txt[269] = "Blue";
$txt[270] = "Beige";
$txt[271] = "Brown";
$txt[272] = "Teal";
$txt[273] = "Navy";
$txt[274] = "Maroon";
$txt[275] = "Lime Green";

$txt[276] = "Disable Smilies";
$txt[277] = "Check this if you'll be adding code (or don't like smilies).";
$txt[278] = "Reset Form";
$txt[279] = "Posted by";
$txt[280] = "Posted on";

$txt[281] = "Standard";
$txt[282] = "Thumb Up";
$txt[283] = "Thumb Down";
$txt[284] = "Exclamation point";
$txt[285] = "Question mark";
$txt[286] = "Lamp";
$txt[287] = "Smiley";
$txt[288] = "Angry";
$txt[289] = "Cheesy";
$txt[290] = "Laugh";
$txt[291] = "Sad";
$txt[292] = "Wink";
$txt[293] = "Grin";
$txt[294] = "Shocked";
$txt[295] = "Cool";
$txt[296] = "Huh";
$txt[297] = "Add Smilies";

$txt[298] = "Moderator";
$txt[299] = "Moderators";

$txt[300] = "Mark Topics as Read for this Board";
$txt[301] = "Views";
$txt[302] = "New";

$txt[303] = "View All Users";
$txt[304] = "View By Letter";
$txt[305] = "View";
$txt[306] = "Posters";
$txt[307] = "Email";

$txt[308] = "Viewing Members";
$txt[309] = "of";
$txt[310] = "total members";
$txt[311] = "to";
$txt[312] = "Viewing Members By Letter";
$txt[313] = "Viewing The";
$txt[314] = "Top Posters";
$txt[315] = "Forgot password?";

$txt[316] = "Inbox";
$txt[317] = "Date";
$txt[318] = "From";
$txt[319] = "Subject";
$txt[320] = "Outbox";
$txt[321] = "New Message";
$txt[322] = "Receive New Messages";
$txt[323] = "Preferences";
$txt[324] = "To";
$txt[325] = "Ignorelist";
$txt[326] = "Add one Username on each line.<br>Or enter * to ignore all messages.";
$txt[327] = "Notify by email";
$txt[328] = "Save Preferences";
$txt[329] = "Reset Form";

$txt[330] = "Topics";
$txt[331] = "Members";
$txt[332] = "Members List";
$txt[333] = "New Posts";
$txt[334] = "No New Posts";

$txt[335] = "Enter your name";
$txt[336] = "Enter your email address";

$txt[337] = "This field only accepts numbers from 0-9";

$txt[338] = "Send an email to the above email list";
$txt[339] = "Send";
$txt[340] = "Edit Ban List";
$txt[341] = "Set Reserved Names";
$txt[342] = "One word per line.";
$txt[343] = "Match all words";
$txt[344] = "Match any words";
$txt[345] = "Match as phrase";
$txt[346] = "Search -All- Members only";

$txt[347] = "This pages allows you to change every setting for your YaBB forum.  Be very careful with these settings, as they may render your YaBB dysfunctional.  Also note that some of these options are default options for guests only (such as time format).";
$txt[348] = "Maintenance Mode?";
$txt[349] = "Language Pack You Wish to Use";
$txt[350] = "Message Board Name";
$txt[351] = "Board URL";
$txt[352] = "Cookie Name - Username";
$txt[353] = "Cookie Name - Password";
$txt[354] = "Location of Sendmail Program";
$txt[355] = "Webmaster Email Address";
$txt[356] = "YaBB Directory";
$txt[357] = "Data Directory";
$txt[358] = "Members Directory";
$txt[359] = "Boards Directory";
$txt[360] = "Sources Directory";
$txt[361] = "Variables Directory";
$txt[362] = "Avatars Directory";
$txt[363] = "Images URL";
$txt[364] = "Help File";
$txt[365] = "Title BG Color";
$txt[366] = "Title Text Color";
$txt[367] = "Window BG Color";
$txt[368] = "Window BG Color #2";
$txt[369] = "Category BG Color";
$txt[370] = "Table Border Color";
$txt[371] = "Time Offset";
$txt[372] = "Number of Top Posters for Members List";
$txt[373] = "Members Per Page in Member List-All";
$txt[374] = "Maximum Topics to Display in the Message Index";
$txt[375] = "Maximum Messages to Display in a Topic Page";
$txt[376] = "Remove entries from user logs after _ days";
$txt[377] = "or";
$txt[378] = "Enable Bulletin Board Code?";
$txt[379] = "Enable News?";
$txt[380] = "Enable Guest Posting?";
$txt[381] = "Allow Email Notification?";
$txt[382] = "Show Latest Member on Board Index?";
$txt[383] = "Show Modification Date on Modified Posts?";
$txt[384] = "Show User Pics in Message View?";
$txt[385] = "Show User Text in Message View?";
$txt[386] = "Show Gender Image in Message View?";
$txt[387] = "Show News Fader on Board Index?";
$txt[388] = "News Fader Title Color";
$txt[389] = "News Fader News Color";
$txt[390] = "URL to News Fader file (fader.js)";
$txt[391] = "Use File-Locking?";
$txt[392] = "Lock EX";
$txt[393] = "Lock UN";

$txt[394] = "Mailprogram error.";
$txt[395] = "Send email to";
$txt[396] = "to ask for password";

$txt[397] = "The search field does not accept / or \\ in the query string";
$txt[398] = "Sorry, no matches were found";

$txt[399] = "The board field does not accept / in the query string";
$txt[400] = "The board field does not accept \\ in the query string";

$txt[401] = "no File-Locking";
$txt[402] = "Unix/Linux File-Locking";
$txt[403] = "Windows File-Locking";

$txt[404] = "Send Mails using";
$txt[405] = "sendmail";
$txt[406] = "SMTP";

$txt[407] = "SMTP-Server";

$txt[408] = "Minimum time between two postings from the same IP";
$txt[409] = "The last posting from your IP was less than";
$txt[410] = "seconds ago. Please try again later.";

$txt[411] = "Top";

$txt[412] = "Delete all messages in your IMBOX";
$txt[413] = "Are you sure you want to delete all messages?";

$txt[414] = "There are no topics with Notification marked.";
$txt[415] = "You are notified on replies in the following topics";
$txt[416] = "Activate checkboxes to <b><i>deactivate</i></b> Notification on Topic.";
$txt[417] = "Update Notifications";
$txt[418] = "Notification";
$txt[419] = "Show all Topics with Notification";

$txt[420] = "Age";
$txt[421] = "Use the <b>01/01/01 at 01:01:01<\/b> date\/time format.";
$txt[422] = "(no pic)";
$txt[423] = "Avatars URL";
$txt[424] = "YaBB Admin Options";
$txt[425] = "Your Version/Current Version";
$txt[426] = "Member Controls";
$txt[427] = "Forum Controls";
$txt[428] = "Forum Configuration";
$txt[429] = "Detailed Version Check";
$txt[430] = ", you are banned from using this forum";
$txt[431] = "Success! You are now a member of the Forum.";
$txt[432] = "Default Length for login cookies to last (in minutes)";

$txt[433] = "Insert Flash";
$txt[434] = "Insert Ftp Link";
$txt[435] = "Insert Image";
$txt[436] = "Insert Table";
$txt[437] = "Insert Table Column";
$txt[438] = "There are no topics with Notification.";
$txt[439] = "Marquee";
$txt[440] = "Teletype";
$txt[441] = "Strikethrough";
$txt[442] = "Glow";
$txt[443] = "Shadow";
$txt[444] = "Preformatted Text";
$txt[445] = "Left Align";
$txt[446] = "Right Align";
$txt[447] = "Superscript";
$txt[448] = "Subscript";
$txt[449] = "Insert Table Row";

$txt[450] = "Roll Eyes";
$txt[451] = "Tongue";

$txt[452] = "Mark ALL messages as read";

$txt[453] = "The user whose profile you are trying to view does not exist.";

$txt[454] = "Hot Topic (More than 15 Replies)";
$txt[455] = "Very Hot Topic (More than 25 Replies)";
$txt[456] = "Locked Topic";
$txt[457] = "Normal Topic";

$txt[458] = "Latest posts of: ";
$txt[459] = "Additional Information";
$txt[460] = "Show the last";
$txt[461] = "posts of this person";
$txt[462] = "GO";

$txt[463] = "All times are CST.  All dates are in MM-DD-YY format.";
$txt[464] = "Start+new+thread"; # + instead of spaces.
$txt[465] = "Print";
$txt[466] = "Message";
$txt[467] = "Profile";
$txt[468] = "Topic Summary";
$txt[469] = "Message";
$txt[470] = "N/A";
$txt[471] = "message";
$txt[472] = "This topic doesn't exist on this board.";

$txt[473] = "This name is already in use by another member.";

$txt[474] = "Select one or specify a web path (ex: <b>http://www.mypage.com/mypic.gif</b>) to your own image.";
$txt[475] = "I have my own pic:";
$txt[476] = "Userpic Width (0 = disable limit)";
$txt[477] = "Userpic Height (0 = disable limit)";
$txt[478] = "Text To Describe The Limits";

$txt[479] = "This selection will make dates throughout this Forum display in this format.";
$txt[480] = "01/31/01 $txt[107] 13:15:17";
$txt[481] = "31.01.01 $txt[107] 13:15:17";
$txt[482] = "31.01.2001 $txt[107] 13:15:17";
$txt[483] = "January 12th, 2001, 1:15pm";
$txt[484] = "01/31/01 $txt[107] 1:15pm";
$txt[485] = "31. January $txt[107] 13:15";
$txt[486] = "Time Format";
$txt[487] = "Time Offset must be between -23.5 and 23.5.";

$txt[488] = "Total Members:";
$txt[489] = "Total Posts:";
$txt[490] = "Total Topics:";
$txt[491] = "P.S. Your username is";
$txt[492] = "and your password is";
$txt[493] = "YaBB Current Version";
$txt[494] = "Users Version";
$txt[495] = "YaBB File";
$txt[496] = "YaBB Package";

$txt[497] = "Session Length in Minutes";
$txt[498] = "Maximum Allowed Characters in Posts";
$txt[499] = "Your message is too long. Please go back and shorten it, then resubmit.";

$txt[500] = "Please enter a valid email address.";

$txt[501] = "Maintenance Controls";
$txt[502] = "Recount All Board Totals";
$txt[503] = "All Board Totals have been recounted.";
$txt[504] = "Recount Membership";
$txt[505] = "Membership Total has been recounted.";
$txt[506] = "URL to YBBC JavaScript file (ubbc.js)";
$txt[507] = "Preview";
$txt[508] = "Always stay logged in";

$txt[509] = "Show Recent Posts Bar on Board Index?";
$txt[510] = "Show Members List Bar on Board Index?";

$txt[511] = "Logged";
$txt[512] = "IP";

$txt[513] = "ICQ";
$txt[514] = "Pager";
$txt[515] = "WWW";

$txt[517] = "Required Information";
$txt[518] = "This is the displayed name that people will see.";
$txt[519] = "Number hours to +/- to make displayed time in your local time.";
$txt[520] = "Used only for identification by YaBB. You can use special characters after logging in, by changing your displayed name in your profile.";

$txt[521] = "Use text menu instead of images?";
$txt[522] = "Show current position in forum as link instead of text?";
$txt[523] = "Show view profile button under post?";
$txt[524] = "Auto-link URLs?";

$txt[525] = "by";

$txt[526] = "embarrassed";
$txt[527] = "lips sealed";
$txt[528] = "undecided";
$txt[529] = "kiss";
$txt[530] = "cry";
$txt[531] = "Horizontal Rule";
$txt[532] = "Font Size";
$txt[533] = "Font Face";

$txt[535] = "Recipient";

$txt[560] = "You are not allowed to send IM to this user.";
$txt[561] = "New $mbname-Message: (SUBJECT)";
$txt[562] = "(DATE) SENDER has sent you the following Instant Message:\n\n->*<-\n\nMESSAGE\n\n->*<-";

$txt[563] = "Birthdate";
$txt[564] = "Month (MM)";
$txt[565] = "Day (DD)";
$txt[566] = "Year (YYYY)";
$txt[567] = "Invalid input in one or more of the Birthdate fields.";
$txt[568] = "Please shorten your name. It is too long ;)";

$txt[569] = "YaBB Newbie";
$txt[570] = "YaBB God (over $GodPostNum posts)";

$txt[571] = "Credits";

$txt[572] = "Search -All- Guests only";
$txt[573] = "Fields to Search";
$txt[574] = "Age since last post";
$txt[575] = "Min";
$txt[576] = "Max";
$txt[577] = "Any poster";
$txt[578] = "hours";
$txt[579] = "days";

$txt[580] = "BAD post num";
$txt[581] = ", our newest member.";

$txt[582] = "Search for";
$txt[583] = "by user";

$txt[584] = "Show and require agreement letter when registering?";
$txt[585] = "I Agree";
$txt[586] = "I Do Not Agree";

$txt[587] = "Default Time Format";
$txt[588] = "# Posts to become \"Junior Member\"";
$txt[589] = "# Posts to become \"Full Member\"";
$txt[590] = "# Posts to become \"Senior Member\"";
$txt[591] = "# Posts to become \"God Member\"";

$txt[592] = "There are invalid Characters in your personal userpic url or picture name.";

$txt[593] = "Rebuild the members list";
$txt[594] = "The membership list (memberlist.txt) has been rebuilt.";
$txt[595] = "Note: this will sort the list and the newest member will be the last entry after sorting.";

$txt[596] = "We suggest that you use 6 or more characters with a combination of letters and numbers.";
$txt[597] = "Additional Information";
$txt[598] = "This must be included if you specify a URL below.";
$txt[599] = "This must be a complete URL.";
$txt[600] = "This is your ICQ number.";
$txt[601] = "This is your AOL Instant Messenger nickname.";
$txt[602] = "This is your Yahoo! Instant Messenger nickname.";
$txt[603] = "AIM";
$txt[604] = "YIM";
$txt[605] = "Preferences";
$txt[606] = "Signatures are displayed at the bottom of each post or instant message. YaBBC code may be be used in your signature.";

$txt[607] = "Lock SH";
$txt[608] = "Delete Selected Members";
$txt[609] = "For purposes of security, YaBB asks that you please always use absolute paths. The '../' (parent directory) symbol is illegal. Please change your Settings.pl to use absolute paths instead of the '../' symbol.";
$txt[610] = "Repair All Boards and Topics";
$txt[611] = "YaBB must be in maintenance mode before you can use this feature.";
$txt[612] = "Repairing All Boards";
$txt[613] = "Processing Category";
$txt[614] = "Repairing Board";
$txt[615] = "Use Temporary Files When Appropriate";

$txt[616] = "Remember, this forum is in 'Maintenance Mode'.";


$txt[617] = "Are you sure you want to remove this board?";
$txt[618] = "Enable and Show 'Mark as Read' Buttons?";
$txt[619] = "Send welcome email to users when you do not have mail password turned on?";

$txt[630] = "Use 'Fake' File Truncation. This option should only be enabled if your server gives the error: 'truncate() not supported on this platform.'";
$txt[631] = "Please make sure you have 'fake truncation' turned on in your Settings.pl file.<br>\$faketruncation = 1;<br>Could not truncate file";

$txt[632] = "Disallow guests from doing anything but login or register?";
$txt[633] = "Warning!";
$txt[634] = "Only registered members are allowed to access this forum.";
$txt[635] = "Please login below or click";
$txt[636] = "-here-";
$txt[637] = "to register an account with $mbname.";

$txt[638] = "You've changed your email address. You will receive a new password by email.";
$txt[639] = "Email new password if a user changes his/her email address?";

$txt[640] = "Window BG Color #3";

$txt[641] = "Read";
$txt[642] = "times";

$txt[643] = "click to reorder the boards in this category";
$txt[644] = "This is your '$txt[208]'. You can modify your settings and template from here, as well as maintain your forum.<BR><BR>Please read the manual before you contact any form of support, and please be careful with these functions. You may also find answers to your problems on the <a href=\"http://yabb.xnull.com/community/\" target=\"_blank\">support forum</a> or the troubleshooting section of your manual.<br>You can also click the <img src=\"$imagesdir/helptopics.gif\" border=\"0\" alt=\"$txt[119]\"> symbol to find out how to use some functions.";
$txt[645] = "YaBB SE Stats";
$txt[656] = "Latest Member:";
$txt[657] = "Miscellaneous";
$txt[658] = "Total Categories:";
$txt[659] = "Latest Post:";

$txt[660] = "You've got";
$txt[661] = "Click";
$txt[662] = "here";
$txt[663] = "to view them.";

$txt[664] = "Max $MaxSigLen; characters remaining: ";

$txt[665] = "Total Boards:";
$txt[666] = "Check this box if you experience errors on an MS IIS server";
$txt[667] = "Check this box if you experience blank pages after posting (usually on MS IIS servers)";

$txt[668] = "Print Page";
$txt[669] = "Password Reminder";

$txt[670] = "Please place one news item per line. Some YaBBC tags, such as [b], [i] and [u] are allowed in your news, as well as smilies.";
$txt[671] = "This ID is used internally by YaBB.";
$txt[672] = "This is the name that will be displayed.";
$txt[673] = "List the membergroups you wish to give access to this category (it *is* case-sensitive). List multiple groups like this: group1,group2";
$txt[674] = "A board with the id";
$txt[675] = "already exists.";
$txt[676] = "A category with the id";
$txt[677] = "Edit your boards here. List multiple moderators as 'mod1s_username,mod2s_username' (these must be usernames and it *is* case-sensitive). Click the link on the category name and you can reorder the listing of the boards you see in that category. The board id is used internally by YaBB and to determine where posts are (see the url when viewing a board for an example).";

$txt[678] = "Sorry";

$txt[679] = "This must be a valid email address.";
$txt[680] = "The Administrator with username of 'admin' cannot be set to a different membergroup.";

$txt[681] = "Please inform the administrator of this forum to fix the \$facesdir setting immediately.";
$txt[682] = "This is your template for your YaBB forum.  You can change anything you like here, using HTML, and your Forum will automatically look different after you save the template.";

$txt[683] = "a whole lot";
$txt[684] = "Forum Administrators";
$txt[685] = "$mbname - Info Center";

$txt[686] = "online";
$txt[687] = "offline";
$txt[688] = "Send this member a private message";

$txt[689] = "Maximum allowed characters in signatures";
$txt[690] = "Time in minutes to log each click in your forum";

$txt[691] = "Total Clicks";
$txt[692] = "in the last $ClickLogTime minutes";
$txt[693] = "View forum access log";
$txt[694] = "IP Access";
$txt[695] = "Browsers";
$txt[696] = "Operating System";
$txt[697] = "This is a simple system that analyzes the log YaBB creates with each click someone makes in your forum. Use this as a rough estimate of the traffic, browser and operating system of $mbname visitors. The numbers in parenthesis beside each item is the number of occurrences of that item in your log.<P>You currently have logging set for $ClickLogTime minutes.";

$txt[698] = "This is your profile. You can choose which information to fill out, other than the required section. This information will be displayed in various places throughout $mbname.";

$txt[699] = "Reserved names will keep members from registering certain usernames or using these words in their displayed names. Choose the options you wish to use from the bottom before submitting.";

$txt[700] = "Welcome to";
$txt[701] = "You may change it after you log in by going to the profile page, or by visiting this page after you log in:";
$txt[702] = "Email Random Password to New Member Upon Registration?";
$txt[703] = "Thank you for registration. You will receive an email soon with your password. You may change the password after you login for the first time.";

##### do not translate these 3 lines except the words 'on', 'wrote', and 'code sample'
$txt[704] = '<BR><i>on DATE, <a href="QUOTELINK">AUTHOR wrote</a>:</i><table bgcolor="$color[bordercolor]" class="bordercolor" cellspacing="1" width="90%"><tr><td width="100%"><table cellpadding="2" cellspacing="0" class="quote" width="100%"><tr><td width="100%"><font face="Arial,Helvetica" class="quote" size="1">QUOTE</font></td></tr></table></td></tr></table>';
$txt[705] = '<BR><i>Quote:</i><table bgcolor="$color[bordercolor]" class="bordercolor" cellspacing="1" width="90%"><tr><td width="100%"><table cellpadding="2" cellspacing="0" class="quote" width="100%"><tr><td width="100%"><font face="Arial,Helvetica" class="quote" size="1">QUOTE</font></td></tr></table></td></tr></table>';
$txt[706] = '<BR><B>Code:</B><br><table bgcolor="$color[bordercolor]" class="bordercolor" cellspacing="1"><tr><td><table cellpadding="2" cellspacing="0" class="code"><tr><td><font face="Courier New" class="code" size="1">CODE</font></td></tr></table></td></tr></table>';
#####

$txt[707] = "Send the topic";
$txt[708] = "to a friend.";
$txt[709] = "The board is missing from the query.";
$txt[710] = "The topic is missing from the query.";
$txt[711] = "Dear";
$txt[712] = "I want you to check out the following topic";
$txt[713] = "To view it, please click the link below";
$txt[714] = "Thanks";
$txt[715] = "Your name";
$txt[716] = "Your email address";
$txt[717] = "Recipient's name";
$txt[718] = "Recipient's email address";

$txt[719] = "Your username is: ";

$txt[721] = "Hide E-Mail from public?";
$txt[722] = "hidden";
$txt[723] = "Allow users to hide their email from public (except admin)?";

$txt[724] = "IP banning: (e.g. 192.168.12.213 or 128.0.*.*) - one entry per line";
$txt[725] = "Email banning: (e.g. badguy@somewhere.com) - one entry per line";
$txt[7252] = "User name banning: (e.g. l33tuser) - one entry per line";

$txt[726] = "Match whole name only. If unchecked, will search for reserved words within name.";
$txt[727] = "Match case. If unchecked, search will be case insensitive.";
$txt[728] = "Check username.";
$txt[729] = "Check display name.";

$txt[730] = "That email address";
$txt[731] = "is being used by a registered member already. If you feel this is a mistake, go to the login page and use the password reminder with that address.";

$txt[732] = "Show Board Descriptions in the Message Index?";

$txt[733] = "Your password has been changed. It is now";
$txt[734] = "and your username is";
$txt[735] = "You can email anyone from this page. Your entire $mbname mailing list should appear below, but you may remove or add any email addresses you wish. Be sure that each address is separated in this fashion: 'address1; address2'.";

$txt[736] = "Are you sure you want to remove this category?";
$txt[737] = "Check all";
$txt[738] = "Below is a list of the category id's that you have. You may move them around (one per line) then submit to reorder them in that order. If you accidentally delete an id completely, you may type it back in and resubmit, and the category will reappear.";

$txt[739] = "Time in seconds to display each item in the news fader";
$txt[740] = "Show YaBBC Buttons on Posting and IM send Pages?";

$txt[741] = "Current forum time";

$txt[742] = "Total Clicks";
$txt[743] = "Total Unique Visitors";
$txt[744] = "Total Browsers";
$txt[745] = "Total Operating Systems";

$txt[746] = "Enable Members to Select Profile Avatars?";

$txt[747] = "could not be messaged. The usernames are either invalid, or they have you on their ignore list.";
$txt[748] = "(multiple recipients as 'username1, username2')";

$txt[749] = "The 'number of posts' box can only contain digits.";

$txt['yse1'] = "Failed to make backup of Settings.php";
$txt['yse2'] = "Installed 'Mods' Settings and Options";
$txt['yse3'] = "This page allows you to change the settings of mods installed in your forum.";
$txt['yse4'] = "Enable Sticky Topics";
$txt['yse5'] = "Server on which the database resides";
$txt['yse6'] = "Database Username";
$txt['yse7'] = "Database Password";
$txt['yse8'] = "Database Name";
$txt['yse9'] = "Enable Today Mod";
$txt['yse10'] = "<b>Today</b> at ";
$txt['yse11'] = "Edit Registration Agreement";
$txt['yse12'] = "This agreement is only displayed if you have toggled require agreement in your Forum Preferences and Settings.";
$txt['yse13'] = "Lock after Post";
$txt['yse14'] = "Check this if you wish to be notified of replies to this topic.";
$txt['yse15'] = "Check this if you wish to lock this thread after this post.";
$txt['yse16'] = "shortcuts (IE and NS6 only): hit alt+s to submit/post, alt+p to preview, or alt+r to reset";
$txt['yse17'] = "Enable Previous/Next Topic Mod";
$txt['yse18'] = "Previous Topic Link";
$txt['yse19'] = "Next Topic Link";
$txt['yse20'] = "Post New Poll";
$txt['yse21'] = "Question";
$txt['yse22'] = "Option";
$txt['yse23'] = "Submit Vote";
$txt['yse24'] = "Total Votes";
$txt['yse25'] = "shortcuts (IE and NS6 only): hit alt+s to submit/post, or alt+r to reset";
$txt['yse26'] = "You didn't select a vote option.";
$txt['yse27'] = "Either that poll doesn't exist, the poll has been locked, or you tried to vote twice.";
$txt['yse28'] = "This option is only available to registered members.";
$txt['yse29'] = "View results.";
$txt['yse30'] = "Lock Voting";
$txt['yse30b'] = "Unlock Voting";
$txt['yse31'] = "This was locked by an administrator.  You cannot unlock it.";
$txt['yse32'] = "Enable Polls";
$txt['yse33'] = "Show Polls as Topics";
$txt['yse34'] = "Disable Polls";
$txt['yse35'] = "Poll Mod Mode";
$txt['yse36'] = "Poll Posting Restrictions";
$txt['yse37'] = "Adminsitrators Only";
$txt['yse38'] = "Any Registered Member";
$txt['yse39'] = "Edit Poll";
$txt['yse40'] = "Reset Vote Count";
$txt['yse41'] = "Check this if you want to reset all vote counts to 0.";
$txt['yse42'] = "votes";
$txt['yse43'] = "Poll";
$txt['yse44'] = "Poll Editing Restrictions";
$txt['yse45'] = "Administrators and Moderators";
$txt['yse46'] = "Administrators, Moderators and Poll Creator";
$txt['yse47'] = "1 Day";
$txt['yse48'] = "1 Week";
$txt['yse49'] = "1 Month";
$txt['yse50'] = "Forever";
$txt['yse51'] = "Enable VB Style Login";
$txt['yse52'] = "Login with username, password and session length";
$txt['yse53'] = "1 Hour";
$txt['yse54'] = "Database Tables Prefix";
$txt['yse55'] = "Select the membergroups to whom you want to grant access to this category.  Hold down the ctrl key to select multiple entries.  Click the $txt[17] button when you are done.";
$txt['yse56'] = "MOVED";
$txt['yse57'] = "Please enter a brief description as to<br>why this topic is being moved.";
$txt['yse58'] = "Enable Compressed Output";
$txt['yse59'] = "This option will compress output to lower bandwidth<br>consumption, but it requires zlib to be installed.";
$txt['yse60'] = "Sorry, you don't have enough posts to modify karma - you need at least ";
$txt['yse61'] = "Sorry, you are not permitted to modify your own karma.";
$txt['yse62'] = "Sorry, you can't repeat an action within the wait time.  You must wait ";
$txt['yse63'] = "Sorry, this feature is disabled.";
$txt['yse64'] = "Disable Karma|Enable Karma Total|Enable Karma Positive/Negative";
$txt['yse65'] = "Restrict Admins to wait time";
$txt['yse66'] = "Set wait time in hours";
$txt['yse67'] = "Set the min # of posts needed to modify karma";
$txt['yse68'] = "Allowed membergroups (blank for all)";
$txt['yse69'] = "Karma Label|Karma Smite Label|Karma Applaud Label";
$txt['yse70'] = "Karma Mode";
$txt['yse71'] = "Inactive members for at least";
$txt['yse72'] = "days";
$txt['yse73'] = "Listing of board errors";
$txt['yse74'] = "The following errors are fouling up your board (blank if none)";
$txt['yse75'] = "has a bad first message";
$txt['yse76'] = "has a bad last message";
$txt['yse78'] = "Fatal Error";
$txt['yse79'] = "'s Board ID is";
$txt['yse80'] = "It, and any messages inside, will be deleted.";
$txt['yse81'] = "does not have a matching board";
$txt['yse82'] = "Board";
$txt['yse83'] = "does not have a matching category";
$txt['yse84'] = "Category";
$txt['yse85'] = "Would you like to fix these errors?";
$txt['yse86'] = "Fixing board errors";
$txt['yse87'] = "Error updating";
$txt['yse88'] = "in";
$txt['yse89'] = "Error creating a";
$txt['yse90'] = "the number of topics in ";
$txt['yse91'] = "the number of posts in ";
$txt['yse92'] = "All errors fixed! You will want to check on any created categories, boards, or topics to decide what to do with them.";
$txt['yse93'] = "Disable recent posts";
$txt['yse94'] = "Enable single post";
$txt['yse95'] = "Enable multiple posts";
$txt['yse96'] = "Sticky Topic";
$txt['yse97'] = "Locked Sticky Topic";
$txt['yse98'] = "Locked Poll";
$txt['yse99'] = "View All Inactive Members";
$txt['yse100'] = "Username/Email";
$txt['yse101'] = "by User:";
$txt['yse102'] = "by Email:";
$txt['yse103'] = "Disable output caching";
$txt['yse104'] = "Checking this box will make your board more secure.";
$txt['yse105'] = "Enable inline links";
$txt['yse106'] = "Enabling this will cause your current location to be down in a single line, as opposed to in a tree-like manner.";

$txt['yse110'] = "Attachments Mode";
$txt['yse111'] = "Disable Attachments|Enable All Attachments|Disable New Attachments";
$txt['yse112'] = "Display Attachment as Picture in Post";
$txt['yse113'] = "Check Attachment Extension";
$txt['yse114'] = "Allowed Attachment Extensions";
$txt['yse115'] = "Attachments Upload Path";
$txt['yse116'] = "Attachments URL";
$txt['yse117'] = "Max Attachment Size (in kB)";
$txt['yse118'] = "Max Attachment Folder Space (in kB)";
$txt['yse119'] = "Attach";
$txt['yse120'] = "Allowed file types";
$txt['yse121'] = "Maximum attachment size allowed";
$txt['yse122'] = "Your file is too large. The maximum attachment size allowed is";
$txt['yse123'] = "You cannot upload that type of file. The only allowed extensions are";
$txt['yse124'] = "There was an error saving your attachment, please try again.";
$txt['yse125'] = "Sorry! That filename is already taken. Please rename the file and try again.";
$txt['yse126'] = "The upload folder is full. Please try a smaller file and contact the <a href=mailto:$webmaster_email>administrator</a>.";
$txt['yse127'] = "Allow guests to post attachments?";
$txt['yse128'] = "Restrict attachments to member groups";
$txt['yse129'] = "To delete your attachment, leave this blank.";
$txt['yse130'] = "Check here to delete your attachment.";
$txt['yse130b'] = "That is a restricted filename. Please try a different filename.";

// Package manager
$txt['yse131'] = "Package manager";
$txt['yse132'] = "These are the files currently in your packages folder";
$txt['yse133'] = "NOTE that the package manager is very beta and to backup your files before trying it's features";
$txt['yse134'] = "Apply Mod";
$txt['yse135'] = "Use avatars";
$txt['yse136'] = "Add language";
$txt['yse137'] = "List files";
$txt['yse138'] = "Remove";
$txt['yse139'] = "Create a new package";
$txt['yse140'] = "Download packages";
$txt['yse141'] = "Package creator";
$txt['yse142'] = "Create package";
$txt['yse143'] = "Directory to pack";
$txt['yse144'] = "relative to your YaBB root directory";
$txt['yse145'] = "Root directory";
$txt['yse146'] = "the root directory, normally can be empty";
$txt['yse147'] = "Filename of package";
$txt['yse148'] = "Go!";
$txt['yse149'] = "Packing";
$txt['yse150'] = "You can download this package now from here";
$txt['yse151'] = "Download";
$txt['yse152'] = <<<EOT
Before you proceed you must be very sure that you want to do this. These mods come with no
warranty, and <b>might</b> screw up your board. Before proceeding make sure that:
<ul>
   <li>The modification is compatible with the current version you're running
   <li>You have backed up your current YaBB sources
   <li>You have a recent database backup
   <li>You only apply mods from trusted sources
   </ul>
EOT;
$txt['yse153'] = "Apply mod";
$txt['yse154'] = "Proceed";
$txt['yse155'] = "Applying mod";
$txt['yse156'] = "Extracting archive";
$txt['yse157'] = "Modification file was extracted, now the modification file which came with it should be applied.";
$txt['yse158'] = "Test (recommended)";
$txt['yse159'] = "Apply";
$txt['yse160'] = "Modification file was extracted, but this modification also comes with a php script which should be executed before it will work";
$txt['yse161'] = "Run";
$txt['yse162'] = "Modification file was extracted, this modification also comes with a textfile with additional instructions/information, it's recommended that you read it.";
$txt['yse163'] = "Read";
$txt['yse164'] = "Modding was done successfully. Everything should work now.";
$txt['yse165'] = "Wrote ";
$txt['yse166'] = "backup is called ";
$txt['yse167'] = "We're going to look for:";
$txt['yse168'] = "String <b>found</b>, I will now add:";
$txt['yse169'] = "String <b>not found</b>, there's probably an error in your mod.";
$txt['yse170'] = "String <b>found</b>, I will now replace it with:";
$txt['yse171'] = "Modification would have completed if this weren't a test, so if there were no errors, the mod could be applied, hit the back button in your browser.";
$txt['yse172'] = "Modification file was applied, ";
$txt['yse173'] = "Script output:";
$txt['yse174'] = "Additional notes";
$txt['yse175'] = "Instruction/Additional notes file";
$txt['yse176'] = "Extracting avatars";
$txt['yse177'] = "The avatars have been extracted, you can now use them.";
$txt['yse178'] = "Extracting language pack";
$txt['yse179'] = "The language pack has been extracted, you can now use it (by setting it in your settings).";
$txt['yse180'] = "List files in package";
$txt['yse181'] = "Files in archive";
$txt['yse182'] = "Package Get";
$txt['yse183'] = "Package servers";
$txt['yse184'] = "Browse";
$txt['yse185'] = "Add server";
$txt['yse186'] = "Server name";
$txt['yse187'] = "URL";
$txt['yse188'] = "Browse packages";
$txt['yse189'] = "No packages yet";
$txt['yse190'] = "Download";
$txt['yse191'] = "Could not connect to server or could not find file";
$txt['yse192'] = "Package downloaded successfully";
$txt['yse193'] = "Package has been downloaded successfully";
$txt['yse194'] = "Archiving";
$txt['yse195'] = "Skipping ";
$txt['yse196'] = " because it's a newer version or a version of the same age";
$txt['yse197'] = "Wrote ";
$txt['yse198'] = "Package Manager";

$txt['yse199'] = "Your Instant Messages";
$txt['yse200'] = "Enable SP1 style statistics on board index";

// attachment admin stuff
$txt['yse201'] = "Attachment Manager";
$txt['yse202'] = "From here you can administer the attached files on your system. You can delete attachments by size and by date from your system. Statistics on attachments are also displayed below.";
$txt['yse203'] = "File Attachment Statistics";
$txt['yse204'] = "Total Attachments";
$txt['yse205'] = "Total Size of Attachment Directory";
$txt['yse206'] = "Total Space Available in Attachment Directory";
$txt['yse207'] = "File Attachment Options";
$txt['yse208'] = "Attachment Log";
$txt['yse209'] = "Remove attachments older than";
$txt['yse210'] = "Remove attachments larger than";
$txt['yse211'] = "KB";
$txt['yse212'] = "Your curent uploads";
$txt['yse213'] = "Attachment Name";
$txt['yse214'] = "File Size";
$txt['yse215'] = "No maximum directory size is currently set";
$txt['yse216'] = "[attachment deleted by admin]";

$txt['yse217'] = "Live from www.yabb.info...";

$yycopyright = "<font face=\"Verdana, Arial\" size=\"1\"> $mbname | Powered by <a href=\"http://www.yabb.info/index.php?affiliate=$mbname&l=$boardurl&v=$YaBBversion\" target=\"_blank\">YaBB SE</a><BR>\n&copy; 2001-2002, YaBB SE Dev Team. All Rights Reserved.</font>";

$img[im_config_small] = "<img src=\"$imagesdir/im_sm_prefs.gif\" alt=\"$txt[323]\" border=\"0\">";
$img[im_new_small] = "<img src=\"$imagesdir/im_sm_newmsg.gif\" alt=\"$txt[321]\" border=\"0\">";

if( $MenuType == 1 ) {
	$menusep = ' | ';
	$img[admin] = $txt[2];
	$img[delete] = $txt[31];
	$img[email] = $txt[69];
	$img[email_sm] = $txt[69];
	$img[help] = $txt[119];
	$img[home] = $txt[103];
	$img[im_config] = $txt[323];
	$img[im_delete] = $txt[412];
	$img[im_inbox] = $txt[316];
	$img[im_new] = $txt[321];
	$img[im_outbox] = $txt[320];
	$img[im_reload] = $txt[322];
	$img[im_remove] = $txt[154];
	$img[im_reply] = $txt[146];
	$img[im_website] = $txt[515];
	$img[lock] = $txt[104];
	$img[login] = $txt[34];
	$img[logout] = $txt[108];
	$img[markallread] = $txt[452];
	$img[markboardread] = $txt[300];
	$img[message] = $txt[144];
	$img[message_sm] = $txt[144];
	$img[modify] = $txt[17];
	$img[newthread] = $txt[33];
	$img[newpoll] = $txt[yse20];
	$img[notification] = $txt[418];
	$img[notify] = $txt[131];
	$img[notify_sm] = $txt[131]; 
	$img[printt] = $txt[465];
	$img[profile] = $txt[467];
	$img[register] = $txt[97];
	$img[removetopic] = $txt[63];
	$img[reply] = $txt[146];
	$img[replyquote] = $txt[145];
	$img[reply_sm] = $txt[146]; 
	$img[search] = $txt[182];
	$img[sendtopic] = $txt[707];
	$img[viewprofile] = $txt[27];
	$img[viewprofile_sm] = $txt[27];
	$img[website] = $txt[515];
	$img[website_sm] = $txt[515];
}
else {
	$menusep = ' ';
	$img[admin] = "<img src=\"$imagesdir/admin.gif\" alt=\"$txt[2]\" border=\"0\">";
	$img[delete] = "<img src=\"$imagesdir/delete.gif\" alt=\"$txt[121]\" border=\"0\">";
	$img[email] = "<img src=\"$imagesdir/email.gif\" alt=\"$txt[69]\" border=\"0\">";
	$img[email_sm] = "<img src=\"$imagesdir/email_sm.gif\" alt=\"$txt[69]\" border=\"0\">";
	$img[help] = "<img src=\"$imagesdir/help.gif\" alt=\"$txt[119]\" border=\"0\">";
	$img[home] = "<img src=\"$imagesdir/home.gif\" alt=\"$txt[103]\" border=\"0\">";
	$img[im_config] = "<img src=\"$imagesdir/im_config.gif\" alt=\"$txt[323]\" border=\"0\">";
	$img[im_delete] = "<img src=\"$imagesdir/im_delete.gif\" alt=\"$txt[412]\" border=\"0\">";
	$img[im_inbox] = "<img src=\"$imagesdir/im_inbox.gif\" alt=\"$txt[316]\" border=\"0\">";
	$img[im_new] = "<img src=\"$imagesdir/im_new.gif\" alt=\"$txt[321]\" border=\"0\">";
	$img[im_outbox] = "<img src=\"$imagesdir/im_outbox.gif\" alt=\"$txt[320]\" border=\"0\">";
	$img[im_remove] = "<img src=\"$imagesdir/delete.gif\" alt=\"$txt[154]\" border=\"0\">";
	$img[im_reload] = "<img src=\"$imagesdir/im_reload.gif\" alt=\"$txt[322]\" border=\"0\">";
	$img[im_reply] = "<img src=\"$imagesdir/im_reply.gif\" alt=\"$txt[146]\" border=\"0\">";
	$img[im_website] = "<img src=\"$imagesdir/im_www.gif\" alt=\"$txt[515]\" border=\"0\">";
	$img[lock] = "<img src=\"$imagesdir/lock.gif\" alt=\"$txt[104]\" border=\"0\">";
	$img[login] = "<img src=\"$imagesdir/login.gif\" alt=\"$txt[34]\" border=\"0\">";
	$img[logout] = "<img src=\"$imagesdir/logout.gif\" alt=\"$txt[108]\" border=\"0\">";
	$img[markallread] = "<img src=\"$imagesdir/markread.gif\" alt=\"$txt[452]\" border=\"0\">";
	$img[markboardread] = "<img src=\"$imagesdir/markread.gif\" alt=\"$txt[300]\" border=\"0\">";
	$img[message] = "<img src=\"$imagesdir/message.gif\" alt=\"$txt[144]\" border=\"0\">";
	$img[message_sm] = "<img src=\"$imagesdir/message_sm.gif\" alt=\"$txt[144]\" border=\"0\">";
	$img[modify] = "<img src=\"$imagesdir/modify.gif\" alt=\"$txt[66]\" border=\"0\">";
	$img[newthread] = "<img src=\"$imagesdir/new_thread.gif\" alt=\"$txt[33]\" border=\"0\">";
	$img[newpoll] = "<img src=\"$imagesdir/new_poll.gif\" alt=\"$txt[yse20]\" border=\"0\">";
	$img[notification] = "<img src=\"$imagesdir/notification.gif\" alt=\"$txt[419]\" border=\"0\">";
	$img[notify] = "<img src=\"$imagesdir/notify.gif\" alt=\"$txt[131]\" border=\"0\">";
	$img[notify_sm] = "<img src=\"$imagesdir/notify_sm.gif\" alt=\"$txt[131]\" border=\"0\">"; 
	$img[printt] = "<img src=\"$imagesdir/print.gif\" alt=\"$txt[465]\" border=\"0\">";
	$img[profile] = "<img src=\"$imagesdir/profile.gif\" alt=\"$txt[79]\" border=\"0\">";
	$img[register] = "<img src=\"$imagesdir/register.gif\" alt=\"$txt[97]\" border=\"0\">";
	$img[removetopic] = "<img src=\"$imagesdir/remove.gif\" alt=\"$txt[63]\" border=\"0\">";
	$img[reply] = "<img src=\"$imagesdir/reply.gif\" alt=\"$txt[146]\" border=\"0\">";
	$img[replyquote] = "<img src=\"$imagesdir/quote.gif\" alt=\"$txt[145]\" border=\"0\">";
	$img[reply_sm] = "<img src=\"$imagesdir/reply_sm.gif\" alt=\"$txt[146]\" border=\"0\">"; 
	$img[search] = "<img src=\"$imagesdir/search.gif\" alt=\"$txt[182]\" border=\"0\">";
	$img[sendtopic] = "<img src=\"$imagesdir/sendtopic.gif\" alt=\"$txt[707]\" border=\"0\">";
	$img[viewprofile] = "<img src=\"$imagesdir/profile.gif\" alt=\"$txt[27]\" border=\"0\">";
	$img[viewprofile_sm] = "<img src=\"$imagesdir/profile_sm.gif\" alt=\"$txt[27]\" border=\"0\">";
	$img[website] = "<img src=\"$imagesdir/www.gif\" alt=\"$txt[515]\" border=\"0\">";
	$img[website_sm] = "<img src=\"$imagesdir/www_sm.gif\" alt=\"$txt[515]\" border=\"0\">";
}

?>
file|^|fader.js|^|3221|^|1008271546
/********************************************************************
  allbrowsers_fader.mod
  v2.0 11/12/2001
  YaBB integration & modification: NRg (yabb_fader@gmx.de)
  Latest version: http://www.talknet.de/~norbru/

  based upon:
  Fading Scroller by DynamicDrive.com  http://www.dynamicdrive.com
*********************************************************************/

// You can changes these three values to modify the output:
var frame = 50;  	// frame-range. standard = 50
var st = 30;  	// milliseconds between frames. standard = 30
var wait = 100;    // value to display the full text without fade
			// 1 = approx. 60 milliseconds. standard = 50

ie4 = document.all&&!document.getElementById;
ns4 = document.layers;
DOM2 = document.getElementById;

bR = HexToR(bcolor);
bG = HexToG(bcolor);
bB = HexToB(bcolor);
tR = HexToR(tcolor);
tG = HexToG(tcolor);
tB = HexToB(tcolor);
bR_m = bR;
bG_m = bG;
bB_m = bB;
tR_m = tR;
tG_m = tG;
tB_m = tB;

function HexToR(h) { return parseInt((cutHex(h)).substring(0,2),16) }
function HexToG(h) { return parseInt((cutHex(h)).substring(2,4),16) }
function HexToB(h) { return parseInt((cutHex(h)).substring(4,6),16) }
function cutHex(h) { return (h.charAt(0)=="#") ? h.substring(1,7) : h}

dir = ((tR+tG+tB) > (bR+bG+bB)) ? "up" : "down";
dirback = ((tR+tG+tB) < (bR+bG+bB)) ? "up" : "down";
dir_m = dir;
index = 0;
frame_m = frame;
framehalf = frame / 2;
wait_m = wait;
stepR = Math.abs(tR - bR) / framehalf;
stepG = Math.abs(tG - bG) / framehalf;
stepB = Math.abs(tB - bB) / framehalf;
step = Math.min(Math.round(Math.max(stepR,Math.max(stepG,stepB))),(240/framehalf));

function fade() {
 if (index>=fcontent.length)
  index = 0;
  if (DOM2) {
   document.getElementById("fscroller").innerHTML=begintag+fcontent[index]+closetag;
   index++;
   colorfade();
  }
  else if (ie4) {
   document.all.fscroller.innerHTML=begintag+fcontent[index]+closetag;
   index++;
   setTimeout("fade()",Math.min(delay,2500));
  }
  else if (ns4) {
   document.fscrollerns.document.fscrollerns_sub.document.write(begintag+fcontent[index]+closetag);
   document.fscrollerns.document.fscrollerns_sub.document.close();
   index++;
   setTimeout("fade()",Math.min(delay,2500));
  }
}

function colorfade() {
 if (frame>0) {
  if (frame==framehalf && wait>0) {
   document.getElementById("fscroller").style.color="rgb("+wR+","+wG+","+wB+")";
   wait--;
   setTimeout("colorfade()",50);
  }
  else {
   if (dir=="down") {
    if (bR>tR) bR-=step;
    if (bG>tG) bG-=step;
    if (bB>tB) bB-=step;
    }
   else {
    if (bR<tR) bR+=step;
    if (bG<tG) bG+=step;
    if (bB<tB) bB+=step;
   }
   document.getElementById("fscroller").style.color="rgb("+bR+","+bG+","+bB+")";
   if (frame==framehalf+1) {
    document.getElementById("fscroller").style.color="rgb("+tR+","+tG+","+tB+")";
    dir = dirback;
    wR = tR;
    wG = tG;
    wB = tB;
    tR = bR_m;
    tG = bG_m;
    tB = bB_m;
   }
   frame--;
   setTimeout("colorfade()",st);
  }
 }
 else {
  document.getElementById("fscroller").innerHTML=" ";
  dir = dir_m;
  frame = frame_m;
  wait = wait_m;
  tR = tR_m;
  tG = tG_m;
  tB = tB_m;
  bR = bR_m;
  bG = bG_m;
  bB = bB_m;
  (dir_m=="down") ? setTimeout("fade()",delay) : fade();
 }
}file|^|gpl.txt|^|18009|^|1008003807
		    GNU GENERAL PUBLIC LICENSE
		       Version 2, June 1991

 Copyright (C) 1989, 1991 Free Software Foundation, Inc.
                       59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 Everyone is permitted to copy and distribute verbatim copies
 of this license document, but changing it is not allowed.

			    Preamble

  The licenses for most software are designed to take away your
freedom to share and change it.  By contrast, the GNU General Public
License is intended to guarantee your freedom to share and change free
software--to make sure the software is free for all its users.  This
General Public License applies to most of the Free Software
Foundation's software and to any other program whose authors commit to
using it.  (Some other Free Software Foundation software is covered by
the GNU Library General Public License instead.)  You can apply it to
your programs, too.

  When we speak of free software, we are referring to freedom, not
price.  Our General Public Licenses are designed to make sure that you
have the freedom to distribute copies of free software (and charge for
this service if you wish), that you receive source code or can get it
if you want it, that you can change the software or use pieces of it
in new free programs; and that you know you can do these things.

  To protect your rights, we need to make restrictions that forbid
anyone to deny you these rights or to ask you to surrender the rights.
These restrictions translate to certain responsibilities for you if you
distribute copies of the software, or if you modify it.

  For example, if you distribute copies of such a program, whether
gratis or for a fee, you must give the recipients all the rights that
you have.  You must make sure that they, too, receive or can get the
source code.  And you must show them these terms so they know their
rights.

  We protect your rights with two steps: (1) copyright the software, and
(2) offer you this license which gives you legal permission to copy,
distribute and/or modify the software.

  Also, for each author's protection and ours, we want to make certain
that everyone understands that there is no warranty for this free
software.  If the software is modified by someone else and passed on, we
want its recipients to know that what they have is not the original, so
that any problems introduced by others will not reflect on the original
authors' reputations.

  Finally, any free program is threatened constantly by software
patents.  We wish to avoid the danger that redistributors of a free
program will individually obtain patent licenses, in effect making the
program proprietary.  To prevent this, we have made it clear that any
patent must be licensed for everyone's free use or not licensed at all.

  The precise terms and conditions for copying, distribution and
modification follow.

		    GNU GENERAL PUBLIC LICENSE
   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION

  0. This License applies to any program or other work which contains
a notice placed by the copyright holder saying it may be distributed
under the terms of this General Public License.  The "Program", below,
refers to any such program or work, and a "work based on the Program"
means either the Program or any derivative work under copyright law:
that is to say, a work containing the Program or a portion of it,
either verbatim or with modifications and/or translated into another
language.  (Hereinafter, translation is included without limitation in
the term "modification".)  Each licensee is addressed as "you".

Activities other than copying, distribution and modification are not
covered by this License; they are outside its scope.  The act of
running the Program is not restricted, and the output from the Program
is covered only if its contents constitute a work based on the
Program (independent of having been made by running the Program).
Whether that is true depends on what the Program does.

  1. You may copy and distribute verbatim copies of the Program's
source code as you receive it, in any medium, provided that you
conspicuously and appropriately publish on each copy an appropriate
copyright notice and disclaimer of warranty; keep intact all the
notices that refer to this License and to the absence of any warranty;
and give any other recipients of the Program a copy of this License
along with the Program.

You may charge a fee for the physical act of transferring a copy, and
you may at your option offer warranty protection in exchange for a fee.

  2. You may modify your copy or copies of the Program or any portion
of it, thus forming a work based on the Program, and copy and
distribute such modifications or work under the terms of Section 1
above, provided that you also meet all of these conditions:

    a) You must cause the modified files to carry prominent notices
    stating that you changed the files and the date of any change.

    b) You must cause any work that you distribute or publish, that in
    whole or in part contains or is derived from the Program or any
    part thereof, to be licensed as a whole at no charge to all third
    parties under the terms of this License.

    c) If the modified program normally reads commands interactively
    when run, you must cause it, when started running for such
    interactive use in the most ordinary way, to print or display an
    announcement including an appropriate copyright notice and a
    notice that there is no warranty (or else, saying that you provide
    a warranty) and that users may redistribute the program under
    these conditions, and telling the user how to view a copy of this
    License.  (Exception: if the Program itself is interactive but
    does not normally print such an announcement, your work based on
    the Program is not required to print an announcement.)

These requirements apply to the modified work as a whole.  If
identifiable sections of that work are not derived from the Program,
and can be reasonably considered independent and separate works in
themselves, then this License, and its terms, do not apply to those
sections when you distribute them as separate works.  But when you
distribute the same sections as part of a whole which is a work based
on the Program, the distribution of the whole must be on the terms of
this License, whose permissions for other licensees extend to the
entire whole, and thus to each and every part regardless of who wrote it.

Thus, it is not the intent of this section to claim rights or contest
your rights to work written entirely by you; rather, the intent is to
exercise the right to control the distribution of derivative or
collective works based on the Program.

In addition, mere aggregation of another work not based on the Program
with the Program (or with a work based on the Program) on a volume of
a storage or distribution medium does not bring the other work under
the scope of this License.

  3. You may copy and distribute the Program (or a work based on it,
under Section 2) in object code or executable form under the terms of
Sections 1 and 2 above provided that you also do one of the following:

    a) Accompany it with the complete corresponding machine-readable
    source code, which must be distributed under the terms of Sections
    1 and 2 above on a medium customarily used for software interchange; or,

    b) Accompany it with a written offer, valid for at least three
    years, to give any third party, for a charge no more than your
    cost of physically performing source distribution, a complete
    machine-readable copy of the corresponding source code, to be
    distributed under the terms of Sections 1 and 2 above on a medium
    customarily used for software interchange; or,

    c) Accompany it with the information you received as to the offer
    to distribute corresponding source code.  (This alternative is
    allowed only for noncommercial distribution and only if you
    received the program in object code or executable form with such
    an offer, in accord with Subsection b above.)

The source code for a work means the preferred form of the work for
making modifications to it.  For an executable work, complete source
code means all the source code for all modules it contains, plus any
associated interface definition files, plus the scripts used to
control compilation and installation of the executable.  However, as a
special exception, the source code distributed need not include
anything that is normally distributed (in either source or binary
form) with the major components (compiler, kernel, and so on) of the
operating system on which the executable runs, unless that component
itself accompanies the executable.

If distribution of executable or object code is made by offering
access to copy from a designated place, then offering equivalent
access to copy the source code from the same place counts as
distribution of the source code, even though third parties are not
compelled to copy the source along with the object code.

  4. You may not copy, modify, sublicense, or distribute the Program
except as expressly provided under this License.  Any attempt
otherwise to copy, modify, sublicense or distribute the Program is
void, and will automatically terminate your rights under this License.
However, parties who have received copies, or rights, from you under
this License will not have their licenses terminated so long as such
parties remain in full compliance.

  5. You are not required to accept this License, since you have not
signed it.  However, nothing else grants you permission to modify or
distribute the Program or its derivative works.  These actions are
prohibited by law if you do not accept this License.  Therefore, by
modifying or distributing the Program (or any work based on the
Program), you indicate your acceptance of this License to do so, and
all its terms and conditions for copying, distributing or modifying
the Program or works based on it.

  6. Each time you redistribute the Program (or any work based on the
Program), the recipient automatically receives a license from the
original licensor to copy, distribute or modify the Program subject to
these terms and conditions.  You may not impose any further
restrictions on the recipients' exercise of the rights granted herein.
You are not responsible for enforcing compliance by third parties to
this License.

  7. If, as a consequence of a court judgment or allegation of patent
infringement or for any other reason (not limited to patent issues),
conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License.  If you cannot
distribute so as to satisfy simultaneously your obligations under this
License and any other pertinent obligations, then as a consequence you
may not distribute the Program at all.  For example, if a patent
license would not permit royalty-free redistribution of the Program by
all those who receive copies directly or indirectly through you, then
the only way you could satisfy both it and this License would be to
refrain entirely from distribution of the Program.

If any portion of this section is held invalid or unenforceable under
any particular circumstance, the balance of the section is intended to
apply and the section as a whole is intended to apply in other
circumstances.

It is not the purpose of this section to induce you to infringe any
patents or other property right claims or to contest validity of any
such claims; this section has the sole purpose of protecting the
integrity of the free software distribution system, which is
implemented by public license practices.  Many people have made
generous contributions to the wide range of software distributed
through that system in reliance on consistent application of that
system; it is up to the author/donor to decide if he or she is willing
to distribute software through any other system and a licensee cannot
impose that choice.

This section is intended to make thoroughly clear what is believed to
be a consequence of the rest of this License.

  8. If the distribution and/or use of the Program is restricted in
certain countries either by patents or by copyrighted interfaces, the
original copyright holder who places the Program under this License
may add an explicit geographical distribution limitation excluding
those countries, so that distribution is permitted only in or among
countries not thus excluded.  In such case, this License incorporates
the limitation as if written in the body of this License.

  9. The Free Software Foundation may publish revised and/or new versions
of the General Public License from time to time.  Such new versions will
be similar in spirit to the present version, but may differ in detail to
address new problems or concerns.

Each version is given a distinguishing version number.  If the Program
specifies a version number of this License which applies to it and "any
later version", you have the option of following the terms and conditions
either of that version or of any later version published by the Free
Software Foundation.  If the Program does not specify a version number of
this License, you may choose any version ever published by the Free Software
Foundation.

  10. If you wish to incorporate parts of the Program into other free
programs whose distribution conditions are different, write to the author
to ask for permission.  For software which is copyrighted by the Free
Software Foundation, write to the Free Software Foundation; we sometimes
make exceptions for this.  Our decision will be guided by the two goals
of preserving the free status of all derivatives of our free software and
of promoting the sharing and reuse of software generally.

			    NO WARRANTY

  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY
FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN
OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES
PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED
OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS
TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE
PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,
REPAIR OR CORRECTION.

  12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR
REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,
INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING
OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED
TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY
YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER
PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.

		     END OF TERMS AND CONDITIONS

	    How to Apply These Terms to Your New Programs

  If you develop a new program, and you want it to be of the greatest
possible use to the public, the best way to achieve this is to make it
free software which everyone can redistribute and change under these terms.

  To do so, attach the following notices to the program.  It is safest
to attach them to the start of each source file to most effectively
convey the exclusion of warranty; and each file should have at least
the "copyright" line and a pointer to where the full notice is found.

    <one line to give the program's name and a brief idea of what it does.>
    Copyright (C) <year>  <name of author>

    This program is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; either version 2 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program; if not, write to the Free Software
    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA


Also add information on how to contact you by electronic and paper mail.

If the program is interactive, make it output a short notice like this
when it starts in an interactive mode:

    Gnomovision version 69, Copyright (C) year name of author
    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
    This is free software, and you are welcome to redistribute it
    under certain conditions; type `show c' for details.

The hypothetical commands `show w' and `show c' should show the appropriate
parts of the General Public License.  Of course, the commands you use may
be called something other than `show w' and `show c'; they could even be
mouse-clicks or menu items--whatever suits your program.

You should also get your employer (if you work as a programmer) or your
school, if any, to sign a "copyright disclaimer" for the program, if
necessary.  Here is a sample; alter the names:

  Yoyodyne, Inc., hereby disclaims all copyright interest in the program
  `Gnomovision' (which makes passes at compilers) written by James Hacker.

  <signature of Ty Coon>, 1 April 1989
  Ty Coon, President of Vice

This General Public License does not permit incorporating your program into
proprietary programs.  If your program is a subroutine library, you may
consider it more useful to permit linking proprietary applications with the
library.  If this is what you want to do, use the GNU Library General
Public License instead of this License.
file|^|help.php|^|1613|^|1008653428
<?php
/*****************************************************************************/
/* Help.php                                                                  */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This file gives admins some help in the admin center                      */
/*****************************************************************************/
?>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<TITLE> YaBBSE Admin Help </TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFFF">
<TABLE>
<TR>
	<TD>
		<font face="verdana, serif" size="2">
		
		<?

		include("helpadmin.help");
		echo $helptxt[$help];
		?>

		</font>
	</TD>
</TR>
</TABLE>
</BODY>
</HTML>


file|^|helpadmin.help|^|11145|^|1008653430
<?php
/*****************************************************************************/
/* Help.php                                                                  */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This file gives admins some help in the admin center                      */
/*****************************************************************************/

$helptxt[0] = "<b>Edit Categories</b><br>
        From this menu you are able to edit \"Categories\". Categories are the 
          upper-level topics for a forum. For example, if you had a wide-ranging 
          site that offered information on \"Sports\" and \"Cars\" and \"Music\", these 
          would be the top-level Categories you'd create. Under each of these 
          categories you'd likely want to create heirarctical \"sub-categories\", 
          or \"Boards\" for topics within each. Here's a small example: <br>
         <ul>
          <li><b>Sports </b>-<b> 
            </b>A &quot;category&quot; 
            <ul>
              <li><b>Baseball</b> 
                - A board under the category of &quot;Sports&quot;</li>
              <li><b>Football</b> 
                &nbsp;- A board under the category of &quot;Sports&quot;</li>
            </ul>
        </ul>
          Categories allow you to break down the board into broad topics (\"Cars, 
          Sports\"), and the \"Boards\" under them are the actual topics under which 
          members can post. In the above example, a user interested in Pinto's 
          would post a message under \"Cars->Pinto\". Categories allow people to 
          quickly find what their interests are: Instead of a \"Store\" you have 
          \"Hardware\" and \"Clothing\" stores you can go to. This simplifies your 
          search for \"pipe joint compound\" because you can go to the Hardware 
          Store \"category\" instead of the Clothing Store (where you're unlikely 
          to find pipe joint compound)." ;

$helptxt[1] = "<b>Edit Boards</b><br>
          In this menu you can create/reorder/remove the boards under the categories 
          discussed above. It's a simple hierarchy, with this structure: <br>
          <ul>
          <li><font face=\"Arial, Helvetica, sans-serif\" size=\"2\">Category</font> 
            <ul>
              <li><font face=\"Arial, Helvetica, sans-serif\" size=\"2\">Board1</font></li>
              <li><font face=\"Arial, Helvetica, sans-serif\" size=\"2\">Board2</font></li>
              <li><font face=\"Arial, Helvetica, sans-serif\" size=\"2\">... etc ...</font></li>
            </ul>
        </ul>
        As noted above, a Board is a key topic underneath a broad category. 
        If you want to discuss \"Pintos\" you'd go to the \"Auto\" category and 
        jump into the \"Pinto\" board to post your thoughts in that board. <br>
        Administrative functions for this menu item are to create new boards 
        under each category, to reorder them (put \"Pinto\" behind \"Chevy\"), or 
        to delete the board entirely." ;


$helptxt[2] = "<b>Edit YaBB SE News</b><br>
	<table align=center border=0 cellspacing=4 cellpadding=0><tr><td width=85 valign=top><table align=left border=1 width=85 cellspacing=0><tr><td align=center><img src=http://www.yabb.info/images/yabb_peter.jpg><br><font size=1>Being a reporter by day (night job classified), Peter is more than qualified to help you with YaBB SE News!</font></td></tr></table></td><td valign=top><font size=2>
	This allows you to set the text for news items displayed on the Board Index page. 
	Add any item you want (e.g., \"Don't miss the conference this Tuesday\"). Each news item is separated
	by a carriage-return." ;

$helptxt[3] = "<b>Edit Registration Agreement</b><br>
	This allows you to set the text for the registration agreement displayed when members sign up for your board. 
	You can add, or remove anything from the default registration agreement, which is included in YaBB" ;

$helptxt[4] = "<b>View All Members</b><br>
	View all members in the board. You are presented with a hyperlinked list of member names. You may click
	on any of the names to find details of the members (homepage, age, etc.), and as Administrator
	you are able to modify these parameters. You have complete control over members, including the
	ability to delete them from the forum." ;

$helptxt[5] = "<b>Edit Membergroups</b><br>
	You may create or modify \"Member Groups\". Member Groups are special groups that you can 
	create to restrict access to certain categories on your forum. For example, you can create
	a category, where only the \"test\" membergroup can access and see it." ;

$helptxt[6] = "<b>Email Your Members</b><br>
	From this menu you can send messages to all members who've registered and entered their
	email addresses (not all will, of course). You may edit the distribution list, or send messages 
	to all. Useful for important update/news information. However, use sparingly, the board doesn't
	have an \"opt in/out\" feature, and may users may object to having messages sent to them without 
	their authorization." ;

$helptxt[7] = "<b>Ban Members</b><br>
	YaBB provides the ability to \"ban\" users, to prevent people who have violated the trust of the board
	by spamming, trolling, etc. This allows you to those users who are detrimental to your forum. As an admin,
	when you view messages, you can see each user's IP address used to post at that time. In the ban list,
	you simply type that IP address in, save, and they can no longer post from that location.<br>You can also 
	ban people through their email address." ;

$helptxt[8] = "<b>Set Reserved Names</b><br>
	This allows you to put in keywords or names that you want to restrict people from using as 
	a name or username." ;

$helptxt[9] = "<b>Edit Your Forum Template</b><br>
	<table align=center border=0 cellspacing=4 cellpadding=0><tr><td width=85 valign=top><table align=left border=1 width=85 cellspacing=0><tr><td align=center><img src=http://www.yabb.info/images/yabb_tim.jpg><br><font size=1>Mr. Tim Correct-Html can help you with your forum template.</font></td></tr></table></td><td valign=top><font size=2>
	This brings up a simple editor for the HTML of your template code. The \"template\" (in your \"yabb\"
	directory, as you set it up), defines the look-and-feel for your pages. It is an HTML file. You can 
	modify the template here, or use some other HTML editing software to create the look&feel for your site</font></td></tr></table>" ;

$helptxt[10] = "<b>Installed 'Mods' Settings and Options</b><br>
	<table align=center border=0 cellspacing=4 cellpadding=0><tr><td width=85 valign=top><table align=left border=1 width=85 cellspacing=0><tr><td align=center><img src=http://www.yabb.info/images/yabb_dave.jpg><br><font size=1>Modster-Dave is here to help you!</font></td></tr></table></td><td valign=top><font size=2>
	YaBBSE has some preinstalled mods, you can switch them on or off in this menu.</font></td></tr></table>";

$helptxt[11] = "<b>Set censored words</b><br>
	YaBB offers the option to censor certain words, by replacing them with another one.<br>Add a new word 
	per line, like the example bellow:<br>clown=funny guy";

//Everything below this line takes care of user support

$helptxt[12] = "<b>Time Format</b><br>
	<table align=center border=0 cellspacing=4 cellpadding=0><tr><td width=85 valign=top><table align=left border=1 width=85 cellspacing=0><tr><td align=center><img src=http://www.yabb.info/images/yabb_jeff.jpg><br><font size=1>Super-Admin Jeff is a wiz at timestamps, and he can even help <i>you</i> figure them out!</font></td></tr></table></td><td valign=top><font size=2>
	You have the power to adjust how the time and date look for yourself. There are a lot of little letters, but it's quite simple. 
	The conventions follow PHP's date function and are described as below.<br>
	The following characters are recognized in the format string: <br>
	a - \"am\" or \"pm\" <br>
	A - \"AM\" or \"PM\" <br>
	B - Swatch Internet time <br>
	d - day of the month, 2 digits with leading zeros; i.e. \"01\" to \"31\" <br>
	D - day of the week, textual, 3 letters; i.e. \"Fri\"<br> 
	F - month, textual, long; i.e. \"January\" <br>
	g - hour, 12-hour format without leading zeros; i.e. \"1\" to \"12\" <br>
	G - hour, 24-hour format without leading zeros; i.e. \"0\" to \"23\" <br>
	h - hour, 12-hour format; i.e. \"01\" to \"12\" <br>
	H - hour, 24-hour format; i.e. \"00\" to \"23\" <br>
	i - minutes; i.e. \"00\" to \"59\" <br>
	I - (capital i) - \"1\" if Daylight Savings Time, \"0\" otherwise. <br>
	j - day of the month without leading zeros; i.e. \"1\" to \"31\" <br> 
	l - (lowercase 'L') - day of the week, textual, long; i.e. \"Friday\" <br>
	L - boolean for whether it is a leap year; i.e. \"0\" or \"1\" <br>
	m - month; i.e. \"01\" to \"12\" <br>
	M - month, textual, 3 letters; i.e. \"Jan\" <br>
	n - month without leading zeros; i.e. \"1\" to \"12\" <br>
	O - Difference to Greenwich time in hours; i.e. \"+0200\" <br>
	r - RFC 822 formatted date; i.e. \"Thu, 21 Dec 2000 16:01:07 +0200\"<br>
	s - seconds; i.e. \"00\" to \"59\" <br>
	S - English ordinal suffix, textual, 2 characters; i.e. \"th\", \"nd\" <br>
	t - number of days in the given month; i.e. \"28\" to \"31\" <br>
	T - Timezone setting of this machine; i.e. \"MDT\" <br>
	U - seconds since the epoch <br>
	w - day of the week, numeric, i.e. \"0\" (Sunday) to \"6\" (Saturday)<br> 
	Y - year, 4 digits; i.e. \"1999\" <br>
	y - year, 2 digits; i.e. \"99\" <br>
	z - day of the year; i.e. \"0\" to \"365\"<br>
	If you want to use any of the above character combinations as strings 
	(as opposed to their date codes) you must escape them with a \<br>
	For example M jS \a\t h:ia  will display the dates as Nov 25th at 07:01pm
	</font></td></tr></table>
	";

$helptxt[13] = "<b>XML Syndication</b><br>
	This box displays news items as pulled from an XML file at <a href=\"http://www.yabb.info/yabbinfo.xml\">yabb.info</a>.
	This file is polled at most once every 30 minutes, and recent copy is cached on your server.  You should check here
	for important news items from the YaBB SE Team.<p>
	P.S. If you really want, you can syndicate this XML file your site ;)" ;

?>file|^|index.php|^|16143|^|1008881424
<?php
ob_start();
/* last edit by joseph nov 30 13:30 est */
/*****************************************************************************/
/* YaBB.php                                                                  */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

/* ### Version Info ### */
$YaBBversion = 'YaBB SE 1.0.0';
$YaBBplver = 'YaBB SE';

include_once ("QueryString.php");
include_once ("Settings.php");
include_once ($language);
include_once ("$sourcedir/Subs.php");
include_once ("$sourcedir/Load.php");
include_once ("$sourcedir/Security.php");
$dbcon = mysql_connect($db_server, $db_user, $db_passwd);
mysql_select_db($db_name);

/* Load the mysql version, and set a variable for 3.22 compliancy :P */
$request = mysql_query("SELECT VERSION()");
$row = mysql_fetch_row($request);  // version will be something like '3.23.13-log'
global $doLimitOne;
$doLimitOne = (substr($row[0],0,4) >= 3.23)?' LIMIT 1':'';


/* ### Log this click ### */
ClickLog();

/* ### Load the user's cookie (or set to guest) ### */
LoadCookie();

/* ### Load user settings ### */
LoadUserSettings();

/* ### Banning ### */
banning();

/* ### Write log ### */
WriteLog();

/* ### Load board information ### */
LoadBoard();

set_error_handler("yabb_error_handler");
yymain();
function  yymain() {
	global $maintenance,$action,$sourcedir,$settings,$username,$guestaccess,$currentboard;

/* #BEGIN SUB YYMAIN */

/* #### Choose what to do based on the form action #### */
if ($maintenance == 1 && $action == 'login2') { include_once("$sourcedir/LogInOut.php"); Login2(); }
if ($maintenance == 1 && $settings[7] != 'Administrator') { include_once ("$sourcedir/Maintenance.php"); InMaintenance(); }
/* ### Guest can do the very few following actions. */
if($username == 'Guest' && $guestaccess == 0) {
            if (!(($action == 'login') || ($action == 'login2') || ($action == 'register') || ($action == 'register2')))
            { KickGuest(); }
}
	
$fastfind = substr($action,0,1);
/* #BEGIN FASTFIND IF STATEMENT */
if( $fastfind == 'l' ) {
	if ($action == 'login') { include_once ("$sourcedir/LogInOut.php"); Login(); }
	else if ($action == 'login2') { include_once ("$sourcedir/LogInOut.php"); Login2(); }
	else if ($action == 'logout') { include_once ("$sourcedir/LogInOut.php"); Logout(); }
	else if ($action == 'lock') { include_once ("$sourcedir/LockThread.php"); LockThread(); }
	else if ($action == 'lockVoting') { include_once ("$sourcedir/Poll.php"); LockVoting(); }
/* END FASTFIND L* */
}
if( $fastfind == 'd' ) {
	if ($action == 'display') { include_once ("$sourcedir/Display.php"); Display(); }
	else if ($action == 'displaynew') { include_once ("$sourcedir/DisplayNew.php"); DisplayNew(); }
	else if ($action == 'detailedversion') { include_once ("$sourcedir/Admin.php"); ver_detail(); }
	else if ($action == 'deletemultimembers') { include_once ("$sourcedir/Admin.php"); DeleteMultiMembers(); }
	else if ($action == 'do_clean_log') { include_once ("$sourcedir/Admin.php"); do_clean_log(); }
/* #END FASTFIND D* */
}
else if( $fastfind == 'm' ) {
	$fastfind = substr($action,1,1);
	if( $fastfind == 'o' ) {
		if ($action == 'modify') { include_once ("$sourcedir/ModifyMessage.php"); ModifyMessage(); }
		else if ($action == 'modify2') { include_once ("$sourcedir/ModifyMessage.php"); ModifyMessage2(); }
		else if ($action == 'modtemp') { include_once ("$sourcedir/Admin.php"); ModifyTemplate(); }
		else if ($action == 'modtemp2') { include_once ("$sourcedir/Admin.php"); ModifyTemplate2(); }
		else if ($action == 'modsettings') { include_once ("$sourcedir/Admin.php"); ModifySettings(); }
		else if ($action == 'modsettings2') { include_once ("$sourcedir/Admin.php"); ModifySettings2(); }
		else if ($action == 'modmemgr') { include_once ("$sourcedir/Admin.php"); EditMemberGroups(); }
		else if ($action == 'modmemgr2') { include_once ("$sourcedir/Admin.php"); EditMemberGroups2(); }
		else if ($action == 'movethread') { include_once ("$sourcedir/MoveThread.php"); MoveThread(); }
		else if ($action == 'movethread2') { include_once ("$sourcedir/MoveThread.php"); MoveThread2(); }
		else if ($action == 'modifycatorder') { include_once ("$sourcedir/ManageCats.php"); ReorderCats(); }
		else if ($action == 'modifycat') { include_once ("$sourcedir/ManageCats.php"); ModifyCat(); }
		else if ($action == 'modifyboard') { include_once ("$sourcedir/ManageBoards.php"); ModifyBoard(); }
		else if ($action == 'modifyModSettings') { include_once ("$sourcedir/ModSettings.php"); ModifyModSettings(); }
		else if ($action == 'modifyModSettings2') { include_once ("$sourcedir/ModSettings.php"); ModifyModSettings2(); }
		else if ($action == 'modifykarma') { include_once ("$sourcedir/Karma.php"); ModifyKarma(); }
#END FASTFIND MO*
	}
	else {
		if ($action == 'markasread') { include_once "$sourcedir/MessageIndex.php"; MarkRead(); }
		else if ($action == 'markallasread') { include_once "$sourcedir/BoardIndex.php"; MarkAllRead(); }
		else if ($action == 'managecats') { include_once "$sourcedir/ManageCats.php"; ManageCats(); }
		else if ($action == 'mailing') { include_once "$sourcedir/Admin.php"; MailingList(); }
		else if ($action == 'membershiprecount') { include_once "$sourcedir/Admin.php"; AdminMembershipRecount(); }
		else if ($action == 'mlall') { include_once "$sourcedir/Memberlist.php"; MLAll(); }
		else if ($action == 'mlletter') { include_once "$sourcedir/Memberlist.php"; MLByLetter(); }
		else if ($action == 'mltop') { include_once "$sourcedir/Memberlist.php"; MLTop(); }
		else if ($action == 'manageboards') { include_once "$sourcedir/ManageBoards.php"; ManageBoards(); }
		else if ($action == 'manageattachments') { include_once "$sourcedir/ManageAttachments.php"; ManageAttachments(); }
		else if ($action == 'ml') { include_once "$sourcedir/Admin.php"; ml(); }
#END FASTFIND M*
	}
}
else if( $fastfind == 'p' ) {
	if ($action == 'post') { include_once "$sourcedir/Post.php"; Post(); }
	else if ($action == 'post2') { include_once "$sourcedir/Post.php"; Post2(); }
	else if ($action == 'profile') { include_once "$sourcedir/Profile.php"; ModifyProfile(); }
	else if ($action == 'profile2') { include_once "$sourcedir/Profile.php"; ModifyProfile2(); }
	else if ($action == 'postpoll') { include_once "$sourcedir/Poll.php"; PostPoll(); }
	else if ($action == 'postpoll2') { include_once "$sourcedir/Poll.php"; PostPoll2(); }
   else if ($action == 'packages') { include_once "$sourcedir/Packages.php"; Packages(); }
   else if ($action == 'packagecreate') { include_once "$sourcedir/Packages.php"; PackageCreate(); }
   else if ($action == 'packagecreate2') { include_once "$sourcedir/Packages.php"; PackageCreate2(); }
   else if ($action == 'packagepremod') { include_once "$sourcedir/Packages.php"; PackagePremod(); }
   else if ($action == 'packagemod') { include_once "$sourcedir/Packages.php"; PackageMod(); }
   else if ($action == 'packagemod2') { include_once "$sourcedir/Packages.php"; PackageMod2(); }
   else if ($action == 'packagemod3') { include_once "$sourcedir/Packages.php"; PackageMod3(); }
   else if ($action == 'packagemod4') { include_once "$sourcedir/Packages.php"; PackageMod4(); }
   else if ($action == 'packageavatars') { include_once "$sourcedir/Packages.php"; PackageAvatars(); }
   else if ($action == 'packagelanguage') { include_once "$sourcedir/Packages.php"; PackageLanguage(); }
   else if ($action == 'packageremove') { include_once "$sourcedir/Packages.php"; PackageRemove(); }
   else if ($action == 'packagelist') { include_once "$sourcedir/Packages.php"; PackageList(); }
   else if ($action == 'packageget') { include_once "$sourcedir/PackageGet.php"; PackageGet(); }
   else if ($action == 'pgadd') { include_once "$sourcedir/PackageGet.php"; PackageServerAdd(); }
   else if ($action == 'pgremove') { include_once "$sourcedir/PackageGet.php"; PackageServerRemove(); }
   else if ($action == 'pgbrowse') { include_once "$sourcedir/PackageGet.php"; PackageBrowse(); }
   else if ($action == 'pgdownload') { include_once "$sourcedir/PackageGet.php"; PackageDownload(); }
#END FASTFIND P*
}
else if( $fastfind == 'r' ) {
	if ($action == 'register') { include_once "$sourcedir/Register.php"; Register(); }
	else if ($action == 'register2') { include_once "$sourcedir/Register.php"; Register2(); }
	else if ($action == 'removethread2') { include_once "$sourcedir/RemoveThread.php"; RemoveThread2(); }
	else if ($action == 'recent') { include_once "$sourcedir/Recent.php"; RecentPosts(); }
	else if ($action == 'removeoldthreads') { include_once "$sourcedir/RemoveOldThreads.php"; RemoveOldThreads(); }
	else if ($action == 'reorderboards') { include_once "$sourcedir/ManageBoards.php"; ReorderBoards(); }
	else if ($action == 'reorderboards2') { include_once "$sourcedir/ManageBoards.php"; ReorderBoards2(); }
	else if ($action == 'repairboards') { include_once "$sourcedir/RepairBoards.php"; RepairBoards(); }
	else if ($action == 'rebuildmemlist') { include_once "$sourcedir/Admin.php"; RebuildMemList(); }
	else if ($action == 'removeAttachmentsByAge') { include_once "$sourcedir/ManageAttachments.php"; RemoveAttachmentByAge(); }
	else if ($action == 'removeAttachmentsBySize') { include_once "$sourcedir/ManageAttachments.php"; RemoveAttachmentBySize(); }
	else if ($action == 'removeattachment') { include_once "$sourcedir/ManageAttachments.php"; RemoveAttachment(); }
	else if ($action == 'removeallattachments') { include_once "$sourcedir/ManageAttachments.php"; RemoveAllAttachments(); }
#END FASTFIND R*
}
else if( $fastfind == 'i' ) {
	if ($action == 'im') { include_once "$sourcedir/InstantMessage.php"; IMIndex(); }
	else if ($action == 'imprefs') { include_once "$sourcedir/InstantMessage.php"; IMPreferences(); }
	else if ($action == 'imprefs2') { include_once "$sourcedir/InstantMessage.php"; IMPreferences2(); }
	else if ($action == 'imoutbox') { include_once "$sourcedir/InstantMessage.php"; IMOutbox(); }
	else if ($action == 'imremove') { include_once "$sourcedir/InstantMessage.php"; IMRemove(); }
	else if ($action == 'imsend') { include_once "$sourcedir/InstantMessage.php"; IMPost(); }
	else if ($action == 'imsend2') { include_once "$sourcedir/InstantMessage.php"; IMPost2(); }
	else if ($action == 'imremoveall') { include_once "$sourcedir/InstantMessage.php"; KillAllQuery(); }
	else if ($action == 'imremoveall2') { include_once "$sourcedir/InstantMessage.php"; KillAll(); }
	else if ($action == 'icqpager') { include_once "$sourcedir/ICQPager.php"; IcqPager(); }
	else if ($action == 'ipban') { include_once "$sourcedir/Admin.php"; ipban(); }
	else if ($action == 'ipban2') { include_once "$sourcedir/Admin.php"; ipban2(); }
#END FASTFIND I*
}
else if( $fastfind == 'c' ) {
	if ($action == 'changemode') { setmode; }
	else if ($action == 'changemv') { setmv; }
	else if ($action == 'createcat') { include_once "$sourcedir/ManageCats.php"; CreateCat(); }
	else if ($action == 'clean_log') { include_once "$sourcedir/Admin.php"; clean_log(); }
#END FASTFIND C*
}
else if( $fastfind == 'n' ) {
	if ($action == 'notify') { include_once "$sourcedir/Notify.php"; Notify(); }
	else if ($action == 'notify2') { include_once "$sourcedir/Notify.php"; Notify2(); }
	else if ($action == 'notify3') { include_once "$sourcedir/Notify.php"; Notify3(); }
	else if ($action == 'notify4') { include_once "$sourcedir/Notify.php"; Notify4(); }
#END FASTFIND N*
}
else if( $fastfind == 's' ) {
	if ($action == 'setsmp') { setsmp; }
	else if ($action == 'sendICQpage') { include_once "$sourcedir/ICQPager.php"; send_icqpage(); }
	else if ($action == 'sendtopic') { include_once "$sourcedir/SendTopic.php"; SendTopic(); }
	else if ($action == 'sendtopic2') { include_once "$sourcedir/SendTopic.php"; SendTopic2(); }
	else if ($action == 'setcensor') { include_once "$sourcedir/Admin.php"; SetCensor(); }
	else if ($action == 'setcensor2') { include_once "$sourcedir/Admin.php"; SetCensor2(); }
	else if ($action == 'search') { include_once "$sourcedir/Search.php"; plushSearch1(); }
	else if ($action == 'search2') { include_once "$sourcedir/Search.php"; plushSearch2(); }
	else if ($action == 'setreserve') { include_once "$sourcedir/Admin.php"; SetReserve(); }
	else if ($action == 'setreserve2') { include_once "$sourcedir/Admin.php"; SetReserve2(); }
	else if ($action == 'showclicks') { include_once "$sourcedir/Admin.php"; ShowClickLog(); }
	else if ($action == 'shownotify') { include_once "$sourcedir/Notify.php"; ShowNotifications(); }
	else if ($action == 'sticky') { include_once "$sourcedir/Subs.php"; Sticky(); }
#END FASTFIND S*
}
else {
	if ($action == 'viewprofile') { include_once "$sourcedir/Profile.php"; ViewProfile(); }
	else if ($action == 'addboard') { include_once "$sourcedir/ManageBoards.php"; CreateBoard(); }
	else if ($action == 'admin') { include_once "$sourcedir/Admin.php"; Admin(); }
	else if ($action == 'viewmembers') { include_once "$sourcedir/Admin.php"; ViewMembers(); }
    else if ($action == 'viewinactive') { include_once "$sourcedir/Admin.php"; ViewInactiveMembers(); }
	else if ($action == 'editnews') { include_once "$sourcedir/Admin.php"; EditNews(); }
	else if ($action == 'boardrecount') { include_once "$sourcedir/Admin.php"; AdminBoardRecount(); }
	else if ($action == 'editnews2') { include_once "$sourcedir/Admin.php"; EditNews2(); }
	else if ($action == 'editagreement') { include_once "$sourcedir/Admin.php"; EditAgreement(); }
	else if ($action == 'editagreement2') { include_once "$sourcedir/Admin.php"; EditAgreement2(); }
	else if ($action == 'usersrecentposts') { include_once "$sourcedir/Profile.php"; usersrecentposts(); }
	else if ($action == 'vote') { include_once "$sourcedir/Poll.php"; Vote(); }
	else if ($action == 'editpoll') { include_once "$sourcedir/Poll.php"; EditPoll(); }
	else if ($action == 'editpoll2') { include_once "$sourcedir/Poll.php"; EditPoll2(); }
#END FASTFIND *
}
#END FASTFIND IF STATEMENT

# No board? Show Board Index

if ($currentboard == "") { require_once "$sourcedir/BoardIndex.php"; BoardIndex(); }
# No action? Show Message Index
include_once "$sourcedir/MessageIndex.php";
MessageIndex();

obExit();
}

function yabb_error_handler($errno, $errstr, $errfile, $errline) {
	if (!($errno & error_reporting())) return; 
	fatal_error ("$errno: $errstr\n<br>($errfile ln $errline)");
}
#END SUB YYMAIN
?>
file|^|Printpage.php|^|11279|^|1008872712
<?php
ob_start();
/*****************************************************************************/
/* Printpage.php                                                             */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

include_once ("QueryString.php");
include_once ("Settings.php");
include_once ("$language");
include_once ("$sourcedir/Subs.php");
include_once ("$sourcedir/Load.php");
include_once ("$sourcedir/Security.php");
$dbcon = mysql_connect($db_server, $db_user, $db_passwd);
mysql_select_db($db_name);

/* Load the mysql version, and set a variable for 3.22 compliancy :P */
$request = mysql_query("SELECT VERSION()");
$row = mysql_fetch_row($request);  // version will be something like '3.23.13-log'
global $doLimitOne;
$doLimitOne = (substr($row[0],0,4) >= 3.23)?' LIMIT 1':'';

/* ### Log this click ### */
ClickLog();

$printpageplver="YaBB SE";

/* ### Load the user's cookie (or set to guest) ### */
LoadCookie();

/* ### Load user settings ### */
LoadUserSettings();

/* #### Choose what to do based on the form action #### */
if ($maintenance == 1 && $settings[7] != 'Administrator') { include_once "$sourcedir/Maintenance.pl"; InMaintenance(); }

/* ### Load board information ### */
LoadBoard();

/* ### Banning ### */
banning();

/* ### Write log ### */
WriteLog();

/* # Load Censor List */
LoadCensorList();


/* ### Determine what category we are in. ### */
$request = mysql_query ("SELECT ID_CAT,name FROM {$db_prefix}boards WHERE ID_BOARD=$currentboard");
$row = mysql_fetch_array($request);
$boardname = $row['name'];

$request = mysql_query("SELECT name FROM {$db_prefix}categories WHERE ID_CAT=$row[ID_CAT]");
$row = mysql_fetch_array($request);
$cat = $row['name'];

$request = mysql_query("SELECT m.posterTime,m.posterName FROM {$db_prefix}messages as m WHERE (m.ID_TOPIC=$threadid) ORDER BY ID_MSG LIMIT 1");
$row = mysql_fetch_array($request);
LoadRealName($row['posterName']);
$startedby = $realNames[$row['posterName']];
$startedon = timeformat($row['posterTime']);

### Lets output all that info. ###
print <<<EOT
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<style type="text/css"> 
<!-- 
BODY          {font-family: Verdana, arial, helvetica, serif; font-size:12px;} 
TABLE       {empty-cells: show } 
TD            {font-family: Verdana, arial, helvetica, serif; color: #000000; font-size:12px;} 
--> 
</style> 
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">  

<title>$txt[668]</title>
</head>

<body bgcolor="#FFFFFF" text="#000000">


<font size="3" face="arial">
 <b>$mbname</B></font>
	<pre>
    $cat => $boardname => $txt[195]: $startedby $txt[176] $startedon
	</pre>
	<table border=0 width="90%"><tr><td>
EOT;

### Split the threads up so we can print them.
$request = mysql_query("SELECT subject,posterName,posterTime,body FROM {$db_prefix}messages WHERE ID_TOPIC=$threadid ORDER BY ID_MSG");
while ($row = mysql_fetch_array($request)) {
	$threadtitle = $row['subject'];
	$threadposter = $row ['posterName'];
	$threaddate = timeformat($row ['posterTime']);
	$threadpost = $row ['body'];

## Do YaBBC Stuff ###
	$threadpost = str_replace ("<br>","\n",$threadpost);
	$threadpost = str_replace ("[code]","<BR><B>Code:</B><br><table bgcolor=#000000 cellspacing=1><tr><td><table cellpadding=2 cellspacing=0 bgcolor=#FFFFFF><tr><td><font face=Courier size=1 color=#000000>", $threadpost);
	$threadpost = str_replace ("[/code]", "</font></td></tr></table></td></tr></table>", $threadpost);

	$threadpost = str_replace ("[b]", "<b>", $threadpost);
	$threadpost = str_replace ("[i]", "<i>", $threadpost);
	$threadpost = str_replace ("[u]", "<u>", $threadpost);
	$threadpost = str_replace ("[s]", "<s>", $threadpost);
	$threadpost = str_replace ("[/b]", "</b>", $threadpost);
	$threadpost = str_replace ("[/i]", "</i>", $threadpost);
	$threadpost = str_replace ("[/u]", "</u>", $threadpost);
	$threadpost = str_replace ("[/s]", "</s>", $threadpost);

	$threadpost = str_replace ("[move]", "", $threadpost);
	$threadpost = str_replace ("[/move]", "", $threadpost);

	$threadpost = preg_replace ("/\[glow(.*)\](.*)\[\/glow\]/","$2",$threadpost);
	$threadpost = preg_replace ("/\[shadow(.*)\](.*)\[\/shadow\]/", "$2", $threadpost);

	$threadpost = preg_replace ("/\[color=(.*)\](.*)\[\/color\]/","$2",$threadpost);

	$threadpost = str_replace("[black]","",$threadpost);
	$threadpost = str_replace("[white]","",$threadpost);
	$threadpost = str_replace("[red]","",$threadpost);
	$threadpost = str_replace("[green]","",$threadpost);
	$threadpost = str_replace("[blue]","",$threadpost);
	$threadpost = str_replace("[/black]","",$threadpost);
	$threadpost = str_replace("[/white]","",$threadpost);
	$threadpost = str_replace("[/red]","",$threadpost);
	$threadpost = str_replace("[/green]","",$threadpost);
	$threadpost = str_replace("[/blue]","",$threadpost);

	$threadpost = preg_replace ("/\[font=(.*)\](.*)\[\/font\]/", "<font face=\"$1\">$2</font>", $threadpost);
	$threadpost = preg_replace ("/\[size=(.*)\](.*)\[\/size\]/", "<font size=\"$1\">$2</size>", $threadpost);

	$threadpost = str_replace("[img(.*)]","",$threadpost);
	$threadpost = str_replace("[/img]","",$threadpost);

	$threadpost = str_replace ("[tt]", "<tt>", $threadpost);
	$threadpost = str_replace ("[/tt]", "</tt>", $threadpost);
	$threadpost = str_replace ("[left]", "<p align=left>", $threadpost);
	$threadpost = str_replace ("[/left]", "</p>", $threadpost);
	$threadpost = str_replace ("[center]", "<center>", $threadpost);
	$threadpost = str_replace ("[/center]", "</center>", $threadpost);
	$threadpost = str_replace ("[right]", "<p align=right>", $threadpost);
	$threadpost = str_replace ("[/right]", "</p>", $threadpost);
	$threadpost = str_replace ("[sub]", "<sub>", $threadpost);
	$threadpost = str_replace ("[/sub]", "</sub>", $threadpost);
	$threadpost = str_replace ("[sup]", "<sup>", $threadpost);
	$threadpost = str_replace ("[/sup]", "</sup>", $threadpost);
	$threadpost = str_replace ("[fixed]", "<font face=\"Courier New\">", $threadpost);
	$threadpost = str_replace ("[/fixed]", "</font>", $threadpost);

	$threadpost = str_replace ("[[","{{",$threadpost);
	$threadpost = str_replace ("]]","}}",$threadpost);

	$threadpost = str_replace ("|","&#124;",$threadpost);

	$threadpost = str_replace ("[hr]","<hr width=40% align=left size=1>",$threadpost);
	$threadpost = str_replace ("[br]","\n",$threadpost);

	$threadpost = preg_replace("/\[url=(.+)\](.+)\s*\[\/url\]/","$2 ($1)",$threadpost);
	$threadpost = preg_replace("/\[url\](.+)\[\/url\]/","$1",$threadpost);

	$threadpost = preg_replace("/\[email\](.*)\[\/email\]/","$1",$threadpost);
	$threadpost = preg_replace("/\[email=(.*)\](.*)\[\/email\]/","$2 ($1)",$threadpost);

	$threadpost = str_replace("[news]","",$threadpost);
	$threadpost = str_replace("[/news]","",$threadpost);
	$threadpost = str_replace("[gopher]","",$threadpost);
	$threadpost = str_replace("[/gopher]","",$threadpost);
	$threadpost = str_replace("[ftp]","",$threadpost);
	$threadpost = str_replace("[/ftp]","",$threadpost);

	$threadpost = preg_replace("/\[quote\s+author=(.*) link=(.*) date=(.*)\](.*)\[\/quote\]/","<BR><i>on $3, <a href=$scripturl?action=display&$2>$1 wrote</a>:</i><table bgcolor=#000000 cellspacing=1 width=90%><tr><td width=100%><table cellpadding=2 cellspacing=0 width=100% bgcolor=#FFFFFF><tr><td width=100%><font size=1 color=#000000>$4</font></td></tr></table></td></tr></table>",$threadpost);
	$threadpost = preg_replace("/\[quote\](.*)\[\/quote\]/","<BR><i>Quote:</i><table bgcolor=#000000 cellspacing=1 width=90%><tr><td width=100%><table cellpadding=2 cellspacing=0 width=100% bgcolor=#FFFFFF><tr><td width=\"100%\"><font face=\"Arial,Helvetica\" size=\"1\" color=#000000>$1</font></td></tr></table></td></tr></table>",$threadpost);

	$threadpost = str_replace("[list]","<ul>",$threadpost);
	$threadpost = str_replace("[*]","<li>",$threadpost);
	$threadpost = str_replace("[/list]","</li>",$threadpost);

	$threadpost = str_replace("[pre]","<pre>",$threadpost);
	$threadpost = str_replace("[/pre]","</pre>",$threadpost);

	$threadpost = preg_replace("/\[flash=(.*)\](.*)\[\/flash\]/","$2",$threadpost);

	$threadpost = str_replace ("{{","[",$threadpost);
	$threadpost = str_replace ("}}","]",$threadpost);

	$threadpost = preg_replace("/\[table(.*?)\]/","<table$1>",$threadpost);
	$threadpost = str_replace("[\/table]","</table>",$threadpost);
	$threadpost = str_replace("[tr]","<tr>",$threadpost);
	$threadpost = str_replace("[/tr]","</tr>",$threadpost);
	$threadpost = str_replace("[td]","<td>",$threadpost);
	$threadpost = str_replace("[/td]","</td>",$threadpost);

	$threadpost = str_replace("\n","<br>",$threadpost);
	
	### Censor it ###
	foreach ($censored as $tmpa=>$tmpb) {
		$threadtitle = str_replace($tempa, $tmpb, $threadtitle);
		$threadpost = str_replace($tempa, $tmpb, $threadpost);
	}
	
print <<<EOT
<hr size=2 width="100%">
<font size=2>$txt[196]: <b>$threadtitle</b>
<BR>$txt[197]: <b>$threadposter</b> $txt[176] <b>$threaddate</b></font>
<hr>
<table border="0" width="95%" align=center><tr><td><font size="2">$threadpost</font></td></tr></table><p>
EOT;

}

print <<<EOT
<BR><BR>
<center><font size="1">$yycopyright</font></center>
</td></tr></table>
</body></html>
EOT;

function donoopen ()
{
global $txt;
print <<<EOT
<html><head><title>$txt[199]</title></head>
<body bgcolor=#ffffff>
<center>$txt[199]</center>
</body></html>

EOT;
}

?>file|^|QueryString.php|^|2393|^|1008653435
<?php
/*****************************************************************************/
/* QueryString.php                                                           */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

if(strlen($QUERY_STRING)>0)
{
	$str = (substr($QUERY_STRING,0,5)=="url=/")?$HTTP_SERVER_VARS["REDIRECT_QUERY_STRING"]:$QUERY_STRING;
	$query_strings = split("[;&]",$str);
	foreach ($query_strings as $tmp)
	{
		list($key,$value) = explode("=",$tmp);
		$GLOBALS[$key] = str_replace("%20"," ",$value);
	}
}
?>file|^|Reminder.php|^|6391|^|1008653436
<?php
ob_start();
/* last updated by Jeff 11:18 Nov 27 */
/*****************************************************************************/
/* Reminder.php                                                              */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

include_once ("QueryString.php");
include_once ("Settings.php");
include_once ("$language");
include_once ("$sourcedir/Load.php");
include_once ("$sourcedir/Subs.php");
include_once ("$sourcedir/Security.php");
$dbcon = mysql_connect($db_server, $db_user, $db_passwd);
mysql_select_db($db_name);

/* Load the mysql version, and set a variable for 3.22 compliancy :P */
$request = mysql_query("SELECT VERSION()");
$row = mysql_fetch_row($request);  // version will be something like '3.23.13-log'
global $doLimitOne;
$doLimitOne = (substr($row[0],0,4) >= 3.23)?' LIMIT 1':'';

/* ### Log this click ### */
ClickLog();

$reminderplver = "1 Gold - PHP/MySQL Flavour";

$username = 'Guest';

/* ### Banning ### */
banning();

/* ### Write log ### */
WriteLog();

/* ############################################################################### */

$yytitle="$mbname $txt[669]";
template_header();
if (stristr ($QUERY_STRING, "input_user")) {
	input();
	footer();
	obExit();
}

if ($searchtype=="usearch"){
$request = mysql_query ("SELECT realName,emailAddress,memberGroup FROM {$db_prefix}members WHERE memberName='$user' LIMIT 1");}
if ($searchtype=="esearch"){
$request = mysql_query ("SELECT realName,emailAddress,memberGroup FROM {$db_prefix}members WHERE emailAddress='$user' LIMIT 1");}

$row = mysql_fetch_array($request);
$name = trim($row[realName]);
$email = trim($row[emailAddress]);
if ($email == '')
	mailprog_error();
if ($user == '')
	no_user_error();
$status = trim($row[memberGroup]);

// randomly generate a new password
srand(time());
$password = crypt(mt_rand(-100000,100000));
$cryptpassword = crypt($password,substr($password,0,2));

//$password = "changeme";
if ($searchtype=="usearch"){
$request = mysql_query ("UPDATE {$db_prefix}members SET passwd='$cryptpassword' WHERE memberName='$user' LIMIT 1");}
if ($searchtype=="esearch"){
$request = mysql_query ("UPDATE {$db_prefix}members SET passwd='$cryptpassword' WHERE emailAddress='$user' LIMIT 1");}

$subject = "$txt[36] $mbname : $name";
sendmail($email, $subject, "$txt[711] $name,\n\n$mbname ==>\n\n$txt[35]: $user\n$txt[36]: $password\n$txt[87]: $status\n\n$txt[130]",$webmaster_email);

print <<<EOT
<BR><BR><table border=0 width=400 cellspacing=1 bgcolor="$color[bgcolor]" align="center">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]">
    <font size=2 class="text1" color="$color[titletext]"><b>$mbname $txt[36] $txt[194]</b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]">
    <table border=0 align="center">
      <tr>
        <td align="center"><font size="2"><b>$txt[192]: $user</b></font></td>
      </tr>
    </table>
    </td>
  </tr>
</table>
<br><center><a href="javascript:history.back(-2)">$txt[193]</a></center><br>
EOT;
footer();
	obExit();

/* ############################################################################### */

function input () {
global $color,$reminderurl,$txt,$mbname;
print <<<EOT
<BR><BR><table border=0 width=400 cellspacing=1 bgcolor="$color[bgcolor]" align="center">
  <tr>
    <td class="titlebg" bgcolor="$color[titlebg]">
    <font size=2 class="text1" color="$color[titletext]"><b>$mbname $txt[36] $txt[194]</b></b></font></td>
  </tr><tr>
    <td class="windowbg" bgcolor="$color[windowbg]">
    <form action="$reminderurl?user=">
    <table border=0 align="center">
      <tr>
        <td><font size="2">$txt[yse100]: <input type="text" name="user">
        <input type="submit" value="$txt[339]"></font></td>
      </tr>
      <tr>
        <td><center><font size="2">$txt[yse101] <input type="radio" value="usearch" checked name="searchtype"> $txt[yse102] <input type="radio" name="searchtype" value="esearch">
        </font></center></td>
      </tr>
    </table>
    </form>
    </td>
  </tr>
</table>
EOT;
}

function mailprog_error () {
	global $txt,$webmaster_email;
	print "<br><center><b>$txt[394]<br>$txt[395] <a href=\"mailto:$webmaster_email\">Webmaster</a> $txt[396].</b></center>\n";
	print "<br><a href=\"javascript:history.back(-1)\">Back</a><br>\n";
	footer();
	obExit();

}

function no_user_error () {
	global $txt;
	print "<br><center><b>$txt[40]</b></center>\n";
	print "<br><a href=\"javascript:history.back(-1)\">$txt[193]</a><br>\n";
	footer();
	obExit();
}
?>
file|^|Settings.php|^|9611|^|1008860582
<?php
/*****************************************************************************/
/* Settings.php                                                              */
/*****************************************************************************/
/* YaBB: Yet another Bulletin Board                                          */
/* Open-Source Project started by Zef Hemel (zef@zefnet.com)                 */
/* Software Version: YaBB SE                                                 */
/* ========================================================================= */
/* Software Distributed by:    http://www.yabb.info                          */
/* Support, News, Updates at:  http://www.yabb.info/community                */
/*                             http://yabb.xnull.com/community               */
/* ========================================================================= */
/* Copyright (c) 2001-2002 Lewis Media - All Rights Reserved                 */
/* Software by: The YaBB Development Team                                    */
/*****************************************************************************/
/* This program is free software; you can redistribute it and/or modify it   */
/* under the terms of the GNU General Public License as published by the     */
/* Free Software Foundation; either version 2 of the License, or (at your    */
/* option) any later version.                                                */
/*                                                                           */
/* This program is distributed in the hope that it will be useful, but       */
/* WITHOUT ANY WARRANTY; without even the implied warranty of                */
/* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General */
/* Public License for more details.                                          */
/*                                                                           */
/* The GNU GPL can be found in gpl.txt in this directory                     */
/*****************************************************************************/

########## Board Info ##########
# Note: these settings must be properly changed for YaBB to work

$maintenance = 0;				# Set to 1 to enable Maintenance mode
$mtitle = "";                       # Subject for display
$mmessage = "";                   # Message Description for display

$guestaccess = 1;				# Set to 0 to disallow guests from doing anything but login or register

$yyForceIIS = 0;				# Set to 1 if you encounter errors while running on an MS IIS server
$yyblankpageIIS = 0;			# Set to 1 if you encounter blank pages after posting (usually on MS IIS servers)

$language = "english.lng";				# Change to language pack you want to use
$mbname = "My Community";					# The name of your YaBB forum
$boardurl = "http://www.myserver.com/community";				# URL of your board's folder (without trailing '/')

$Cookie_Length = 60;			# Cookies will expire after XX minutes of person logging in (they will be logged out after)
$cookieusername = "YaBBusername";			# Name of the username cookie
$cookiepassword = "YaBBpassword";			# Name of the password cookie

$RegAgree = 0;					# Set to 1 to display the registration agreement when registering
$emailpassword = 0;			# 0 - instant registration. 1 - password emailed to new members
$emailnewpass = 0;				# Set to 1 to email a new password to members if they change their email address
$emailwelcome = 1;				# Set to 1 to email a welcome message to users even when you have mail password turned off

$mailprog = "/usr/sbin/sendmail";				# Location of your sendmail program
$smtp_server = "smtp.myserver.com";				# SMTP-Server
$webmaster_email = "webmaster@myserver.com";		# Your e-mail address
$mailtype = 0;					# 0 - sendmail, 1 - SMTP

########## Database Info ##########
$db_name = "yabbse";
$db_user = "yabbse";
$db_passwd = "yabbse";
$db_server = "localhost";
$db_prefix = "";

########## Directories/Files ##########
# Note: directories other than $imagesdir do not have to be changed unless you move things

$boarddir = "."; 				# The absolute path to the board's folder (usually can be left as '.')
$sourcedir = "./Sources";        			# Directory with YaBB source files
$facesdir = "/home/httpd/html/myserver/www/community/YaBBImages/avatars";				# Absolute Path to your avatars folder
$facesurl = "http://www.myserver.com/community/YaBBImages/avatars";				# URL to your avatars folder
$imagesdir = "http://www.myserver.com/community/YaBBImages";				# URL to your images directory
$ubbcjspath = "http://www.myserver.com/community/ubbc.js";	                        # Web path to your 'ubbc.js' REQUIRED for post/modify to work properly!
$faderpath = "http://www.myserver.com/community/fader.js";				# Web path to your 'fader.js'
$helpfile = "http://www.myserver.com/community/YaBBHelp/index.html";				# Location of your help file


########## Colors ##########
# Note: equivalent to colors in CSS tag of template.html, so set to same colors preferrably
# for browsers without CSS compatibility and for some items that don't use the CSS tag

$color['titlebg'] = "#6E94B7";		# Background color of the 'title-bar'
$color['titletext'] = "#FFFFFF";		# Color of text in the 'title-bar' (above each 'window')
$color['windowbg'] = "#AFC6DB";		# Background color for messages/forms etc.
$color['windowbg2'] = "#F8F8F8";		# Background color for messages/forms etc.
$color['windowbg3'] = "#6394BD";		# Color of horizontal rules in posts
$color['catbg'] = "#DEE7EF";			# Background color for category (at Board Index)
$color['bordercolor'] = "#6394BD";	# Table Border color for some tables
$color['fadertext']  = "#000000";		# Color of text in the NewsFader ("The Latest News" color)
$color['fadertext2']  = "#000000";	# Color of text in the NewsFader (news color)

########## Layout ##########

$MenuType = 0;					# 1 for text menu or anything else for images menu
$curposlinks = 1;				# 1 for links in navigation on current page, or 0 for text without link
$profilebutton = 1;			# 1 to show view profile button under post, or 0 for blank
$timeformatstring = "F jS, Y, h:i:s a";				# Select your preferred output Format of Time and Date
$allow_hide_email = 1;			# Allow users to hide their email from public. Set 0 to disable
$showlatestmember = 0;			# Set to 1 to display "Welcome Newest Member" on the Board Index
$shownewsfader = 0;			# 1 to allow or 0 to disallow NewsFader javascript on the Board Index
							# If 0, you'll have no news at all unless you put <yabb news> tag
							# back into template.html!!!
$Show_RecentBar = 1;			# Set to 1 to display the Recent Posts bar on Board Index
$Show_MemberBar = 1;			# Set to 1 to display the Members List table row on Board Index
$showmarkread = 1;				# Set to 1 to display and enable the mark as read buttons
$showmodify = 1;				# Set to 1 to display "Last modified: Realname - Date" under each message
$ShowBDescrip = 1;				# Set to 1 to display board descriptions on the topic (message) index for each board
$showuserpic = 1;				# Set to 1 to display each member's picture in the message view (by the ICQ.. etc.)
$showusertext = 1;				# Set to 1 to display each member's personal text in the message view (by the ICQ.. etc.)
$showgenderimage = 1;			# Set to 1 to display each member's gender in the message view (by the ICQ.. etc.)
$showyabbcbutt = 1;                       # Set to 1 to display the yabbc buttons on Posting and IM Send Pages

########## Feature Settings ##########

$enable_ubbc = 1;				# Set to 1 if you want to enable UBBC (Uniform Bulletin Board Code)
$enable_news = 1;				# Set to 1 to turn news on, or 0 to set news off
$allowpics = 1;				# set to 1 to allow members to choose avatars in their profile
$enable_guestposting = 1;		# Set to 0 if do not allow 1 is allow.
$enable_notification = 1;		# Allow e-mail notification
$autolinkurls = 1;				# Set to 1 to turn URLs into links, or 0 for no auto-linking.

$timeoffset = 0;				# Time Offset (so if your server is EST, this would be set to -1 for CST)
$TopAmmount = 15;				# No. of top posters to display on the top members list
$MembersPerPage = 30;			# No. of members to display per page of Members List - All
$maxdisplay = 20;				# Maximum of topics to display
$maxmessagedisplay = 15;		# Maximum of messages to display
$MaxMessLen = 10000;  				# Maximum Allowed Characters in a Posts
$MaxSigLen = 300;				# Maximum Allowed Characters in Signatures
$ClickLogTime = 60;				# Time in minutes to log every click to your forum (longer time means larger log file size)
$max_log_days_old = 21;			# If an entry in the user's log is older than ... days remove it
							# Set to 0 if you want it disabled
$fadertime = 5000;				# Length in seconds to display each item in the news fader
$timeout = 5;					# Minimum time between 2 postings from the same IP


########## Membergroups ##########

$JrPostNum = 50;					# Number of Posts required to show person as 'junior' membergroup
$FullPostNum = 100;				# Number of Posts required to show person as 'full' membergroup
$SrPostNum = 250;					# Number of Posts required to show person as 'senior' membergroup
$GodPostNum = 500;					# Number of Posts required to show person as 'god' membergroup


########## MemberPic Settings ##########

$userpic_width = 65;			# Set pixel size to which the selfselected userpics are resized, 0 disables this limit
$userpic_height = 65;			# Set pixel size to which the selfselected userpics are resized, 0 disables this limit
$userpic_limits = "Please note that your image has to be <b>gif</b> or <b>jpg</b> and that it will be resized!";			# Text To Describe The Limits
?>file|^|template.html|^|6128|^|1008872598
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"> 
<html> 
<head> 
<title><yabb title></title> 
<style type="text/css"> 
<!-- 
/* These take care of the regular links */ 
A:link        {text-decoration: none; color: #005177; background-color: transparent;} 
A:visited     {text-decoration: none; color: #005177; background-color: transparent; } 
A:hover       {color: #CC3333; text-decoration: none; background-color: transparent; } 
/* These take care of the navigation tree links */ 
.nav          {text-decoration: none; color: #000000; background-color: transparent;} 
.nav:link     {text-decoration: none; color: #000000; background-color: transparent;} 
.nav:visited  {text-decoration: none; color: #000000; background-color: transparent;} 
.nav:hover    { text-decoration: underline; color: #CC3333; font-weight: bold; background-color: transparent;} 
/* Standards */ 
BODY          {font-family: Verdana, arial, helvetica, serif; font-size:12px;} 
TABLE       {empty-cells: show } 
TD            {font-family: Verdana, arial, helvetica, serif; color: #000000; font-size:12px;} 
input         {background-color: #AFC6DB; font-family: Verdana,arial, helvetica, serif; font-size: 9pt; color: #000000;} 
textarea      {background-color: #AFC6DB; font-family: Verdana,arial, helvetica, serif; font-size: 9pt; color: #000000;} 
select        {background-color: #AFC6DB; font-family: Verdana,arial, helvetica, serif; font-size: 7pt; color: #000000;} 
/* YaBB Colors */ 
.windowbg     {background-color: #AFC6DB; font-size: 12px; font-family: Verdana, arial, helvetica, serif; color: #000000;} 
.windowbg2    {background-color: #F8F8F8; font-size: 12px; font-family: Verdana, arial, helvetica, serif; color: #000000;} 
.windowbg3    {background-color: #6394BD; font-size: 12px; font-family: Verdana, arial, helvetica, serif; color: #000000;} 
.hr           {color: #6394BD; background-color: transparent;} 
.titlebg      {background-color: #6E94B7; color: #FFFFFF;} 
.text1        {font-style: normal; font-weight: bold; font-size: 12px; color: #FFFFFF; background-color: transparent;} 
.catbg        {color: #000000; font-weight: bold; font-size: 13px; background-image : url(http://www.yabb.info/community/YaBBImages/catbg.jpg);} 
.bordercolor  {background-color: #6394BD; font-size: 12px; font-family: Verdana, arial, helvetica, serif;} 
.quote        {font-size: 10px; font-family: Arial, verdana, helvetica, serif; color: #000000; background-color: #DEE7EF;} 
.code         {font-size: 10px; font-family: Courier New, helvetica, Times New Roman, serif; color: #000000; background-color: #CCCCCC;} 
.help         {background-color: transparent; cursor:help; }
.meaction     {color: red;}
 
--> 
</style> 
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">  
<META NAME="description" CONTENT="<yabb title>"> 
<META NAME="keywords" CONTENT="PHP, MySQL, bulletin, board, free, open, source, YaBB, yet, another, SE">
</head> 
 
<body text="#000000" bgcolor="#F5F5F5" link="#0033FF"> 
<table border="0" width="90%" cellspacing="0" cellpadding="0" bgcolor="#6394BD" class="bordercolor" align="center"><tr><td>
<table border="0" width="100%" cellspacing="1" cellpadding="0" bgcolor="#6394BD" class="bordercolor" align="center"> 
  <tr>  
    <td>  
    <table cellpadding="0" cellspacing="0" border="0" width="100%" align="center"> 
      <tr>  
        <td valign="middle" align="LEFT" bgcolor="#FFFFFF"><img src="YaBBImages/selogo.jpg" alt="logo"></td> 
        <td bgcolor="#FFFFFF" valign="middle"><font size="2"><yabb uname> <yabb im><BR><yabb time></font></td> 
      </tr> 
    </table> 
	</td> 
   </tr>
   <tr align="center" valign="middle" bgcolor="#b7bbda">  
     <td bgcolor="#AFC6DB"><font size="1"><yabb menu></font></td> 
   </tr> 
     <tr>  
        <td width="100%" bgcolor="#FFFFFF" height="24"> 
         <yabb news>
    </td> 
  </tr> 
</table>
</td></tr></table>
<br>
<table border="0" width="90%" cellspacing="0" cellpadding="0" bgcolor="#6394BD" class="bordercolor" align="center"><tr><td>
<table border="0" width="100%" cellspacing="1" cellpadding="0" bgcolor="#6394BD" class="bordercolor" align="center"> 
  <tr> 
    <td>  
    <table width="100%" cellspacing="0" cellpadding="10" border="0" align="center" bgcolor="#FFFFFF"> 
      <tr>  
        <td valign="TOP" width="100%"> 
        <yabb main> 
        </td> 
      </tr> 
    </table> 
    </td> 
  </tr> 
</table> 
</td></tr></table>
<table border="0" cellspacing="0" cellpadding="0" width="90%" align="center"><tr><td align="right" nowrap><yabb VBStyleLogin></td></tr></table><br>
<table border="0" width="90%" cellspacing="0" cellpadding="0" bgcolor="#6394BD" class="bordercolor" align="center"><tr><td>
<table border="0" width="100%" cellspacing="1" cellpadding="0" bgcolor="#6394BD" class="bordercolor" align="center"> 
  <tr>  
    <td>  
    <table border="0" width="100%" cellpadding="3" cellspacing="0" bgcolor="#FFFFFF"> 
      <tr>  
        <td valign="middle" align="right" bgcolor="#FFFFFF" width="25%">  
         <a href="http://www.mysql.com"><img border="0" 
        src="http://www.yabb.info/community/YaBBImages/mysql.gif" 
        alt="Powered by MySQL" height="31" width="88"></a> 
        <a href="http://www.php.net"><img border="0" 
        src="http://www.yabb.info/community/YaBBImages/php.gif" 
        alt="Powered by PHP" height="31" width="88"></a>          
        </td> 
        <td bgcolor="#FFFFFF" valign="middle" align="center" width="50%">  
        <yabb copyright> 
        </td> 
         <td bgcolor="#FFFFFF" valign="middle" align="left" width="25%">  
         <a href="http://validator.w3.org/check/referer"><img border="0" 
        src="http://www.yabb.info/community/YaBBImages/vhtml.gif" 
        alt="Valid HTML 4.01!" height="31" width="88"></a> 
        <a href="http://jigsaw.w3.org/css-validator/check/referer"><img border="0" 
        src="http://www.yabb.info/community/YaBBImages/vcss.gif" 
        alt="Valid CSS!" height="31" width="88"></a> 
        </td> 
      </tr> 
    </table> 
    </td>
  </tr> 
</table> 
</td></tr></table>
</body> 
</html>file|^|ubbc.js|^|3887|^|1008003814
function DoConfirm(message, url) {
	if(confirm(message)) location.href = url;
}

function WhichClicked(ww) {
	window.document.postmodify.waction.value = ww;
}

function submitonce(theform) {
	// if IE 4+ or NS 6+
	if (document.all || document.getElementById) {
		// hunt down "submit" and "reset"
		for (i=0;i<theform.length;i++) {
			var tempobj=theform.elements[i];
			if(tempobj.type.toLowerCase()=="submit"||tempobj.type.toLowerCase()=="reset") {
				//disable it
				tempobj.disabled=true;
			}
		}
	}
}

function storeCaret(text) { 
	if (text.createTextRange) {
		text.caretPos = document.selection.createRange().duplicate();
	}
}

function AddText(text) {
	if (document.postmodify.message.createTextRange && document.postmodify.message.caretPos) {      
		var caretPos = document.postmodify.message.caretPos;      
		caretPos.text = caretPos.text.charAt(caretPos.text.length - 1) == ' ' ?
		text + ' ' : text;
	}
	else document.postmodify.message.value += text;
	document.postmodify.message.focus(caretPos)
}

function hr() {
	AddTxt="[hr]";
	AddText(AddTxt);
}

function size() {
	AddTxt="[size=2][/size]";
	AddText(AddTxt);
}

function font() {
	AddTxt="[font=Verdana][/font]";
	AddText(AddTxt);
}

function teletype() {
	AddTxt="[tt][/tt]";
	AddText(AddTxt);
}

function right() {
	AddTxt="[right][/right]";
	AddText(AddTxt);
}

function left() {
	AddTxt="[left][/left]";
	AddText(AddTxt);
}

function superscript() {
	AddTxt="[sup][/sup]";
	AddText(AddTxt);
}

function subscript() {
	AddTxt="[sub][/sub]";
	AddText(AddTxt);
}

function image() {
	AddTxt="[img]URL[/img]";
	AddText(AddTxt);
}

function ftp() {
	AddTxt="[ftp][/ftp]";
	AddText(AddTxt);
}

function move() {
	AddTxt="[move]STUFF[/move]";
	AddText(AddTxt);
}

function shadow() {
	AddTxt="[shadow=red,left,300]TEXT[/shadow]";
	AddText(AddTxt);
}

function glow() {
	AddTxt="[glow=red,2,300]TEXT[/glow]";
	AddText(AddTxt);
}

function flash() {
	AddTxt="[flash=200,200]URL[/flash]";
	AddText(AddTxt);
}

function pre() {
	AddTxt="[pre][/pre]";
	AddText(AddTxt);
}

function tcol() {
	AddTxt="[td][/td]";
	AddText(AddTxt);
}

function trow() {
	AddTxt="[tr][/tr]";
	AddText(AddTxt);
}

function table() {
	AddTxt="[table][tr][td][/td][/tr][/table]";
	AddText(AddTxt);
}

function strike() {
	AddTxt="[s][/s]";
	AddText(AddTxt);
}

function underline() {
	AddTxt="[u][/u]";
	AddText(AddTxt);
}

function emai1() {
	AddTxt="[email][/email]";
	AddText(AddTxt);
}

function bold() {
	AddTxt="[b][/b]";
	AddText(AddTxt);
}

function italicize() {
	AddTxt="[i][/i]";
	AddText(AddTxt);
}

function quote() {
	AddTxt="[quote][/quote]";
	AddText(AddTxt);
}

function center() {
	AddTxt="[center][/center]";
	AddText(AddTxt);
}

function hyperlink() {
	AddTxt="[url][/url]";
	AddText(AddTxt);
}

function showcode() {
	AddTxt="[code][/code]";
	AddText(AddTxt);
}

function list() {
	AddTxt="[list][*][*][*][/list]";
	AddText(AddTxt);
}

function showcolor(color) {
	AddTxt="[color="+color+"][/color]";
	AddText(AddTxt);
}

function smiley() {
	AddTxt=" :)";
	AddText(AddTxt);
}

function wink() {
	AddTxt=" ;)";
	AddText(AddTxt);
}

function cheesy() {
	AddTxt=" :D";
	AddText(AddTxt);
}

function grin() {
	AddTxt=" ;D";
	AddText(AddTxt);
}

function angry() {
	AddTxt=" >:(";
	AddText(AddTxt);
}

function sad() {
	AddTxt=" :(";
	AddText(AddTxt);
}

function shocked() {
	AddTxt=" :o";
	AddText(AddTxt);
}

function cool() {
	AddTxt=" 8)";
	AddText(AddTxt);
}

function huh() {
	AddTxt=" ???";
	AddText(AddTxt);
}

function rolleyes() {
	AddTxt=" ::)";
	AddText(AddTxt);
}

function tongue() {
	AddTxt=" :P";
	AddText(AddTxt);
}

function lipsrsealed() {
	AddTxt=" :-X";
	AddText(AddTxt);
}

function embarassed() {
	AddTxt=" :-[";
	AddText(AddTxt);
}

function undecided() {
	AddTxt=" :-\\";
	AddText(AddTxt);
}

function kiss() {
	AddTxt=" :-*";
	AddText(AddTxt);
}

function cry() {
	AddTxt=" :'(";
	AddText(AddTxt);
}
file|^|yabb.sql|^|13025|^|1008605958
#
# Table structure for table `banned`
#

CREATE TABLE banned (
  type tinytext NOT NULL,
  value tinytext NOT NULL
) TYPE=MyISAM;

#
# Table structure for table `boards`
#

CREATE TABLE boards (
  ID_CAT tinyint(4) NOT NULL default '0',
  ID_BOARD tinyint(4) NOT NULL auto_increment,
  name tinytext NOT NULL,
  description text,
  moderators text,
  boardOrder tinyint(4) NOT NULL default '0',
  numTopics int(11) NOT NULL default '0',
  numPosts int(11) NOT NULL default '0',
  PRIMARY KEY  (ID_BOARD)
) TYPE=MyISAM;

#
# Dumping data for table `boards`
#

INSERT INTO boards VALUES (1, 1, 'General Discussion', 'Feel free to talk about anything and everything in this board.', '', 0, 1, 1);
# --------------------------------------------------------

#
# Table structure for table `categories`
#

CREATE TABLE categories (
  ID_CAT tinyint(4) NOT NULL auto_increment,
  name tinytext NOT NULL,
  memberGroups text,
  catOrder tinyint(4) NOT NULL default '0',
  PRIMARY KEY  (ID_CAT)
) TYPE=MyISAM;

#
# Dumping data for table `categories`
#

INSERT INTO categories VALUES (1, 'General Category', '', 0);
# --------------------------------------------------------

#
# Table structure for table `censor`
#

CREATE TABLE censor (
  vulgar tinytext,
  proper tinytext
) TYPE=MyISAM;

#
# Table structure for table `instant_messages`
#

CREATE TABLE instant_messages (
  ID_IM bigint(20) NOT NULL auto_increment,
  ID_MEMBER_FROM int(11) NOT NULL default '0',
  ID_MEMBER_TO int(11) NOT NULL default '0',
  deletedBy int(11) NOT NULL default '-1',
  fromName tinytext NOT NULL,
  toName tinytext NOT NULL,
  msgtime bigint(20) default NULL,
  subject tinytext,
  body text,
  PRIMARY KEY  (ID_IM)
) TYPE=MyISAM;


#
# Table structure for table `log_banned`
#

CREATE TABLE log_banned (
  ip tinytext,
  email tinytext,
  logTime bigint(20) default NULL
) TYPE=MyISAM;


#
# Table structure for table `log_boards`
#

CREATE TABLE log_boards (
  memberName tinytext NOT NULL,
  ID_BOARD tinyint(4) NOT NULL default '0',
  logTime bigint(20) default NULL
) TYPE=MyISAM;


#
# Table structure for table `log_clicks`
#

CREATE TABLE log_clicks (
  ip tinytext,
  logTime bigint(20) NOT NULL default '0',
  agent tinytext,
  toUrl tinytext,
  fromUrl tinytext,
  KEY logTime (logTime)
) TYPE=MyISAM;

#
# Table structure for table `log_floodcontrol`
#

CREATE TABLE log_floodcontrol (
  ip tinytext,
  logTime bigint(20) default NULL
) TYPE=MyISAM;


#
# Table structure for table `log_karma`
#

CREATE TABLE log_karma (
  ID_TARGET int(11) NOT NULL default '0',
  ID_EXECUTOR int(11) NOT NULL default '0',
  action tinytext NOT NULL,
  logTime bigint(20) NOT NULL default '0'
) TYPE=MyISAM;

#
# Table structure for table `log_mark_read`
#

CREATE TABLE log_mark_read (
  memberName tinytext NOT NULL,
  ID_BOARD tinyint(4) NOT NULL default '0',
  logTime bigint(20) default NULL
) TYPE=MyISAM;

#
# Table structure for table `log_online`
#

CREATE TABLE log_online (
  identity tinytext NOT NULL,
  logTime bigint(20) default NULL
) TYPE=MyISAM;


#
# Table structure for table `log_topics`
#

CREATE TABLE log_topics (
  memberName tinytext NOT NULL,
  ID_TOPIC int(11) NOT NULL default '0',
  logTime bigint(20) default NULL
) TYPE=MyISAM;

#
# Table structure for table `membergroups`
#

CREATE TABLE membergroups (
  ID_GROUP tinyint(4) NOT NULL auto_increment,
  membergroup tinytext NOT NULL,
  grouptype tinyint(1) NOT NULL default '0',
  PRIMARY KEY  (ID_GROUP)
) TYPE=MyISAM;

#
# Dumping data for table `membergroups`
#

INSERT INTO membergroups VALUES (1, 'Administrator', 0);
INSERT INTO membergroups VALUES (2, 'Moderator', 0);
INSERT INTO membergroups VALUES (3, 'Newbie', 0);
INSERT INTO membergroups VALUES (4, 'Jr. Member', 0);
INSERT INTO membergroups VALUES (5, 'Full Member', 0);
INSERT INTO membergroups VALUES (6, 'Sr. Member', 0);
INSERT INTO membergroups VALUES (7, 'YaBB God', 0);
INSERT INTO membergroups VALUES (8, 'Global Moderator', 0);

# --------------------------------------------------------

#
# Table structure for table `members`
#

CREATE TABLE members (
  ID_MEMBER int(10) unsigned NOT NULL auto_increment,
  memberName tinytext NOT NULL,
  realName tinytext,
  passwd tinytext NOT NULL,
  emailAddress tinytext,
  dateRegistered bigint(20) default NULL,
  personalText tinytext,
  memberGroup tinytext,
  gender tinytext,
  birthdate date NOT NULL default '0000-00-00',
  websiteTitle tinytext,
  websiteUrl tinytext,
  location tinytext,
  ICQ tinytext,
  AIM tinytext,
  YIM tinytext,
  hideEmail tinyint(4) default NULL,
  timeFormat tinytext,
  signature text,
  posts int(11) default NULL,
  timeOffset float default NULL,
  avatar tinytext,
  im_ignore_list text,
  im_email_notify tinyint(4) NOT NULL default '0',
  karmaGood int NOT NULL default '0',
  karmaBad int NOT NULL default '0',
  lastLogin bigint(20),
  PRIMARY KEY  (ID_MEMBER),
  UNIQUE KEY memberID (ID_MEMBER),
  KEY memberID_2 (ID_MEMBER)
) TYPE=MyISAM;

#
# Table structure for table `messages`
#

CREATE TABLE messages (
  ID_MSG int(11) NOT NULL auto_increment,
  ID_TOPIC int(11) NOT NULL default '0',
  ID_MEMBER int(11) NOT NULL default '0',
  subject tinytext,
  posterName tinytext NOT NULL,
  posterEmail tinytext,
  posterTime bigint(20) default NULL,
  posterIP tinytext NOT NULL,
  smiliesEnabled tinyint(4) NOT NULL default '1',
  modifiedTime bigint(20) default NULL,
  modifiedName tinytext,
  body text,
  icon tinytext,
  attachmentSize int(11) NOT NULL default '0',
  attachmentFilename tinytext,
  PRIMARY KEY  (ID_MSG),
  KEY ID_TOPIC (ID_TOPIC)
) TYPE=MyISAM;

#
# Dumping data for table `messages`
#

INSERT INTO messages VALUES (1, 1, -1, 'Welcome to YaBB SE!', 'YaBB SE Dev Team', 'yabbsedev@yabb.info', 1007831725, '65.93.102.203', 1, NULL, NULL, 'Welcome to YaBB SE!\n\nWe hope you enjoy using your new forum.', 'xx','0','');
# --------------------------------------------------------

#
# Table structure for table `polls`
#

CREATE TABLE polls (
  ID_POLL int(11) NOT NULL auto_increment,
  question tinytext NOT NULL,
  votingLocked tinyint(4) NOT NULL default '0',
  votedMemberIDs text,
  option1 tinytext,
  option2 tinytext,
  option3 tinytext,
  option4 tinytext,
  option5 tinytext,
  option6 tinytext,
  option7 tinytext,
  option8 tinytext,
  votes1 int(11) NOT NULL default '0',
  votes2 int(11) NOT NULL default '0',
  votes3 int(11) NOT NULL default '0',
  votes4 int(11) NOT NULL default '0',
  votes5 int(11) NOT NULL default '0',
  votes6 int(11) NOT NULL default '0',
  votes7 int(11) NOT NULL default '0',
  votes8 int(11) NOT NULL default '0',
  PRIMARY KEY  (ID_POLL)
) TYPE=MyISAM;

#
# Table structure for table `reserved_names`
#

CREATE TABLE reserved_names (
  setting tinytext NOT NULL,
  value text NOT NULL
) TYPE=MyISAM;

#
# Dumping data for table `reserved_names`
#

INSERT INTO reserved_names VALUES ('matchword', '0');
INSERT INTO reserved_names VALUES ('matchcase', '1');
INSERT INTO reserved_names VALUES ('matchuser', '1');
INSERT INTO reserved_names VALUES ('matchname', '1');

# --------------------------------------------------------

#
# Table structure for table `settings`
#

CREATE TABLE settings (
  variable tinytext NOT NULL,
  value text NOT NULL
) TYPE=MyISAM;

#
# Dumping data for table `settings`
#

INSERT INTO settings VALUES ('news', 'YaBB SE! Just Installed!');
INSERT INTO settings VALUES ('agreement', 'You agree, through your use of this YaBB forum, that you will not post any material which is false, defamatory, inaccurate, abusive, vulgar, hateful, harassing, obscene, profane, sexually oriented, threatening, invasive of a person\'s privacy, or otherwise in violation of ANY law. This is not only humorous, but legal actions can be taken against you. You also agree not to post any copyrighted material unless the copyright is owned by you or you have consent from the owner of the copyrighted material. Spam, flooding, advertisements, chain letters, pyramid schemes, and solicitations are also inappropriate to this YaBB forum. \r\n\r\nNote that it is impossible for us to confirm the validity of posts on this YaBB forum. Please remember that we do not actively monitor the posted messages and are not responsible for their content. We do not warrant the accuracy, completeness or usefulness of any information presented. The messages express the views of the author, not necessarily the views of this YaBB forum. Anyone who feels that a posted message is objectionable is encouraged to notify an administrator of this forum immediately. We have the rights to remove objectionable content, within a reasonable time frame, if we determine that removal is necessary. This is a manual process, however, so please realize that we may not be able to remove or edit particular messages immediately. This policy goes for member profile information as well.\r\n\r\nYou remain solely responsible for the content of your messages, and you agree to indemnify and hold harmless this forum, and any related websites to this forum. We at this YaBB forum also reserve the right to reveal your identity (or any information we have about you) in the event of a complaint or legal action arising from any information posted by you.\r\n\r\nYou have the ability, as you register, to choose your username. We advise that you keep the name appropriate. With this user account you are about to register, you agree to never give your password out to another member, for your protection and for validity reasons. You also agree to NEVER use another member\'s account to post messages or browse this forum.\r\n\r\nAfter you register and log into this YaBB forum, you can fill out a detailed profile. It is your responsibility to present clean and accurate information. Any information we deem inaccurate or vulgar will be removed.\r\n\r\nPlease note that with each post, your IP address is recorded, in the event that you need to be banned from this YaBB forum or your ISP contacted. This will only happen in the event of a major violation of this agreement.\r\n\r\nAlso note that the software places a cookie, a text file containing bits of information (such as your username and password), in your browsers cache. This is ONLY used to keep you logged in/out. The software does not collect or sends any other form of information to your computer.');
INSERT INTO settings VALUES ('maxdays', '30');
INSERT INTO settings VALUES ('yabbinfo', '1007831605');
INSERT INTO settings VALUES ('enableStickyTopics', '0');
INSERT INTO settings VALUES ('todayMod', '0');
INSERT INTO settings VALUES ('karmaMode', '0');
INSERT INTO settings VALUES ('karmaTimeRestrictAdmins', '1');
INSERT INTO settings VALUES ('enablePreviousNext', '0');
INSERT INTO settings VALUES ('PreviousNext_back', '<sub> previous</sub>');
INSERT INTO settings VALUES ('PreviousNext_forward', '<sub>next </sub>');
INSERT INTO settings VALUES ('pollPostingRestrictions', '0');
INSERT INTO settings VALUES ('pollMode', '0');
INSERT INTO settings VALUES ('pollEditMode', '0');
INSERT INTO settings VALUES ('enableVBStyleLogin', '0');
INSERT INTO settings VALUES ('enableCompressedOutput', '0');
INSERT INTO settings VALUES ('karmaWaitTime', '6');
INSERT INTO settings VALUES ('karmaMinPosts', '0');
INSERT INTO settings VALUES ('karmaMemberGroups', '');
INSERT INTO settings VALUES ('karmaLabel', 'Karma:');
INSERT INTO settings VALUES ('karmaSmiteLabel', '[smite]');
INSERT INTO settings VALUES ('karmaApplaudLabel', '[applaud]');
INSERT INTO settings VALUES ('attachmentSizeLimit', '200');
INSERT INTO settings VALUES ('attachmentDirSizeLimit', '10240');
INSERT INTO settings VALUES ('attachmentUploadDir', '');
INSERT INTO settings VALUES ('attachmentUrl', '');
INSERT INTO settings VALUES ('attachmentExtensions', 'txt,jpg,gif,pdf');
INSERT INTO settings VALUES ('attachmentCheckExtensions', '1');
INSERT INTO settings VALUES ('attachmentShowImages', '0');
INSERT INTO settings VALUES ('attachmentEnable', '0');
INSERT INTO settings VALUES ('attachmentEnableGuest', '0');
INSERT INTO settings VALUES ('attachmentMemberGroups', 'Administrator');
INSERT INTO settings VALUES ('disableCaching', '0');
INSERT INTO settings VALUES ('enableInlineLinks', '0');
INSERT INTO settings VALUES ('enableSP1Info', '0');
# --------------------------------------------------------

#
# Table structure for table `topics`
#

CREATE TABLE topics (
  ID_TOPIC int(11) NOT NULL auto_increment,
  ID_BOARD tinyint(4) NOT NULL default '0',
  ID_MEMBER_STARTED int(11) NOT NULL default '0',
  ID_MEMBER_UPDATED int(11) NOT NULL default '0',
  ID_FIRST_MSG int(11) NOT NULL default '0',
  ID_LAST_MSG int(11) NOT NULL default '0',
  ID_POLL int(11) NOT NULL default '-1',
  numReplies int(11) NOT NULL default '0',
  numViews int(11) NOT NULL default '0',
  locked tinyint(4) NOT NULL default '0',
  notifies text,
  isSticky tinyint(4) NOT NULL default '0',
  PRIMARY KEY  (ID_TOPIC)
) TYPE=MyISAM;

#
# Dumping data for table `topics`
#

INSERT INTO topics VALUES (1, 1, -1, -1, 1, 1, -1, 0, 0, 0, NULL, 0);
file|^|yabbinfo.xml|^|644|^|1008003816
<?xml version="1.0"?><yabbinfo
xmlns:yabbinfo="http://yabb.info/yabbinfo.dtd">

	<infoitem>
		<subject>YaBB SE revealed!</subject>
		<url>http://www.yabb.info/</url>
		<timestamp>1006200382</timestamp>
		<author>YaBB SE Team</author>
		<details>YaBB SE has finally been revealed for testing - downloads coming soon!</details>
	</infoitem>

	<infoitem>
		<subject>XML Syndication!</subject>
		<url>http://www.yabb.info/yabbinfo.xml</url>
		<timestamp>1006200382</timestamp>
		<author>YaBB SE Team</author>
		<details>YaBB.info news is now available as an XML file - feel free to include the info on your site</details>
	</infoitem>

</yabbinfo>
